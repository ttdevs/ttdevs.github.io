{"meta":{"title":"ttdevs","subtitle":"ä½ ä¹‹æ‰€ä»¥è§‰å¾—æ—¶é—´ä¸€å¹´æ¯”ä¸€å¹´è¿‡å¾—å¿«ï¼Œæ˜¯å› ä¸ºæ—¶é—´å¯¹ä½ ä¸€å¹´æ¯”ä¸€å¹´é‡è¦","description":"ttdevs's blog","author":"ttdevs","url":"https://ttdevs.github.io"},"pages":[{"title":"About","date":"2017-04-17T02:39:44.000Z","updated":"2017-04-17T03:37:50.000Z","comments":true,"path":"about/index.html","permalink":"https://ttdevs.github.io/about/index.html","excerpt":"","text":"ttdevs Github: ttdevs ç®€ä¹¦: ttdevs å›¾è™«: ttdevs"},{"title":"tags","date":"2017-04-17T09:08:36.000Z","updated":"2017-04-17T09:09:26.000Z","comments":false,"path":"tags/index.html","permalink":"https://ttdevs.github.io/tags/index.html","excerpt":"","text":""},{"title":"categories","date":"2017-04-17T09:09:44.000Z","updated":"2017-04-17T09:15:21.000Z","comments":false,"path":"categories/index.html","permalink":"https://ttdevs.github.io/categories/index.html","excerpt":"","text":""}],"posts":[{"title":"[Android]ä»é€šè¿‡view.post()è·å–Viewå®½é«˜è°ˆAndroidæ¶ˆæ¯æœºåˆ¶","slug":"Android-ä»é€šè¿‡view-post-è·å–Viewå®½é«˜è°ˆAndroidæ¶ˆæ¯æœºåˆ¶","date":"2017-07-26T05:23:19.000Z","updated":"2017-07-27T07:19:01.000Z","comments":true,"path":"2017/07/26/Android-ä»é€šè¿‡view-post-è·å–Viewå®½é«˜è°ˆAndroidæ¶ˆæ¯æœºåˆ¶/","link":"","permalink":"https://ttdevs.github.io/2017/07/26/Android-ä»é€šè¿‡view-post-è·å–Viewå®½é«˜è°ˆAndroidæ¶ˆæ¯æœºåˆ¶/","excerpt":"","text":"0x00 é€šè¿‡view.post()è·å–Viewå®½é«˜æœ‰æ—¶å€™æˆ‘ä»¬å¸Œæœ›åœ¨ç•Œé¢åˆå§‹è¯çš„æ—¶å€™æ ¹æ®Viewçš„å°ºå¯¸æ¥åšä¸€äº›ç›¸å…³çš„æ“ä½œï¼ˆè°ƒæ•´ï¼‰ï¼Œé‚£å¦‚ä½•è·å–Viewçš„å°ºå¯¸å‘¢ï¼Ÿ åœ¨Activityçš„ onCreate() æ–¹æ³•ä¸­ delay å‡ ç™¾æ¯«ç§’\u001b\u001b ç”±äºæˆ‘ä»¬çŸ¥é“åœ¨ onCreate() ä¸­ç›´æ¥è·å–Viewçš„å°ºå¯¸å¾—åˆ°çš„å®½é«˜éƒ½æ˜¯0ï¼Œè¿™ä¸ªä¸ç»æ€è€ƒçš„ç­”æ¡ˆç›¸ä¿¡å¾ˆå¤šäººåœ¨ç”¨ã€‚ å¦‚æœä½ Googleè¿‡ç­”æ¡ˆï¼Œä¸€èˆ¬ä¼šæœ‰ä¸‹é¢è¿™å‡ ç§æ–¹æ³•ï¼š onWindowFocusChanged é‡å†™Activityçš„ onWindowFocusChanged() æ–¹æ³•ï¼Œå½“Activityçš„ç„¦ç‚¹çŠ¶æ€å‘ç”Ÿå˜åŒ–æ—¶ä¼šå›è°ƒè¿™ä¸ªæ–¹æ³•ï¼Œå‚æ•° hasFocus ä¸º true æ—¶è¡¨ç¤ºå·²ç»è·å–åˆ°ç„¦ç‚¹ï¼Œè¿™ä¸ªæ—¶å€™Viewçš„ç»˜åˆ¶å·²ç»å®Œæˆï¼Œä¹Ÿå°±å¯ä»¥è·å–åˆ°Viewçš„å°ºå¯¸äº†ã€‚ @Override public void onWindowFocusChanged(boolean hasFocus) { super.onWindowFocusChanged(hasFocus); if (hasFocus) { System.out.println(&quot;&gt;&gt;&gt;&gt;&gt;onWindowFocusChanged&quot; + tvLog.getWidth()); System.out.println(&quot;&gt;&gt;&gt;&gt;&gt;onWindowFocusChanged&quot; + tvLog.getHeight()); } } ViewTreeObserver.addOnPreDrawListener or .addOnGlobalLayoutListener è¿™ä¸ªæ–¹æ³•çš„ç¼ºç‚¹æ˜¯ä¼šå¤šæ¬¡è°ƒç”¨ã€‚ private void getViewSize(){ tvLog.getViewTreeObserver().addOnPreDrawListener(new ViewTreeObserver.OnPreDrawListener() { @Override public boolean onPreDraw() { System.out.println(&quot;&gt;&gt;&gt;&gt;&gt;addOnPreDrawListener&quot; + tvLog.getWidth()); System.out.println(&quot;&gt;&gt;&gt;&gt;&gt;addOnPreDrawListener&quot; + tvLog.getHeight()); return true; } }); tvLog.getViewTreeObserver().addOnGlobalLayoutListener(new ViewTreeObserver.OnGlobalLayoutListener() { @Override public void onGlobalLayout() { System.out.println(&quot;&gt;&gt;&gt;&gt;&gt;addOnGlobalLayoutListener&quot; + tvLog.getWidth()); System.out.println(&quot;&gt;&gt;&gt;&gt;&gt;addOnGlobalLayoutListener&quot; + tvLog.getHeight()); } }); } view.post() è¿™ä¸­æ–¹æ³•æ˜¯æˆ‘ä¸ªäººæ¨èçš„æ–¹æ³•ï¼Œæ¥ä¸‹æ¥çš„å†…å®¹ä¼šç€é‡åˆ†æã€‚ private void getViewSize() { tvLog.post(new Runnable() { @Override public void run() { System.out.println(&quot;&gt;&gt;&gt;&gt;&gt;post&quot; + tvLog.getWidth()); System.out.println(&quot;&gt;&gt;&gt;&gt;&gt;post&quot; + tvLog.getHeight()); } }); } å½“ç„¶ï¼Œè¿˜ä¼šæœ‰ä¸€äº›å…¶ä»–æ–¹æ³•ï¼Œæ¯”å¦‚æ‰‹åŠ¨measureï¼Œåœ¨Viewå†…éƒ¨è·å–ç­‰ç­‰ å¯ä»¥å‚è€ƒè¿™é‡Œ ä»¥ä¸Šçš„å‡ ç§æ–¹æ³•éƒ½å¯ä»¥ï¼Œä¸‹é¢é’ˆå¯¹View.poståšä¸€ä¸ªåˆ†æã€‚ 0x01 Androidç³»ç»Ÿçš„æ¶ˆæ¯æœºåˆ¶Androidç³»ç»Ÿçš„æ¶ˆæ¯æœºåˆ¶ï¼Œæ˜¯æ¯ä¸ªåˆå­¦è€…éƒ½å¿…é¡»æŒæ¡çš„åŸºç¡€çŸ¥è¯†ã€‚ä»¥å‰å­¦ä¹ çš„æ—¶å€™æœ‰çœ‹è¿‡ï¼Œåˆé¢è¯•çš„æ—¶å€™ä¹Ÿå»çªå‡»è¿‡ï¼Œä½†æ˜¯éƒ½æ·±å…¥çš„å»ç†è§£å»æŒæ¡ï¼Œæƒ­æ„§å‘¢ã€‚ å¯¹äºä¸€ä¸ªæ¶ˆæ¯ç³»ç»Ÿï¼Œå¤§å®¶å¯ä»¥ç±»æ¯”ä¸‹ç”Ÿæ´»ä¸­çš„å¿«é€’ç³»ç»Ÿï¼šæœ‰å‘ä»¶äººï¼Œæœ‰æ”¶ä»¶äººï¼Œæœ‰å¿«é€’å…¬å¸ï¼Œå½“ç„¶è¿˜æœ‰æœ€é‡è¦çš„ä¿¡ä»¶ã€‚é€šè¿‡è¿™ä¸ªç³»ç»Ÿæˆ‘ä»¬å¯ä»¥å°†ä¸åŒçš„ä¿¡ä»¶æŠ•é€åˆ°ä¸åŒçš„åœ°æ–¹ï¼Œæ¯”å¦‚ä»ä¸ªäººæŠ•é€åˆ°æ”¿åºœéƒ¨é—¨ï¼Œä»å›½å†…æŠ•é€åˆ°å›½å¤–ç­‰ã€‚ä¸‹é¢çš„è¡¨æ ¼çœ‹èµ·æ¥ä¼šæ›´ç›´è§‚ä¸€äº›ï¼š å¿«é€’ç³»ç»Ÿ Androidæ¶ˆæ¯ç³»ç»Ÿ èŒè´£ å‘ä»¶äºº Handler å‘é€æ¶ˆæ¯ æ”¶ä»¶äºº Handler æ¥æ”¶å¤„ç†æ¶ˆæ¯ å¿«ä»¶ Message å‘é€çš„å†…å®¹ å¿«é€’å…¬å¸ Looper / MessageQueue æ¥æ”¶æ¶ˆæ¯ã€ä¼ é€’æ¶ˆæ¯ã€åˆ†å‘æ¶ˆæ¯ ç›¸ä¿¡è¿™ä¸ªç®€å•çš„å¯¹æ¯”å¯¹ç†è§£æ¶ˆæ¯æœºåˆ¶ä¼šæœ‰å¾ˆå¤§å¸®åŠ©ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬å†æ¥çœ‹çœ‹è¿™ä¸ªç³»ç»Ÿæ˜¯å¦‚ä½•è¿è¡Œçš„ã€‚ å…ˆçœ‹ä¸€ä¸‹æ¶ˆæ¯ç³»ç»Ÿçš„ç®€å•ä½¿ç”¨ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142public class MainActivity extends AppCompatActivity implements View.OnClickListener &#123; private static Handler mHandler = new Handler() &#123; @Override public void handleMessage(Message msg) &#123; super.handleMessage(msg); printMsg(\"handleMessage:\" + msg.obj); &#125; &#125;; @Override protected void onCreate(Bundle savedInstanceState) &#123; super.onCreate(savedInstanceState); setContentView(R.layout.activity_main); &#125; @Override public void onClick(View view) &#123; switch (view.getId()) &#123; case R.id.btSendMsg: defaultSendMsg(); break; default: break; &#125; &#125; private void defaultSendMsg() &#123; Message msg = new Message(); msg.obj = \"è¿™æ˜¯æœ€ç®€å•çš„ä½¿ç”¨æ–¹æ³•ï¼Œä½†æ— å®é™…æ„ä¹‰\"; mHandler.sendMessage(msg); printMsg(\"Is MainLooper: \" + (mHandler.getLooper() == getMainLooper())); &#125; private static void printMsg(String msg) &#123; System.out.println(\"&gt;&gt;&gt;&gt;&gt;\" + msg); &#125;&#125; è¾“å‡ºä¿¡æ¯ï¼š 12I/System.out: &gt;&gt;&gt;&gt;&gt;Is MainLooper: trueI/System.out: &gt;&gt;&gt;&gt;&gt;handleMessage:è¿™æ˜¯æœ€ç®€å•çš„ä½¿ç”¨æ–¹æ³•ï¼Œä½†æ— å®é™…æ„ä¹‰ ä»è¿™é‡Œå¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬éœ€è¦å…ˆåˆ›å»ºä¸€ä¸ªHandlerå¯¹è±¡ï¼Œç„¶åé€šè¿‡è¿™ä¸ªHandlerå‘é€æ¶ˆæ¯ï¼Œç„¶ååœ¨Handlerä¸­å¤„ç†æ¥æ”¶åˆ°çš„æ¶ˆæ¯ã€‚å¦å¤–æˆ‘ä»¬è¿˜çœ‹åˆ°æˆ‘ä»¬çš„Looperå¯¹è±¡æ˜¯ä¸»çº¿ç¨‹çš„Looperï¼Œè¿™æ˜¯å› ä¸ºæˆ‘ä»¬æ˜¯åœ¨Activityè·‘çš„è¿™æ®µä»£ç ã€‚ä¸‹é¢æˆ‘ä»¬æ¥è·Ÿä¸€ä¸‹ä»£ç ã€‚ ä»Handlerçš„æ„é€ æ–¹æ³•å¼€å§‹ï¼š 123456789101112public Handler(Callback callback, boolean async) &#123; ... mLooper = Looper.myLooper(); if (mLooper == null) &#123; throw new RuntimeException( \"Can't create handler inside thread that has not called Looper.prepare()\"); &#125; mQueue = mLooper.mQueue; mCallback = callback; // è¿™ä¸ªå¯¹è±¡æˆ‘ä»¬åœ¨åé¢çš„dispatchMessageæ—¶ä¼šç”¨åˆ° mAsynchronous = async;&#125; è¿™é‡Œæˆ‘ä»¬çœ‹åˆ°ï¼Œé€šè¿‡ Looper.myLooper() è·å–åˆ°ä¸€ä¸ªLooperå¯¹è±¡ï¼Œç„¶åå†ä»è¿™ä¸ªLooperå¯¹è±¡ä¸­æ‹¿åˆ°ä¸€ä¸ªMessageQueueå¯¹è±¡ï¼ˆmQueueï¼‰ï¼Œè¿™æ ·æˆ‘ä»¬å¾ˆå®¹æ˜“å¾—åˆ°ç»“è®ºâ€”â€”æ¶ˆæ¯é˜Ÿåˆ—æ˜¯ä½äºLooperä¸­çš„ã€‚é‚£MessageQueueæ˜¯ä»€ä¹ˆæ—¶å€™åˆ›å»ºçš„ï¼Œåˆæ˜¯æ€æ ·å¤„ç†æ¶ˆæ¯çš„ï¼Ÿå¸¦ç€è¿™äº›ç–‘é—®æˆ‘ä»¬æ¥ä¸‹æ¥çœ‹ Handler.sendMessage(msg) (sendMessage() æœ€ç»ˆä¼šè°ƒåˆ° sendMessageAtTime())ï¼š 123456789101112131415161718public boolean sendMessageAtTime(Message msg, long uptimeMillis) &#123; MessageQueue queue = mQueue; if (queue == null) &#123; RuntimeException e = new RuntimeException( this + \" sendMessageAtTime() called with no mQueue\"); Log.w(\"Looper\", e.getMessage(), e); return false; &#125; return enqueueMessage(queue, msg, uptimeMillis);&#125;private boolean enqueueMessage(MessageQueue queue, Message msg, long uptimeMillis) &#123; msg.target = this; if (mAsynchronous) &#123; msg.setAsynchronous(true); &#125; return queue.enqueueMessage(msg, uptimeMillis);&#125; sendMessageAtTime() ä¼šä¼ å…¥ä¸¤ä¸ªå‚æ•°ï¼šMessage å’Œ uptimeMillisï¼ŒuptimeMillis çš„æ„æ€æ˜¯æ¶ˆæ¯å°†ä¼šåœ¨è¿™ä¸ªæ—¶åˆ»æ‰§è¡Œï¼ˆä¸æ˜¯éå¸¸ç²¾ç¡®ï¼‰ï¼Œè¿™ç§æƒ…å†µæ¯”å¦‚å¸¸è§çš„ postDelayã€‚åœ¨ enqueueMessage() æ–¹æ³•ä¸­ï¼Œä¼šæ ¹æ®è¿™ä¸ªå€¼å°†æ¶ˆæ¯åŠ å…¥æ¶ˆæ¯é˜Ÿåˆ—ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥çœ‹åˆ°ï¼Œåœ¨æ”¾å…¥é˜Ÿåˆ—ä¹‹å‰Messageçš„ target è¢«è®¾ç½®ä¸ºå½“å‰çš„Handlerå¯¹è±¡â€”â€”é€éœ²ä¸‹è¿™ä¸ªæ˜¯ä¿è¯ä¹‹åæ¶ˆæ¯æŠ•é€’çš„æ—¶å€™ä»åˆ†å‘ç»™å½“å‰Handlerï¼Œè¿™ä¸ªå¾ˆé‡è¦ï¼ å†æ¥çœ‹ä¸‹ä¸Šé¢æåˆ°çš„ Looper å’Œ MessageQueueï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788899091929394959697public final class Looper &#123; ... // sThreadLocal.get() will return null unless you've called prepare(). static final ThreadLocal&lt;Looper&gt; sThreadLocal = new ThreadLocal&lt;Looper&gt;(); ... private static void prepare(boolean quitAllowed) &#123; if (sThreadLocal.get() != null) &#123; throw new RuntimeException(\"Only one Looper may be created per thread\"); &#125; sThreadLocal.set(new Looper(quitAllowed)); &#125; /** * Initialize the current thread as a looper, marking it as an * application's main looper. The main looper for your application * is created by the Android environment, so you should never need * to call this function yourself. See also: &#123;@link #prepare()&#125; */ public static void prepareMainLooper() &#123; prepare(false); synchronized (Looper.class) &#123; if (sMainLooper != null) &#123; throw new IllegalStateException(\"The main Looper has already been prepared.\"); &#125; sMainLooper = myLooper(); &#125; &#125; /** * Returns the application's main looper, which lives in the main thread of the application. */ public static Looper getMainLooper() &#123; synchronized (Looper.class) &#123; return sMainLooper; &#125; &#125; /** * Run the message queue in this thread. Be sure to call * &#123;@link #quit()&#125; to end the loop. */ public static void loop() &#123; final Looper me = myLooper(); if (me == null) &#123; throw new RuntimeException(\"No Looper; Looper.prepare() wasn't called on this thread.\"); &#125; final MessageQueue queue = me.mQueue; ... for (;;) &#123; Message msg = queue.next(); // might block if (msg == null) &#123; // No message indicates that the message queue is quitting. return; &#125; ... msg.target.dispatchMessage(msg); if (logging != null) &#123; logging.println(\"&lt;&lt;&lt;&lt;&lt; Finished to \" + msg.target + \" \" + msg.callback); &#125; ... msg.recycleUnchecked(); &#125; &#125; private Looper(boolean quitAllowed) &#123; mQueue = new MessageQueue(quitAllowed); mThread = Thread.currentThread(); &#125; /** * Return the Looper object associated with the current thread. Returns * null if the calling thread is not associated with a Looper. */ public static @Nullable Looper myLooper() &#123; return sThreadLocal.get(); &#125; /** * Return the &#123;@link MessageQueue&#125; object associated with the current * thread. This must be called from a thread running a Looper, or a * NullPointerException will be thrown. */ public static @NonNull MessageQueue myQueue() &#123; return myLooper().mQueue; &#125; private Looper(boolean quitAllowed) &#123; mQueue = new MessageQueue(quitAllowed); mThread = Thread.currentThread(); &#125; ...&#125; Looperçš„æ„é€ æ–¹æ³•ä¸­åªæ˜¯åˆ›å»ºäº†ä¸€ä¸ª MessageQueue å¯¹è±¡ï¼ŒåŒæ—¶è¿™ä¸ªæ–¹æ³•æ˜¯ç§æœ‰çš„ï¼Œå› æ­¤è¿™ä¸ªç±»æ— æ³•åœ¨å¤–éƒ¨é€šè¿‡newæ¥åˆ›å»ºï¼Œã€‚æˆ‘ä»¬çœ‹åˆ°å”¯ä¸€åˆ›å»ºçš„åœ°æ–¹å°±æ˜¯ Looper.prepare() æ–¹æ³•ä¸­ï¼Œåˆ›å»ºå¥½ä¹‹åç›´æ¥è¢«åŠ å…¥åˆ°ThreadLocalä¸­ã€‚å†æ¥çœ‹æˆ‘ä»¬åˆšæ‰ç”¨åˆ°çš„ Looper.myLooper() æ–¹æ³•ï¼Œè¿™å…¶ä¸­åªæœ‰ä¸€è¡Œå¾ˆå°´å°¬çš„ä»£ç ï¼ŒsThreadLocal.get() ï¼Œå®ƒå°±æ˜¯ä»ThreadLocalä¸­è·å– å±äºå½“å‰çº¿ç¨‹çš„ Looper å¯¹è±¡ã€‚å…³äº ThreadLocalï¼Œè¿™ä¸ªåœ¨æˆ‘çš„å¦ä¸€ç¯‡æ–‡ç« ä¸­æœ‰ä»‹ç»â€”â€”æˆ‘ä»¬åœ¨çº¿ç¨‹ä¸­åˆ›å»ºçš„å˜é‡ï¼Œä»»ä½•ä¸€ä¸ªçº¿ç¨‹éƒ½å¯ä»¥è®¿é—®å¹¶å¯¹å…¶ä¿®æ”¹ï¼Œä½†æ˜¯æˆ‘ä»¬é€šè¿‡LocalThreadåˆ›å»ºçš„å˜é‡ï¼Œå°±åªæœ‰å½“å‰çº¿ç¨‹å¯ä»¥è®¿é—®äº†ã€‚ ä¹‹å‰æˆ‘ä»¬çŸ¥é“é€šè¿‡ Handler.sendMessage(msg) å°† Message å­˜å…¥ MessageQueue ä¸­ï¼Œåœ¨ä¸Šé¢çš„ä»£ç ä¸­æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼ŒLooper.loop()ä¸­å¼€äº†ä¸€ä¸ªæ­»å¾ªç¯ï¼Œå°†æ¶ˆæ¯ä» MessageQueue ä¸­å–å‡ºç„¶åè¿›è¡Œåˆ†å‘ã€‚çœ‹åˆ° MessageQueue åæˆ‘ç¬¬ä¸€ä¸ªæƒ³åˆ°å°±æ˜¯é˜»å¡é˜Ÿåˆ—ï¼Œç»“æœçœ‹äº†æºç ä¹‹åå¹¶ä¸æ˜¯è¿™ä¹ˆç®€å•ã€‚å¦‚æœæƒ³çœ‹è¿™ä¸ªç±»çš„åˆ†æï¼Œå¯ä»¥å‚è€ƒè¿™é‡Œï¼Œè¿™æ˜¯æœ€æ ¸å¿ƒçš„éƒ¨åˆ†ï¼Œæ¶‰åŠåˆ°æ“ä½œç³»ç»Ÿçš„çŸ¥è¯†ï¼Œæˆ‘å°±ä¸å–å¼„äº†ã€‚ä½†æ˜¯è¿™ä¸å½±å“æˆ‘ä»¬å°† MessageQueue æŒ‰ç…§ä¸€ä¸ªé˜»å¡é˜Ÿåˆ—æ¥ç†è§£ã€‚ å†çœ‹ä¸‹Looperæ˜¯å¦‚ä½•ä½¿ç”¨çš„ã€‚æˆ‘ä»¬åœ¨Looperçš„ç±»æ³¨é‡Šä¸­å¯ä»¥çœ‹åˆ°è¿™æ®µä¿¡æ¯ï¼š 12345678910111213141516171819202122232425262728293031/** * Class used to run a message loop for a thread. Threads by default do * not have a message loop associated with them; to create one, call * &#123;@link #prepare&#125; in the thread that is to run the loop, and then * &#123;@link #loop&#125; to have it process messages until the loop is stopped. * * &lt;p&gt;Most interaction with a message loop is through the * &#123;@link Handler&#125; class. * * &lt;p&gt;This is a typical example of the implementation of a Looper thread, * using the separation of &#123;@link #prepare&#125; and &#123;@link #loop&#125; to create an * initial Handler to communicate with the Looper. * * &lt;pre&gt; * class LooperThread extends Thread &#123; * public Handler mHandler; * * public void run() &#123; * Looper.prepare(); * * mHandler = new Handler() &#123; * public void handleMessage(Message msg) &#123; * // process incoming messages here * &#125; * &#125;; * * Looper.loop(); * &#125; * &#125;&lt;/pre&gt; */public final class Looper &#123;...&#125; å¦‚æœæˆ‘ä»¬éœ€è¦åœ¨è‡ªå·±çš„çº¿ç¨‹ä¸­å®ç°æ¶ˆæ¯æœºåˆ¶ï¼Œæˆ‘ä»¬éœ€è¦å…ˆæ‰§è¡Œ Looper.prepare();ï¼› ç„¶ååˆ›å»º Handlerå¯¹è±¡ï¼›æœ€åå†æ‰§è¡Œ Looper.loop()ï¼›è¿™ä¸ªé¡ºåºä¸èƒ½é¢ å€’ï¼æœ€åæˆ‘ä»¬å†æ¥å°†è¿™ä¸ªæµç¨‹æ¢³ç†ä¸€ä¸‹ï¼š Looper.prepare()ï¼› åˆå§‹åŒ–å±äºå½“å‰çº¿ç¨‹çš„ Looper å¯¹è±¡ï¼Œç„¶åæ”¾å…¥ ThreadLocal ä¸­ã€‚ new Handler()ï¼› ä¸ºä»€ä¹ˆä¸€å®šè¦åœ¨ Looper.prepare() ä¹‹å Looper.loop() ä¹‹å‰åˆ›å»ºHandlerå¯¹è±¡å‘¢ï¼Ÿ ç­”ï¼šåœ¨ Looper.prepare() ä¹‹åæ˜¯å› ä¸º Handler çš„æ„é€ å‡½æ•°ä¸­éœ€è¦æä¾›å½“å‰çº¿ç¨‹çš„ Looper å¯¹ è±¡ï¼Œè¿™ä¸ª Looper å¯¹è±¡åªèƒ½é€šè¿‡ Looper.prepare() æ¥åˆ›å»ºã€‚åœ¨ Looper.loop() ä¹‹å‰æ˜¯å› ä¸ºLooper.loop()æ˜¯ä¸ªæ­»å¾ªç¯ï¼Œå†™åœ¨å…¶åä»£ç æ˜¯æ‰§è¡Œä¸åˆ°çš„ï¼ˆçœ‹çœ‹æœ€åç•™çš„é‚£ä¸ªé—®é¢˜ï½ï¼‰ã€‚ Looper.loop(); è¿™ä¸ªæ“ä½œå°±æ˜¯å¼€å§‹æ‰§è¡Œæ¶ˆæ¯å¾ªç¯ï¼Œå¤„ç†æ¶ˆæ¯ã€‚ å°ç»“ï¼š æ¶ˆæ¯æœºåˆ¶æ˜¯Androidç³»ç»Ÿä¸­çº¿ç¨‹é€šä¿¡éå¸¸é‡è¦çš„ä¸€ç§æ–¹æ³•ã€‚å¦‚æœå‘å¦ä¸€ä¸ªçº¿ç¨‹ä¼ é€’æ•°æ®ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ç›®æ ‡çº¿ç¨‹ä¸­å¯åŠ¨æ¶ˆæ¯æœºåˆ¶ï¼Œæ‹¿åˆ°è¿™ä¸ªçº¿ç¨‹Looperå¯¹è±¡åˆ›å»ºä¸€ä¸ªHandlerï¼Œé€šè¿‡è¿™ä¸ªHandlerå°±å¯ä»¥å‘ç›®æ ‡çº¿ç¨‹å‘é€æ¶ˆæ¯äº†ï¼Œåä¹‹äº¦ç„¶ã€‚ 0x03 HandlerThreadã€AsyncTask å’Œ UI Thread HandlerThread ä»æºç å¯ä»¥çœ‹åˆ°ï¼Œè¿™ä¸ªç±»æ˜¯å¯¹æˆ‘ä»¬Androidæ¶ˆæ¯æœºåˆ¶çš„ä¸€ä¸ªå°è£…ã€‚å½“æˆ‘ä»¬éœ€è¦è‡ªå·±å»å†™ä¸€ä¸ªåœ¨å­çº¿ç¨‹å·¥ä½œç„¶åå°†ç»“æœä¼ åˆ°ä¸»çº¿ç¨‹çš„åŠŸèƒ½æ—¶å¯ä»¥è€ƒè™‘ç”¨è¿™ä¸ªç±»ã€‚ä¸‹é¢æä¾›ä¸€ä¸ªç®€å•çš„Demoï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667public class HandlerThreadActivity extends AppCompatActivity &#123; private Handler mHandler = new Handler()&#123; @Override public void handleMessage(Message msg) &#123; super.handleMessage(msg); String threadName = Thread.currentThread().getName(); tvLog.setText(String.format(\"å½“å‰çº¿ç¨‹ï¼š%s Msgï¼š%s\", threadName, msg.obj)); &#125; &#125;; private TextView tvLog; @Override protected void onCreate(Bundle savedInstanceState) &#123; super.onCreate(savedInstanceState); setContentView(R.layout.activity_handler_thread); Toolbar toolbar = (Toolbar) findViewById(R.id.toolbar); setSupportActionBar(toolbar); tvLog = (TextView)findViewById(R.id.tvLog); FloatingActionButton fab = (FloatingActionButton) findViewById(R.id.fab); fab.setOnClickListener(new View.OnClickListener() &#123; @Override public void onClick(View view) &#123; sendMessage(); &#125; &#125;); initData(); &#125; private Handler mWorker; private void initData() &#123; HandlerThread worker = new HandlerThread(\"worker\"); worker.start(); mWorker = new Handler(worker.getLooper()); &#125; private void sendMessage() &#123; mWorker.post(new Runnable() &#123; @Override public void run() &#123; print(\"æˆ‘å·¥ä½œåœ¨çº¿ç¨‹ï¼š\" + Thread.currentThread().getName()); try &#123; Thread.sleep(6 * 1000); &#125; catch (InterruptedException e) &#123; e.printStackTrace(); &#125; sendMsgToUI(); &#125; private void sendMsgToUI()&#123; Message msg = new Message(); msg.obj = Thread.currentThread().getName() + \"å·¥ä½œå®Œæˆï¼Œè¿™æ˜¯ç»“æœ\"; mHandler.sendMessage(msg); &#125; &#125;); &#125; private static void print(String msg) &#123; System.out.println(\"&gt;&gt;&gt;&gt;&gt;\" + msg); &#125;&#125; æ€è·¯å¦‚ä¸‹ï¼š åˆ›å»ºHandlerThreadå¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡æ˜¯ä¸€ä¸ªçº¿ç¨‹ å¯åŠ¨ç¬¬ä¸€æ­¥åˆ›å»ºçš„çº¿ç¨‹ åˆ›å»ºä¸€ä¸ªHandlerï¼Œå¹¶ä½¿ç”¨ç¬¬ä¸€æ­¥åˆ›å»ºçš„çº¿ç¨‹ä¸­çš„Looper ç„¶ååœ¨ä¸»çº¿ç¨‹é€šè¿‡è¿™ä¸ªHandlerå‘å·¥ä½œçº¿ç¨‹å‘ä»»åŠ¡ ä»»åŠ¡æ‰§è¡Œå®Œæ¯•åï¼Œä½¿ç”¨åœ¨Activityï¼ˆä¸»çº¿ç¨‹ï¼‰ä¸­çš„Handlerå‘é€æ¶ˆæ¯ï¼Œå°†ç»“æœä»å·¥ä½œçº¿ç¨‹ä¼ å›ä¸»çº¿ç¨‹ AsyncTask è¿™æ˜¯ä¸ªéå¸¸å¼ºå¤§çš„å·¥å…·ç±»ï¼Œç”¨åˆ°çš„çŸ¥è¯†ç‚¹ä¹Ÿéå¸¸å¤šï¼Œæ›¾ç»ç»Ÿæ²»è¿‡ç½‘ç»œåº“çš„ç¼–å†™ã€‚è¿™é‡Œåªè®²è·Ÿæˆ‘ä»¬æ¶ˆæ¯ç³»ç»Ÿç›¸å…³çš„çŸ¥è¯†ï¼Œå…ˆçœ‹ä¸€æ®µæºç ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107public abstract class AsyncTask&lt;Params, Progress, Result&gt; &#123;... private static InternalHandler sHandler; ... // è·å–åˆ°Handler private static Handler getHandler() &#123; synchronized (AsyncTask.class) &#123; if (sHandler == null) &#123; sHandler = new InternalHandler(); &#125; return sHandler; &#125;... // åœ¨å·¥ä½œçº¿ç¨‹å‘é€ç»“æœåˆ°ä¸»çº¿ç¨‹ï¼Œè¿™é‡Œè·å–åˆ°Message.targetéƒ½æ˜¯sHandlerå¯¹è±¡ private Result postResult(Result result) &#123; @SuppressWarnings(\"unchecked\") Message message = getHandler().obtainMessage(MESSAGE_POST_RESULT, new AsyncTaskResult&lt;Result&gt;(this, result)); message.sendToTarget(); return result; &#125;... /** * &lt;p&gt;Runs on the UI thread after &#123;@link #doInBackground&#125;. The * specified result is the value returned by &#123;@link #doInBackground&#125;.&lt;/p&gt; * * &lt;p&gt;This method won't be invoked if the task was cancelled.&lt;/p&gt; * * @param result The result of the operation computed by &#123;@link #doInBackground&#125;. * * @see #onPreExecute * @see #doInBackground * @see #onCancelled(Object) */ @SuppressWarnings(&#123;\"UnusedDeclaration\"&#125;) @MainThread // è¿™ä¸ªæ–¹æ³•é‡Œçš„ä»£ç éƒ½æ˜¯åœ¨ä¸»çº¿ç¨‹æ‰§è¡Œäº† protected void onPostExecute(Result result) &#123; &#125; /** * Runs on the UI thread after &#123;@link #publishProgress&#125; is invoked. * The specified values are the values passed to &#123;@link #publishProgress&#125;. * * @param values The values indicating progress. * * @see #publishProgress * @see #doInBackground */ @SuppressWarnings(&#123;\"UnusedDeclaration\"&#125;) @MainThread // è¿™ä¸ªæ–¹æ³•é‡Œçš„ä»£ç éƒ½æ˜¯åœ¨ä¸»çº¿ç¨‹æ‰§è¡Œäº† protected void onProgressUpdate(Progress... values) &#123; &#125;... /** * This method can be invoked from &#123;@link #doInBackground&#125; to * publish updates on the UI thread while the background computation is * still running. Each call to this method will trigger the execution of * &#123;@link #onProgressUpdate&#125; on the UI thread. * * &#123;@link #onProgressUpdate&#125; will not be called if the task has been * canceled. * * @param values The progress values to update the UI with. * * @see #onProgressUpdate * @see #doInBackground */ @WorkerThread // ä»å·¥ä½œçº¿ç¨‹å‘æ¶ˆæ¯åˆ°ä¸»çº¿ç¨‹ protected final void publishProgress(Progress... values) &#123; if (!isCancelled()) &#123; getHandler().obtainMessage(MESSAGE_POST_PROGRESS, new AsyncTaskResult&lt;Progress&gt;(this, values)).sendToTarget(); &#125; &#125; private void finish(Result result) &#123; if (isCancelled()) &#123; onCancelled(result); &#125; else &#123; onPostExecute(result); &#125; mStatus = Status.FINISHED; &#125; private static class InternalHandler extends Handler &#123; public InternalHandler() &#123; super(Looper.getMainLooper()); // åˆ›å»ºä¸€ä¸ªHandlerå¯¹è±¡ï¼Œä½¿ç”¨çš„Looperæ˜¯ä¸»çº¿ç¨‹çš„Looperï¼Œé‚£ä¹ˆå®ƒå¤„ç†çš„æ¶ˆæ¯éƒ½å°†åœ¨ä¸»çº¿ç¨‹ï¼Œè¿™ä¸ªå¾ˆå…³é”® &#125; @SuppressWarnings(&#123;\"unchecked\", \"RawUseOfParameterizedType\"&#125;) @Override public void handleMessage(Message msg) &#123; AsyncTaskResult&lt;?&gt; result = (AsyncTaskResult&lt;?&gt;) msg.obj; switch (msg.what) &#123; case MESSAGE_POST_RESULT: // There is only one result result.mTask.finish(result.mData[0]); break; case MESSAGE_POST_PROGRESS: result.mTask.onProgressUpdate(result.mData); break; &#125; &#125; &#125;...&#125; çœ‹äº†ä¸Šé¢çš„æºç å†å›æƒ³ä¸‹AsyncTaskç”¨æ³•æˆ‘ä»¬å¯ä»¥å¾—åˆ°å¦‚ä¸‹ç»“è®ºï¼š ä¸»çº¿ç¨‹æ— éœ€åŠ¨æ€å‘å·¥ä½œçº¿ç¨‹å‘æ¶ˆæ¯ï¼Œåªæ˜¯åˆå§‹åŒ–çš„æ—¶å€™ä¼ é€’ä¸€äº›å‚æ•° å·¥ä½œçº¿ç¨‹å®Œæˆåï¼Œé€šè¿‡è·å–ä¸»çº¿ç¨‹çš„Looperï¼Œæ„å»ºHandlerå°†ç»“æœå‘é€ç»™ä¸»çº¿ç¨‹ UI Thread çœ‹äº†ä¸Šé¢çš„ä¸¤ä¸ªæ¡ˆä¾‹ï¼Œæˆ‘ä»¬åœ¨æ¥çœ‹çœ‹ä¸ºä»€ä¹ˆæˆ‘ä»¬ä½¿ç”¨çš„ä¸»çº¿ç¨‹å¯ä»¥ç›´æ¥ä½¿ç”¨æ¶ˆæ¯ç³»ç»Ÿè€Œæ²¡æœ‰æ‰§è¡ŒLooper.prepare()ï¼ŒLooper.loop() ä¹‹ç±»çš„åˆå§‹åŒ–å·¥ä½œå‘¢ã€‚ å…¶å®ç»“è®ºå¾ˆç®€å•ï¼Œä¸å¯èƒ½ä¸åˆå§‹åŒ–ï¼Œåªæ˜¯ç³»ç»Ÿæå‰å·²ç»å¸®æˆ‘ä»¬åˆå§‹åŒ–å¥½äº†ï¼Œè¿™éƒ¨åˆ†çš„æºç ä½äº sdk/sources/android-xx/android/app/ActivityThread.java ä¸­ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384public final class ActivityThread &#123;... final H mH = new H();...private class H extends Handler &#123; public static final int LAUNCH_ACTIVITY = 100; public static final int PAUSE_ACTIVITY = 101; public static final int PAUSE_ACTIVITY_FINISHING= 102; public static final int STOP_ACTIVITY_SHOW = 103; public static final int STOP_ACTIVITY_HIDE = 104; ... public void handleMessage(Message msg) &#123; ... switch (msg.what) &#123; case LAUNCH_ACTIVITY: &#123; Trace.traceBegin(Trace.TRACE_TAG_ACTIVITY_MANAGER, \"activityStart\"); final ActivityClientRecord r = (ActivityClientRecord) msg.obj; r.packageInfo = getPackageInfoNoCheck( r.activityInfo.applicationInfo, r.compatInfo); handleLaunchActivity(r, null, \"LAUNCH_ACTIVITY\"); Trace.traceEnd(Trace.TRACE_TAG_ACTIVITY_MANAGER); &#125; break; case RELAUNCH_ACTIVITY: &#123; Trace.traceBegin(Trace.TRACE_TAG_ACTIVITY_MANAGER, \"activityRestart\"); ActivityClientRecord r = (ActivityClientRecord)msg.obj; handleRelaunchActivity(r); Trace.traceEnd(Trace.TRACE_TAG_ACTIVITY_MANAGER); &#125; break; case PAUSE_ACTIVITY: &#123; Trace.traceBegin(Trace.TRACE_TAG_ACTIVITY_MANAGER, \"activityPause\"); SomeArgs args = (SomeArgs) msg.obj; handlePauseActivity((IBinder) args.arg1, false, (args.argi1 &amp; USER_LEAVING) != 0, args.argi2, (args.argi1 &amp; DONT_REPORT) != 0, args.argi3); maybeSnapshot(); Trace.traceEnd(Trace.TRACE_TAG_ACTIVITY_MANAGER); &#125; break; ... &#125; ... &#125; ... public static void main(String[] args) &#123; Trace.traceBegin(Trace.TRACE_TAG_ACTIVITY_MANAGER, \"ActivityThreadMain\"); SamplingProfilerIntegration.start(); // CloseGuard defaults to true and can be quite spammy. We // disable it here, but selectively enable it later (via // StrictMode) on debug builds, but using DropBox, not logs. CloseGuard.setEnabled(false); Environment.initForCurrentUser(); // Set the reporter for event logging in libcore EventLogger.setReporter(new EventLoggingReporter()); // Make sure TrustedCertificateStore looks in the right place for CA certificates final File configDir = Environment.getUserConfigDirectory(UserHandle.myUserId()); TrustedCertificateStore.setDefaultUserDirectory(configDir); Process.setArgV0(\"&lt;pre-initialized&gt;\"); Looper.prepareMainLooper(); // å‡†å¤‡MainLooper ActivityThread thread = new ActivityThread(); thread.attach(false); if (sMainThreadHandler == null) &#123; sMainThreadHandler = thread.getHandler(); &#125; if (false) &#123; Looper.myLooper().setMessageLogging(new LogPrinter(Log.DEBUG, \"ActivityThread\")); &#125; // End of event ActivityThreadMain. Trace.traceEnd(Trace.TRACE_TAG_ACTIVITY_MANAGER); Looper.loop(); // å¯åŠ¨è¿™ä¸ªæ¶ˆæ¯å¾ªç¯ // å½“ä¸Šé¢çš„Looperæ‰§è¡Œquit()çš„æ—¶å€™æ‰§è¡Œåˆ°è¿™é‡Œï¼Œå½“ç„¶ï¼Œè¿™ä¸ªæ—¶å€™appå°±è¦é€€å‡ºäº† throw new RuntimeException(\"Main thread loop unexpectedly exited\"); &#125;&#125; å†å›åˆ°æˆ‘ä»¬æ–‡ç« å¼€å§‹çš„æ—¶å€™æåˆ°çš„é—®é¢˜ï¼šä¸ºä»€ä¹ˆé€šè¿‡ view.post() å¯ä»¥è·å–åˆ°Viewçš„å°ºå¯¸å‘¢ï¼Ÿ ç­”ï¼šé¦–å…ˆå¤§å®¶éœ€è¦çŸ¥é“ï¼Œæˆ‘ä»¬Activityçš„å¯åŠ¨ï¼Œä¹Ÿæ˜¯é€šè¿‡ç³»ç»Ÿæ¶ˆæ¯çš„æ–¹å¼è§¦å‘çš„ã€‚ä»ä¸Šé¢çš„ä»£ç ä¸­å¯ä»¥çœ‹åˆ°ï¼Œå½“ Looper.loop() æ‰§è¡Œä¹‹åï¼Œå³å¯æ¥æ”¶ç³»ç»Ÿæ¶ˆæ¯äº†ï¼Œæ¯”å¦‚å¯åŠ¨Activityä¹‹ç±»çš„æ¶ˆæ¯ã€‚å½“ç³»ç»Ÿå‘å‡ºäº†ä¸€ä¸ªå¯åŠ¨Activityçš„æ¶ˆæ¯ï¼Œç„¶åæ‰§è¡Œè¿™ä¸ªæ¶ˆæ¯æ‰ä¼šå»å¯åŠ¨Actvityï¼Œå¯åŠ¨Activiyä¼šè°ƒç”¨å®ƒçš„ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ï¼Œæ¯”å¦‚ onCreate() ç­‰ï¼Œåœ¨ Activity.onCreate() ä¸­ç”¨view.postå‘ä¸€ä¸ªä»»åŠ¡åˆ°ä¸»çº¿ç¨‹çš„æ¶ˆæ¯é˜Ÿåˆ—ï¼Œé‚£è¿™ä¸ªæ¶ˆæ¯è‚¯å®šè¦ç­‰ä¹‹å‰çš„æ¶ˆæ¯ä»»åŠ¡æ‰§è¡Œå®Œï¼Œä¹Ÿå°±æ˜¯å½“å‰åˆ›å»ºActivityçš„æ¶ˆæ¯æ‰§è¡Œå®Œæˆä¹‹åæ‰èƒ½æ‰§è¡Œã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬å°±å¯ä»¥è·å–åˆ°Viewçš„å°ºå¯¸äº†ã€‚ é‚£ä¹ˆæˆ‘ä»¬æ¥éªŒè¯ä¸€ä¸‹ï¼š 1234567891011121314151617181920212223242526272829303132333435363738public class ViewPostActivity extends AppCompatActivity &#123; private TextView tvInfo; @Override protected void onCreate(Bundle savedInstanceState) &#123; super.onCreate(savedInstanceState); setContentView(R.layout.activity_view_post); printMsg(\"onCreate\"); tvInfo = (TextView) findViewById(R.id.tvInfo); tvInfo.post(new Runnable() &#123; @Override public void run() &#123; printMsg(\"Width:\" + tvInfo.getWidth()); printMsg(\"Height:\" + tvInfo.getHeight()); &#125; &#125;); &#125; @Override protected void onStart() &#123; super.onStart(); printMsg(\"onStart\"); &#125; @Override protected void onResume() &#123; super.onResume(); printMsg(\"onResume\"); &#125; private static void printMsg(String msg) &#123; System.out.println(\"&gt;&gt;&gt;&gt;&gt;\" + msg); &#125;&#125; è¾“å‡ºçš„Logï¼š 1234507-27 13:06:36.373 17506-17506/com.ttdevs.message I/System.out: &gt;&gt;&gt;&gt;&gt;onCreate07-27 13:06:36.378 17506-17506/com.ttdevs.message I/System.out: &gt;&gt;&gt;&gt;&gt;onStart07-27 13:06:36.378 17506-17506/com.ttdevs.message I/System.out: &gt;&gt;&gt;&gt;&gt;onResume07-27 13:06:36.433 17506-17506/com.ttdevs.message I/System.out: &gt;&gt;&gt;&gt;&gt;Width:24807-27 13:06:36.433 17506-17506/com.ttdevs.message I/System.out: &gt;&gt;&gt;&gt;&gt;Height:76 å’Œæ¨æµ‹çš„ä¸€è‡´ï¼ŒCooooolï½ï½ æœ€åï¼Œç•™ä¸ªå¥½ç©çš„é—®é¢˜ï¼Œæ‰§è¡Œ getMainLooper().quit() ä¼šæ€æ ·å‘¢ï¼Ÿ æºç å‚è€ƒè¿™é‡Œ","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"https://ttdevs.github.io/categories/æŠ€æœ¯/"}],"tags":[{"name":"Android","slug":"Android","permalink":"https://ttdevs.github.io/tags/Android/"}]},{"title":"","slug":"2017-06-20","date":"2017-06-20T13:30:43.000Z","updated":"2017-06-20T13:37:57.000Z","comments":true,"path":"2017/06/20/2017-06-20/","link":"","permalink":"https://ttdevs.github.io/2017/06/20/2017-06-20/","excerpt":"","text":"# è¥¿å®‰æ¸¸ â€”â€” å¤§å”ç››ä¸– ç»å†äº†æ¼«é•¿çš„çŠ¹è±«çº ç»“ä¹‹åå†³å®šè£¸è¾ã€‚ä¸€åœºè¯´èµ°å°±èµ°çš„æ—…ç¨‹å°±è¿™ä¹ˆå¼€å§‹äº†ã€‚ ç¦»èŒæ—¶æ— æ„ä¸­è·Ÿä¸€ä¸ªå°ä¼™ä¼´èŠå¤©ï¼Œå¾—çŸ¥å¥¹ä¹Ÿæ˜¯ç¦»èŒçŠ¶æ€ï¼Œé‚ç»“ä¼´ä¸€èµ·å»å¾€è¥¿å®‰ã€‚è™½ç„¶æ˜¯ä¸€ä¸ªæ¾æ•£ç»„åˆï¼Œä½†ä¹Ÿä¸ç”¨ä¸€ç›´ä¸€ä¸ªäººäº†ï½ï¼ˆå…¶å®å•èº«ç‹—æœ‰æ—¶å€™ä¹Ÿéœ€è¦æ‰¾åˆ«äººå¸®æ‹æ—…æ¸¸ç…§ï¼‰ å‡ºå‘ä¹‹å‰å¹¶æ²¡æœ‰åšè¯¦ç»†çš„æ”»ç•¥ï¼Œåªæœ‰ä¸€ä¸ªç›®çš„åœ°è¥¿å®‰ã€‚æƒ³åˆ°å“ªé‡Œå»å“ªé‡Œï¼Œæ¯”å¦‚è‘—åçš„ç§¦å§‹çš‡é™µå…µé©¬ä¿‘ï¼Œåå±±ï¼Œå¤åŸå¢™ï¼Œå¤§é›å¡”ï¼Œè¥¿å®‰å°åƒç­‰ç­‰ï¼Œå½“ç„¶è¿˜æœ‰äº›ä¹‹å‰ä¸çŸ¥é“çš„æ™¯ç‚¹ã€‚æœ€åçœ‹æ¥ï¼Œé™¤äº†åå±±å’Œå¤§é›å¡”æ²¡æœ‰å»æœ‰ç‚¹å°é—æ†¾ä¹‹å¤–ï¼Œå¤§éƒ¨åˆ†æœŸå¾…çš„éƒ½å»äº†ï¼Œè€Œä¸”å¤šæ•°éƒ½æ˜¯è¶…è¿‡ä¹‹å‰çš„æœŸå¾…ï½ ç¬¬ä¸€å¤© ä»å‡ºå‘åˆ°å›æ°‘è¡—æå‰ä¸¤å¤©ä¹°çš„æœºç¥¨ï¼Œå—èˆªCZ6616ä¸Šåˆ11:25 ä¸Šæµ·é£è¥¿å®‰ã€‚ç¦»æœºåœºå¾ˆè¿‘ï¼Œæ‰€ä»¥ä¸ç”¨æ—©èµ·èµ¶ç°æœºï¼Œå‡†ç‚¹èµ·é£ï¼Œé¢„ç¤ºä¸€ä¸ªç¾å¥½çš„æ—…ç¨‹å³å°†å¼€å§‹ï½ å‡ºå‘ä¹‹å‰å°ä¼™ä¼´åœ¨ç½‘ä¸ŠæŠ¥äº†ä¸€ä¸ªä¸€å¤©çš„æ—…è¡Œå›¢ï¼ŒåŒ…å«æ¥æœºçš„æœåŠ¡ï¼Œæ—…æ¸¸å·´å£«ï¼Œä»æœºåœºé€åˆ°ä½åœ°ã€‚æ‰€ä»¥æ•´ä¸ªåˆ°è¾¾è¿‡ç¨‹è¿˜æ˜¯ç›¸å½“é¡ºåˆ©æ»´ã€‚ åŒè¡Œå°ä¼™ä¼´è¦ä½é’æ—…ï¼Œè¯´å¯ä»¥ç©ç‹¼äººæ€ç­‰æ¸¸æˆã€‚ç”±äºæ²¡æœ‰ä½è¿‡é’æ—…ï¼Œæƒ³ä½“éªŒä¸‹ï¼Œæ‰€ä»¥ä¹Ÿè®¢äº†ä¸€ä¸ªåºŠé“ºï¼Œå››äººé—´ï¼Œ45å…ƒï¼æ™šã€‚åˆ°äº†é’æ—…åŠäº†å…¥ä½ï¼Œçœ‹äº†æˆ¿é—´ï¼Œç¬é—´ä¸æƒ³ä½äº†ï¼ˆé‡Œé¢å·²ä½ä¸¤äººï¼Œæœ‰ç‚¹ä¹±ï¼Œå¸¦äº†ä¸ªå¯ä»¥ç™»æœºçš„è¡Œæç®±æˆ¿é—´çš„æŸœå­ç«Ÿç„¶æ”¾ä¸ä¸‹ï¼Œä¹Ÿæ²¡å…¶ä»–åœ°æ–¹å¯æ”¾ï¼‰ï¼Œé‚é€€æˆ¿ï¼ˆåæ¥æƒ³äº†ä¸‹ï¼Œå¯èƒ½å·²ç»è¿‡äº†ä½é’æ—…çš„å¹´é¾„äº†å§ï¼‰ï¼Œå»æ‰¾äº†å®¶å¿«æ·é…’åº—ï¼Œç¦»å›æ°‘è¡—å¾ˆè¿‘ï¼Œå¤§åºŠæˆ¿æ¯æ™šä¸åˆ°100ï¼Œä¹‹åå‡ å¤©ä¸€ç›´ä½è¿™é‡Œï¼ˆå“ˆå“ˆï¼Œæ·˜å®ä¹°äº†å‡ å¼ 20çš„ä¼˜æƒ åˆ¸ï¼Œè¿˜æ˜¯èƒ½çœä¸€ç‚¹æ˜¯ä¸€ç‚¹ï¼‰ã€‚ å®‰å®šå¥½ä¹‹åå¼€å§‹é€›å›æ°‘è¡—ã€é’Ÿæ¥¼å’Œé¼“æ¥¼ã€‚ä¸‹é¢å¼€å§‹ä¸Šå›¾ï½ äººè¶…å¤šæœ‰æ²¡æœ‰ï½ï½ è‰²å½©è¶…çº§ä¸°å¯Œå•Š ç¬¬äºŒå¤© ç§¦å§‹çš‡é™µå…µé©¬ä¿‘è¥¿å®‰ä¸€æ—¥æ¸¸å‰é¢æåˆ°æŠ¥äº†ä¸€ä¸ªæ—…æ¸¸å›¢ï¼šå…µé©¬ä¿‘+åæ¸…å®«+éªŠå±±ç´¢é“ä¸€æ—¥æ¸¸ï¼ˆèµ æ¥æœº/é«˜é“/åŒè€³éº¦/èµ è‡ªåŠ©é¤ï¼‰ä»·æ ¼390ï¼Œä¸åç´¢é“330ï¼Œé©¬èœ‚çªä¸Šæœ‰å”®ã€‚ç¾å¥³å¯¼æ¸¸ï¼Œå¤§å·´æ¥é€ï¼Œæ— è´­ç‰©ï¼Œè‡ªåŠ©é¤ç­‰ç­‰ï¼Œå»ä¹‹å‰è¿˜æ‹…å¿ƒè¢«å¸¦åˆ°å‡å…µé©¬ä¿‘ç­‰å„ç§å‘ï¼Œæœ€åæ€»ç»“ä¸‹æ¥å¾ˆæ»¡æ„çš„ä¸€æ¬¡è·Ÿå›¢ã€‚å…·ä½“çš„è¡Œç¨‹å¤§å®¶å¯ä»¥çœ‹ä»‹ç»ã€‚ æˆ‘ä»¬çš„ç¾å¥³å¯¼æ¸¸ï½ è¥¿å®‰å¤åŸå¢™æ—…æ¸¸å›¢ç»“æŸä¹‹åé€å›é’Ÿæ¥¼ï¼Œè·¯ä¸Šå¯¼æ¸¸æ¨èäº†å‡ å®¶ï¼Œä½†æ˜¯éƒ½æ²¡è®°ä½ã€‚ä¸è¿‡è¿˜æ˜¯è¦å»æ‰¾åƒçš„ï¼Œå‡‰çš®è‚‰å¤¹é¦è‡ªç„¶æ˜¯é¦–é€‰ï¼ˆå›æ°‘è¡—å–çš„è‚‰å¤¹é¦éƒ½æ˜¯ç‰›ç¾Šè‚‰çš„ï¼Œæˆ‘è¿˜æ˜¯å–œæ¬¢çŒªè‚‰çš„ï¼Œæ‰€ä»¥è¿™ä¸ªè‚‰å¤¹é¦ä¸æ˜¯å›æ°‘è¡—ä¹°çš„ï½ï¼‰ã€‚ åƒé¥­åƒå®Œæ—¶é—´è¿˜æ—©ï¼Œé‚å†³å®šå»å¤åŸå¢™ã€‚å°±è¿™æ ·ä¸€ä¸ªäººéª‘ç€å°é»„è½¦å±é¢ å±é¢ çš„èµ¶åˆ°åŸå¢™ï¼Œä¹°ç¥¨è¿›å…¥ï¼Œé—¨ç¥¨54ã€‚ ç”±äºå»çš„æ—¶å€™å¤©å·²ç»å¿«æ™šä¸Š8ç‚¹äº†ï¼Œæ‰€ä»¥è¿˜æ˜¯æœ‰ç‚¹æ™šçš„ã€‚åŠ ä¹‹å¤©æ°”ä¸å¥½é˜´çš„å¾ˆé‡ï¼Œä¸­é—´è¿˜æœ‰å°é›¨ï¼Œåˆä¸æƒ³éª‘è‡ªè¡Œè½¦ä¸€ä¸ªäººèµ°äº†å››åˆ†ä¹‹ä¸€å°±æ’¤äº†ï¼ˆä»å—é—¨èµ°åˆ°è¥¿é—¨ï¼‰ã€‚å¯èƒ½éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæ™šä¸Šä¸æ˜¯æ¯ä¸ªé—¨éƒ½å¼€çš„ï¼Œæƒ³å‡ºæ¥ä¹Ÿå¾—èµ°åˆ°æŸä¸ªå¤§ä¸€ç‚¹çš„é—¨ã€‚ ç¬¬ä¸‰å¤© å¤§å”èŠ™è“‰å›­å‰ä¸€å¤©é€›çš„å¤ªæ™šï¼Œæ¯”è¾ƒç´¯ï¼Œæ‰€ä»¥ç¡äº†ä¸ªæ‡’è§‰ï¼Œèµ·åºŠå·²ç»ä¸‹åˆã€‚æ—¶é—´ä¸å¤ŸèŠ™è“‰å›­å’Œå¤§é›å¡”ä¸èƒ½åŒæ—¶å»äº†ï¼ˆå¤§é›å¡”éŸ³ä¹å–·æ³‰ä¹Ÿæ²¡å»æˆï¼‰ï¼Œå¤§é›å¡”ä¸æ˜¯ç‰¹åˆ«æœŸå¾…ï¼Œæœ€åé€‰æ‹©äº†èŠ™è“‰å›­ã€‚å»ä¹‹å‰ç®€å•äº†è§£äº†ä¸‹ï¼šæ–°å»ºçš„æ™¯ç‚¹ï¼Œä¸æ˜¯å†å²å¤è¿¹ï¼Œæ‰€ä»¥ä¹Ÿä¸æŠ±å¤ªå¤§å¸Œæœ›ã€‚ä¹°äº†å¸¦æ¼”å‡ºçš„198å—çš„é—¨ç¥¨ï¼Œå…¶ä¸­å¸¦äº†å¤§å”ç››ä¸–çš„æ¼”å‡ºã€‚ å¤§å”ç››ä¸–è¿™æ˜¯ä¸€ä¸ªå•†ä¸šæ¼”å‡ºï¼Œå¦‚æœä¸å–œæ¬¢å¯ä»¥ä¹°120çš„ç¥¨ï¼Œå°±æ²¡æœ‰è¿™ä¸€é¡¹äº†ã€‚æ‚„æ‚„çš„å‘Šè¯‰ä½ ä»¬ï¼Œæˆ‘æ˜¯ç¬¬ä¸€æ¬¡çœ‹æ¼”å‡ºï¼Œç¬¬ä¸€æ’ï¼Œè¿™ä¸ªä½ç½®æœ‰ç‚¹ä½ï¼Œå¾€åä¸¤æ’åº”è¯¥ä¼šæ›´å¥½ï¼Œä½†æ˜¯ä¹Ÿæœ‰ä¸€ä¸ªå¥½å¤„æ˜¯ç¦»æ¼”å‘˜å¾ˆè¿‘ï¼Œå¯ä»¥çœ‹ç¾å¥³ï½ï½ å››ç‚¹åŠå°±å¯ä»¥å…¥åœºäº†ï¼Œæœ¬ä»¥ä¸ºçœ‹çš„äººä¼šå¾ˆå°‘ï¼Œä½†æ˜¯æœ€åå‘ç°å‡ ä¹åº§æ— è™šå¸­ï¼Œè¶…ä¹æˆ‘çš„æƒ³è±¡ã€‚ ï¼ˆä¸å¥½æ„æ€ï¼ŒåŸè°…æˆ‘å·æ‹ç…§äº†ï¼‰ å¯¹æˆ‘æ¥è¯´ç™½å¤©è¿™ä¸ªå›­å­å¯çœ‹çš„ä¸æ˜¯å¾ˆå¤šã€‚æœ‰ä¸€äº›é›•å¡‘ï¼Œçœ‹ä¸æ‡‚çš„æˆ‘ï¼ŒçœŸæ˜¯èœœæ±å°´å°¬ï¼Œæ¯”å¦‚ä¸‹é¢è¿™åº§ï¼š å”¯ä¸€æœ‰å¥½ä¸€ç‚¹å°è±¡çš„æ˜¯ç´«äº‘æ¥¼ä¸­ä¼šæœ‰å®šæ—¶çš„è¡¨æ¼”ï¼Œæ„Ÿå…´è¶£å¯ä»¥çœ‹çœ‹ã€‚ ç¯å…‰è¡¨æ¼”ä»ä¸¤ä¸ªæ ‡é¢˜å¯ä»¥çœ‹å‡ºï¼Œå¯¹äºè¿™é‡Œçš„å»ºç­‘çœŸæ˜¯æœŸå¾…ä¸å¤§ï¼Œå¥½åœ¨æœ‰æ™šä¸Šçš„ç¯å…‰æ°´å¹•ç­‰è¡¨æ¼”ï¼Œå“ˆå“ˆï½ï½ ä¸€ä¸ªäººåœ¨ä¸€ä¸ªååƒ»çš„è§’è½çœ‹å®Œæ•´ä¸ªè¡¨æ¼”ï¼ˆå…¶å®å°±æ˜¯ä¸ºäº†æ‹ç…§ï½ï½ï¼‰æ™šä¸Šçš„ç¯å…‰è¿˜æ˜¯å¾ˆæ¼‚äº®çš„ã€‚å¬è¯´æ˜¯å…¨å›½æœ€å¤§çš„æ°´å¹•ç”µå½±ã€‚ ç¬¬å››å¤© é™•è¥¿å†å²åšç‰©é¦†åƒè´§ä»¬å¯èƒ½å·²ç»å‘ç°ä¸€ä¸ªé—®é¢˜â€”â€”åŸºæœ¬ä¸Šæ²¡æœ‰ä»‹ç»åƒã€‚çœ‹æˆ‘çš„å°´å°¬è„¸ğŸ˜… å› ä¸ºä»æ¥ç¬¬äºŒå¤©å°±å¼€å§‹æ‹‰è‚šå­ï¼Œæ¶å¿ƒæƒ³åï¼Œå•¥ä¹Ÿä¸æƒ³åƒã€‚æœ‹å‹è¯´è‚ èƒƒæ„Ÿå†’ï¼Œåƒç‚¹è¯å°±å¥½ã€‚ä½†æ˜¯ä»Šå¤©æ„Ÿè§‰å¿«è¦æ­»äº†ï¼ˆæ¥ä¸‹æ¥è¿˜æœ‰ä¸€å‘¨å¤šçš„è¡Œç¨‹ï¼Œé’±å·²äº¤ï¼‰ï¼Œé‚å»äº†åŒ»é™¢ã€‚ä¸€å¤§æ—©èµ¶åˆ°è¥¿å®‰äº¤é€šå¤§å­¦ç¬¬ä¸€é™„å±åŒ»é™¢çœ‹äº†ä¸ªæ¶ˆåŒ–å†…ç§‘ï¼ŒåŒ»ç”Ÿä¸åˆ†é’çº¢çš‚ç™½çš„ç»™å¼€äº†ä¸€å †è¯ï¼ˆè¿˜æœ‰è¿›å£çš„é…µæ¯èŒï¼Œå–è¯æ—¶æ‰å‘ç°ï¼Œæˆ‘ä»¬ä¹‹å‰ä¹Ÿå–è¿‡ï¼Œå‘å•Šï¼‰ï¼Œè¾“æ¶²ä¸¤ç“¶ï¼Œè¯è´¹480+ï¼Œç®€ç›´æ˜¯æŠ¢åŠ«å•Šï¼Œæœ‰æ²¡æœ‰ã€‚æœ€åéƒ½ä¸çŸ¥é“æ˜¯åƒäº†è¿™äº›è¯å¥½çš„è¿˜æ˜¯æˆ‘è‡ªå·±å»è¯åº—ä¹°çš„è—¿é¦™æ­£æ°”æ°´åƒå¥½çš„ã€‚ã€‚ã€‚ è¾“å®Œæ¶²ï¼Œèµ¶åˆ°è¥¿å®‰å†å²åšç‰©é¦†ï¼Œå·²ç»ä¸‹åˆä¸¤ç‚¹å¤šã€‚åœ¨å¯¹é¢å–äº†ç‚¹ç²¥ï¼Œåƒäº†ç‚¹ä¸œè¥¿â€”â€”çƒ¤é¦â€”â€”ä¸€å—é’±ä¸€ä¸ªâ€”â€”è¶…çº§å¥½åƒï¼Œé‚£ä¸ªçŠ¶æ€æˆ‘ç«Ÿç„¶åƒäº†ä¿©ï½ è¯´æ­£é¢˜ï¼Œä¸ºä»€ä¹ˆæƒ³æ¥è¿™é‡Œå‘¢ï¼Ÿéš¾é“æˆ‘å¾ˆçˆ±å†å²å˜›ï½ å…¶å®ä¸æ˜¯ï¼Œå°±æ˜¯æƒ³å¤šäº†è§£ä¸€ä¸‹å†å²è€Œå·²ã€‚ä¹‹å‰å»è¿‡å—äº¬åšç‰©é™¢ï¼Œä¸€ä¸ªäººé€›äº†åŠå¤©ï¼Œè¿˜æ˜¯æŒºéœ‡æ’¼çš„ã€‚æ‰€ä»¥å¯¹äºè¥¿å®‰è¿™åº§å¤åŸï¼Œå¯¹ä»–çš„åšç‰©é¦†è¿˜æ˜¯æŒºæœŸå¾…çš„ã€‚ ç®€å•æé†’ä¸€ä¸‹ï¼Œè¿™é‡Œçš„ç¥¨å…è´¹ï¼Œå¯ä»¥å®˜ç½‘é¢„çº¦ï¼Œé¢„çº¦å¥½äº†é‚£å¤©å•¥æ—¶å€™å»éƒ½å¯ä»¥ï¼Œå¦åˆ™çš„è¯å°±åˆ°ç°åœºæ’é˜Ÿã€‚äººå¤šçš„æ—¶å€™é˜Ÿä¼å¯èƒ½ä¼šæ¯”è¾ƒé•¿ã€‚ ç”±äºå®åœ¨éš¾å—ï¼Œä¹Ÿæ²¡é€›å¤šä¹…å°±æ—©æ—©çš„å›å»ä¼‘æ¯äº†ã€‚ ç¬¬äº”å¤© ä»è¥¿å®‰åˆ°è¥¿å®æœ€åä¸€å¤©çš„è¡Œç¨‹ï¼Œè¥¿å®‰åˆ°è¥¿å®ã€‚æœ¬æ‰“ç®—åšæœºåœºå¤§å·´ï¼Œä½†æ˜¯æœ‰ä¸ªè¡Œæç®±æ¯”è¾ƒé‡ï¼ŒåŒè¡Œçš„å°ä¼™ä¼´å†³å®šä¸€èµ·æ‰“è½¦ã€‚å«äº†ä¸“è½¦ï¼Œä»è¥¿å®‰å¸‚åŒºé€åˆ°å’¸é˜³æœºåœºã€‚ä¼˜æƒ äº†50ï¼Œæ¯ä¸ªäºº50å¿«ï¼Œè¿˜æ˜¯æŒºåˆ’ç®—çš„ã€‚ æ„Ÿè§‰ä¸€è·¯ä¸Šç°æœºç»è¿‡äº†é™•ç”˜ä¸åŒçš„åœ°è²Œç¯å¢ƒï¼Œå·å·ç”¨æ‰‹æœºæ‹äº†å‡ ç«™ï¼Œè¶…çº§åæ‚”ç°æœºä¸Šæ²¡æœ‰æŠŠç›¸æœºæ‹¿å‡ºæ¥ã€‚ç»™å¤§å®¶åˆ†äº«å‡ å¼ ï¼Œè¥¿å®‰è¡Œç¨‹ç»“æŸï½ è¥¿å®‰ä¹‹è¡Œå°±è¿™ä¹ˆç»“æŸäº†ã€‚å¦‚æœæœ‰äººä¸€èµ·çš„è¯ï¼Œå¯èƒ½ä¼šå»çˆ¬åå±±ï¼Œä¸è¿‡ç•™ç€ä»¥åæœ‰æœºä¼šå»ä¹Ÿå¥½ã€‚","categories":[],"tags":[]},{"title":"","slug":"2017-06-02","date":"2017-06-02T05:55:45.000Z","updated":"2017-06-02T05:55:45.000Z","comments":true,"path":"2017/06/02/2017-06-02/","link":"","permalink":"https://ttdevs.github.io/2017/06/02/2017-06-02/","excerpt":"","text":"#","categories":[],"tags":[]},{"title":"[Android]å‡çº§Support Library","slug":"Android-å‡çº§SupportLibrary","date":"2017-05-26T06:14:07.000Z","updated":"2017-05-26T06:14:07.000Z","comments":true,"path":"2017/05/26/Android-å‡çº§SupportLibrary/","link":"","permalink":"https://ttdevs.github.io/2017/05/26/Android-å‡çº§SupportLibrary/","excerpt":"","text":"0x00 Support Library0x01 æ³¨æ„äº‹é¡¹ compileSdkVersionä¸buildToolsVersionç‰ˆæœ¬ä¸ä¸€è‡´ 12345678 /Users/ttdevs/Android/app/build/intermediates/res/merged/debug/values-v24/values-v24.xmlError:(3) Error retrieving parent for item: No resource found that matches the given name 'android:TextAppearance.Material.Widget.Button.Borderless.Colored'.Error:(4) Error retrieving parent for item: No resource found that matches the given name 'android:TextAppearance.Material.Widget.Button.Colored'.Error:(3) Error retrieving parent for item: No resource found that matches the given name 'android:TextAppearance.Material.Widget.Button.Borderless.Colored'.Error:(4) Error retrieving parent for item: No resource found that matches the given name 'android:TextAppearance.Material.Widget.Button.Colored'.Error:Execution failed for task ':app:processDebugResources'.&gt; com.android.ide.common.process.ProcessException: Failed to execute aaptInformation:BUILD FAILED 0xFF å‚è€ƒ https://developer.android.com/topic/libraries/support-library/index.html https://developer.android.com/topic/libraries/support-library/revisions.html https://stackoverflow.com/questions/41365401/how-to-fix-eror-app-build-intermediates-res-merged-debug-values-v24-values-v24-x","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"https://ttdevs.github.io/categories/æŠ€æœ¯/"}],"tags":[{"name":"Android","slug":"Android","permalink":"https://ttdevs.github.io/tags/Android/"}]},{"title":"ã€ŒAndroid-Bluetoothã€0x02æ“ä½œ","slug":"[Android-Bluetooth]0x02æ“ä½œ","date":"2017-05-18T16:00:00.000Z","updated":"2017-05-19T11:07:57.000Z","comments":true,"path":"2017/05/19/[Android-Bluetooth]0x02æ“ä½œ/","link":"","permalink":"https://ttdevs.github.io/2017/05/19/[Android-Bluetooth]0x02æ“ä½œ/","excerpt":"","text":"0x00 ä½åŠŸè€—è“ç‰™ï¼ˆBLEï¼‰ä¸Šä¸€ç¯‡ç®€å•ä»‹ç»äº†ä¼ ç»Ÿè“ç‰™è®¾å¤‡çš„ä½¿ç”¨ï¼Œå½“ä½ æ²¿ç€ä¸Šä¸€ç¯‡çš„æ€è·¯å»è¿æ¥æŸäº›è“ç‰™è®¾å¤‡çš„æ—¶å€™ï¼Œä½ ä¼šå‘ç°æ€»æ˜¯ä¸æˆåŠŸã€‚æ²¡é”™ï¼Œæˆ‘ä»¬è¿˜æœ‰å¦å¤–ä¸€ç§è“ç‰™æ²¡æœ‰è®²ï¼šä½åŠŸè€—è“ç‰™(BLE: Bluetooth Low Energy)ã€‚ è¿™å¹¶ä¸æ˜¯ä¸€ç§æ–°çš„ä¸œè¥¿ï¼Œå®ƒåªæ˜¯è“ç‰™åè®®ä¸­çš„ä¸€ä¸ªæ–°çš„ç‰ˆæœ¬ã€‚ä¹‹å‰æåˆ°çš„å¤šæ˜¯è“ç‰™2.0/2.1ï¼Œè¿™é‡Œçš„ä½åŠŸè€—è“ç‰™ï¼ˆBLEï¼‰ä¸»è¦æ˜¯æŒ‡è“ç‰™4.0/4.1/4.2ã€‚åœ¨æˆ‘ä»¬çš„æ—¥å¸¸ç”Ÿæ´»ä¸­è¿™ç§è“ç‰™è¶Šæ¥è¶Šå¸¸è§ï¼Œæ¯”å¦‚å„ç§æ‰‹ç¯ã€ä½“è„‚ç§¤ã€æ™ºèƒ½è®¾å¤‡ã€ä¾¿æºè“ç‰™è®¾å¤‡ç­‰ç­‰ã€‚ æ›´å¤šå…³äºè“ç‰™çš„ä»‹ç»å¯ä»¥å‚è€ƒè¿™é‡Œ 0x01 è“ç‰™åè®®æ ˆå’Œå­¦ä¹  TCP/IP ä¸€æ ·ï¼Œå¦‚æœäº†è§£BLEçš„è®®æ ˆå¯¹æˆ‘ä»¬æŒæ¡è“ç‰™ä¼šæœ‰å¾ˆå¤§çš„å¸®åŠ©ã€‚ ç‰©ç† (PHY) å±‚ é€šè¿‡è“ç‰™é€šä¿¡ä¿¡é“æ§åˆ¶ 2.4Ghz å°„é¢‘çš„ä¼ è¾“/æ¥æ”¶ã€‚BR/EDR æä¾›çš„ä¿¡é“è¾ƒå¤šä½†å¸¦å®½è¾ƒçª„ï¼Œè€Œ LE ä½¿ç”¨çš„ä¿¡é“è¾ƒå°‘ä½†å¸¦å®½è¾ƒå®½ã€‚ é“¾è·¯å±‚ å®šä¹‰æ•°æ®åŒ…ç»“æ„/ä¿¡é“ã€å‘ç°/è¿æ¥ç¨‹åºä»¥åŠå‘é€/æ¥æ”¶æ•°æ®ã€‚ ç›´æ¥æµ‹è¯•æ¨¡å¼ å…è®¸æµ‹è¯•äººå‘˜å‘ PHY å±‚å‘å‡ºæŒ‡ä»¤ä»¥ä¼ è¾“æˆ–æ¥æ”¶ç»™å®šæ•°æ®åŒ…åºåˆ—ï¼Œé€šè¿‡ HCI æˆ– 2 çº¿ UART æ¥å£æäº¤å‘½ä»¤ã€‚ ä¸»æœºæ§åˆ¶å™¨æ¥å£ (HCI) è“ç‰™æ§åˆ¶å™¨å­ç³»ç»Ÿï¼ˆåº•éƒ¨ä¸‰å±‚ï¼‰å’Œè“ç‰™ä¸»æœºä¹‹é—´çš„å¯é€‰æ ‡å‡†æ¥å£ã€‚ é€»è¾‘é“¾è·¯æ§åˆ¶å’Œé€‚é…åè®® (L2CAP) å±‚ åŸºäºæ•°æ®åŒ…çš„åè®®ï¼Œå¯å°†æ•°æ®åŒ…ä¼ è¾“è‡³ HCI æˆ–ç›´æ¥ä¼ è¾“åˆ°æ— ä¸»æœºç³»ç»Ÿä¸­çš„é“¾è·¯ç®¡ç†å™¨ã€‚æ”¯æŒæ›´é«˜çº§åˆ«çš„åè®®å¤šè·¯å¤ç”¨ã€æ•°æ®åŒ…åˆ†å‰²å’Œé‡ç»„ï¼Œä»¥åŠå°†æœåŠ¡è´¨é‡ä¿¡æ¯ä¼ è¾“åˆ°æ›´é«˜å±‚ã€‚ å±æ€§åè®® (ATT) åœ¨å»ºç«‹è¿æ¥ä¹‹åå®šä¹‰æ•°æ®äº¤æ¢å®¢æˆ·ç«¯/æœåŠ¡å™¨åè®®ã€‚ä½¿ç”¨é€šç”¨å±æ€§é…ç½®æ–‡ä»¶ (GATT) å°†å±æ€§åˆ†ç±»ä¸ºæœ‰æ„ä¹‰çš„æœåŠ¡ã€‚ATT ä¸»è¦ç”¨äº LE éƒ¨ç½²ï¼Œå¶å°”ä¹Ÿä¼šç”¨äº BR/EDR éƒ¨ç½²ã€‚ å®‰å…¨ç®¡ç†å™¨ å®šä¹‰ç®¡ç†è“ç‰™è®¾å¤‡ä¹‹é—´é…å¯¹å®Œæ•´æ€§ã€èº«ä»½éªŒè¯ä»¥åŠåŠ å¯†çš„åè®®å’Œæ“ä½œï¼Œæä¾›å®‰å…¨åŠŸèƒ½å·¥å…·ç®±ï¼Œå…¶ä»–ç»„ä»¶å¯åˆ©ç”¨è¯¥å·¥å…·ç®±æ”¯æŒä¸åŒåº”ç”¨æ‰€éœ€çš„å„ç§å®‰å…¨çº§åˆ«ã€‚ é€šç”¨å±æ€§é…ç½®æ–‡ä»¶ (GATT) ä½¿ç”¨å±æ€§åè®®ï¼ŒGATT å¯¹å°è£…è®¾å¤‡ç»„ä»¶æ€§èƒ½çš„æœåŠ¡è¿›è¡Œåˆ†ç»„ï¼Œå¹¶æè¿°åŸºäº GATT åŠŸèƒ½çš„ç”¨ä¾‹ã€è§’è‰²å’Œä¸€èˆ¬æ€§èƒ½ã€‚å…¶æœåŠ¡æ¡†æ¶å®šä¹‰æœåŠ¡è§„ç¨‹å’Œæ ¼å¼åŠå…¶ç‰¹æ€§ï¼Œå…¶ä¸­åŒ…æ‹¬å‘ç°ã€è¯»å–ã€å†™å…¥ã€é€šçŸ¥ä»¥åŠæŒ‡ç¤ºç‰¹æ€§ä»¥åŠé…ç½®ç‰¹æ€§å¹¿æ’­ã€‚GATT ä»…ç”¨äºè“ç‰™ LE éƒ¨ç½²ã€‚ è¯¦ç»†äº†è§£ GATT ä¿¡æ¯ã€‚ é€šç”¨è®¿é—®é…ç½®æ–‡ä»¶(GAP) å¯ä¸è“ç‰™ LE éƒ¨ç½²ä¸­çš„ GATT é…åˆä½¿ç”¨ï¼Œä»¥å®šä¹‰ä¸å‘ç°è“ç‰™è®¾å¤‡å’Œå…±äº«ä¿¡æ¯ç›¸å…³çš„è§„ç¨‹å’Œè§’è‰²ï¼Œä»¥åŠè¿æ¥è“ç‰™è®¾å¤‡çš„é“¾è·¯ç®¡ç†å†…å®¹ã€‚ ä»¥ä¸Šä¿¡æ¯æ¥è‡ªè¿™é‡Œ 0x02 Androidç³»ç»Ÿä¸­çš„BLEAndroidç³»ç»Ÿä¸­å¯¹äºä½åŠŸè€—è“ç‰™æˆ‘ä»¬éœ€è¦å…³å¿ƒä»¥ä¸‹å‡ ç‚¹ï¼š Android 4.3ï¼ˆ18ï¼‰å¼€å§‹æ”¯æŒBLE Android 5.0ï¼ˆ21ï¼‰ä¹‹å‰æ‰‹æœºåªå¯ä»¥ä½œä¸ºä¸­å¿ƒè®¾å¤‡ï¼ˆCentral modeï¼‰ä½¿ç”¨ï¼Œ5.0ä¹‹åå¯ä»¥ä½œä¸ºå¤–è®¾ï¼ˆPeripheral modeï¼‰ä½¿ç”¨ é™¤äº†ä»¥ä¸Šä¿¡æ¯ï¼Œæˆ‘ä»¬åœ¨å¯¹åè®®ä¸­çš„å‡ ä¸ªæ¦‚å¿µåšä¸ªä»‹ç»ï¼Œè¿™æ¶‰åŠåˆ°ä¹‹åçš„å¼€å‘ï¼š Attribute Protocol (ATT) å±æ€§åè®®ï¼Œå¯¹åº” BluetoothGattService Generic Attribute Profile (GATT) é€šç”¨å±æ€§é…ç½®æ–‡ä»¶ï¼Œå¯¹åº”Androidä¸­çš„ BluetoothGatt Characteristic BluetoothGattCharacteristic Descriptor BluetoothGattDescriptor Service BluetoothGattService 0x03 Androidç³»ç»Ÿä¸­çš„BLEæ“ä½œæµç¨‹å’Œä¹‹å‰çš„æ™®é€šè“ç‰™ç›¸åŒï¼Œæˆ‘ä»¬éœ€è¦å…ˆæ£€æµ‹è®¾å¤‡çš„è“ç‰™æ˜¯å¦å¯ç”¨ï¼Œç„¶åæ‰«æå‘¨å›´çš„è“ç‰™è®¾å¤‡ï¼Œç„¶åè¿æ¥ã€‚è¿™é‡Œå¯ä»¥çœ‹åˆ°ï¼ŒBLEçš„æ“ä½œå¹¶ä¸éœ€è¦é…å¯¹ã€‚å¦‚éœ€è¦åœ¨è®¾å¤‡å¿…é¡»æ”¯æŒä½åŠŸè€—è“ç‰™ï¼Œåˆ™è¿˜éœ€è¦åŠ ä¸Šè¿™å¥ï¼š &lt;uses-feature android:name=&quot;android.hardware.bluetooth_le&quot; android:required=&quot;true&quot;/&gt; è“ç‰™æ‰«æ 1234567891011121314151617181920212223242526272829private boolean mScanning;private void scanLeDevice(final boolean enable) &#123; if (enable) &#123; mHandler.postDelayed(new Runnable() &#123; @Override public void run() &#123; mScanning = false; mBluetoothAdapter.stopLeScan(mLeScanCallback); &#125; &#125;, SCAN_PERIOD); mScanning = true; mBluetoothAdapter.startLeScan(mLeScanCallback); &#125; else &#123; mScanning = false; mBluetoothAdapter.stopLeScan(mLeScanCallback); &#125;&#125;// Device scan callback.private BluetoothAdapter.LeScanCallback mLeScanCallback = new BluetoothAdapter.LeScanCallback() &#123; @Override public void onLeScan(final BluetoothDevice device, int rssi, byte[] scanRecord) &#123; String format = \"Name:%s, Mac:%s, Type:%s\"; String msg = String.format(format, device.getName(), device.getAddress(), device.getType()); print(msg); &#125;&#125;; æ‰«æå®Œæˆä¹‹åï¼Œæˆ‘ä»¬ä¼šæ‹¿åˆ°è“ç‰™çš„è®¾å¤‡ä¿¡æ¯ï¼Œç„¶åå°±å¯ä»¥è¿›è¡Œè¿æ¥äº†ã€‚ è¿æ¥è“ç‰™ 12345678910111213141516171819202122232425262728293031@Overridepublic int onStartCommand(Intent intent, int flags, int startId) &#123; if (null != intent) &#123; mMAC = intent.getStringExtra(KEY_MAC); &#125; if (TextUtils.isEmpty(mMAC)) &#123; mMAC = MAC_BIKE; &#125; mBluetoothManager = (BluetoothManager) getSystemService(Context.BLUETOOTH_SERVICE); mBluetoothAdapter = mBluetoothManager.getAdapter(); if (null == mBluetoothAdapter) &#123; stopSelf(); return START_NOT_STICKY; &#125; BluetoothDevice device = mBluetoothAdapter.getRemoteDevice(mMAC); if (null == device) &#123; stopSelf(); return START_NOT_STICKY; &#125; closeConnect(); mBluetoothGatt = device.connectGatt(this, false, mCallBack); if (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.LOLLIPOP) &#123; //5.0è®¾ç½®çš„ä¼ è¾“æœ€å¤§ç©ºé—´ mBluetoothGatt.requestConnectionPriority(BluetoothGatt.CONNECTION_PRIORITY_HIGH); mBluetoothGatt.requestMtu(84); &#125; print(\"Gatt connect\"); return START_STICKY;&#125; è¿æ¥è“ç‰™ åœ¨è¿æ¥çš„CallBackä¸­å¦‚æœæˆ‘ä»¬æ£€æµ‹åˆ°è¿æ¥æˆåŠŸï¼Œæ‰å¯ä»¥è¯·æ±‚è“ç‰™æä¾›çš„æœåŠ¡ï¼Œè¿™é‡Œå…ˆæ£€æµ‹è¿æ¥çš„çŠ¶æ€ï¼š 123456789101112131415161718192021222324252627 private final BluetoothGattCallback mCallBack = new BluetoothGattCallback() &#123; @Override public void onConnectionStateChange(BluetoothGatt gatt, int status, int newState) &#123; super.onConnectionStateChange(gatt, status, newState); print(String.format(\"status:%d, newState:%d\", status, newState)); if (status != BluetoothGatt.GATT_SUCCESS) &#123; closeConnect(); &#125; switch (newState) &#123; case BluetoothProfile.STATE_CONNECTED: print(\"è¿æ¥GATTæœåŠ¡æˆåŠŸï¼Œå¼€å§‹å‘ç°æœåŠ¡...\"); gatt.discoverServices(); break; case BluetoothProfile.STATE_DISCONNECTED: print(\"æ–­å¼€GATTæœåŠ¡ï¼ŒBye\"); closeConnect(); break; default: break; &#125; &#125; ...&#125;; å‘ç°æœåŠ¡ 12345678910111213141516171819202122232425262728293031private final BluetoothGattCallback mCallBack = new BluetoothGattCallback() &#123; @Override public void onServicesDiscovered(BluetoothGatt gatt, int status) &#123; super.onServicesDiscovered(gatt, status); print(\"å‘ç°æœåŠ¡ï¼š\" + status); if (BluetoothGatt.GATT_SUCCESS == status) &#123; List&lt;BluetoothGattService&gt; gattServices = gatt.getServices(); if (null == gattServices || gattServices.size() == 0) &#123; return; &#125; for (BluetoothGattService gattService : gattServices) &#123; String serviceUUID = gattService.getUuid().toString(); print(\"UUID GATT:\" + serviceUUID); List&lt;BluetoothGattCharacteristic&gt; characteristics = gattService.getCharacteristics(); for (BluetoothGattCharacteristic characteristic : characteristics) &#123; String uuid = characteristic.getUuid().toString(); print(\"UUID Cha:\" + uuid); print(\"UUID Status:\" + getProperties(characteristic)); if (UUID_RECEIVE.toString().equalsIgnoreCase(uuid)) &#123; mBluetoothGatt.setCharacteristicNotification(characteristic, true); print(\"å¼€å§‹ç›‘å¬ï¼š\" + uuid); &#125; &#125; &#125; &#125; &#125; ...&#125; ä½¿ç”¨æœåŠ¡ â€¦ 0x04 è¿˜éœ€è¦äº†è§£çš„ä¸€äº›ç»†èŠ‚ UUID åˆ¤æ–­æœåŠ¡çš„å±æ€§ 0x05 å¯èƒ½ä¼šé‡åˆ°çš„å‘æ‰‹ä¸Šçš„ä¸¤å°é­…æ—è®¾å¤‡ï¼Œè¿æ¥ä¸€ä¸ªå®¢æˆ·æä¾›çš„è“ç‰™æ¨¡å—ï¼Œæ­»æ´»è¿ä¸ä¸Šï¼Œå…¶ä»–æ‰‹æœºè¿æ¥æ­£å¸¸ã€‚è¿™ä¸¤éƒ¨è®¾å¤‡è¿æ¥æ·˜å®ä¸Šä¹°çš„ä¸€ä¸ªè“ç‰™æ¨¡å—æ­£å¸¸ã€‚ 0xFF å‚è€ƒ https://developer.android.com/guide/topics/connectivity/bluetooth-le.html https://www.bluetooth.com/zh-cn/specifications/bluetooth-core-specification https://zh.wikipedia.org/wiki/%E8%97%8D%E7%89%99#.E8.97.8D.E7.89.994.0 https://race604.com/android-ble-in-action/ http://blog.csdn.net/qinxiandiqi/article/details/40741269 http://www.jianshu.com/p/8690dbafe849 https://www.bluetooth.com/zh-cn/specifications/adopted-specifications https://www.bluetooth.org/DocMan/handlers/DownloadDoc.ashx?doc_id=286439","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"https://ttdevs.github.io/categories/æŠ€æœ¯/"}],"tags":[{"name":"Android","slug":"Android","permalink":"https://ttdevs.github.io/tags/Android/"},{"name":"Bluetooth","slug":"Bluetooth","permalink":"https://ttdevs.github.io/tags/Bluetooth/"}]},{"title":"ã€ŒAndroid-Bluetoothã€0x01æ“ä½œ","slug":"[Android-Bluetooth]0x01æ“ä½œ","date":"1969-12-31T16:00:00.000Z","updated":"2017-04-27T11:07:57.000Z","comments":true,"path":"1970/01/01/[Android-Bluetooth]0x01æ“ä½œ/","link":"","permalink":"https://ttdevs.github.io/1970/01/01/[Android-Bluetooth]0x01æ“ä½œ/","excerpt":"","text":"0x00 è“ç‰™ï¼ˆBluetoothï¼‰è¿™ä¸ªå°ç¡¬ä»¶å·²ç»æ˜¯Androidæœºå™¨çš„æ ‡é…äº†ï¼Œç”±äºå¹³æ—¶ä¸æ€ä¹ˆç”¨ï¼Œå› æ­¤åˆ°ç°åœ¨éƒ½æ²¡æœ‰å»ç ”ç©¶è¿‡ã€‚ç°åœ¨æœ‰ä¸€ä¸ªç®€å•çš„å°éœ€æ±‚ï¼šé€šè¿‡è“ç‰™è¿æ¥ä¸€ä¸ªä¸²å£è®¾å¤‡è¯»å–å…¶ä¸Šé¢çš„æ•°æ®ï¼Œå³ä»å·²é…å¯¹çš„è®¾å¤‡åˆ—è¡¨ä¸­é€‰æ‹©æˆ‘ä»¬çš„ä¸²å£è“ç‰™è®¾å¤‡ï¼ˆä»ï¼‰ï¼Œè¿æ¥ï¼Œç„¶åè¯»å–æ•°æ®ã€‚é‚å†™æ­¤æ–‡ã€‚ 0x01 ç®€å•ä½¿ç”¨è“ç‰™è®¾å¤‡çš„è¯¦ç»†ä½¿ç”¨ï¼Œå¯ä»¥å‚è€ƒAndroidå…³äºè“ç‰™çš„å®˜æ–¹æ–‡æ¡£ã€‚å¦‚æœä½ å’Œæˆ‘ä¸€æ ·ï¼Œä¹‹å‰æ²¡æœ‰ç ”ç©¶è¿‡è“ç‰™ï¼Œä¼°è®¡çœ‹çœ‹å®Œåä¹Ÿä¼šæœ‰ä¸€å †é—®é¢˜å­˜åœ¨ï¼šä»€ä¹ˆä¸»è®¾å¤‡ã€ä»è®¾å¤‡ã€UUIDæ˜¯å¹²å˜›çš„ï¼Œå¦‚ä½•å…å¯†é’¥é…å¯¹ç­‰ç­‰ã€‚ä¸ç€æ€¥ï¼Œæˆ‘ä»¬æ…¢æ…¢æ¥ã€‚ ä¸Šé¢å·²ç»è¯´åˆ°ï¼Œæˆ‘ä»¬çš„è®¾å¤‡å·²ç»æå‰é…å¯¹å®Œæˆï¼ˆæ€ä¹ˆé…å¯¹ï¼šç½‘ç»œè®¾ç½®ä¸­ä¸­æ‰¾åˆ°è“ç‰™ï¼Œç„¶åæœç´¢ï¼Œæ‰¾åˆ°ä½ çš„è®¾å¤‡ï¼Œç„¶åé…å¯¹ã€‚è¿™ä¸ªæ—¶å€™å¯èƒ½ä¼šæç¤ºè¾“å…¥å¯†ç ï¼Œé»˜è®¤å¯†ç æ¯”0000ï¼Œ1234ç­‰ï¼‰ã€‚æˆ‘ä»¬åªéœ€è¦è¿æ¥å³å¯ã€‚ä¸‹é¢ç®€è¿°æ“ä½œæ­¥éª¤ï¼š æ·»åŠ è“ç‰™æƒé™ 12&lt;uses-permission android:name=\"android.permission.BLUETOOTH\" /&gt;&lt;uses-permission android:name=\"android.permission.BLUETOOTH_ADMIN\" /&gt; åˆ¤æ–­æ˜¯å¦æ”¯æŒè“ç‰™ 123456789101112131415private void initBluetooth() &#123; mBluetoothAdapter = BluetoothAdapter.getDefaultAdapter(); if (null == mBluetoothAdapter) &#123; tvContent.setText(\"BluetoothAdapter is null\"); return; &#125; if (!mBluetoothAdapter.isEnabled()) &#123; tvContent.setText(\"BluetoothAdapter is disable, please open it\"); Intent intent = new Intent(BluetoothAdapter.ACTION_REQUEST_ENABLE); startActivityForResult(intent, REQUEST_ENABLE_BT); &#125; tvContent.setText(\"Bluetooth init success\");&#125; é¦–å…ˆæ˜¯åˆ¤æ–­æ˜¯å¦æœ‰è“ç‰™é€‚é…å™¨ï¼Œå¦‚æœæ²¡æœ‰ï¼Œ`BluetoothAdapter.getDefaultAdapter()` è¿”å› `null`ã€‚ç„¶ååˆ¤æ–­è“ç‰™è®¾å¤‡æ˜¯å¦å¯ç”¨ `mBluetoothAdapter.isEnabled()` ï¼Œå¦‚æœæœªå¯ç”¨ï¼Œåˆ™å‘é€ä¸€ä¸ª `Intent` æ¥è®©ç”¨æˆ·å¯ç”¨è“ç‰™ï¼Œè¿™ä¸ª `Intent` æ˜¯ç³»ç»Ÿçš„ï¼Œæˆ‘ä»¬åœ¨ `onActivityResult` ä¸­å¤„ç†ç”¨æˆ·æ“ä½œç»“æœï¼Œå¦‚æœç”¨æˆ·é¡ºåˆ©å¼€å¯è“ç‰™ï¼Œåˆ™ä¼šè¿”å› `RESULT_OK`ã€‚ è·å–è®¾å¤‡åˆ—è¡¨ 12345678Set&lt;BluetoothDevice&gt; pairedDevices = mBluetoothAdapter.getBondedDevices();if (null != pairedDevices &amp;&amp; pairedDevices.size() &gt; 0) &#123; for (BluetoothDevice device : pairedDevices) &#123; ...... String msg = String.format(\"%s %s\\n\", device.getName(), device.getAddress()); ...... &#125;&#125; è¿™ä¸ªæ—¶å€™æˆ‘ä»¬å¯ä»¥æ‹¿åˆ° `BluetoothDevice` ï¼Œè¿™ä¸ªå¯¹è±¡ä¸­ä¿å­˜äº†å·²é…å¯¹è“ç‰™è®¾å¤‡çš„ä¿¡æ¯ï¼Œæ¯”å¦‚åç§°ï¼ŒMACåœ°å€ï¼ŒçŠ¶æ€ï¼ŒUUIDç­‰ä¿¡æ¯ï¼ˆä½†è¿™äº›ä¿¡æ¯ä¸ä¸€å®šéƒ½éƒ½ï¼‰ï¼Œæˆ‘ä»¬éœ€è¦ä¿å­˜ä¸‹æ¥ï¼Œåœ¨æ¥ä¸‹æ¥è¿æ¥çš„æ—¶å€™ä¼šä½¿ç”¨ã€‚ è¿æ¥è®¾å¤‡ æœ‰äº† BluetoothDevice ä¿¡æ¯ï¼Œæˆ‘ä»¬å°±å¯ä»¥è¿æ¥è¿™ä¸ªå·²ç»é…å¯¹çš„è“ç‰™è®¾å¤‡äº†ã€‚ 12345678910111213 public static final UUID DEFAULT_UUID = UUID.fromString(\"00001101-0000-1000-8000-00805f9b34fb\"); try &#123; if(null == mSocket)&#123; mSocket = mDevice.createRfcommSocketToServiceRecord(DEFAULT_UUID); &#125; mSocket.connect(); // é˜»å¡çš„ mIn = mSocket.getInputStream();&#125; catch (IOException e) &#123; e.printStackTrace(); return false;&#125; è¿æ¥æˆåŠŸåï¼Œæˆ‘ä»¬ä¼šå¾—åˆ°ä¸€ä¸ª `BluetoothSocket` å¯¹è±¡ï¼Œç„¶åè°ƒç”¨å…¶é˜»å¡çš„ `connect()` æ–¹æ³•ï¼Œç­‰å¾…ä¸¤å°è®¾å¤‡è¿æ¥æˆåŠŸï¼ˆæ‰€ä»¥è¿™ä¸ªæ—¶å€™å¿…é¡»åœ¨å¦å¤–ä¸€ä¸ªçº¿ç¨‹ä¸­è¿›è¡Œï¼‰ã€‚å½“ä¸¤å°è®¾å¤‡è¿æ¥æˆåŠŸä¹‹åä¼šç»§ç»­å‘ä¸‹æ‰§è¡Œã€‚ è¯»å–æ•°æ® è¿æ¥æˆåŠŸä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ mSocket.getInputStream() è·å¾—ä¸€ä¸ªè¾“å…¥æµï¼Œç»“ä¸‹æ¥çš„æ“ä½œå°±æ˜¯æµçš„æ“ä½œäº†ï¼Œè¿™ä¸ªå’Œæ™®é€š socket ä¸­è¾“å…¥è¾“å‡ºæµçš„æ“ä½œä¸€æ ·äº†ã€‚ 1234567891011 try &#123; mBytes = mIn.read(readBuffer); System.arraycopy(readBuffer, 0, tempBuffer, mCount, mBytes); mCount += mBytes; if (mCount &gt;= SIZE) &#123; parseData(tempBuffer); mCount = 0; &#125;&#125; catch (IOException e) &#123; e.printStackTrace();&#125; 0x02 æ€»ç»“Androidè“ç‰™ï¼ˆä¸»ä»ï¼‰çš„æ“ä½œï¼š æ£€æŸ¥æ˜¯å¦æ”¯æŒï¼Œæ˜¯å¦å¯ç”¨ï¼ˆåŒ…æ‹¬æ˜¯å¦å¯è§ç­‰ï¼‰ æ‰«æè®¾å¤‡ é…å¯¹ è¿æ¥ æ•°æ®äº¤æ¢ ç­‰ç­‰ è¿™é‡Œåªè®²äº†æ£€æŸ¥éƒ¨åˆ†æ“ä½œï¼Œæ¶‰åŠçš„æ‰«æä¸é…å¯¹å¯èƒ½æ˜¯æ›´å¤æ‚ä¸€äº›çš„ï¼Œåœ¨æ¥ä¸‹æ¥è®²è¿°ã€‚ æœ€åï¼Œé¡¹ç›®ä»£ç å¯å‚è€ƒè¿™é‡Œgithub/ttdevs/airã€‚ 0x03 Javaçº¿ç¨‹çš„å°è£…1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465/** * Created by ttdevs * 2017-01-22 (android) * https://github.com/ttdevs */public abstract class BaseWorkerThread extends Thread &#123; private boolean isRunning = true; @Override public void run() &#123; super.run(); isRunning = workerBefore(); while (isRunning) &#123; workerCycle(); &#125; workerAfter(); &#125; /** * æå‰æ‰§è¡Œ true: ç»§ç»­ false: ç»“æŸ * * @return */ public boolean workerBefore() &#123; return true; &#125; /** * å·¥ä½œæ–¹æ³•ï¼Œè¢«å¾ªç¯è°ƒç”¨ * * @return true: ç»§ç»­ false: ç»“æŸ */ public abstract void workerCycle(); /** * ç»“æŸæ‰§è¡Œ */ public void workerAfter() &#123; &#125; /** * å¼€å§‹çº¿ç¨‹ */ public void startThread() &#123; isRunning = true; try &#123; start(); &#125; catch (Exception e) &#123; e.printStackTrace(); isRunning = false; &#125; &#125; /** * ç»“æŸçº¿ç¨‹ */ public void stopThread() &#123; isRunning = false; &#125;&#125; 0x04 å‚è€ƒ https://developer.android.google.cn/guide/topics/connectivity/bluetooth.html","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"https://ttdevs.github.io/categories/æŠ€æœ¯/"}],"tags":[{"name":"Android","slug":"Android","permalink":"https://ttdevs.github.io/tags/Android/"},{"name":"Bluetooth","slug":"Bluetooth","permalink":"https://ttdevs.github.io/tags/Bluetooth/"}]},{"title":"ã€ŒAndroid-SQLiteã€0x02ä»åŠ è½½æœ¬åœ°æ•°æ®åº“å¼€å§‹","slug":"[Android-SQLite]0x02ä»åŠ è½½æœ¬åœ°æ•°æ®åº“å¼€å§‹","date":"1969-12-31T16:00:00.000Z","updated":"2017-04-27T11:07:57.000Z","comments":true,"path":"1970/01/01/[Android-SQLite]0x02ä»åŠ è½½æœ¬åœ°æ•°æ®åº“å¼€å§‹/","link":"","permalink":"https://ttdevs.github.io/1970/01/01/[Android-SQLite]0x02ä»åŠ è½½æœ¬åœ°æ•°æ®åº“å¼€å§‹/","excerpt":"","text":"0x00 å¼•è¨€ å¥½ä¹…ä»¥å‰å°±å†™äº†ï¼Œä½†æ˜¯ä¸€ç›´æ‹–æ‹–æ‹‰æ‹‰çš„ï¼Œåœ¨è‰ç¨¿ç®±é‡Œæ”¾äº†ä¸¤ä¸ªæ˜ŸæœŸè¿˜æ²¡å†™å®Œï¼Œæƒ³æƒ³è¿™æ ·æ‰˜ä¸‹å»åˆè¦åºŸæ‰äº†ï¼Œè¿˜æ˜¯åˆ†å¼€æ¥å§ï¼Œå†™å¤šå°‘æ˜¯å¤šå°‘ã€‚ Androidçš„SQLiteæ•°æ®åº“ç®€å•ä½¿ç”¨ä¸€æ®µæ—¶é—´äº†ï¼Œç°åœ¨æƒ³æŠ½äº›æ—¶é—´æ€»ç»“ä¸‹ï¼Œä¸ç„¶æ€»æ„Ÿè§‰å¾ˆä¹±ã€‚ 0x01 SQLiteExpertå…ˆè¯´ä¸€ä¸ªå·¥å…·ï¼ŒSQLite Expertï¼Œä¸€æ¬¾SQLiteæ•°æ®åº“ç®¡ç†å·¥å…·ï¼Œä¸‹è½½åœ°å€ï¼š http://www.sqliteexpert.com/ï¼ŒPersonal Editionæ˜¯å…è´¹çš„ï¼Œæ—¥å¸¸ä½¿ç”¨åŸºæœ¬è¶³å¤Ÿï¼Œéœ€è¦ä¸“ä¸šç‰ˆçš„å¯ä»¥è‡ªè¡Œç½‘ä¸Šæ‰¾å¯»ã€‚å½“ç„¶ï¼Œå…¶ä»–å…è´¹çš„å·¥å…·è¿˜æœ‰å¾ˆå¤šï¼Œå¦‚ï¼šSQLite Database Browserã€ SQLiteManager ç­‰ã€‚ 0x02 åŠ è½½æœ¬åœ°æ•°æ®åº“å‡è®¾æˆ‘ä»¬SDCardçš„æ ¹ç›®å½•ä¸Šå·²ç»å­˜åœ¨ä¸€ä¸ªæ•°æ®åº“ï¼Œåç§°ä¸ºï¼šChinaCity.dbã€‚è¿™æ—¶å€™æˆ‘ä»¬å¯ä»¥è¿™æ ·æ“ä½œï¼š 1234567891011121314151617181920212223public void readDataBaseFromSDCard() &#123; String dbPath = Environment.getExternalStorageDirectory() + \"/ChinaCity.db\"; File dbFile = new File(dbPath); if (!dbFile.exists()) &#123; Toast.makeText(getApplicationContext(), \"è¯·å…ˆç‚¹å‡»æ‹·è´åˆ°SDCard\", Toast.LENGTH_LONG).show(); return; &#125; openOrCreateDatabase(dbPath, SQLiteDatabase.CREATE_IF_NECESSARY, null); SQLiteDatabase db = SQLiteDatabase.openDatabase(dbPath, null, SQLiteDatabase.OPEN_READWRITE); // db = openOrCreateDatabase(dbPath, SQLiteDatabase.OPEN_READWRITE, null); StringBuffer sb = new StringBuffer(); Cursor cursor = db.rawQuery(\"select * from china_provinces_code\", null); while (cursor.moveToNext()) &#123; int id = cursor.getInt(cursor.getColumnIndex(\"_id\")); String name = cursor.getString(cursor.getColumnIndex(\"name\")); sb.append(id + \":\" + name + \" \\n\"); &#125; System.out.println(sb.toString());&#125; å…ˆç”¨SQLiteDatabaseçš„ä¸€ä¸ªé™æ€æ–¹æ³•openDatabaseæ‰“å¼€ä¸€ä¸ªæ•°æ®åº“ï¼Œç¬¬ä¸€ä¸ªå‚æ•°ä¸ºæ•°æ®åº“æ–‡ä»¶è·¯å¾„ï¼Œç¬¬äºŒä¸ªå‚æ•°ä¸€èˆ¬ä¸ºnullï¼Œç¬¬ä¸‰ä¸ªå‚æ•°ä¸ºæ‰“å¼€æ•°æ®åº“çš„æ–¹å¼ï¼Œç”±äºåªéœ€è¦è¯»å–æ•°æ®ï¼Œæ‰€ä»¥æˆ‘ä»¬é€‰æ‹© SQLiteDatabase.OPEN_READONLYï¼Œæ­¤ç§æ–¹å¼çš„å¥½å¤„æ˜¯æ•°æ®åº“å­˜åœ¨çš„è¯å°±ä¸ä¼šå‡ºé”™ï¼›å¦å¤–ä¸€ç§ä¸º SQLiteDatabase.OPEN_READWRITEï¼Œä»¥è¯»å†™çš„æ–¹å¼æ‰“å¼€ã€‚æ‰§è¡Œä¸Šé¢ä»£ç ï¼Œæˆ‘ä»¬ä¼šçœ‹ä¸ä¸Šå›¾ä¿¡æ¯ç›¸åŒçš„ï¼š å¼€å‘çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šéœ€è¦ä¸€äº›åˆå§‹åŒ–æ•°æ®ï¼Œæ¯”å¦‚åŸå¸‚ä»£ç ä¿¡æ¯ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥äº‹å…ˆåˆ›å»ºå¥½ä¸€ä¸ªæ•°æ®åº“ï¼Œå†™å…¥åˆå§‹æ•°æ®ï¼Œå°†å…¶æ”¾å…¥è‡ªå·±çš„apkä¸­ä¸€èµ·åˆ†å‘ã€‚è¿™ä¸ªæ—¶å€™æˆ‘ä»¬å°±å¯ä»¥ç›´æ¥ä»èµ„æºæ–‡ä»¶ä¸­è¯»å–è¿™ä¸ªæ•°æ®åº“æ–‡ä»¶å†™å…¥åˆ°åº”ç”¨çš„æ•°æ®åº“ç›®å½•æˆ–è€…SDCardä¸­ï¼Œç„¶åå°±å¯ä»¥å¯¹å…¶æ“ä½œï¼Œæ‹·è´å¯ä»¥è¿™æ ·æ“ä½œï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253/** * æ‹·è´èµ„æºä¸­æ•°æ®åº“ * * @param where 1SDCARD,2LOCAL */public void copyDataBase(int where) &#123; // æ¯ä¸ªåº”ç”¨éƒ½æœ‰ä¸€ä¸ªæ•°æ®åº“ç›®å½•ï¼Œä»–ä½äº /data/data/packagename/databases/ç›®å½•ä¸‹ String packageName = \"com.ttdevs.citydata\"; // xmlä¸­é…ç½®çš„ String dbName = \"ChinaCity.db\"; String dbPath = null; if (where == 1) &#123; // sdcard dbPath = Environment.getExternalStorageDirectory() + File.separator + dbName; &#125; else &#123; // local, TODO Environment.getDataDirectory() dbPath = \"/data/data/\" + packageName + \"/databases/\" + dbName; &#125; if (where == 2) &#123; new File(\"/data/data/\" + packageName + \"/databases/\").mkdirs(); &#125; if (where == 1 &amp;&amp; !Environment.MEDIA_MOUNTED.equals(Environment.getExternalStorageState())) &#123; return; // æœªæŒ‚è½½å¤–éƒ¨å­˜å‚¨ï¼Œæ‹·è´åˆ°å†…éƒ¨ä¸ç”¨åˆ¤æ–­ &#125; File dbFile = new File(dbPath); if (dbFile.exists()) &#123; dbFile.delete(); &#125; try &#123; dbFile.createNewFile(); &#125; catch (IOException e1) &#123; e1.printStackTrace(); return; &#125; try &#123; InputStream is = getResources().getAssets().open(dbName); OutputStream os = new FileOutputStream(dbPath); byte[] buffer = new byte[1024]; int length = 0; while ((length = is.read(buffer)) &gt; 0) &#123; os.write(buffer, 0, length); &#125; os.flush(); os.close(); is.close(); &#125; catch (IOException e) &#123; e.printStackTrace(); &#125; Toast.makeText(getApplicationContext(), \"æ‹·è´æˆåŠŸ\", Toast.LENGTH_LONG).show();&#125; ä»£ç ä¸æ˜¯å¾ˆä¸¥è°¨ï¼Œå‡‘æ´»ç€çœ‹å“ˆã€‚ç»è¿‡ä»¥ä¸Šæ­¥éª¤ï¼Œæˆ‘ä»¬å°±å¯ä»¥å¼€å§‹ä½¿ç”¨æ•°æ®åº“ï¼Œæ•°æ®åº“çš„å¸¸ç”¨æ“ä½œï¼Œåœ¨æ¥ä¸‹æ¥çš„ä»‹ç»ä¸­ç»§ç»­ã€‚ 0x03 ä¸‹è½½ChinaCity.dbæ•°æ®åº“ï¼š ä¸‹è½½","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"https://ttdevs.github.io/categories/æŠ€æœ¯/"}],"tags":[{"name":"Android","slug":"Android","permalink":"https://ttdevs.github.io/tags/Android/"},{"name":"SQLite","slug":"SQLite","permalink":"https://ttdevs.github.io/tags/SQLite/"}]},{"title":"ã€ŒAndroid-SQLiteã€0x01åˆ›å»ºè‡ªå·±çš„æ•°æ®åº“","slug":"[Android-SQLite]0x01åˆ›å»ºè‡ªå·±çš„æ•°æ®åº“","date":"1969-12-31T16:00:00.000Z","updated":"2017-04-27T11:07:57.000Z","comments":true,"path":"1970/01/01/[Android-SQLite]0x01åˆ›å»ºè‡ªå·±çš„æ•°æ®åº“/","link":"","permalink":"https://ttdevs.github.io/1970/01/01/[Android-SQLite]0x01åˆ›å»ºè‡ªå·±çš„æ•°æ®åº“/","excerpt":"","text":"0x01 åˆ›å»ºè‡ªå·±çš„æ•°æ®åº“å¤§å¤šæ•°æƒ…å†µï¼Œæˆ‘ä»¬è¿˜æ˜¯éœ€è¦è‡ªå·±å»ç»´æŠ¤ä¸€ä¸ªæ•°æ®åº“ï¼Œå¸¸è§çš„åŒ…æ‹¬æ•°æ®åº“çš„åˆ›å»ºï¼Œå‡çº§ï¼Œé”€æ¯ç­‰æ“ä½œã€‚ androidæä¾›äº†SQLiteOpenHelperæŠ½è±¡ç±»ï¼Œæˆ‘ä»¬åˆ›å»ºSQLiteOpenHelperçš„å®ç°ç±»ï¼Œé‡å†™ä»–çš„onCreate(), onUpgrade() æˆ–è€… onOpen()æ–¹æ³•ï¼Œå¯¹æ•°æ®åº“è¿›è¡Œç®¡ç†ã€‚å¦‚ä¸‹ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879public class DataBaseOpenHelper extends SQLiteOpenHelper &#123; private static final String DATABASE_NAME = \"ChinaCity.db\"; private static final int DATABASE_VERSION = 1; // Version must be &gt;= 1 public DataBaseOpenHelper(Context context) &#123; super(context, DATABASE_NAME, null, DATABASE_VERSION); System.out.println(\"DataBaseOpenHelper\"); &#125; public DataBaseOpenHelper(Context context, int version) &#123; super(context, DATABASE_NAME, null, version); System.out.println(\"DataBaseOpenHelper version\"); &#125; @Override public void onOpen(SQLiteDatabase db) &#123; if (!db.isReadOnly()) &#123; db.execSQL(\"PRAGMA foreign_keys = ON;\"); // Enable foreign key constraints &#125; // create table test(id integer references students(id),score integer check (score&lt;=100 and score&lt;=0),primary key(id,score)) super.onOpen(db); &#125; @Override public void onCreate(SQLiteDatabase db) &#123; CityData.createTable(db); &#125; @Override public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) &#123; CityData.dropTable(db); CityData.createTable(db); &#125; public static class CityData implements BaseColumns &#123; public static final String TYPE_TEXT = \" text \"; public static final String TYPE_INTEGER = \" integer \"; public static final String COMMA_SEP = \",\"; // *******************************china_city_code*********************************** public static final String TABLE_NAME_CITY = \"china_city_code\"; public static final String COLUMN_NAME_PROVINCE = \"province\"; public static final String COLUMN_NAME_CITY = \"city\"; public static final String COLUMN_NAME_COUNTY = \"county\"; public static final String COLUMN_NAME_CODE = \"code\"; public static final String SQL_CREATE_CITY = \"CREATE TABLE IF NOT EXISTS \" + TABLE_NAME_CITY + \" (\" + _ID + TYPE_INTEGER + \" PRIMARY KEY AUTOINCREMENT, \" + COLUMN_NAME_PROVINCE + TYPE_TEXT + COMMA_SEP + COLUMN_NAME_CITY + TYPE_TEXT + COMMA_SEP + COLUMN_NAME_COUNTY + TYPE_TEXT + COMMA_SEP + COLUMN_NAME_CODE + TYPE_INTEGER + \" )\"; public static final String SQL_CREATE_CITY_INDEX = \"CREATE UNIQUE INDEX IF NOT EXISTS \" + COLUMN_NAME_CODE + \" ON \" + TABLE_NAME_CITY + \"(\" + COLUMN_NAME_CODE + \")\"; public static final String SQL_DELETE_CITY = \"DROP TABLE IF EXISTS \" + TABLE_NAME_CITY; // *******************************china_provinces_code******************************* public static final String TABLE_NAME_PROVINCE = \"china_provinces_code\"; public static final String COLUMN_NAME_ID = \"id\"; public static final String COLUMN_NAME_NAME = \"name\"; public static final String SQL_CREATE_PROVINCE = \"CREATE TABLE IF NOT EXISTS \" + TABLE_NAME_PROVINCE + \" (\" + _ID + TYPE_INTEGER + \" PRIMARY KEY AUTOINCREMENT, \" + COLUMN_NAME_ID + TYPE_INTEGER + COMMA_SEP + COLUMN_NAME_NAME + TYPE_TEXT + \" )\"; public static final String SQL_DELETE_PROVINCE = \"DROP TABLE IF EXISTS \" + TABLE_NAME_PROVINCE; public static void createTable(SQLiteDatabase db) &#123; db.execSQL(SQL_CREATE_PROVINCE); db.execSQL(SQL_CREATE_CITY); db.execSQL(SQL_CREATE_CITY_INDEX); &#125; public static void dropTable(SQLiteDatabase db) &#123; db.execSQL(SQL_DELETE_PROVINCE); db.execSQL(SQL_DELETE_CITY); &#125; &#125;&#125; æ„é€ å‡½æ•°ä¸­æˆ‘ä»¬éœ€è¦ä¼ å…¥å››ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°ä¸ºä¸Šä¸‹æ–‡ï¼Œç¬¬äºŒä¸ªä¸ºæ•°æ®åº“åç§°ï¼Œç¬¬ä¸‰ä¸ªå‚æ•°ä¸€èˆ¬ä¸ºnullï¼Œç¬¬å››ä¸ªä¸ºæ•°æ®åº“çš„ç‰ˆæœ¬ã€‚onCreate()æ–¹æ³•ä¸­ä¸»è¦æ‰§è¡Œæ•°æ®åº“çš„åˆ›å»ºæ“ä½œã€‚onUpgrade()æ–¹æ³•ä¸»è¦åœ¨æ•°æ®åº“å‡çº§æ—¶è°ƒç”¨ï¼Œæºç  android.database.sqlite.SQLiteOpenHelper.getDatabaseLocked(boolean writable) ä¸­è¿™æ ·æè¿°ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990private SQLiteDatabase getDatabaseLocked(boolean writable) &#123; if (mDatabase != null) &#123; if (!mDatabase.isOpen()) &#123; // Darn! The user closed the database by calling mDatabase.close(). mDatabase = null; &#125; else if (!writable || !mDatabase.isReadOnly()) &#123; // The database is already open for business. return mDatabase; &#125; &#125; if (mIsInitializing) &#123; throw new IllegalStateException(\"getDatabase called recursively\"); &#125; SQLiteDatabase db = mDatabase; try &#123; mIsInitializing = true; if (db != null) &#123; if (writable &amp;&amp; db.isReadOnly()) &#123; db.reopenReadWrite(); &#125; &#125; else if (mName == null) &#123; db = SQLiteDatabase.create(null); &#125; else &#123; try &#123; if (DEBUG_STRICT_READONLY &amp;&amp; !writable) &#123; final String path = mContext.getDatabasePath(mName).getPath(); db = SQLiteDatabase.openDatabase(path, mFactory, SQLiteDatabase.OPEN_READONLY, mErrorHandler); &#125; else &#123; db = mContext.openOrCreateDatabase(mName, mEnableWriteAheadLogging ? Context.MODE_ENABLE_WRITE_AHEAD_LOGGING : 0, mFactory, mErrorHandler); &#125; &#125; catch (SQLiteException ex) &#123; if (writable) &#123; throw ex; &#125; Log.e(TAG, \"Couldn't open \" + mName + \" for writing (will try read-only):\", ex); final String path = mContext.getDatabasePath(mName).getPath(); db = SQLiteDatabase.openDatabase(path, mFactory, SQLiteDatabase.OPEN_READONLY, mErrorHandler); &#125; &#125; onConfigure(db); final int version = db.getVersion(); if (version != mNewVersion) &#123; if (db.isReadOnly()) &#123; throw new SQLiteException(\"Can't upgrade read-only database from version \" + db.getVersion() + \" to \" + mNewVersion + \": \" + mName); &#125; db.beginTransaction(); try &#123; if (version == 0) &#123; onCreate(db); &#125; else &#123; if (version &gt; mNewVersion) &#123; onDowngrade(db, version, mNewVersion); &#125; else &#123; onUpgrade(db, version, mNewVersion); &#125; &#125; db.setVersion(mNewVersion); db.setTransactionSuccessful(); &#125; finally &#123; db.endTransaction(); &#125; &#125; onOpen(db); if (db.isReadOnly()) &#123; Log.w(TAG, \"Opened \" + mName + \" in read-only mode\"); &#125; mDatabase = db; return db; &#125; finally &#123; mIsInitializing = false; if (db != null &amp;&amp; db != mDatabase) &#123; db.close(); &#125; &#125;&#125; å½“å½“å‰ç‰ˆæœ¬å°äºæ–°ç‰ˆæœ¬æ—¶ï¼Œä¼šè°ƒç”¨onUpgrade()æ–¹æ³•ã€‚æ‰€ä»¥ä¸Šé¢SQLiteOpenHelperçš„å®ç°æ€è·¯ä¸ºï¼šæ„é€ æ–¹æ³•ä¸­åˆå§‹åŒ–ä¸€ä¸‹æ•°æ®åº“çš„å¿…è¦å‚æ•°ï¼Œå¦‚æ•°æ®åº“ç‰ˆæœ¬ï¼Œæ•°æ®åº“åç­‰ï¼›åœ¨onCreate()æ–¹æ³•ä¸­åˆ›å»ºæ•°æ®åº“çš„è¡¨ï¼›å½“æˆ‘ä»¬éœ€è¦å¯¹æ•°æ®åº“è¿›è¡Œå‡çº§çš„æ—¶å€™ï¼Œä¿®æ”¹æ•°æ®åº“çš„ç‰ˆæœ¬å·ï¼Œè¿™æ ·å°±å¯ä»¥è§¦å‘onUpgrade()æ–¹æ³•ï¼Œè¿™é‡Œæˆ‘ä»¬åšæœ€ç®€å•çš„å¤„ç†ï¼šdropæ‰æ‰€æœ‰è¡¨ç„¶åé‡æ–°åˆ›å»ºã€‚å½“ç„¶æˆ‘ä»¬è¿˜å¯ä»¥åœ¨onOpen()æ–¹æ³•ä¸­åšä¸€ä¸‹æ•°æ®åº“çš„è®¾ç½®æ“ä½œï¼Œå¦‚è®¾ç½®å¤–é”®ç”Ÿæ•ˆã€‚è¿™æ ·æˆ‘ä»¬çš„æ•°æ®åº“ç®¡ç†ç±»å°±å®ç°äº†ã€‚ 0x02 æ‹¿åˆ°æ•°æ®åº“å¯¹è±¡æœ‰äº†æ•°æ®åº“ç®¡ç†ç±»ï¼Œå¯¹æ•°æ®åº“è¿›è¡Œæ“ä½œæˆ‘ä»¬æœ€å¥½å°è£…ä¸€ä¸ªæ“ä½œç±»ï¼Œåœ¨è¿™ä¸ªç±»ä¸­å¯¹æ•°æ®åº“ä¸­çš„è¡¨è¿›è¡Œæ“ä½œã€‚ä¸‹é¢çš„ä»£ç ä¹Ÿæ˜¯ç½‘ä¸Šæ¯”è¾ƒå¸¸è§çš„ï¼ˆå¯¹äºæ•°æ®åº“å¯¹è±¡ï¼Œä¹Ÿæœ‰å¤„ç†æˆå•ä¾‹ï¼‰ã€‚å…ˆçœ‹ä»£ç ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546public class DataBaseManager &#123; private DataBaseOpenHelper dbHelper; private SQLiteDatabase db; public DataBaseManager(Context context) throws SQLException &#123; this.dbHelper = new DataBaseOpenHelper(context); this.db = dbHelper.getWritableDatabase(); &#125; public CopyOfDataBaseManager(Context context, int version) throws SQLException &#123; this.dbHelper = new DataBaseOpenHelper(context, version); this.db = dbHelper.getWritableDatabase(); &#125; public void closeDataBase() &#123; if (db != null &amp;&amp; db.isOpen()) &#123; db.close(); &#125; &#125; public boolean isInitData(String tableName) &#123; int count = 0; String sql = \"select count(*) from \" + tableName; Cursor cursor = db.rawQuery(sql, null); if (cursor.moveToFirst()) &#123; count = cursor.getInt(0); &#125; return count &gt; 0; &#125; public void clearTable(String tableName) &#123; String sql = \"delete from \" + tableName + \";\"; sql += \"update sqlite_sequence set seq = 0 where name = \" + tableName + \";\"; db.execSQL(sql); &#125; public void insertProvinceData(int id, String name) &#123; String sql = \"insert into \" + CityData.TABLE_NAME_PROVINCE + \" (\" + CityData.COLUMN_NAME_ID + \",\" + CityData.COLUMN_NAME_NAME + \") VALUES(\" + id + \",'\" + name + \"');\"; db.execSQL(sql); System.out.println(sql); &#125; // TODOå…¶ä»–ä¸€ä¸‹å¯¹è¡¨è¿›è¡Œçš„æ“ä½œ&#125; é¦–å…ˆæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªDataBaseOpenHelperçš„å®ä¾‹ï¼Œç„¶åé€šè¿‡å®ƒæ‹¿åˆ°SQLiteDatabaseå¯¹è±¡ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥å¯¹æ•°æ®åº“è¿›è¡Œæ“ä½œäº†ã€‚DataBaseOpenHelperæœ‰ä¸¤ç§getæ–¹æ³•ï¼šgetWritableDatabase() å’Œ getReadableDatabase()ï¼Œå¤§å®¶éƒ½åº”è¯¥çŸ¥é“ç€ä¸¤ç§æ–¹æ³•çš„å«ä¹‰ï¼ŒgetReadableDatabase() æ‹¿åˆ°çš„æ•°æ®åº“å¯¹è±¡ä¸å¯ä»¥è¿›è¡Œæ’å…¥ä¿®æ”¹ç­‰å†™æ“ä½œã€‚åœ¨è¿™ä¸¤ç§æ–¹æ³•çš„è¯´æ˜åœ¨æˆ‘ä»¬å¯èƒ½éœ€è¦æ³¨æ„å‡ ç‚¹ï¼š å½“æˆ‘ä»¬æ²¡æœ‰ç”³è¯·æ•°æ®åº“æ“ä½œçš„æƒé™æˆ–è€…ç£ç›˜å·²æ»¡ï¼Œä¼šæŠ¥é”™ æ•°æ®åº“çš„æ›´æ–°å¯èƒ½éœ€è¦å¾ˆé•¿æ—¶é—´ï¼Œå› æ­¤æˆ‘ä»¬ä¸èƒ½åœ¨ä¸»çº¿ç¨‹ä¸­è°ƒç”¨ å½“æˆ‘ä»¬ä¸å†å¯¹æ•°æ®åº“è¿›è¡Œæ“ä½œæ—¶ï¼Œåˆ«å¿˜è®°å…³é—­æ•°æ®åº“ æ¥ä¸‹æ¥å°±æ˜¯æ•°æ®åº“çš„å¸¸ç”¨æ“ä½œäº†","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"https://ttdevs.github.io/categories/æŠ€æœ¯/"}],"tags":[{"name":"Android","slug":"Android","permalink":"https://ttdevs.github.io/tags/Android/"},{"name":"SQLite","slug":"SQLite","permalink":"https://ttdevs.github.io/tags/SQLite/"}]},{"title":"ã€ŒAndroidã€0x01æœ¬åœ°æ•°æ®å®‰å…¨å°è¯•SQLCipher","slug":"[Android]0x01æœ¬åœ°æ•°æ®å®‰å…¨å°è¯•SQLCipher","date":"1969-12-31T16:00:00.000Z","updated":"2017-04-27T11:07:57.000Z","comments":true,"path":"1970/01/01/[Android]0x01æœ¬åœ°æ•°æ®å®‰å…¨å°è¯•SQLCipher/","link":"","permalink":"https://ttdevs.github.io/1970/01/01/[Android]0x01æœ¬åœ°æ•°æ®å®‰å…¨å°è¯•SQLCipher/","excerpt":"","text":"0x00å…ˆçºªå¿µä¸‹ï¼Œä»ä»Šå¤©å¼€å§‹ï¼Œåˆå¼€å§‹å†™åšå®¢å•¦å•¦å•¦å•¦ã€‚è¯è¯´åŸºæœ¬ä¸Šä¸€å¹´å¤šæ²¡å¥½å¥½å†™åšå®¢äº†ã€‚å›æƒ³èµ·æ¥ï¼Œå’Œä¹‹å‰å†™åšå®¢æ—¶ç›¸æ¯”ï¼Œè¿˜æ˜¯å·®è·å¥½å¤§ã€‚å¥½å§ï¼ŒåºŸè¯ä¸è¯´äº†ï¼Œè¿›å…¥æ­£é¢˜ã€‚ é¦–å…ˆï¼Œå¼€ç¯‡æ‰“ç®—è·Ÿå¤§å®¶åˆ†äº«ä¸‹ä½ é‡åˆ°çš„æˆ–è€…å°†æ¥å¯èƒ½é‡åˆ°çš„é—®é¢˜ï¼šæœ¬åœ°æ•°æ®çš„å®‰å…¨é—®é¢˜ã€‚å¤šæ•°æƒ…å†µï¼Œæˆ‘ä»¬å¯èƒ½æ²¡æœ‰å»è€ƒè™‘appçš„æœ¬åœ°æ•°æ®å®‰å…¨é—®é¢˜ï¼Œä¸€æ¥å…¬å¸æ²¡è¿™æ ·çš„è¦æ±‚ï¼ŒäºŒæ¥æˆ‘ä»¬å¯èƒ½ä¹Ÿæ²¡æœ‰éå¸¸éœ€è¦ä¿å¯†çš„æ•°æ®ã€‚é‚£ç°åœ¨æ€è€ƒä¸€ä¸‹ä¸ºå°†æ¥åšå‚¨å¤‡ã€‚ é¢è¯•çš„æ—¶å€™ï¼Œå¯èƒ½å¸¸å¸¸ä¼šè¢«é—®åˆ°è¿™æ ·ä¸€ä¸ªé—®é¢˜ï¼šAndroidçš„æ•°æ®å­˜å‚¨æœ‰å“ªå‡ ç§æ–¹å¼ï¼Ÿ å¯¹äºè¿™ä¸ªé—®é¢˜ï¼ŒAndroidçš„å®˜æ–¹æ–‡æ¡£ æœ‰å›ç­”ï¼š Shared Preferences Internal Storage External Storage SQLite Databases Network Connection è¿™å‡ ç§æ–¹å¼å°±ä¸ç”¨å¤šè¯´äº†ã€‚ç¬¬ä¸€ç§ä»¥key-valueçš„æ–¹å¼å­˜å‚¨åœ¨æˆ‘ä»¬çš„è®¾å¤‡å†…éƒ¨ï¼›ç¬¬äºŒç§ç¬¬ä¸‰ç§ç®€å•ç†è§£ä¸ºæ–‡ä»¶å­˜å‚¨ï¼›ç¬¬å››ç§æœ¬åœ°æ•°æ®åº“å­˜å‚¨ï¼ˆè¿™å››ç§éƒ½å±æœ¬åœ°å­˜å‚¨ï¼‰ã€‚æœ€åä¸€ç§æ–¹å¼ï¼ˆæš‚ä¸”ç®—æ˜¯ä¸€ç§æ–¹å¼å§ï¼‰ä¸åœ¨æˆ‘ä»¬è€ƒè™‘èŒƒå›´ä¹‹å†…ã€‚ç°åœ¨å‡è®¾ä¸€ä¸ªæœ€åçš„ç¯å¢ƒï¼šè®¾å¤‡å·²ç»rootï¼Œä»»ä½•æœ¬åœ°æ•°æ®éƒ½å¯ä»¥è¢«ç›´æ¥æˆ–è€…é—´æ¥æ‹¿åˆ°ã€‚è¿™æ—¶å€™æˆ‘ä»¬è‡ªç„¶æƒ³åˆ°çš„å°±æ˜¯å¯¹æˆ‘ä»¬çš„æ•°æ®è¿›è¡ŒåŠ å¯†ã€‚ 0x01ä»¥ä¸Šæ˜¯å¼€åœºï¼Œä¸‹é¢è¿›å…¥ç¬¬ä¸€éƒ¨åˆ†ï¼šæœ¬åœ°æ•°æ®åº“åŠ å¯†ã€‚å…ˆå›é¡¾ä¸‹æœ¬åœ°æ•°æ®åº“ï¼Œrootä»¥åï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ä¸‹é¢çš„ä½ç½®æ‰¾åˆ°å®ƒï¼š/data/data/you.package/databasesï¼Œä¾‹å¦‚æˆ‘ä»¬demoçš„æ•°æ®åº“ï¼š 1234567891011121314151617root@t03g:/data/data/com.ttdevs.demo/databases # lsnormal_user.dbnormal_user.db-journaluser.dbroot@t03g:/data/data/com.ttdevs.demo/databases #``` çŸ¥é“äº†å®ƒçš„ä½ç½®ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å°±å¯ä»¥ç›´æ¥å°†è¿™äº›æ•°æ®åº“æ–‡ä»¶æ‹·è´å‡ºæ¥ï¼Œç„¶åä½¿ç”¨SQLiteæµè§ˆå™¨æµè§ˆã€‚æˆ‘ä»¬é€‰ç”¨ç½‘ä¸Šä¸€ä¸ªå¼€æºçš„æ–¹æ¡ˆï¼š[SQLCipher][2]ï¼ˆ[GitHubåœ°å€][3]ï¼‰ã€‚SQLCipheræ˜¯åœ¨SQLiteçš„åŸºç¡€ä¸Šå°è£…äº†åŠ å¯†åŠŸèƒ½ï¼Œä½¿ç”¨ä¸Šå’Œç›´æ¥ä½¿ç”¨SQLiteåŸºæœ¬ç›¸åŒã€‚## 0x02é¦–å…ˆï¼ŒæŒ‰ç…§è¯´æ˜ï¼Œæˆ‘ä»¬å¼•å…¥SQLCipherï¼š``` gradlecompile &apos;net.zetetic:android-database-sqlcipher:3.3.1-2@aar&apos; æ¥ä¸‹æ¥å°±æ˜¯ç¼–å†™æˆ‘ä»¬çš„æ•°æ®åº“ä»£ç äº†ã€‚å…ˆåˆ›å»ºä¸€ä¸ªDatabaseHelperï¼š 123456789101112131415161718192021222324252627282930313233343536import net.sqlcipher.database.SQLiteDatabase;import net.sqlcipher.database.SQLiteOpenHelper;public class DatabaseOpenHelper extends SQLiteOpenHelper &#123; private static final String DATABASE_NAME = \"user.db\"; private static final int DATABASE_VERSION = 1; public static final String TABLE = \"user_info\"; public static final String NAME = \"name\"; public static final String AGE = \"age\"; public static final String ICON = \"icon\"; public static final String TOKEN = \"token\"; public DatabaseOpenHelper(Context context) &#123; super(context, DATABASE_NAME, null, DATABASE_VERSION); &#125; @Override public void onCreate(SQLiteDatabase db) &#123; String sql = \"create table \" + TABLE + \" (_id integer primary key autoincrement, \" + NAME + \" text, \" + AGE + \" integer, \" + ICON + \" blob, \" + TOKEN + \" text not null);\"; Log.d(\"EventsData\", \"onCreate: \" + sql); db.execSQL(sql); &#125; @Override public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) &#123; if (oldVersion &lt; newVersion) &#123; // TODO &#125; &#125;&#125; æ³¨æ„ï¼Œæ­¤å¤„çš„SQLiteOpenHelperå’ŒSQLiteDatabaseéƒ½æ¥è‡ªnet.sqlcipher.databaseåŒ…ã€‚ ä¸ºäº†ä¾¿äºå¯¹æ¯”ï¼Œæˆ‘åˆå†™äº†ä¸€ä¸ªç›¸åŒé€»è¾‘ä½¿ç”¨android.database.sqlite.SQLiteOpenHelperçš„Helperä½œå¯¹æ¯”ã€‚æ¥ä¸‹æ¥ä½¿ç”¨ç¼–å†™æ•°æ®åº“æ“ä½œé€»è¾‘ã€‚ä½¿ç”¨ä¸­SQLiteCipheråŒºåˆ«æ˜¯æ‰“å¼€æ•°æ®åº“çš„æ—¶å€™éœ€è¦ä¼ å…¥ç”¨äºåŠ å¯†çš„KEYã€‚ä¸‹é¢æ˜¯æµ‹è¯•ä»£ç ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061public class SqlcipherActivity extends AppCompatActivity implements View.OnClickListener &#123; private static final String TAG = \"&gt;&gt;&gt;&gt;&gt;\"; private static final String CIPHER_KEY = \"123abc_!@#$%^&amp;*\"; private DatabaseOpenHelper mOpenHelper; private NormalDatabaseOpenHelper mNormalHelper;... private void writeData(boolean isCipher) &#123; if (isCipher) &#123; log(\"Cipher:101:\" + System.currentTimeMillis()); SQLiteDatabase db = mOpenHelper.getWritableDatabase(PASSWORD_KEY); log(\"Cipher:102:\" + System.currentTimeMillis()); String name = \"Cipher\" + (++mIndex); ContentValues values = new ContentValues(); values.put(DatabaseOpenHelper.NAME, name); values.put(DatabaseOpenHelper.AGE, mIndex); values.put(DatabaseOpenHelper.TOKEN, PASSWORD_KEY); values.put(DatabaseOpenHelper.ICON, name.getBytes()); log(\"Cipher:11:\" + System.currentTimeMillis()); try &#123; db.beginTransaction(); db.insert(DatabaseOpenHelper.TABLE, null, values); db.setTransactionSuccessful(); &#125; catch (Exception e) &#123; e.printStackTrace(); &#125; finally &#123; db.endTransaction(); &#125; log(\"Cipher:12:\" + System.currentTimeMillis()); db.close(); &#125; else &#123; ... &#125; &#125; private void readData(boolean isCipher) &#123; if (isCipher) &#123; SQLiteDatabase db = mOpenHelper.getReadableDatabase(PASSWORD_KEY); Cursor cursor = db.query(DatabaseOpenHelper.TABLE, null, null, null, null, null, null); while (cursor.moveToNext()) &#123; String name = cursor.getString(cursor.getColumnIndex(DatabaseOpenHelper.NAME)); int age = cursor.getInt(cursor.getColumnIndex(DatabaseOpenHelper.AGE)); String token = cursor.getString(cursor.getColumnIndex(DatabaseOpenHelper.TOKEN)); String result = String.format(\"Cipher&gt;&gt;&gt;&gt; name:%s, age:%d, token:%s\", name, age, token); log(result); &#125; db.close(); &#125; else &#123; android.database.sqlite.SQLiteDatabase ndb = mNormalHelper.getReadableDatabase(); android.database.Cursor cursor = ndb.query(NormalDatabaseOpenHelper.TABLE, null, null, null, null, null, null); while (cursor.moveToNext()) &#123; String name = cursor.getString(cursor.getColumnIndex(DatabaseOpenHelper.NAME)); int age = cursor.getInt(cursor.getColumnIndex(DatabaseOpenHelper.AGE)); String token = cursor.getString(cursor.getColumnIndex(DatabaseOpenHelper.TOKEN)); String result = String.format(\"Normal&gt;&gt;&gt;&gt; name:%s, age:%d, token:%s\", name, age, token); log(result); &#125; ndb.close(); &#125; &#125; ...&#125; å¥½äº†ï¼Œè·‘ä¸€ä¸‹æˆ‘ä»¬çš„æµ‹è¯•ä»£ç ï¼Œå¾—åˆ°ä¸‹é¢çš„ç»“æœï¼š 1234567891011121302-19 13:49:41.596 24884-24884/com.ttdevs.demo E/&gt;&gt;&gt;&gt;&gt;: &gt;&gt;&gt;&gt;&gt; Cipher &gt;&gt;&gt;&gt;&gt;02-19 13:49:41.596 24884-24884/com.ttdevs.demo E/&gt;&gt;&gt;&gt;&gt;: Cipher:101:145586098159702-19 13:49:41.971 24884-24884/com.ttdevs.demo E/&gt;&gt;&gt;&gt;&gt;: Cipher:102:145586098197402-19 13:49:41.971 24884-24884/com.ttdevs.demo E/&gt;&gt;&gt;&gt;&gt;: Cipher:11:145586098197402-19 13:49:41.981 24884-24884/com.ttdevs.demo E/&gt;&gt;&gt;&gt;&gt;: Cipher:12:145586098198302-19 13:49:42.201 24884-24884/com.ttdevs.demo E/&gt;&gt;&gt;&gt;&gt;: Cipher&gt;&gt;&gt;&gt; name:Cipher1, age:1, token:123abc_!@#$%^&amp;*02-19 13:49:42.201 24884-24884/com.ttdevs.demo I/Choreographer: Skipped 35 frames! The application may be doing too much work on its main thread.02-19 13:49:49.471 24884-24884/com.ttdevs.demo E/&gt;&gt;&gt;&gt;&gt;: &gt;&gt;&gt;&gt;&gt; Noremal &gt;&gt;&gt;&gt;&gt;02-19 13:49:49.476 24884-24884/com.ttdevs.demo E/&gt;&gt;&gt;&gt;&gt;: Normal:101:145586098947702-19 13:49:49.521 24884-24884/com.ttdevs.demo E/&gt;&gt;&gt;&gt;&gt;: Normal:102:145586098952502-19 13:49:49.521 24884-24884/com.ttdevs.demo E/&gt;&gt;&gt;&gt;&gt;: Normal:11:145586098952502-19 13:49:49.531 24884-24884/com.ttdevs.demo E/&gt;&gt;&gt;&gt;&gt;: Normal:12:145586098953502-19 13:49:49.541 24884-24884/com.ttdevs.demo E/&gt;&gt;&gt;&gt;&gt;: Normal&gt;&gt;&gt;&gt; name:Normal2, age:2, token:123abc_!@#$%^&amp;* é€šè¿‡ç®€å•çš„å¯¹æ¯”ï¼Œæˆ‘ä»¬å‘ç°ï¼ŒSQLCipheråœ¨æ‰“å¼€å†™æ•°æ®åº“çš„æ—¶å€™èŠ±è´¹äº†375msï¼Œæ—¶é—´å¤§æ¦‚æ˜¯SQLite 45msçš„8~9å€ï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨logä¸­çœ‹åˆ°ä¸¢å¸§çš„æç¤ºã€‚è¿™å°±æç¤ºæˆ‘ä»¬ï¼Œç®€å•çš„æ•°æ®åº“æ“ä½œï¼Œä½¿ç”¨SQLiteæˆ‘ä»¬ä¹Ÿå¯èƒ½éœ€è¦è€ƒè™‘å°†å…¶æ”¾åœ¨æ–°çš„çº¿ç¨‹ä¸­ã€‚å½“ç„¶ï¼Œè¿™ä¸ªæµ‹è¯•å¯¹æ¯”ä¸å¤Ÿå®Œå–„ï¼Œæ¯”å¦‚å¤§æ–‡ä»¶å†™å…¥ï¼Œå¤§é‡æ•°æ®æ’å…¥ï¼Œäº‹åŠ¡ç­‰ç­‰ï¼Œå› æ­¤è¿˜éœ€è¦æ›´å¤šã€æ›´è¯¦ç»†çš„æµ‹è¯•æ¥æ£€æµ‹SQLCipherçš„æ€§èƒ½ç­‰ï¼Œè¿™é‡Œå°±æš‚ä¸è®¨è®ºäº†ã€‚ è·‘å®Œä¸Šé¢çš„ä»£ç ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹æˆ‘ä»¬æœ¬åœ°æ•°æ®åº“ä¸­éƒ½åˆ›å»ºäº†å“ªäº›ä¸œè¥¿ï¼š 12345root@t03g:/data/data/com.ttdevs.demo/databases # lsnormal_user.dbnormal_user.db-journaluser.dbroot@t03g:/data/data/com.ttdevs.demo/databases # æˆ‘ä»¬æŠŠè¿™ä¸¤ä¸ªdbæ–‡ä»¶æ‹·è´åˆ°æˆ‘ä»¬çš„ç”µè„‘ï¼Œçœ‹çœ‹é‡Œé¢æœ‰å“ªäº›ä¸œè¥¿ã€‚è¿™é‡Œæ¨èä¸€ä¸ªå·¥å…·ï¼šsqlitebrowserã€‚æ‰“å¼€ä»–ä»¬çš„ç½‘ç«™ä½ ä¼šå‘ç°å®ƒæœ‰ä¸¤ä¸ªç‰ˆæœ¬çš„ï¼šStandardå’ŒSQLCipherçš„ã€‚æ˜¯çš„ï¼Œä½ æ²¡çœ‹é”™ï¼Œå°±æ˜¯é’ˆå¯¹SQLCipherçš„ã€‚å¦‚æœä½ ä½¿ç”¨Standardç‰ˆæœ¬ï¼Œä½ ä¼šå‘ç°æ— æ³•æ‰“å¼€æˆ‘ä»¬åŠ å¯†åçš„user.dbï¼ˆå½“ç„¶ä½ ä¹Ÿå¯æ˜¯è¯•è¯•å…¶ä»–æ–¹æ³•ï¼‰ã€‚ä½¿ç”¨SQLCipherç‰ˆçš„ï¼Œæ‰“å¼€ä¹‹å‰ä¼šè¦æ±‚è¾“å…¥æˆ‘ä»¬åŠ å¯†çš„KEYï¼Œå°±æ˜¯æˆ‘ä»¬ä¸Šé¢çš„123abc_!@#$%^&amp;*ã€‚è¿™æ—¶å€™æˆ‘ä»¬å°±å¯ä»¥çœ‹åˆ°åŸå§‹çš„æ•°æ®äº†ï¼Œå¦‚ä¸‹å›¾ï¼š 0x03åˆ°è¿™é‡Œï¼Œæˆ‘ä»¬åŸºæœ¬ä¸Šå·²ç»è§åˆ°äº†SQLCipherçš„ä½¿ç”¨ã€‚è¿˜æ²¡æœ‰ç»“æŸï¼Œå†æ¥çœ‹ä¸€ä¸ªé—®é¢˜ï¼šåœ¨åˆ›å»ºé¡¹ç›®å¼€å§‹ï¼Œæˆ‘å°è¯•è·‘äº†ä¸‹é¡¹ç›®ï¼Œapkçš„å¤§å°æ˜¯1.4MBï¼Œåœ¨Gradleä¸­å¼•å…¥SQLCipherä¹‹åï¼Œä½“ç§¯ä¸€ä¸‹å­é£™åˆ°äº†8.7MBã€‚å‘µå‘µå‘µ~~ è¿™ä¸ªä½“ç§¯çš„å¢åŠ è¿˜æ˜¯å€¼å¾—æˆ‘ä»¬æ…é‡çš„æ€è€ƒä¸€ä¸‹ä¸‹çš„ã€‚ 0x04è¯´äº†è¿™ä¹ˆå¤šï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°è¿™æ ·ä¸€ä¸ªç»“è®ºï¼Œä½¿ç”¨SQLiteCipherå¯ä»¥å¯¹æˆ‘ä»¬å®¢æˆ·ç«¯çš„æœ¬åœ°æ•°æ®åº“è¿›è¡ŒåŠ å¯†ï¼Œä½†æ˜¯æˆ‘ä»¬éœ€è¦è‡ªå·±å­˜ä¸€ä¸ªåŠ å¯†KEYï¼Œå¦‚æœæˆ‘ä»¬èƒ½ä¿å­˜å¥½è¿™ä¸ªKEYï¼Œé‚£æˆ‘ä»¬çš„æ•°æ®åŸºæœ¬æ˜¯å®‰å…¨çš„ã€‚ä½†æ˜¯åŒæ—¶ï¼Œæˆ‘ä»¬å¯èƒ½éœ€è¦è€ƒè™‘æ•°æ®åº“åŠ å¯†è¿‡ç¨‹ä¸­å¼•å…¥çš„æ–°çš„é—®é¢˜ï¼Œæ¯”å¦‚ï¼šapkä½“ç§¯çš„æš´å¢ï¼ŒåŠ å¯†å¯¹æ€§èƒ½çš„å½±å“ï¼ŒåŠ å¯†KEYçš„ä¿å­˜ç­‰ç­‰ã€‚è¿™äº›é—®é¢˜è€ƒè™‘å¥½ä¹‹åï¼Œæˆ‘ä»¬å°±å¯ä»¥å†³å®šæ˜¯å¦å¼•å…¥SQLCipherã€‚ å¦‚æœä½ å¯¹å¼•å…¥SQLiteCiperå¼•èµ·çš„æ–°é—®é¢˜å¿ƒå­˜èŠ¥è’‚ï¼Œé‚£æ¥ä¸‹æ¥ç»™å¤§å®¶æ¨èä¸‹ä¸€ç§æ–¹æ³•ã€‚æ•¬è¯·æœŸå¾…ï¼šAndroidæœ¬åœ°æ•°æ®å®‰å…¨å°è¯•(ä¸­) PSï¼šGithub Demo","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"https://ttdevs.github.io/categories/æŠ€æœ¯/"}],"tags":[{"name":"Android","slug":"Android","permalink":"https://ttdevs.github.io/tags/Android/"}]},{"title":"ã€ŒAndroidã€0x02æœ¬åœ°æ•°æ®å®‰å…¨å°è¯•Conceal","slug":"[Android]0x02æœ¬åœ°æ•°æ®å®‰å…¨å°è¯•Conceal","date":"1969-12-31T16:00:00.000Z","updated":"2017-04-27T11:07:57.000Z","comments":true,"path":"1970/01/01/[Android]0x02æœ¬åœ°æ•°æ®å®‰å…¨å°è¯•Conceal/","link":"","permalink":"https://ttdevs.github.io/1970/01/01/[Android]0x02æœ¬åœ°æ•°æ®å®‰å…¨å°è¯•Conceal/","excerpt":"","text":"0x00ä¸Šä¸€ç¯‡æˆ‘ä»¬æåˆ°ä½¿ç”¨SQLCipherå¯¹æœ¬åœ°çš„æ•°æ®è¿›è¡ŒåŠ å¯†ã€‚åœ¨ä¿è¯æ•°æ®å®‰å…¨çš„åŒæ—¶ï¼Œæˆ‘ä»¬åˆå¼•å…¥äº†ä¸€äº›æ–°çš„é—®é¢˜ï¼Œæ¯”å¦‚å®‰è£…åŒ…ä½“ç§¯çš„å¢åŠ ï¼Œæ•°æ®å­˜å‚¨è¿‡ç¨‹ä¸­è€—æ—¶å¢åŠ ï¼Œæ•°æ®åŠ å¯†çš„ç²’åº¦ä¸å¯æ§ç­‰ç­‰ã€‚å¦‚æœä½ æ¥å—ä¸äº†è¿™äº›é—®é¢˜ï¼Œé‚£æˆ‘ä»¬è¿˜éœ€å¯»æ‰¾å…¶ä»–çš„åŠ å¯†æ–¹æ³•ã€‚è¿™é‡Œç»™å¤§å®¶æ¨èConceal 0x01Concealæ˜¯Facebookçš„ä¸€ä¸ªå¼€æºé¡¹ç›®ï¼Œå®ƒå¯ä»¥é«˜æ•ˆçš„å¯¹å¤§æ–‡ä»¶è¿›è¡ŒåŠ å¯†ï¼ˆå½“ç„¶å¯¹å°æ•°æ®åŠ å¯†ä¹Ÿä¸æ˜¯é—®é¢˜ï¼‰ï¼ŒåŒæ—¶å¯¹è®¾å¤‡çš„æ€§èƒ½å’Œç³»ç»Ÿç‰ˆæœ¬è¦æ±‚æ¯”è¾ƒä½ã€‚æ›´å…·ä½“çš„ä¿¡æ¯å¯å‚è€ƒè¿™é‡Œã€‚ Conceal doesnâ€™t implement any crypto, but instead, it uses specific cryptographics algorithms from OpenSSL. Conceal attempts to manage memory efficiently between the native and Java heap. Conceal also uses fast modes like AES-GCM and HMAC-SHA1 by default.OpenSSL is a very large library, and would increase the size of apps. Conceal ships with only a select number of encryption algorithms from OpenSSL which make it much smaller (85KB). 0x02å¼•ç”¨compile &#39;com.facebook.conceal:conceal:1.0.1@aar&#39; å…³é”®ä»£ç æˆ‘ä»¬å¯ä»¥ç”¨å…¶åŠ å¯†å¸¸è§çš„æ•°æ®ç±»å‹ï¼Œæ¯”å¦‚å­—ç¬¦ä¸²ï¼Œå›¾ç‰‡ç­‰ã€‚ å­—ç¬¦ä¸² 1234// åŠ å¯†byte[] cipherText = mCrypto.encrypt(plainText, mEntity);// è§£å¯†byte[] plainText = mCrypto.decrypt(cipherText, mEntity); å¤§æ–‡ä»¶ 123456OutputStream out = mCrypto.getCipherOutputStream(fileOS, mEntity);int read = 0;byte[] buffer = new byte[1024];while ((read = sourceFile.read(buffer)) != -1) &#123; out.write(buffer, 0, read);&#125; åˆå§‹åŒ– 12345678public static final String ENTITY = \"ttdevs\";public static void init(Context context) &#123; if (null == mCrypto) &#123; mCrypto = new Crypto(new SharedPrefsBackedKeyChain(context), new SystemNativeCryptoLibrary()); mEntity = new Entity(ENTITY); &#125;&#125; ä»¥ä¸Šä¸‰éƒ¨åˆ†æ˜¯æˆ‘ä»¬ä½¿ç”¨Concealçš„å…³é”®ä»£ç ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦æ„é€ ä¸€ä¸ªCryptoå¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡éœ€è¦ä¼ å…¥ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªæ˜¯KeyChainï¼Œç¬¬äºŒä¸ªæ˜¯NativeCryptoLibraryã€‚NativeCryptoLibraryæˆ‘ä»¬ä½¿ç”¨ç³»ç»Ÿé»˜è®¤çš„ã€‚KeyChainé¡¾åæ€ä¹‰ï¼Œå°±æ˜¯æˆ‘ä»¬çš„åŠ å¯†keyã€‚ä¾‹å­ä¸­æˆ‘ä»¬ä½¿ç”¨äº†SharedPrefsBackedKeyChainï¼Œé€šè¿‡æŸ¥çœ‹æºç ï¼Œæˆ‘ä»¬å‘ç°ï¼Œå®ƒæ˜¯å°†åŠ å¯†çš„keyä¿å­˜åˆ°SharedPreferencesä¸­çš„ä¸€ä¸ªKeyChainçš„å®ç°ã€‚ æµ‹è¯•æ¥ä¸‹æ¥æˆ‘ä»¬æ¥çœ‹çœ‹Concealçš„è¡¨ç°å¦‚ä½•ã€‚æˆ‘å†™äº†ä¸€ä¸ªç®€å•çš„æµ‹è¯•ä»£ç ï¼Œç”±äºæ¯”è¾ƒé•¿ï¼Œå°±ä¸è´´äº†ï¼Œå…·ä½“å¯ä»¥å‚è€ƒè¿™é‡Œï¼Œä¸»è¦æœ‰ä¸‰ä¸ªéƒ¨åˆ†ï¼š æµ‹è¯•å­—ç¬¦ä¸²åŠ è§£å¯† æµ‹è¯•åŠ å¯†æ•°æ®çš„æ•°æ®åº“è¯»å†™ æµ‹è¯•æœ¬åœ°æ–‡ä»¶åŠ è§£å¯† ç•Œé¢å¦‚ä¸‹ï¼š å­—ç¬¦ä¸²åŠ è§£å¯† å­—ç¬¦ä¸²çš„è¯»å†™å¦‚ä¸Šå›¾ï¼ŒåŠ è§£å¯†å­—ç¬¦ä¸²Hello world!è€—æ—¶éƒ½åœ¨3mså·¦å³ï¼Œè¿™ä¸ªæ—¶é—´åº”è¯¥æ˜¯æˆ‘ä»¬å¯ä»¥æ¥å—çš„ã€‚ PS:å¼ºåŠ¿æ’å…¥ä¸€ä¸ª2Bé—®é¢˜ ç»†å¿ƒçš„ä½ å¯èƒ½ä¼šæƒ³å¦‚æœæˆ‘ä»¬ä¸ç”¨æ•°æ®åº“ï¼Œåªæ˜¯åŠ å¯†å‡ ä¸ªç®€å•çš„æ•°æ®ï¼Œèƒ½ä¸èƒ½å°†å¯†æ–‡ç›´æ¥å†™å…¥SharedPreferencesä¸­å‘¢ï¼Ÿå‘Šè¯‰ä½ æˆ‘ä¹Ÿæ˜¯è¿™ä¹ˆæƒ³çš„ï¼Œè€Œä¸”å»æµ‹è¯•äº†ï¼Œä½†æ˜¯æ­»æ´»ä¸æˆåŠŸï¼Œä¸æˆåŠŸï¼Œä¸æˆåŠŸâ€¦â€¦æˆ‘çš„æ€è·¯æ˜¯è¿™æ ·çš„ï¼šç”±äºåŠ å¯†ã€åŠ å¯†ç»“æœã€è§£å¯† ä¸‰ä¸ªæ“ä½œå‚æ•°éƒ½æ˜¯byteï¼Œè€ŒSharedPreferencesæ¥å—çš„å‚æ•°æ˜¯Stringç±»å‹ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦è¿›è¡Œè½¬æ¢ï¼Œnew String(bytes, &quot;utf-8&quot;) å’Œ string.getBytes(&quot;utf-8&quot;) ï¼Œ å½“ä½ è¿™ä¹ˆåšçš„æ—¶å€™ï¼Œä½ ä¼šå‘ç°è§£å¯†æ­»æ´»ä¸æˆåŠŸã€‚ç»å†è¿‡æ— æ•°ä¸ªä¸çœ ä¹‹å¤œåï¼Œç»ˆäºæç„¶å¤§æ‚Ÿï¼ŒåŸæ¥è¿™ä¹ˆè½¬æ¢æ˜¯é”™è¯¯çš„ï¼åŸå› å¾ˆç®€å•ï¼Œä¸€ä¸ªutf-8ç¼–ç æ±‰å­—æ˜¯2bytesï¼Œå¦‚æœæˆ‘ä»¬çš„åŠ å¯†ç»“æœä¸è¶³2byteï¼Œæˆ‘ä»¬å¼ºè½¬æ—¶ä¸è¶³éƒ¨åˆ†å°±ä¼šè¢«è¡¥é½ï¼Œå½“å†è½¬æ¢å›æ¥çš„æ—¶å€™å°±å’ŒåŸæ¥çš„ä¸ä¸€ä¸€æ ·äº†ã€‚æœ€åæ€ä¹ˆè§£å†³å‘¢ï¼Ÿä¹Ÿå¾ˆç®€å•ï¼Œç”¨Base64å¯¹byteæ•°ç»„è¿›è¡Œç¼–ç ï¼Œå…·ä½“æ€ä¹ˆåšå¯ä»¥å‚è€ƒConcealæºç ä¸­çš„SharedPrefsBackedKeyChainã€‚ æ•°æ®åº“è¯»å†™ è¿™ä¸ªæ—¶é—´å°±ä¸åšè¿‡å¤šè§£è¯»ï¼Œæ•°æ®åº“æ“ä½œæ—¶é—´åŠ åŠ è§£å¯†æ—¶é—´ã€‚ 1234561456500607857: Begin transaction 1456500607861: Insert: Hello world! 1456500607865: Read: name:Hello world! token:Hello world! 1456500607868: Read: name:Hello world! token:Hello world! 1456500607871: Read: name:Hello world! token:Hello world! 1456500607885: End transaction æ–‡ä»¶åŠ è§£å¯† è¿™ä¸ªæ¯”è¾ƒé‡è¦ï¼Œå¦‚æœæˆ‘ä»¬æœ‰å¤§æ–‡ä»¶åŠ å¯†çš„éœ€æ±‚ï¼ˆæ¯”å¦‚å‰æ®µæ—¶é—´å¾®ä¿¡çš„çº¢åŒ…å›¾ç‰‡ï¼‰ï¼Œå¯¹æ€§èƒ½å’Œæ•ˆç‡è¦æ±‚å°±æ¯”è¾ƒé«˜äº†ã€‚ æŸä¸€æ¬¡åŠ å¯†æ•°æ®ï¼š 12345678Encrpyt 1.png 1014KB 163msEncrpyt 2.jpg 2078KB 336msEncrpyt 3.jpg 3043KB 477msEncrpyt 4.JPG 3811KB 560msEncrpyt 5.JPG 4772KB 699msEncrpyt 10.apk 10268KB 1281msEncrpyt 10.gif 10421KB 671msEncrpyt 21.apk 20962KB 1323ms æŸä¸€æ¬¡è§£å¯†æ•°æ®ï¼š 12345678Decrpyt encrypt_1.png 1014KB 108msDecrpyt encrypt_2.jpg 2078KB 177msDecrpyt encrypt_3.jpg 3043KB 221msDecrpyt encrypt_4.JPG 3811KB 270msDecrpyt encrypt_5.JPG 4772KB 340msDecrpyt encrypt_10.apk 10268KB 732msDecrpyt encrypt_10.gif 10421KB 764msDecrpyt encrypt_21.apk 20962KB 1468ms ä»ä¸Šé¢çš„æ•°æ®æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼ŒåŠ å¯†å¤šå¼ å¤§å›¾å¹¶æ²¡æœ‰å¯¼è‡´å†…å­˜çš„å¢åŠ ï¼Œåªæ˜¯CPUä½¿ç”¨ç‡æœ‰æ‰€å˜åŒ–ã€‚åŠ å¯†1MBå›¾ç‰‡è€—æ—¶160msï¼ŒåŠ å¯†20MBæ–‡ä»¶è€—æ—¶1300mså¤šã€‚è§£å¯†æ•°æ®çš„æ€§èƒ½æ¶ˆè€—ç±»ä¼¼ã€‚ 0x03åˆ†æäº†è§£äº†Concealçš„åŸºæœ¬æƒ…å†µï¼Œæˆ‘ä»¬æ¥å¯¹æ¯”ä¸‹ä¸Šé¢æåˆ°çš„ä½¿ç”¨SQLCipheré‡åˆ°çš„é—®é¢˜ã€‚é¦–å…ˆï¼ŒConcealåªæœ‰85KBï¼Œè¿™ä¸ªå¤§å°æ˜¯æˆ‘ä»¬å®Œå…¨å¯ä»¥æ¥å—çš„ï¼Œç„¶åå°±æ˜¯åŠ å¯†ç²’åº¦ï¼Œæ— è®ºæ˜¯æ•°æ®åº“è¿˜æ˜¯æ–‡ä»¶ï¼Œæˆ‘ä»¬éƒ½å¯ä»¥åªçœŸå¯¹éœ€è¦çš„é‚£éƒ¨åˆ†åŠ å¯†ï¼Œæœ€åå³ä½¿ä½ é€‰æ‹©å°†æ–‡ä»¶å­˜å…¥æ•°æ®åº“ï¼Œå®ƒçš„æ—¶é—´ä¹Ÿåªæœ‰æ­£å¸¸æ•°æ®åº“æ“ä½œæ—¶é—´åŠ Concealçš„åŠ è§£å¯†æ—¶é—´ã€‚ç»¼ä¸Šæ‰€è¿°ï¼ŒConcealåº”è¯¥æ˜¯ä¸€ä¸ªä¸é”™çš„é€‰æ‹©ã€‚ æ€»ç»“æˆ‘ä»¬å†æ¥æƒ³æƒ³è¿™ä¸¤ç¯‡æ–‡ç« ä¸­æåˆ°çš„åŠ å¯†æ–¹æ³•ï¼šæ— è®ºä½ é€‰æ‹©å“ªä¸€ç§ï¼Œç”±äºä»–ä»¬éƒ½é‡‡ç”¨äº†å¯¹ç§°åŠ å¯†ç®—æ³•ï¼Œè™½ç„¶æ•°æ®éƒ¨åˆ†åŠ å¯†äº†ï¼Œä½†æ˜¯æˆ‘ä»¬å´éœ€è¦ç»´æŠ¤ä¸€ä¸ªç§˜é’¥ï¼Œè¿™ä¸ªç§˜é’¥æ”¾åœ¨é‚£é‡Œï¼ŸSharedPreferencesï¼Ÿæ•°æ®åº“ï¼Ÿæœ¬åœ°æ–‡ä»¶ï¼Ÿè²Œä¼¼è¿›å…¥äº†ä¸€ä¸ªæ­»å¾ªç¯ï¼Œé—®é¢˜åˆå›åˆ°äº†èµ·ç‚¹ã€‚åˆ†æäº†è¿™ä¹ˆå¤šï¼Œå¦‚æœæ²¡æœ‰åŠæ³•è§£å†³ç§˜é’¥çš„é—®é¢˜ï¼Œä¹Ÿéƒ½æ˜¯ç™½æ­ã€‚æ€ä¹ˆåŠï¼Ÿä¸‹ä¸€ç¯‡åœ¨è¿›ä¸€æ­¥åˆ†æã€‚æ•¬è¯·æœŸå¾…ã€‚ PS: æ‰€æœ‰æµ‹è¯•æœºå™¨ é­…æ— MX4PRO æ€§èƒ½å‡è¡¡æ¨¡å¼","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"https://ttdevs.github.io/categories/æŠ€æœ¯/"}],"tags":[{"name":"Android","slug":"Android","permalink":"https://ttdevs.github.io/tags/Android/"}]},{"title":"ã€ŒAndroidã€0x03æœ¬åœ°æ•°æ®å®‰å…¨å°è¯•JNI","slug":"[Android]0x03æœ¬åœ°æ•°æ®å®‰å…¨å°è¯•JNI","date":"1969-12-31T16:00:00.000Z","updated":"2017-04-27T11:07:57.000Z","comments":true,"path":"1970/01/01/[Android]0x03æœ¬åœ°æ•°æ®å®‰å…¨å°è¯•JNI/","link":"","permalink":"https://ttdevs.github.io/1970/01/01/[Android]0x03æœ¬åœ°æ•°æ®å®‰å…¨å°è¯•JNI/","excerpt":"","text":"å‰ä¸¤ç¯‡ï¼Œæˆ‘ä»¬è°ˆåˆ°äº†ä½¿ç”¨SQLCipherå’ŒConcealå¯¹æœ¬åœ°æ•°æ®è¿›è¡ŒåŠ å¯†ã€‚ç”±äºéƒ½ä¸¤ç§æ–¹æ³•éƒ½é‡‡ç”¨äº†å¯¹ç§°åŠ å¯†ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦è‡ªå·±ç®¡ç†åŠ å¯†çš„ç§˜é’¥ã€‚è¿™æ—¶ä½ ä¼šå‘ç°ï¼Œè™½ç„¶å¯¹æˆ‘ä»¬çš„æ•°æ®è¿›è¡Œäº†åŠ å¯†ï¼Œä½†æ˜¯æˆ‘ä»¬å´å¼•å…¥äº†æ–°çš„é—®é¢˜ã€‚æˆ‘ä»¬çš„åŠ å¯†æ–¹æ³•å¾ˆå®¹æ˜“é€šè¿‡åç¼–è¯‘apkè·å–åˆ°ï¼Œé‚£ä¹ˆï¼Œæˆ‘ä»¬å°±éœ€è¦å®‰å…¨çš„ç»´æŠ¤è¿™ä¸ªç§˜é’¥äº†ã€‚ä½†é—æ†¾çš„æ˜¯ï¼Œæœ¬åœ°æ•°æ®å­˜å‚¨æ–¹å¼æˆ‘ä»¬éƒ½å·²ç»è®²è¿°ï¼Œå¹¶æ²¡æœ‰ä¸€ç§ä¸€åŠ³æ°¸é€¸çš„å®‰å…¨ä¿å­˜æ–¹æ³•ï¼Œé‚£ä¹ˆï¼Œæˆ‘ä»¬çš„ç§˜é’¥å­˜åœ¨å“ªé‡Œåˆé€‚å‘¢ï¼Ÿè¿™ä¸ªæ—¶å€™ä½ å¯èƒ½ä¼šæƒ³åˆ°æœ¬åœ°ä¸è¡Œé‚£æˆ‘ä»¬å­˜åˆ°æœåŠ¡å™¨ä¸Šå§ï¼Œé€šè¿‡httpsè¿›è¡Œä¼ è¾“ã€‚è¿™æ ·å½“ç„¶å¯ä»¥ï¼Œé€šè¿‡ä¸€å®šçš„ç®—æ³•ä¸ºæ¯ä¸ªäººé…ç½®ä¸€ä¸ªç§˜é’¥ï¼Œéœ€è¦çš„æ—¶å€™è¯·æ±‚ç½‘ç»œè·å–ï¼Œç„¶åå¯¹æœ¬åœ°æ•°æ®è¿›è¡Œè§£å¯†ã€‚ä½†æ˜¯è¿™æ ·ä¹Ÿå­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼šæœ¬åœ°ä¿å­˜çš„æ•°æ®å¦‚æœä¸è”ç½‘å°±æ— æ³•æ‰“å¼€ã€‚é‚£ä¹ˆï¼Œè¿˜æœ‰æ›´å¥½çš„æ–¹æ¡ˆå—ï¼Ÿä»Šå¤©ç»™å¤§å®¶ä»‹ç»JNIã€‚ 0x01NDKï¼ŒJNIå¯¹äºåˆšæ¥è§¦androidå¼€å‘çš„æ”»åŸç‹®æ¥è¯´æ˜¯æœ‰è¾ƒå¤§çš„é—¨æ§›çš„ï¼Œä½†æ˜¯ä¸ºäº†å®ç°æˆ‘ä»¬æ›´å®‰å…¨çš„ä¿å­˜æ•°æ®ï¼Œä»–å¯èƒ½æ˜¯ä¸é”™çš„é€‰æ‹©ã€‚åç¼–è¯‘è¿‡åˆ«äººå®¶appçš„ä½ å¯èƒ½éƒ½é‡åˆ°è¿‡è¿™æ ·çš„æƒ…å†µï¼šä¸€ä¸ªä¸ªæ²¡æ— æ³•æŸ¥çœ‹ä»£ç é€»è¾‘çš„soæ–‡ä»¶ã€‚è¿™äº›æ–‡ä»¶æˆ‘ä»¬å¯ä»¥ä½¿ç”¨javaä»£ç è°ƒç”¨ï¼Œå®ç°ä¸€äº›æˆ‘ä»¬ä¸çŸ¥é“å†…éƒ¨é€»è¾‘ä½†æ˜¯ä¼šç»™æˆ‘ä»¬ä¸€ä¸ªç»“æœåŠŸèƒ½ã€‚é‚£ä¹ˆï¼Œæˆ‘ä»¬æŠŠå¯†ç æ”¾åˆ°è¿™äº›soä¸­å°±å¯ä»¥æ›´è¿›ä¸€æ­¥æé«˜æˆ‘ä»¬æœ¬åœ°æ•°æ®çš„å®‰å…¨çº§åˆ«ã€‚ ä¸‹é¢é€šè¿‡ä¸€ä¸ªåŠ å•çš„demoæ¥çœ‹çœ‹JNIçš„å®ç°ã€‚ é¦–å…ˆåˆ›å»ºä¸€ä¸ªå·¥å…·ç±»ï¼š 123456789public class CipherUtil &#123; static &#123; System.loadLibrary(\"Cipher\"); &#125; public static native String getCipherKey();&#125; åœ¨è¿™ä¸ªç±»æ–‡ä»¶ä¸Šç‚¹å‡»å³é”®ï¼Œä½¿ç”¨æˆ‘ä»¬ä¹‹å‰é…ç½®çš„javahå·¥å…·ç”Ÿæˆå¤´æ–‡ä»¶ã€‚ä¹‹åæˆ‘ä»¬ä¼šåœ¨å’Œjavaç›®å½•åŒçº§çš„jniæ–‡ä»¶ä¸‹çœ‹åˆ°ä¸€ä¸ª.hæ–‡ä»¶ï¼Œå¦‚ä¸‹ï¼š 123456789101112131415161718192021/* DO NOT EDIT THIS FILE - it is machine generated */#include &lt;jni.h&gt;/* Header for class com_ttdevs_ndk_CipherUtil */#ifndef _Included_com_ttdevs_ndk_CipherUtil#define _Included_com_ttdevs_ndk_CipherUtil#ifdef __cplusplusextern \"C\" &#123;#endif/* * Class: com_ttdevs_ndk_CipherUtil * Method: getCipherKey * Signature: ()Ljava/lang/String; */JNIEXPORT jstring JNICALL Java_com_ttdevs_ndk_CipherUtil_getCipherKey (JNIEnv *, jclass);#ifdef __cplusplus&#125;#endif#endif ç„¶ååœ¨hæ–‡ä»¶çš„åŒçº§æ–°å»ºä¸€ä¸ªC++æ–‡ä»¶ï¼ˆå³é”®&gt;New&gt;C/C++ Source fileï¼‰,å†…å®¹å¦‚ä¸‹ï¼š 12345678910111213141516#include &lt;string.h&gt;#include &lt;stdio.h&gt;#include &lt;stdlib.h&gt;#include \"QiniuConfig.h\"#include &lt;android/log.h&gt;#define LOG_TAG \"System.out\"#define LOGD(...) __android_log_print(ANDROID_LOG_DEBUG, LOG_TAG, __VA_ARGS__)#define LOGI(...) __android_log_print(ANDROID_LOG_INFO, LOG_TAG, __VA_ARGS__)#include \"com_ttdevs_ndk_CipherUtil.h\"JNIEXPORT jstring JNICALL Java_com_ttdevs_ndk_CipherUtil_getCipherKey(JNIEnv *env, jclass)&#123; return (*env).NewStringUTF(\"Hello World! getCipherKey\");&#125; æˆ‘ä»¬è¿˜éœ€è¦åˆ›å»ºä¸¤ä¸ªæ–‡ä»¶ï¼Œä¸€ä¸ªå«Android.mkï¼Œå¦ä¸€ä¸ªå«Application.mkï¼Œä»–ä»¬éƒ½åœ¨jniç›®å½•ä¸‹ã€‚ Android.mk: 1234567891011# http://developer.android.com/intl/zh-tw/ndk/guides/android_mk.htmlLOCAL_PATH := $(call my-dir)include $(CLEAR_VARS)LOCAL_MODULE := CipherLOCAL_SRC_FILES := Cipher.cppLOCAL_LDLIBS += -lloginclude $(BUILD_SHARED_LIBRARY) Application.mk 12345678# http://developer.android.com/intl/zh-tw/ndk/guides/application_mk.html# APP_STL := stlport_staticAPP_STL := gnustl_staticAPP_CPPFLAGS := -frtti -std=c++11APP_CFLAGS += -Wno-error=format-securityAPP_ABI := all è¿˜æ²¡æœ‰å®Œï¼Œæˆ‘ä»¬è¿˜éœ€è¦ä¿®æ”¹å½“å‰Projectæˆ–è€…Moduleçš„gradle.buildæ–‡ä»¶: 123456789101112131415161718192021android &#123; compileSdkVersion 23 buildToolsVersion &quot;23.0.2&quot; defaultConfig &#123; minSdkVersion 16 targetSdkVersion 23 versionCode 1 versionName &quot;1.0&quot; ndk &#123; moduleName &quot;ndkutil&quot; &#125; &#125; sourceSets.main &#123; jni.srcDirs = [] jniLibs.srcDir &quot;libs&quot; &#125;...&#125; å®Œæˆè¿™äº›ï¼Œæˆ‘ä»¬å°±å¯ä»¥è¿›è¡Œç¼–è¯‘äº†ã€‚åœ¨å½“å‰Projectï¼ˆModuleï¼‰ä¸Šç‚¹å‡»å³é”®ï¼Œä½¿ç”¨ä¹‹å‰é…ç½®çš„ndk-buildå·¥å…·è¿›è¡Œç¼–è¯‘ï¼Œå¦‚æœæ²¡æœ‰é—®é¢˜ï¼Œæˆ‘ä»¬ä¼šåœ¨libsç›®å½•ä¸‹çœ‹åˆ°ç”Ÿäº§çš„soæ–‡ä»¶ã€‚å¥½äº†ï¼Œæœ€åæˆ‘ä»¬å¯ä»¥ç¼–å†™æµ‹è¯•ä»£ç äº†ï¼šåœ¨javaç›´æ¥è°ƒç”¨åˆšæ‰åˆ›å»ºçš„CipherUtilå³å¯ï¼š 1Log.d(\"&gt;&gt;&gt;&gt;&gt;\", CipherUtil.getCipherKey()); è¿è¡Œä¸Šé¢ä»£ç ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨logä¸­çœ‹åˆ°è¾“å‡ºçš„å­—ç¬¦ä¸²ï¼š 1Hello World! getCipherKey 0x02ä¸Šè¿°demoä¸­ï¼Œæˆ‘ä»¬åªæ˜¯ç®€å•çš„è¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè¦å®ç°æ›´å®‰å…¨ï¼Œæˆ‘ä»¬å¯ä»¥å°†æ­¤æ–¹æ³•å†™çš„æ›´å¤æ‚ï¼Œæ¯”å¦‚è·å–appçš„ç­¾åï¼Œè·å–è®¾å¤‡çš„ç¡¬ä»¶ä¿¡æ¯è¿›è¡Œå¤æ‚çš„ç»„åˆï¼Œä»¥ä¿éšœæœ€ç»ˆç”Ÿæˆçš„ç§˜é’¥çš„å”¯ä¸€æ€§å’Œå®‰å…¨æ€§ï¼ˆæ›´éš¾ä¼ªé€ ï¼‰ï¼Œè¿™é‡Œæœ‰ä¸€ä¸ªdemoå¯ä»¥å‚è€ƒã€‚ å†™åˆ°è¿™é‡Œï¼Œå¯èƒ½åˆæœ‰äººä¼šé—®åˆ°ï¼šå…¶å®soæ–‡ä»¶ä¹Ÿä¸æ˜¯å¾ˆå…¨ï¼Œå¯ä»¥é€šè¿‡å¯¹æ±‡ç¼–çš„åˆ†æå¾—åˆ°é‡Œé¢çš„ä»£ç é€»è¾‘ã€‚å½“ç„¶ï¼Œé«˜æ‰‹æ˜¯å¯ä»¥åšåˆ°å¯¹soæ–‡ä»¶è¿›è¡Œåˆ†æçš„ï¼Œä½†æ˜¯soè¿˜æ˜¯å¯ä»¥é˜»éš”å¤§éƒ¨åˆ†çš„åç¼–è¯‘äººå‘˜ã€‚å¦‚æœæˆ‘ä»¬èƒ½æŠŠgetCipherKeyå®ç°çš„æ›´å¥½ï¼Œä¹Ÿä¼šå¢åŠ ç ´è§£çš„æˆæœ¬ã€‚å¦å¤–ï¼Œsoè¿˜æœ‰ä¸€ä¸ªè¢«ç›—ç”¨çš„é—®é¢˜ï¼Œå°±æ˜¯åˆ«äººç›´æ¥è°ƒç”¨æˆ‘ä»¬çš„soï¼Œè¿™ä¸ªé—®é¢˜ä¹Ÿå¯ä»¥é€šè¿‡ä¸€å®šçš„ä»£ç é€»è¾‘æ¥é¿å…ã€‚ä¹‹åä¼šç»§ç»­è®²è§£ã€‚ æœ€åå†è¯´ä¸€ç‚¹ï¼Œå¯¹äºç§˜é’¥ï¼Œæˆ‘ä»¬æœ€ç»ˆè¿˜ä¼šè¢«è½½å…¥æˆ‘ä»¬çš„å†…å­˜ï¼Œå¦‚æœç›´æ¥dumpæˆ‘ä»¬çš„å†…å­˜ï¼Œä¼šæ˜¯ä¸€ä¸ªäººä»€ä¹ˆæ ·çš„ç»“æœå‘¢ï¼Ÿ","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"https://ttdevs.github.io/categories/æŠ€æœ¯/"}],"tags":[{"name":"Android","slug":"Android","permalink":"https://ttdevs.github.io/tags/Android/"}]},{"title":"ã€ŒAndroidã€Androidé—¹é’Ÿé‡åˆ°çš„é‚£äº›å‘","slug":"[Android]Androidé—¹é’Ÿé‡åˆ°çš„é‚£äº›å‘","date":"1969-12-31T16:00:00.000Z","updated":"2017-04-27T11:07:57.000Z","comments":true,"path":"1970/01/01/[Android]Androidé—¹é’Ÿé‡åˆ°çš„é‚£äº›å‘/","link":"","permalink":"https://ttdevs.github.io/1970/01/01/[Android]Androidé—¹é’Ÿé‡åˆ°çš„é‚£äº›å‘/","excerpt":"","text":"0x00 åšè¿‡é—¹é’Ÿçš„è¯ä½ æ‰ä¼šç†è§£çš„å‘ç¬¬ä¸€æ¬¡åšé—¹é’Ÿç¨‹åºæ˜¯åœ¨2012å¹´ï¼Œé‚£æ—¶å€™androidæœ€æ–°ç‰ˆæœ¬æ˜¯2.2ï¼Œ2.3å‘å¸ƒåœ¨å³ï¼Œåšäº†ä¸€ä¸ªæ•´ç‚¹æé†’çš„å°å·¥å…·ï¼Œè®°å¾—å¾ˆæ¸…æ¥šï¼Œä¸»è¦çš„é—®é¢˜æ˜¯é”å±ä¹‹åé—¹é’Ÿä¸èƒ½å‡†æ—¶è¢«å”¤é†’ï¼Œæ€»ä¼šæ™šé‚£ä¹ˆå‡ ç§’é’Ÿï¼Œåæ¥æ²¡åŠæ³•æŠŠé—¹é’Ÿæå‰è®¾ç½®å‡ ç§’é’Ÿã€‚ä¸è¿‡é‚£æ—¶å€™ç¯å¢ƒè¿˜å¥½ï¼Œæ²¡æœ‰é‡åˆ°æ”»å…‹ä¸äº†çš„é—®é¢˜ï¼Œé‡å¯ä¹Ÿå¯ä»¥å”¤èµ·é—¹é’Ÿçš„ã€‚ ä½†æ˜¯éšç€androidç‰ˆæœ¬çš„è¿›åŒ–ï¼Œå¼€å‘è€…èŠ‚æ“çš„ä¸¢å¤±ï¼Œé—®é¢˜å°±è¶Šæ¥è¶Šéš¾åšäº†ã€‚é—¹é’Ÿæ˜æ˜è®¾ç½®äº†å´ä¸èƒ½åˆ°æ¥ï¼›ä¸å†è®¾ç½®çš„æ—¶é—´åˆ°æ¥ï¼Œæ™šäº†å¥½ä¹…æ‰åˆ°ï¼›é‡å¯ä¹‹åé—¹é’Ÿå°±æ²¡äº†ç­‰ç­‰ã€‚å½“ç„¶ï¼Œè¿˜æœ‰å¥½å¤šå¥½å¤šï¼Œæ€»ä¹‹å¾ˆå¤šä¸œè¥¿ä¸æŒ‰ç…§è‡ªå·±æœŸå¾…çš„æ¥ã€‚ é¡¹ç›®ä¸Šçº¿ï¼Œè¸©è¿‡ä¹‹åæŒ‘ä¸€äº›åšæ€»ç»“ã€‚ ç”±äºæ—¶é—´å…³ç³»ï¼Œé¡¹ç›®æ¯”è¾ƒèµ¶ï¼Œæ‰€ä»¥æ²¡æœ‰å»è€ƒè™‘é—¹é’Ÿæ— æ³•åŠæ—¶è§¦å‘çš„é—®é¢˜ï¼Œå‡è®¾äº†ä¸€ä¸ªæœ€ç†æƒ³çš„ç¯å¢ƒã€‚ï¼ˆæ›´å¤šçš„ä¿¡æ¯å¯ä»¥å‚è€ƒä¸‹é¢çš„æ–‡ç« ï¼‰ 0x01 é—¹é’Ÿçš„åˆ›å»ºè¿™é‡Œæ¶‰åŠåˆ°ä¸åŒç‰ˆæœ¬è®¾ç½®é—¹é’Ÿçš„æ–¹æ³•ï¼Œä¸‹é¢çš„å‚è€ƒæ–‡ç« ä¸­å·²ç»æåˆ°ï¼š 123456789private void startAlarm(Calendar calendar, PendingIntent pendingIntent) &#123; if (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.KITKAT) &#123; // mManager.setWindow(AlarmManager.RTC_WAKEUP, calendar.getTimeInMillis(), 1000* 5, mFirstPIntent); mManager.setExact(AlarmManager.RTC_WAKEUP, calendar.getTimeInMillis(), pendingIntent); // mManager.set(AlarmManager.RTC_WAKEUP, calendar.getTimeInMillis(), mSecondPIntent); &#125; else &#123; mManager.set(AlarmManager.RTC_WAKEUP, calendar.getTimeInMillis(), pendingIntent); &#125;&#125; 0x02 é—¹é’Ÿçš„å–æ¶ˆæœ‰çš„æ—¶å€™å¯èƒ½éœ€è¦å»å–æ¶ˆä¸€ä¸ªé—¹é’Ÿã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸¤ç§æ–¹å¼æ¥å–æ¶ˆï¼š é€šè¿‡ PendingIntent.cancel(); æ¥å–æ¶ˆ 12345678910/** * Cancel a currently active PendingIntent. Only the original application * owning a PendingIntent can cancel it. */public void cancel() &#123; try &#123; ActivityManagerNative.getDefault().cancelIntentSender(mTarget); &#125; catch (RemoteException e) &#123; &#125;&#125; è¿™ç§æ–¹å¼åªæœ‰èƒ½æ‹¿åˆ° `PendingIntent` æ‰å¯ä»¥ã€‚ é€šè¿‡ AlarmManager.cancel(PendingIntent); æ¥å–æ¶ˆ 12345678910111213141516/** * Remove any alarms with a matching &#123;@link Intent&#125;. * Any alarm, of any type, whose Intent matches this one (as defined by * &#123;@link Intent#filterEquals&#125;), will be canceled. * * @param operation IntentSender which matches a previously added * IntentSender. * * @see #set */public void cancel(PendingIntent operation) &#123; try &#123; mService.remove(operation); &#125; catch (RemoteException ex) &#123; &#125;&#125; 0x03 é—¹é’Ÿçš„æŸ¥çœ‹åˆä¸ªadbå‘½ä»¤å¯ä»¥ç”¨æ¥æŸ¥çœ‹å½“å‰ç³»ç»Ÿä¸­å­˜åœ¨çš„é—¹é’Ÿï¼š adb shell dumpsys alarm ä¸æ˜¯åœ¨æ‰€æœ‰çš„è®¾å¤‡ä¸Šéƒ½å¥½ä½¿ï¼Œæ¯”å¦‚åœ¨æˆ‘çš„é­…æ—è®¾å¤‡ä¸Šå¯ä»¥æ­£å¸¸ä½¿ç”¨ï¼Œè€Œåœ¨å¦ä¸€å° OPPO R7Cä¸Šå°±ä¸å¯ä»¥ã€‚ 0xFF å‚è€ƒ http://www.jianshu.com/p/1f919c6eeff6","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"https://ttdevs.github.io/categories/æŠ€æœ¯/"}],"tags":[{"name":"Android","slug":"Android","permalink":"https://ttdevs.github.io/tags/Android/"}]},{"title":"ã€ŒAndroidã€Android Studio 1.x NDKç¯å¢ƒæ­å»º","slug":"[Android]Android Studio 1.x NDKç¯å¢ƒæ­å»º","date":"1969-12-31T16:00:00.000Z","updated":"2017-04-27T11:07:57.000Z","comments":true,"path":"1970/01/01/[Android]Android Studio 1.x NDKç¯å¢ƒæ­å»º/","link":"","permalink":"https://ttdevs.github.io/1970/01/01/[Android]Android Studio 1.x NDKç¯å¢ƒæ­å»º/","excerpt":"","text":"ä¸‹è½½NDKä¸‹è½½NDK Download mac: android-ndk-r10e-linux-x86.bin å®‰è£…1234âœ ndk lsandroid-ndk-r10e-darwin-x86_64.binâœ ndk chmod a+x android-ndk-r10e-darwin-x86_64.binâœ ndk ./android-ndk-r10e-darwin-x86_64.bin é…ç½®ç¯å¢ƒgradle.propertiesåœ¨æœ«å°¾æ·»åŠ ä¸€è¡Œï¼š android.useDeprecatedNdk=true æ·»åŠ buildå·¥å…·AS &gt; Preferences &gt; Tools &gt; External Tools add javah Name: javah Group: default(External Tools) Description: generate C header Options: select all Show in: select all Tools Settings: Program: $JDKPath$/bin/javah Parameters: -v -d $ModuleFileDir$/src/main/jni -jni $FileClass$ Parameters: -bootclasspath $ModuleSdkPath$/platforms/android-23/android.jar -v -d $ModuleFileDir$/src/main/jni -jni $FileClass$ (if you need android object) Working directory: $SourcepathEntry$ (PS: Right click on the class) 123456789101112131415âœ ~ javahç”¨æ³•: javah [options] &lt;classes&gt;å…¶ä¸­, [options] åŒ…æ‹¬: -o &lt;file&gt; è¾“å‡ºæ–‡ä»¶ (åªèƒ½ä½¿ç”¨ -d æˆ– -o ä¹‹ä¸€) -d &lt;dir&gt; è¾“å‡ºç›®å½• -v -verbose å¯ç”¨è¯¦ç»†è¾“å‡º -h --help -? è¾“å‡ºæ­¤æ¶ˆæ¯ -version è¾“å‡ºç‰ˆæœ¬ä¿¡æ¯ -jni ç”Ÿæˆ JNI æ ·å¼çš„æ ‡å¤´æ–‡ä»¶ (é»˜è®¤å€¼) -force å§‹ç»ˆå†™å…¥è¾“å‡ºæ–‡ä»¶ -classpath &lt;path&gt; ä»ä¸­åŠ è½½ç±»çš„è·¯å¾„ -bootclasspath &lt;path&gt; ä»ä¸­åŠ è½½å¼•å¯¼ç±»çš„è·¯å¾„&lt;classes&gt; æ˜¯ä½¿ç”¨å…¶å…¨é™å®šåç§°æŒ‡å®šçš„(ä¾‹å¦‚, java.lang.Object)ã€‚ add ndkBuild Name: ndkBuild Group: default(External Tools) Description: ndk build Options: select all Show in: select all Tools Settings: Program: /Users/ttdevs/android/android-ndk-r10e/ndk-build Parameters: NDK_LIBS_OUT=$ModuleFileDir$/libs Working directory: $ModuleFileDir$/src/main (PS: Right click on the module name) ç¼–å†™ä»£ç æ–°å»ºä¸€ä¸ªModuleï¼šndkutilä¿®æ”¹ndkutilçš„build.gradle123456789101112131415161718android &#123; ... defaultConfig &#123; ... ndk &#123; moduleName \"ndkutil\"// abiFilters \"armeabi-v7a\", \"x86\"// stl \"gnustl_static\"// cFlags \"-std=c++11 -Wall\"// ldLibs \"log\", \"jnigraphics\", \"EGL\", \"GLESv3\" &#125; &#125; sourceSets.main &#123; jni.srcDirs = [] jniLibs.srcDir \"libs\" &#125;&#125; åˆ›å»ºå·¥å…·ç±»CipherUtil1234567package com.ttdevs.ndk;public class CipherUtil &#123; static &#123; System.loadLibrary(\"Cipher\"); &#125; public static native String getCipherKey();&#125; ç”Ÿæˆå¤´æ–‡ä»¶com_ttdevs_ndk_CipherUtil.håœ¨åˆšæ‰åˆ›å»ºçš„CipherUtil.javaä¸Šç‚¹å‡»å³é”® &gt; External Tools &gt; javahæ­¤æ—¶ä¼šåœ¨mainç›®å½•ä¸‹ç”Ÿæˆ: jni/com_ttdevs_ndk_CipherUtil.h ç¼–å†™ä»£ç éƒ½æ˜¯åœ¨ndkutil/src/main/jniç›®å½•ä¸‹ åˆ›å»ºCæºç :Cipher.cpp 12345#include \"com_ttdevs_ndk_CipherUtil.h\"JNIEXPORT jstring JNICALL Java_com_ttdevs_ndk_CipherUtil_getCipherKey(JNIEnv *env, jclass)&#123; return (*env).NewStringUTF(\"Hello World!\");&#125; åˆ›å»ºAndroid.mk 12345678LOCAL_PATH := $(call my-dir)include $(CLEAR_VARS)LOCAL_MODULE := CipherLOCAL_SRC_FILES := Cipher.cppinclude $(BUILD_SHARED_LIBRARY) åˆ›å»ºApplication.mk 12APP_MODULE := CipherAPP_ABI := all ç¼–è¯‘ç”Ÿæˆsoæ–‡ä»¶åœ¨moduleï¼ˆndkutilï¼‰ä¸Šç‚¹å‡»å³é”® &gt; External Tools &gt; ndkBuild ï¼Œå¯ä»¥çœ‹åˆ°å¦‚ä¸‹logï¼š 123456789101112131415161718192021222324/Users/ttdevs/android/android-ndk-r10d/ndk-build NDK_LIBS_OUT=/Users/ttdevs/android/workspace/Demo/ndkutil/libs[arm64-v8a] Compile++ : Cipher &lt;= Cipher.cpp[arm64-v8a] SharedLibrary : libCipher.so[arm64-v8a] Install : libCipher.so =&gt; /Users/ttdevs/android/workspace/Demo/ndkutil/libs/arm64-v8a/libCipher.so[x86_64] Compile++ : Cipher &lt;= Cipher.cpp[x86_64] SharedLibrary : libCipher.so[x86_64] Install : libCipher.so =&gt; /Users/ttdevs/android/workspace/Demo/ndkutil/libs/x86_64/libCipher.so[mips64] Compile++ : Cipher &lt;= Cipher.cpp[mips64] SharedLibrary : libCipher.so[mips64] Install : libCipher.so =&gt; /Users/ttdevs/android/workspace/Demo/ndkutil/libs/mips64/libCipher.so[armeabi-v7a] Compile++ thumb: Cipher &lt;= Cipher.cpp[armeabi-v7a] SharedLibrary : libCipher.so[armeabi-v7a] Install : libCipher.so =&gt; /Users/ttdevs/android/workspace/Demo/ndkutil/libs/armeabi-v7a/libCipher.so[armeabi] Compile++ thumb: Cipher &lt;= Cipher.cpp[armeabi] SharedLibrary : libCipher.so[armeabi] Install : libCipher.so =&gt; /Users/ttdevs/android/workspace/Demo/ndkutil/libs/armeabi/libCipher.so[x86] Compile++ : Cipher &lt;= Cipher.cpp[x86] SharedLibrary : libCipher.so[x86] Install : libCipher.so =&gt; /Users/ttdevs/android/workspace/Demo/ndkutil/libs/x86/libCipher.so[mips] Compile++ : Cipher &lt;= Cipher.cpp[mips] SharedLibrary : libCipher.so[mips] Install : libCipher.so =&gt; /Users/ttdevs/android/workspace/Demo/ndkutil/libs/mips/libCipher.soProcess finished with exit code 0 æ­¤æ—¶æˆ‘ä»¬å¯ä»¥å‘ç°åœ¨ndkutil/libs/ç›®å½•ä¸‹ç”Ÿæˆçš„soæ–‡ä»¶ã€‚ æµ‹è¯•ä»£ç 1String cipher = CipherUtil.getCipherKey(); é¡¹ç›®ç»“æ„","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"https://ttdevs.github.io/categories/æŠ€æœ¯/"}],"tags":[{"name":"Android","slug":"Android","permalink":"https://ttdevs.github.io/tags/Android/"}]},{"title":"ã€ŒAndroidã€DataBindingç»™Buttonè®¾ç½®èƒŒæ™¯æ— æ•ˆ","slug":"[Android]DataBindingç»™Buttonè®¾ç½®èƒŒæ™¯æ— æ•ˆ","date":"1969-12-31T16:00:00.000Z","updated":"2017-04-27T11:07:57.000Z","comments":true,"path":"1970/01/01/[Android]DataBindingç»™Buttonè®¾ç½®èƒŒæ™¯æ— æ•ˆ/","link":"","permalink":"https://ttdevs.github.io/1970/01/01/[Android]DataBindingç»™Buttonè®¾ç½®èƒŒæ™¯æ— æ•ˆ/","excerpt":"","text":"0x00 é—®é¢˜é€šè¿‡Data Bindingç»™Buttonè®¾ç½®èƒŒæ™¯æ— æ•ˆã€‚å…·ä½“è¡¨ç°ä¸ºç»™Buttonè®¾ç½®ä¸åŒçš„èƒŒæ™¯å›¾ç‰‡ï¼Œä½†æ˜¯æ— è®ºæ€æ ·èƒŒæ™¯åªä¼šæ˜¾ç¤ºä¸åŒçš„é¢œè‰²ï¼Œè€Œä¸æ˜¯æ˜¾ç¤ºæœŸæœ›çš„å›¾ç‰‡ã€‚ 0x01 åˆ†æç”±äºå¯¹Data Bindingä¸æ˜¯å¾ˆç†Ÿæ‚‰ï¼Œæ‰€ä»¥å¾ˆå¥‡æ€ªä¸ºä»€ä¹ˆã€‚ä¸ç®¡æ€æ ·å…ˆæ‰“å°ä¸‹è¿™ä¸ªèµ„æºçš„å€¼ï¼Œå‘ç°åœ¨å¸ƒå±€æ–‡ä»¶ä¸­æ‰“å°èµ„æºå€¼æ˜¯æœ‰çš„ã€‚æ ¹æ®ç»éªŒï¼Œè®¾ç½®ä¸åŒçš„èƒŒæ™¯å›¾ç‰‡ï¼ŒèƒŒæ™¯ä¼šæ˜¾ç¤ºä¸åŒçš„é¢œè‰²ï¼Œé‚£è¿™ä¸ªå€¼å¯èƒ½è¢«è§£ææˆäº†é¢œè‰²å€¼ã€‚ 0x02 è§£å†³åœ¨ç½‘ä¸Šæœäº†ä¸€ä¸‹ï¼ˆå®¹æˆ‘å¿˜è®°äº†å…·ä½“ç½‘å€ï¼‰ï¼Œéœ€è¦é€šè¿‡ä¸åŒçš„æ–¹å¼æ¥è®¾ç½®èƒŒæ™¯ï¼šä¹‹å‰çš„ï¼š 12345678910&lt;Button android:layout_width=\"200dp\" android:layout_height=\"200dp\" android:gravity=\"center\" android:onClick=\"@&#123;(view) -&gt; handler.onStartClick(view)&#125;\" android:text=\"@string/button_start\" android:textColor=\"@color/blueColor\" android:textSize=\"@dimen/global_font_large\" android:background=\"@&#123;handler.startButtonBg&#125;\" tools:background=\"@drawable/btn_main_circle_start\" /&gt; ä¿®æ”¹ä¹‹åï¼š 12345678910&lt;Button android:layout_width=\"200dp\" android:layout_height=\"200dp\" android:gravity=\"center\" android:onClick=\"@&#123;(view) -&gt; handler.onStartClick(view)&#125;\" android:text=\"@string/button_start\" android:textColor=\"@color/blueColor\" android:textSize=\"@dimen/global_font_large\" app:backgroundResource=\"@&#123;handler.startButtonBg&#125;\" tools:background=\"@drawable/btn_main_circle_start\" /&gt; ä¹Ÿå°±æ˜¯å°†ä¹‹å‰çš„ android:background æ¢æˆ app:backgroundResource 0x03 æ€»ç»“æ²¡å•¥æ€»ç»“çš„ï¼ŒData Binding è¿˜æœ‰å¾ˆå¤šç­‰å¾…æ¢ç©¶ã€‚","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"https://ttdevs.github.io/categories/æŠ€æœ¯/"}],"tags":[{"name":"Android","slug":"Android","permalink":"https://ttdevs.github.io/tags/Android/"}]},{"title":"ã€ŒAndroidã€Android Studio 2.0 NDKå¼€å‘ç¯å¢ƒæ­å»º","slug":"[Android]Android Studio 2.0 NDKå¼€å‘ç¯å¢ƒæ­å»º","date":"1969-12-31T16:00:00.000Z","updated":"2017-04-27T11:07:57.000Z","comments":true,"path":"1970/01/01/[Android]Android Studio 2.0 NDKå¼€å‘ç¯å¢ƒæ­å»º/","link":"","permalink":"https://ttdevs.github.io/1970/01/01/[Android]Android Studio 2.0 NDKå¼€å‘ç¯å¢ƒæ­å»º/","excerpt":"","text":"0x00 å‰æƒ…å›é¡¾å‰ä¸ä¹…å†™äº†ä¸€ç¯‡ç¯å¢ƒæ­å»ºï¼Œè™½ç„¶å¯ä»¥è·‘ä¸€ä¸ªdemoï¼Œä½†æ˜¯å¦‚æœä½ è·Ÿç€åšçš„è¯å°±ä¼šå‘ç°ï¼Œä»…ä»…æ˜¯å¯ä»¥è·‘ä¸€ä¸ªDemoï¼ŒçœŸåšèµ·æ¥å¾ˆæ˜¯è›‹ç–¼ã€‚ç¼–å†™æºç ï¼Œç”Ÿæˆsoï¼Œè·‘Appï¼Œæ”¹ä¸€ç‚¹ä»£ç ï¼Œå†ç”Ÿæˆsoï¼Œè·‘appã€‚è€Œä¸”ç¼–å†™ä»£ç æ²¡æœ‰æç¤ºï¼Œä¸èƒ½æ ¼å¼åŒ–ï¼Œå„ç§ä¸èƒ½ï¼Œå°±æ˜¯æœ€åŸºæœ¬çš„æ–‡æœ¬å¼€å‘ã€‚ç»è¿‡ä¸€æ®µæ—¶é—´æŠ˜è…¾å’ŒAndroid Studio 2.0çš„ releaseï¼Œå‘ç°æœ‰æ›´å®Œç¾çš„æ–¹å¼ï¼Œè€Œä¸”ä¸ç”¨ç¼–å†™Android.mkå’ŒApplication.mkã€‚çœ‹åœ¨æˆ‘åˆšå¼€å§‹å­¦çš„ä»½ä¸Šï¼Œå®¹æˆ‘å†æ¥å†™ä¸€éã€‚çœ‹å®Œè¿™ç¯‡ï¼Œä½ ä¼šå‘ç°JNIçš„å¼€å‘ä¹Ÿæ˜¯å¦‚æ­¤çš„so easyã€‚ 0x01 ç¯å¢ƒæ­å»ºæ‰€éœ€ç¯å¢ƒï¼š Android Studio 2.0 Gradle 2.10ï¼ˆæœ€ä½è¦æ±‚ï¼‰ NDKï¼šndk-r11cï¼ˆç›®å‰æœ€æ–°ç‰ˆï¼š2016-04-16ï¼‰ LLDBï¼š2.1ï¼ˆç›®å‰æœ€æ–°ç‰ˆï¼š2016-04-16ï¼‰ ä¸‹é¢å¼€å§‹æ­£å¼æ“ä½œï¼š å®‰è£…Android Studio 2.0 è¿™ä¸ªå°±ä¸ç»†è¯´äº†ã€‚ é…ç½®Gradle æœ€ä½è¦æ±‚Gradleç‰ˆæœ¬ä¸º2.10ï¼Œç›®å‰æœ€æ–°ç‰ˆæœ¬ä¸º2.12ã€‚ä¿®æ”¹æ–¹æ³•ï¼š é¡¹ç›®æ ¹ç›®å½•/gradle/wrapper/gradle-wrapper.properties å°†æœ€ä¸‹é¢çš„ä¸€è¡Œæ”¹æˆä½ è¦çš„ç‰ˆæœ¬ï¼Œå¦‚ï¼š distributionUrl=https\\://services.gradle.org/distributions/gradle-2.10-all.zip å®‰è£…NDK å®‰è£…NDKæœ‰ä¸¤ç§æ–¹å¼ï¼Œä¸€ç§æ˜¯ç›´æ¥ä¸‹è½½æœ€æ–°çš„NDKå®‰è£…æ–‡ä»¶è¿›è¡Œå®‰è£…ï¼Œå¦ä¸€ç§æ˜¯é€šè¿‡SDKå®‰è£…ï¼š NDKå®‰è£…æ–‡ä»¶ ä¸‹è½½å‚è€ƒè¿™é‡Œã€‚æ ¹æ®ä½ çš„æ“ä½œç³»ç»Ÿä¸‹è½½ä¸åŒç‰ˆæœ¬ã€‚ é€šè¿‡SDKå®‰è£… Android Studio &gt; Preferences &gt; Appearance &amp; Behavior &gt; Syetem Settings &gt; Android SDK &gt; SDK Tools åœ¨è¿™ä¸ªTabä¸­æ‰¾åˆ° Android NDKï¼Œé€‰ä¸­å®‰è£…å³å¯ã€‚å®‰è£…ä¹‹åæˆ‘ä»¬å¯ä»¥åœ¨ Android SDK çš„ç›®å½•ä¸‹çœ‹åˆ°ä¸€ä¸ª ndk-bundle ç›®å½•ï¼Œè¿™ä¸ªå°±æ˜¯æˆ‘ä»¬çš„NDKç›®å½•ã€‚ LLDB å’Œ GDB ç±»ä¼¼ï¼ŒLLDB æ˜¯ä¸€æ¬¾è°ƒè¯•å™¨ï¼Œå¯ä»¥è°ƒè¯•æˆ‘ä»¬çš„JNIä»£ç ã€‚åŒä¸Šæ‰“å¼€SDKè®¾ç½®ç•Œé¢ï¼š Android Studio &gt; Preferences &gt; Appearance &amp; Behavior &gt; Syetem Settings &gt; Android SDK &gt; SDK Tools åœ¨è¿™ä¸ªTabä¸­æ‰¾åˆ° LLDBï¼Œé€‰ä¸­å®‰è£…å³å¯ã€‚å®‰è£…ä¹‹åæˆ‘ä»¬å¯ä»¥åœ¨ Android SDK çš„ç›®å½•ä¸‹çœ‹åˆ°ä¸€ä¸ª lldb ç›®å½•ï¼Œè¿™ä¸ªå°±æ˜¯æˆ‘ä»¬çš„ LLDB ç›®å½•ã€‚LLDBçš„æ›´å¤šä¿¡æ¯å¯å‚è€ƒè¿™é‡Œã€‚ é€šè¿‡ä¸Šé¢çš„é…ç½®ï¼Œæ¥ä¸‹æ¥å°±å¯ä»¥å¼€å§‹æˆ‘ä»¬çš„JNIçš„å¼€å‘äº†ã€‚ å¯èƒ½ä½ ä¼šé—®ä¹‹å‰æˆ‘æœ‰ä»‹ç»è¿‡ä¸€ç¯‡å¼€å‘ç¯å¢ƒçš„æ­å»ºï¼Œè¿™ä¸ªæœ‰ä»€ä¹ˆä¸åŒå‘¢ï¼Ÿå¦‚æœä½ ä½¿ç”¨ä¹‹å‰çš„æ–¹æ³•ï¼Œä½ éœ€è¦é…ç½® Android.mkã€Application.mkï¼Œæ— ä»£ç è‡ªåŠ¨å®Œæˆï¼Œä¸èƒ½ä»£ç ä¸ªæ—¶å€™ï¼Œè¿è¡Œè°ƒè¯•éº»çƒ¦ï¼Œç­‰ç­‰ã€‚è¿™äº›é—®é¢˜åœ¨è¿™é‡Œéƒ½ä¸å­˜åœ¨äº†ï¼Œè®©æˆ‘ä»¬æŠŠæ›´å¤šçš„ç²¾åŠ›æ”¾åˆ°ä»£ç ç¼–å†™ä¸­ã€‚ 0x02 æµ‹è¯•Demoæ–°å»ºjavaä»£ç ï¼š 123456public class CipherUtils &#123; static &#123; System.loadLibrary(\"CipherUtils\"); &#125; public static native int add(int x, int y);&#125; ç”Ÿæˆå¯¹åº”çš„C++ä»£ç ï¼š ä»¤äººå…´å¥‹çš„æ˜¯ï¼ŒAndroid Studioå¯ä»¥å¸®æˆ‘ä»¬è‡ªåŠ¨ç”Ÿæˆ C ä»£ç ã€‚ç‚¹å‡» add æ–¹æ³•ï¼ŒOption ï¼‹ Return å³å¯ç”Ÿæˆä¸€ä¸ª CipherUtils.cæ–‡ä»¶ï¼Œç”±äºæˆ‘æ‰“ç®—ä½¿ç”¨C++ï¼Œå› æ­¤å°†æ‰©å±•åæ”¹ä¸º cpp ï¼ŒåŒæ—¶æ·»åŠ å¤´æ–‡ä»¶ï¼Œæœ€ç»ˆå¦‚ä¸‹ï¼š 123456789101112#include &lt;jni.h&gt;#include &lt;string&gt;using namespace std;#include \"utils/log.h\"JNIEXPORT jint JNICALL Java_com_ttdevs_jniutils_CipherUtils_add(JNIEnv *env, jclass type, jint x, jint y) &#123; std::string input_str(\"Test add two number!\"); LOGE(\"%s\", input_str.c_str()); return x + y;&#125; PSï¼šå¦‚æœæŠ¥é”™ï¼Œå¯æ˜¯å°†é”™è¯¯çš„ cppæ–‡ä»¶æ‹·è´å‡ºæ¥å†è€ƒå§å›å»ã€‚ build.gradle é…ç½® 12345678910111213141516171819202122android &#123; ...... defaultConfig &#123; ...... ndk &#123; moduleName \"CipherUtils\" stl \"gnustl_static\" // stlport_static abiFilters \"armeabi\", \"armeabi-v7a\" ldLibs \"log\", \"android\" &#125; &#125; sourceSets.main &#123; // å¦‚æœä¸å†™(jni.srcDirs = ['src/main/jni/']) // Androidå±•ç¤ºæ¨¡å¼æ²¡æœ‰jniç›®å½• // this file has been added after the last project sync with gradle // å¿…é¡»æœ‰å€¼,å¦‚: 'src/main/jni/' jni.srcDirs = ['src/main/jni/'] // jniLibs.srcDir \"libs\" &#125; ......&#125; ç›´æ¥ç‚¹å‡»è¿è¡ŒæŒ‰é’®ï¼Œå³å¯è·‘æˆ‘ä»¬çš„æµ‹è¯•ç¨‹åºäº†ã€‚å°±è¿™ä¹ˆç®€å•ã€‚ 0x03 JNIå±‚çš„Debugè¿™ä¸ªåŒæ ·ç®€å•ã€‚é¦–å…ˆéœ€è¦åœ¨å¤–é¢çš„build.gradleä¸­é…ç½®ä¸€ä¸‹ï¼š 123456789android &#123; ...... buildTypes &#123; debug &#123; jniDebuggable = true &#125; ...... &#125;&#125; åœ¨ C/C++ æºæ–‡ä»¶ä¸Šæ·»åŠ æ–­ç‚¹ï¼Œç‚¹å‡»debugï¼Œå°±å¯ä»¥åƒdebugæˆ‘ä»¬çš„javaä»£ç ä¸€æ ·è°ƒè¯•æˆ‘ä»¬çš„åŸç”Ÿä»£ç äº†ã€‚","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"https://ttdevs.github.io/categories/æŠ€æœ¯/"}],"tags":[{"name":"Android","slug":"Android","permalink":"https://ttdevs.github.io/tags/Android/"}]},{"title":"ã€ŒAndroidã€Androidä½ å¯èƒ½è¦ç”¨åˆ°çš„è‡ªå®šä¹‰Viewåˆ†äº«","slug":"[Android]Androidä½ å¯èƒ½è¦ç”¨åˆ°çš„è‡ªå®šä¹‰Viewåˆ†äº«","date":"1969-12-31T16:00:00.000Z","updated":"2017-04-27T11:07:57.000Z","comments":true,"path":"1970/01/01/[Android]Androidä½ å¯èƒ½è¦ç”¨åˆ°çš„è‡ªå®šä¹‰Viewåˆ†äº«/","link":"","permalink":"https://ttdevs.github.io/1970/01/01/[Android]Androidä½ å¯èƒ½è¦ç”¨åˆ°çš„è‡ªå®šä¹‰Viewåˆ†äº«/","excerpt":"","text":"0x00 mainè¿›æ­¥ã€åˆ›æ–°éƒ½æ˜¯åœ¨ä¸æ–­å˜åŒ–çš„éœ€æ±‚ä¸­è¯ç”Ÿçš„ã€‚ ï¼ï¼ By ttdevs è¿™ä¸ï¼Œæ–°çš„éœ€æ±‚åˆæ¥äº†ã€‚åºŸè¯ä¸å¤šè¯´ï¼Œå…ˆä¸Šè®¾è®¡ç¨¿ï¼š ç®€å•åˆ†æä¸Šå›¾åŒ…æ‹¬ä¸‰éƒ¨åˆ†ï¼šæœ€ä¸Šé¢çš„ç±»Progressbarï¼Œä¸­é—´ä¸¤ä¸ªæŒ‡ç¤ºç›˜å’Œæœ€ä¸‹é¢çš„æŒ‡ç¤ºç›˜ã€‚ç¬¬ä¸€ä¸ªç±»Progressbaræˆ‘ä»¬é¡¹ç›®ä¹‹å‰æœ‰å®ç°è¿‡ï¼Œä½†æ˜¯å’Œè¿™ä¸ªéœ€æ±‚æœ‰ä¸€äº›å·®å¼‚ï¼Œå› æ­¤å†³å®šé‡æ–°å®ç°ä¸€éã€‚å¦å¤–ä¸¤ä¸ªåœ†å½¢æŒ‡ç¤ºç›˜æœ¬æƒ³é€šè¿‡åœ¨ä¸€å¼ èƒŒæ™¯å›¾ç‰‡ä¸Šæ”¾ä¸€å¼ æŒ‡é’ˆå›¾ï¼Œæ§åˆ¶æŒ‡é’ˆå›¾çš„æ—‹è½¬æ¥å®ç°ï¼Œä½†æ˜¯è€ƒè™‘åˆ°è¿™æ ·ä¸å¤Ÿçµæ´»ï¼Œå› æ­¤ä¹Ÿå†³å®šè‡ªå·±æ¥ç”»ã€‚Soï¼Œæˆ‘ä»¬æ¥ä¸‹æ¥å®ç°è¿™ä¸‰ä¸ªViewã€‚ æ­£å¼å¼€å§‹ä¹‹å‰ï¼Œå…ˆçœ‹çœ‹æˆ‘ä»¬æœ€ç»ˆæ•ˆæœå›¾ï¼ˆå½“ç„¶ï¼ŒæŒ‡é’ˆæ˜¯å¯ä»¥åŠ¨çš„ï¼‰ï¼š 0x01 åˆ†æ LineIndicator ï¼ˆç¬¬ä¸€ä¸ªï¼Œç±»Progressbarï¼‰ ä¸»è¦åŒ…æ‹¬ä¸‰éƒ¨åˆ†ï¼šå·¦ä¾§çš„æç¤ºå’Œå†…å®¹ï¼Œå³ä¾§çš„æç¤ºå’Œå†…å®¹ï¼Œä¸­é—´çš„ç±»Progressbarã€‚ä¸¤ä¾§çš„æ–‡å­—æ¯”è¾ƒå®¹æ˜“å¤„ç†ï¼ŒæŒæ¡äº†æ–‡å­—çš„åŸºæœ¬ç»˜åˆ¶ï¼Œç”»èµ·æ¥æ˜¯å¾ˆå®¹æ˜“çš„ã€‚ä¸­é—´çš„ç±»Progressbarç”±äºæ‰“ç®—è‡ªå·±ç”»ï¼Œæ‰€ä»¥ä¸ä¼šç›´æ¥è´´ä¸ªProgressbaråœ¨ä¸Šé¢ã€‚æˆ‘çš„æ€è·¯æ˜¯ç”»ä¸€æ¡é•¿çš„ç›´çº¿ä½œä¸ºèƒŒæ™¯ï¼Œä¸­é—´çš„æŒ‡ç¤ºä¹Ÿæ˜¯ç›´çº¿ï¼Œæ¯”èƒŒæ™¯ç›´çº¿ç²—ï¼Œç›´çº¿çš„Paintè®¾ç½® StrokeCap ä¸º Paint.Cap.ROUND å³ paint.setStrokeCap(Paint.Cap.ROUND);ï¼Œè¿™æ ·å°±å¯ä»¥æœ‰ä¸¤å¤´åŠåœ†çš„æ•ˆæœï¼›ä¸­é—´çš„æŒ‡ç¤ºæ•°å­—ç›´æ¥ç”»åœ¨ç²—çš„æŒ‡ç¤ºç›´çº¿ä¸Šé¢å³å¯ã€‚è¿™é‡Œå¯èƒ½é‡åˆ°çš„é—®é¢˜æœ‰ä¸‹é¢ä¸¤ä¸ªï¼š StrokeCap è®¾ç½® ä¸º Paint.Cap.ROUNDæ—¶çš„ä½ç½®å…³ç³» StrokeCap è®¾ç½® ä¸º Paint.Cap.ROUNDï¼Œç›´çº¿ä¸¤ä¾§çš„åŠåœ†æ˜¯ä¸ç®—åœ¨ç›´çº¿çš„é•¿åº¦é‡Œçš„ã€‚ç®€å•æ¥è¯´ï¼Œå¦‚æœviewçš„é•¿åº¦å’Œæˆ‘ç”»çš„ç›´çº¿é•¿åº¦ä¸€è‡´ï¼Œé‚£ä¹ˆè¿™ä¸ªç›´çº¿å°±æ˜¯çŸ©å½¢è€Œä¸æ˜¯æœŸå¾…çš„ä¸¤ä¾§éƒ½æ˜¯åŠåœ†çš„æ¤­åœ†ã€‚ å½“è¿›åº¦ä¸º0æˆ–è€…ä¸º100ï¼…æ—¶çš„å±•ç¤º å¦‚æœæˆ‘ä»¬èƒŒæ™¯ç›´çº¿å’ŒæŒ‡ç¤ºç›´çº¿èµ·ç‚¹ç»ˆç‚¹ä½ç½®ä¸€è‡´ï¼Œé‚£ä¹ˆæœ€ç»ˆæ•ˆæœå°±æ˜¯å½“è¿›åº¦ä¸º0æˆ–è€…100%çš„æ—¶å€™ï¼ŒæŒ‡ç¤ºç›´çº¿æ˜¯æ˜¾ç¤ºä¸å…¨çš„ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦å¯¹è¿™ä¸¤ä¸ªä½ç½®è¿›è¡ŒçŸ«æ­£ã€‚æˆ‘çš„çŸ«æ­£æ–¹æ³•æ¯”è¾ƒç®€å•ï¼Œåœ¨0ï½xå’Œyï½100%è¿›åº¦çš„æ—¶å€™åˆ†åˆ«æ˜¾ç¤ºxå’Œyï¼ˆæœ¬ä»¥ä¸ºè‡ªå·±çš„æ€è·¯å¾ˆå±Œï¼Œåæ¥å‘ç°åˆ«äººä¹Ÿæ˜¯è¿™ä¹ˆå¹²çš„ï¼‰ã€‚ CircleIndicator ï¼ˆä¸­é—´çš„å¤šç§é¢œè‰²ç¯ï¼‰ è¿™ä¸ªViewæˆ‘å°†å…¶åˆ†è§£ä¸ºå››éƒ¨åˆ†ï¼Œä»ä¸Šå±‚åˆ°ä¸‹å±‚ï¼šä¸­é—´æŒ‡é’ˆï¼Œåˆ»åº¦ç¯ï¼Œæ˜¾ç¤ºçš„å†…å®¹ï¼Œåœ†ç¯èƒŒæ™¯å’Œå¤–å±‚æŒ‡ç¤ºæ–‡å­—ã€‚æ¯ä¸€éƒ¨åˆ†å†åšåˆ†è§£ï¼š ä¸­é—´æŒ‡é’ˆ è¿™ä¸ªåˆåˆ†è§£ä¸ºå…­ä¸ªéƒ¨åˆ†ï¼šæœ€ä¸‹å±‚å¤§åœ†ï¼Œä¸¤ä¸ªåœ†å½¢åŠåœ†ï¼Œä¸¤ä¸ªä¸‰è§’å½¢å’Œä¸Šå±‚å°åœ†ã€‚ åˆ»åº¦ç¯ ç”±äºæ˜¯åœ†ç¯ï¼Œæ‰€ä»¥å¿…é¡»ç”»å¼§çº¿äº†ã€‚ä½†æ˜¯è¿™ä¸ªå¼§çº¿åˆæœ‰ç‚¹ç‰¹æ®Šï¼Œä¸¤ä¾§å¸¦åœ†è§’ï¼Œä¸­é—´åœ†ç¯ç›´è§’ï¼Œè¿™ä¸ªæ²¡æƒ³åˆ°å•¥å¥½åŠæ³•ï¼Œç”¨äº†å¾ˆä¸€èˆ¬çš„æ€è·¯ï¼šå…ˆç”¨ Paint.Cap.ROUND ç”»ä¸¤ä¾§çš„å¼§ï¼Œç„¶å Paint.Style.STROKE ç”»ä¸­é—´çš„éƒ¨åˆ†ã€‚ æ˜¾ç¤ºçš„å†…å®¹ è¿™ä¸ªå°±æ¯”è¾ƒç®€å•äº†ï¼Œä¸»è¦åœ¨äºè®¡ç®—æ–‡å­—çš„æ˜¾ç¤ºä½ç½®ã€‚ åœ†ç¯èƒŒæ™¯å’Œå¤–å±‚æ–‡å­— æœ€ç®€å•çš„ä¸€ä¸ªåœ†ï¼ŒåŠ ä¸€ä¸ªä»¥åœ†ä¸ºè·¯å¾„ç”»çš„æ–‡å­—ã€‚ æœ€åæˆ‘ä»¬ç”»çš„é¡ºåºæ­£å¥½ä¸ä¸Šé¢æ‰€è¿°é¡ºåºç›¸åã€‚ ProgressIndicator ï¼ˆæœ€ä¸‹é¢çš„ä¸¤ç§é¢œè‰²ç¯ï¼‰ è¿™ä¸ªç›¸è¾ƒ CircleIndicator å°±ç®€å•äº†ä¸€äº›ã€‚åœ¨ç”»åœ†ç¯çš„æ—¶å€™ï¼Œæˆ‘ä»¬åªéœ€è¦å…ˆç”»ä¸€ä¸ªç°è‰²èƒŒæ™¯ï¼Œç„¶åå†ç”»ä¸€ä¸ªç»¿è‰²åœ†å¼§å³å¯ã€‚ 0x02 å®ç°Viewçš„ç»˜åˆ¶æˆ‘ä»¬åº”è¯¥éƒ½æ¯”è¾ƒç†Ÿæ‚‰ï¼Œä¸»è¦æœ‰ä¸‹é¢ä¸‰ä¸ªè¿‡ç¨‹ï¼š onMeasureï¼ˆæµ‹é‡ï¼‰ã€onLayoutï¼ˆå¸ƒå±€ï¼‰ã€onDrawï¼ˆç»˜åˆ¶ï¼‰ã€‚é’ˆå¯¹ä¸Šè¿°ä¸‰ä¸ªViewï¼šLineIndicatorï¼Œæˆ‘ä»¬æ ¹æ®å®é™…çš„å†…å®¹æ¥è®¡ç®—Viewçš„é«˜åº¦ï¼Œå®½åº¦ç”¨æˆ·è®¾å®šï¼›CircleIndicatorå’ŒProgressIndicatorçš„å®½åº¦ç”¨æˆ·è®¾å®šï¼Œé«˜åº¦è‡ªå®šè®¡ç®—ä¸å®½åº¦ç›¸åŒã€‚onLayoutæˆ‘ä»¬ä¸éœ€è¦ã€‚æœ€åçš„æ ¹æ®å®é™…çš„å±•ç¤ºå†…å®¹æ¥ç»˜åˆ¶ã€‚ å¦å¤–ï¼Œç”±äºCircleIndicatorå’ŒProgressIndicatorå’Œç›¸ä¼¼åº¦é«˜ï¼Œå¾ˆå¤šä»£ç å¯ä»¥æ‹¿æ¥é‡ç”¨ï¼Œå› æ­¤ï¼Œæˆ‘å†™äº†ä¸€ä¸ªåŸºç±»æ¥å®Œæˆå…¬å…±çš„éƒ¨åˆ†ï¼Œç‰¹æ®Šéƒ¨åˆ†æ¯ä¸ª å­ç±»è‡ªå·±å®Œæˆã€‚æœ€åå†å­ç±»åœ°onDrawæ–¹æ³•ä¸­æŒ‰ç…§é¡ºåºè°ƒç”¨å³å¯ã€‚ ç”±äºä¸»è¦æ˜¯è®¡ç®—å„ç§åæ ‡ä½ç½®ï¼Œä»£ç è¿˜æ˜¯ä¸å°‘çš„ï¼Œè¿™é‡Œå°±ä¸è´´ä»£ç ã€‚æœ€åçš„å®ç°è¯·ç§»æ­¥æˆ‘çš„ githubã€‚ä¸‰ä¸ªViewçš„ä»£ç å·²ç»æ•´ç†å®ŒLineIndicatorï¼Œå…¶å®ƒçš„ä¸¤ä¸ªè¿˜éœ€è¦ç‚¹æ—¶é—´ï¼ˆ2016-06-19ï¼‰ã€‚ 0x03 çŸ¥è¯†ç‚¹ è‡ªå®šä¹‰Viewçš„æ€è·¯ åˆ›å»ºç±»ï¼Œç»§æ‰¿è‡ªViewæˆ–è€…ViewGroupæˆ–è€…å…¶å®ƒViewGroup å®šä¹‰Viewçš„å¯é…ç½®å‚æ•°ï¼Œå¦‚æœä½ éœ€è¦çš„è¯ å®ç°Viewçš„å…·ä½“é€»è¾‘ è¿™ä¸ªå¤ªç²—ç•¥äº†ï¼Œå„ä½å¯ä»¥å‚è€ƒå…·ä½“æºç ã€‚ æ–‡å­—ä½ç½®çš„è®¡ç®— å¦‚æœä½ æ²¡æœ‰è‡ªå·±ç”»è¿‡æ–‡å­—ï¼Œé‚£ä½ è‚¯å®šä¸å¯èƒ½ä¸€ä¸‹å­æ˜ç™½æ–‡å­—çš„ç”»æ³•ï¼Œæˆ–å¤šæˆ–å°‘çš„å‡ºç°åç§»ã€‚è¿™é‡Œç›´æ¥ç»™å¤§å®¶æ¨èä¸€ç¯‡è®²çš„éå¸¸è¯¦ç»†çš„æ–‡ç« ï¼šhttp://blog.csdn.net/aigestudio/article/details/41447349 ä½ç½®ã€åŠå¾„ã€å¼§é•¿ç­‰çš„è®¡ç®— è¿™é‡Œä¼šæ¶‰åŠåˆ°ç®€å•çš„ä¸‰è§’å‡½æ•°å’Œåœ†çš„å‘¨é•¿å¼§åº¦çš„è®¡ç®—ï¼Œå¯èƒ½è¦è¯´çš„å°±æ˜¯ä¸‰è§’å‡½æ•°çš„å‚æ•°æ˜¯å¼§åº¦åˆ¶åº¦ã€‚ ObjectAnimator 12345678910111213141516171819202122232425262728293031323334353637383940414243/** * è®¾ç½®å†…å®¹çš„é¢œè‰²å€¼ï¼ˆéresourceçš„idï¼‰ * * @param contentColor å†…å®¹çš„é¢œè‰²å€¼ * @param unitColor å•ä½çš„é¢œè‰²å€¼ */public void setContentColor(int contentColor, int unitColor) &#123; mContentColor = contentColor; mUnitColor = unitColor;&#125;/** * è®¾ç½®è¿›åº¦ * * @param indicator è¿›åº¦å€¼ */public void setIndicator(float indicator) &#123; if (indicator &lt;= mStartIndicator) &#123; mIndicator = mStartIndicator; &#125; else if (indicator &gt; mEndIndicator) &#123; mIndicator = mEndIndicator; &#125; else &#123; mIndicator = indicator; &#125; postInvalidate();&#125;/** * è·å–è¿›åº¦ * * @return å½“å‰è¿›åº¦å€¼ */public float getIndicator() &#123; return mStartIndicator;&#125;public void animateIndicator(float indicator) &#123; Interpolator interpolator = new AnticipateOvershootInterpolator(1.8f); ObjectAnimator animation = ObjectAnimator.ofFloat(this, \"indicator\", indicator); animation.setDuration(2000); animation.setInterpolator(interpolator); animation.start();&#125; å¤„ç†å±å¹•çš„æ—‹è½¬ ç”±äºæ—¶é—´æ¯”è¾ƒç´§ï¼Œè¿™ä¸ªæˆ‘è¿˜æ²¡åšã€‚ä¸»è¦åœ¨Viewçš„ä»¥ä¸‹ä¸¤ä¸ªæ–¹æ³•ä¸­å®ç°ï¼š 123456789@Overrideprotected Parcelable onSaveInstanceState() &#123; return super.onSaveInstanceState();&#125;@Overrideprotected void onRestoreInstanceState(Parcelable state) &#123; super.onRestoreInstanceState(state);&#125; æœ€åæ¬¢è¿å„ä½åæ§½å¹¶æä¾›æ›´å¥½çš„å»ºè®®ï½ï½","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"https://ttdevs.github.io/categories/æŠ€æœ¯/"}],"tags":[{"name":"Android","slug":"Android","permalink":"https://ttdevs.github.io/tags/Android/"}]},{"title":"ã€ŒAndroidã€MediaPlayerå•æ›²å¾ªç¯ä¸å¡é¡¿","slug":"[Android]MediaPlayerå•æ›²å¾ªç¯ä¸å¡é¡¿","date":"1969-12-31T16:00:00.000Z","updated":"2017-04-27T11:07:57.000Z","comments":true,"path":"1970/01/01/[Android]MediaPlayerå•æ›²å¾ªç¯ä¸å¡é¡¿/","link":"","permalink":"https://ttdevs.github.io/1970/01/01/[Android]MediaPlayerå•æ›²å¾ªç¯ä¸å¡é¡¿/","excerpt":"","text":"0x00 éœ€æ±‚å•æ›²å¾ªç¯æ’­æ”¾æ­Œæ›²ï¼Œè¦æ±‚è¿‡åº¦è¿è´¯ï¼Œå¬ä¸å‡ºæ¥å¡é¡¿æ„Ÿè§‰ã€‚ 0x01 è§£å†³æ€è·¯ MediaPlayer å¯¹äºå¸¸è§çš„éŸ³ä¹æ’­æ”¾ï¼Œæˆ‘ä»¬ç¬¬ä¸€æ—¶é—´æƒ³åˆ°çš„åº”è¯¥å°±æ˜¯å®ƒï¼Œå®ƒæœ‰ä¸€ä¸ªæ–¹æ³• MediaPlayer.setLooping(true); å°±æ˜¯ç”¨æ¥è¿›è¡Œå•æ›²å¾ªç¯çš„ã€‚ä½†æ˜¯å¾ˆé—æ†¾ï¼Œå¦‚æœä½ ç®€å•çš„è¿™ä¹ˆåšï¼Œä¸Šé¢çš„ç›®çš„æ˜¯è¾¾ä¸åˆ°çš„ï¼Œä¼šå‡ºç°ä¸Šä¸€éç»“æŸå‡ºç°ä¸€ä¸ªæ˜æ˜¾çš„åœæ­¢æ‰å¼€å§‹æ’­æ”¾ä¸‹ä¸€æ¬¡çš„ç°è±¡ã€‚ ä¸è¿‡æœ€åå°±æ˜¯ç”¨çš„è¿™ä¸ªç»„ä»¶ï¼Œä¸è¿‡ä¸æ˜¯ç®€å•çš„è®¾ç½® setLooping(true)ã€‚ SoundPool ä¸€æ®µæ—¶é—´å†…å¯èƒ½ä¼šæ’­æ”¾å¾ˆå¤šéŸ³ä¹çš„æ—¶å€™ï¼Œæˆ‘ä»¬é¦–å…ˆåº”è¯¥é€‰æ‹©è¿™ä¸ªã€‚ ç¬¬ä¸‰æ–¹ç»„ä»¶ å¦‚æœæ²¡æœ‰ç‰¹æ®Šçš„éœ€æ±‚ï¼Œè¿™ä¸ªä¸æ˜¯é¦–é€‰ï¼Œç‰¹åˆ«æ˜¯å½“å¼•å…¥çš„ç»„ä»¶ç‰¹åˆ«é‡çš„æ—¶å€™ã€‚ å› ä¸ºä¹‹å‰è¸©è¿‡å‘ï¼šiOSä¸Šç›´æ¥æ’­æ”¾mp3æ–‡ä»¶ï¼Œå•æ›²å¾ªç¯çš„æ—¶å€™æ’­æ”¾çš„é—´éš™ç‰¹åˆ«é•¿ï¼Œå¡é¡¿çš„æ„Ÿè§‰æ— æ³•æ¥å—ï¼Œè§£å†³æ–¹æ³•æ˜¯å°†mp3è½¬æ¢æˆm4aï¼ŒåŸºæœ¬ä¸Šå¬ä¸å‡ºä¸­é—´çš„è¿‡åº¦é—´éš™ã€‚é¦–å…ˆå°è¯•äº†ä½¿ç”¨ MediaPlayer æ¥æ’­æ”¾ï¼Œåœ¨æˆ‘çš„æœºå™¨ï¼ˆMX4 Proï¼‰ä¸Šæ’­æ”¾è¿˜å‹‰å¼ºèƒ½æ¥å—ï¼Œé—´éš™ä¸æ˜¯éå¸¸æ˜æ˜¾ï¼Œæ¢åˆ°é…ç½®å·®ä¸€ç‚¹çš„æœºå™¨ä¸Šå°±ä¸èƒ½å¿äº†ã€‚ç„¶åå°è¯•äº† SoudPool ï¼Œæ— è®ºæ˜¯é¢„åŠ è½½ä¸€æ¬¡å¾ªç¯æ’­æ”¾ï¼Œè¿˜æ˜¯é¢„åŠ è½½ä¸¤æ¬¡å¾ªç¯æ’­æ”¾ï¼Œä¸­é—´çš„å¡é¡¿æ„Ÿè§‰å’Œç”¨ MediaPlayer.setLooping(true); ä¸€æ ·ä¸€æ ·çš„ã€‚å†ç„¶åï¼Œå°è¯•macOS ä¸‹ç¼–è¯‘ vlc for android ï¼Œæˆ‘å¤±è´¥äº†â•®(â•¯â–½â•°)â•­ï¼‰é—®é¢˜æ€»è¦è§£å†³çš„ï¼Œå†æ‰¾å…¶ä»–åŠæ³•ã€‚ 0x02 æ­»å¾ªç¯æ‰¾äº†å¾ˆå¤šèµ„æ–™ï¼Œæœ€åä½¿ç”¨ä¸€ä¸ªå¾ªç¯æ’­æ”¾çš„æ–¹æ³•è§£å†³äº†è¿™ä¸ªé—®é¢˜ï¼š åˆ›å»ºç¬¬ä¸€ä¸ªæ’­æ”¾å™¨ï¼Œæ’­æ”¾ï¼› åŒæ—¶åˆ›å»ºç¬¬äºŒä¸ªæ’­æ”¾å™¨ï¼Œå‡†å¤‡ï¼› ç¬¬ä¸€ä¸ªæ’­æ”¾å™¨æ’­æ”¾å®Œæ¯•ç«‹é©¬å¯åŠ¨ç¬¬äºŒä¸ªï¼› ç„¶ååˆ›å»ºç¬¬ä¸‰ä¸ªæ’­æ”¾å™¨ï¼Œå‡†å¤‡ï¼› å¦‚æ­¤å¾€å¤ï¼Œç›´åˆ°ç”¨æˆ·åœæ­¢â€¦ ç”±äºå¯¹ MediaPlayer æ²¡æœ‰è¿‡æ·±å…¥çš„ç ”ç©¶å’Œä½¿ç”¨ï¼Œè¿™ä¸ªæ€è·¯æ¥ä¸€æ—¶åŠä¼šè‡ªå·±è¿˜æ˜¯æƒ³ä¸å‡ºæ¥çš„ï¼ˆæ€»æ˜¯ä¼šæƒ³åªè¦åˆ›å»ºä¸€ä¸ªæ’­æ”¾å™¨å°±å¤Ÿäº†ï¼‰ã€‚è¿™ä¹ˆåšä¸‹æ¥çœŸçš„å¾ªç¯æ’­æ”¾å°±æ²¡æœ‰é—´éš™æ„Ÿäº†â€¦â€¦ ç”±äº mPlayer.setLooping(true); æ˜¯nativeæ–¹æ³•ï¼Œæ‰€ä»¥æ²¡æœ‰å»è·Ÿå…·ä½“çš„å®ç°é€»è¾‘ã€‚çŒœæµ‹å¯èƒ½æ˜¯é‡æ–°åŠ è½½æˆ–è€…å…¶ä»–åŸå› å¯¼è‡´å•æ›²å¾ªç¯ä¸­é—´é—´éš™è¾ƒå¤§ï¼ˆåŸè°…æˆ‘çš„æ‡’ï¼Œæ²¡æœ‰å»æ‹¿å¤§æ–‡ä»¶å°è¯•ï¼‰ã€‚è€Œä½¿ç”¨ä¸Šé¢çš„æ–¹å¼ï¼Œå½“æ’­æ”¾æ—¶é—´å¤§äºé¢„åŠ è½½æ—¶é—´çš„æ—¶å€™ï¼Œç¬¬ä¸€ä¸ªæ’­æ”¾å™¨æ’­æ”¾çš„æ—¶å€™æœ‰ç¬¬äºŒä¸ªæ’­æ”¾å™¨æœ‰å……è¶³çš„æœºä¼šå»å®ŒæˆåŠ è½½ç„¶åç­‰å¾…æ’­æ”¾ï¼ˆæ’­æ”¾æ—¶é—´å°äºåŠ è½½æ—¶é—´çš„å¯èƒ½æ€§ä¸æ˜¯å¾ˆå¤§ï¼‰ã€‚ 12345678910111213141516171819202122232425262728private MediaPlayer mPlayer, mNextPlayer;private int mPlayResId = R.raw.water;public void testLoopPlayer() &#123; mPlayer = MediaPlayer.create(this, mPlayResId); mPlayer.setOnPreparedListener(new MediaPlayer.OnPreparedListener() &#123; @Override public void onPrepared(MediaPlayer mediaPlayer) &#123; mPlayer.start(); &#125; &#125;); createNextMediaPlayer();&#125;private void createNextMediaPlayer() &#123; mNextPlayer = MediaPlayer.create(this, mPlayResId); mPlayer.setNextMediaPlayer(mNextPlayer); mPlayer.setOnCompletionListener(new MediaPlayer.OnCompletionListener() &#123; @Override public void onCompletion(MediaPlayer mp) &#123; mp.release(); mPlayer = mNextPlayer; createNextMediaPlayer(); &#125; &#125;);&#125; 0x03 æ€»ç»“è¿™æ›´åƒä¸€ä¸ªå¼€è„‘æ´çš„é—®é¢˜ã€‚ 0x04 å‚è€ƒ http://stackoverflow.com/questions/26274182/not-able-to-achieve-gapless-audio-looping-so-far-on-android","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"https://ttdevs.github.io/categories/æŠ€æœ¯/"}],"tags":[{"name":"Android","slug":"Android","permalink":"https://ttdevs.github.io/tags/Android/"}]},{"title":"ã€ŒAndroidã€Toobarçš„ä¸€ä¸ªç®€å•å°è£…","slug":"[Android]Toobarçš„ä¸€ä¸ªç®€å•å°è£…","date":"1969-12-31T16:00:00.000Z","updated":"2017-04-27T11:07:57.000Z","comments":true,"path":"1970/01/01/[Android]Toobarçš„ä¸€ä¸ªç®€å•å°è£…/","link":"","permalink":"https://ttdevs.github.io/1970/01/01/[Android]Toobarçš„ä¸€ä¸ªç®€å•å°è£…/","excerpt":"","text":"Toolbarå’ŒActionBarçš„ç›´è§‚åŒºåˆ«å°±æ˜¯éœ€è¦æˆ‘ä»¬è‡ªå·±å°†ToolBaråŠ åˆ°è‡ªå·±çš„å¸ƒå±€æ–‡ä»¶ä¸­ã€‚ç›®å‰çš„æƒ…å†µæ˜¯ï¼šåœ¨æˆ‘ä»¬çš„ç°æœ‰é¡¹ç›®ä¸Šæ”¹åŠ¨ï¼Œå¤šæ•°çš„Activityéƒ½æ˜¯ç»§æ‰¿ä¸€ä¸ªBaseActivityã€‚ä¸ºäº†ç”¨æœ€å°çš„ä»£ä»·è¾¾åˆ°ç›®çš„ï¼Œç®€å•çš„æ€è€ƒä¹‹åï¼Œåšäº†å¦‚ä¸‹çš„æ”¹åŠ¨ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758/** * å¸¦ToolBarçš„åŸºç±» */public class BaseActivity extends ActionBarActivity &#123; private static final int BASE_VIEW_ID = R.layout.activity_base; private static final LayoutParams LAYOUT_PARAMS = new LayoutParams(LayoutParams.MATCH_PARENT, LayoutParams.MATCH_PARENT); private LinearLayout mParentView; private Toolbar mToolBar; @Override protected void onCreate(Bundle savedInstanceState) &#123; ViewUtils.startTranslucent(this); super.onCreate(savedInstanceState); setContentView(BASE_VIEW_ID); &#125; @Override public void setContentView(int layoutResID) &#123; if (BASE_VIEW_ID == layoutResID) &#123; super.setContentView(layoutResID); mParentView = (LinearLayout) findViewById(R.id.base_parent_view); mToolBar = (Toolbar) findViewById(R.id.toolbar); initToolbar(mToolBar); return; &#125; mParentView.addView(getLayoutInflater().inflate(layoutResID, null), LAYOUT_PARAMS); &#125; @Override public void setContentView(View view) &#123; mParentView.addView(view, LAYOUT_PARAMS); &#125; private void initToolbar(Toolbar toolbar) &#123; setSupportActionBar(toolbar); getSupportActionBar().setDisplayHomeAsUpEnabled(true); toolbar.setNavigationOnClickListener(new View.OnClickListener() &#123; @Override public void onClick(View v) &#123; finish(); &#125; &#125;); &#125; public Toolbar getToolBar() &#123; return mToolBar; &#125; public void setBackground(int colorId) &#123; if (null != mParentView) &#123; mParentView.setBackgroundColor(getResources().getColor(colorId)); &#125; &#125;&#125; å¸ƒå±€æ–‡ä»¶activity_base.xmlï¼š 123456789101112&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;&lt;LinearLayout xmlns:android=\"http://schemas.android.com/apk/res/android\" android:id=\"@+id/base_parent_view\" android:layout_width=\"match_parent\" android:layout_height=\"match_parent\" android:background=\"@color/global_background_status_bar\" android:fitsSystemWindows=\"true\" android:orientation=\"vertical\"&gt; &lt;include layout=\"@layout/subview_toolbar\"/&gt;&lt;/LinearLayout&gt; åœ¨åŸºç±»ä¸­æ·»åŠ å¦‚ä¸Šä»£ç ï¼ŒåŸºæœ¬å¯ä»¥ç”¨æœ€å°çš„æ”¹åŠ¨è¾¾åˆ°ä½¿ç”¨Toolbarçš„ç›®çš„ã€‚ä½†æ˜¯ï¼Œè¿™æ ·ä¹Ÿå­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯ä¼šä½¿æˆ‘ä»¬çš„æ¯ä¸ªActivityçš„å¸ƒå±€å±‚æ¬¡å¤šäº†ä¸€å±‚ã€‚ å¦‚æœæœ‰æ›´å¥½çš„æ€è·¯ï¼Œæ¬¢è¿åˆ†äº«ï½ï½","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"https://ttdevs.github.io/categories/æŠ€æœ¯/"}],"tags":[{"name":"Android","slug":"Android","permalink":"https://ttdevs.github.io/tags/Android/"}]},{"title":"ã€ŒAndroidã€*ä¸åŒContextåŒºåˆ«","slug":"[Android]ä¸åŒContextåŒºåˆ«","date":"1969-12-31T16:00:00.000Z","updated":"2017-04-27T11:07:57.000Z","comments":true,"path":"1970/01/01/[Android]ä¸åŒContextåŒºåˆ«/","link":"","permalink":"https://ttdevs.github.io/1970/01/01/[Android]ä¸åŒContextåŒºåˆ«/","excerpt":"","text":"ä»£ç ï¼š 1234567AlertDialog dialog = new AlertDialog .Builder(context) .setTitle(title) .setCancelable(false) .setPositiveButton(\"ç¡®å®š\", listener) .create();dialog.show(); é”™è¯¯ä¿¡æ¯ï¼š 123456789101112131415android.view.WindowManager$BadTokenException: Unable to add window -- token null is not for an at android.view.ViewRootImpl.setView(ViewRootImpl.java:589) at android.view.WindowManagerImpl.addView(WindowManagerImpl.java:326) at android.view.WindowManagerImpl.addView(WindowManagerImpl.java:224) at android.view.WindowManagerImpl$CompatModeWrapper.addView(WindowManagerImpl.java:149) at android.app.Dialog.show(Dialog.java:293) at com.ttdevs.easysecuritysmartbar.StartHandler.handleMessage(StartHandler.java:39) at android.os.Handler.dispatchMessage(Handler.java:99) at android.os.Looper.loop(Looper.java:137) at android.app.ActivityThread.main(ActivityThread.java:4866) at java.lang.reflect.Method.invokeNative(Native Method) at java.lang.reflect.Method.invoke(Method.java:511) at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:786) at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:553) at dalvik.system.NativeStart.main(Native Method) å…¶ä¸­contextæ˜¯é€š getApplicationContext() è·å–çš„ï¼Œå°†å…¶æ¢æˆ Activity é—®é¢˜è§£å†³ã€‚ 0xFF å‚è€ƒ http://blog.csdn.net/lmj623565791/article/details/40481055","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"https://ttdevs.github.io/categories/æŠ€æœ¯/"}],"tags":[{"name":"Android","slug":"Android","permalink":"https://ttdevs.github.io/tags/Android/"}]},{"title":"ã€ŒAndroidã€LayoutInflateé‡åˆ°çš„å‘","slug":"[Android]LayoutInflateé‡åˆ°çš„å‘","date":"1969-12-31T16:00:00.000Z","updated":"2017-04-27T11:07:57.000Z","comments":true,"path":"1970/01/01/[Android]LayoutInflateé‡åˆ°çš„å‘/","link":"","permalink":"https://ttdevs.github.io/1970/01/01/[Android]LayoutInflateé‡åˆ°çš„å‘/","excerpt":"","text":"0x01 é—®é¢˜123456789101112131415161718192021222324252627private void initVoiceItem() &#123; viewMusicList.removeAllViews(); int localResource = SysPreferences.getAlarmVoiceResource(); LayoutInflater inflater = LayoutInflater.from(this); for (int i = 0; i &lt; VOICE_KEY.length; i++) &#123; View view = inflater.inflate(R.layout.item_voice_name, viewMusicList); // TODO: 2017/2/10 view.setOnClickListener(mClickListener); ... &#125;&#125;private final View.OnClickListener mClickListener = new View.OnClickListener() &#123; @Override public void onClick(View v) &#123; int size = viewMusicList.getChildCount(); for (int i = 0; i &lt; size; i++) &#123; View view = viewMusicList.getChildAt(i); ... if (v == view) &#123; &#123;...1...&#125; &#125; else &#123; &#123;...2...&#125; &#125; &#125; &#125;&#125;; æœ‰ä¸Šé¢ä¸€ä¸²ä»£ç ï¼Œä½ èƒ½å‘ç°æœ‰ä»€ä¹ˆé—®é¢˜å—ï¼Ÿ å—¯å—¯ï¼Œæ˜¯è¿™æ ·çš„ï¼šåªä¼šæ‰§è¡Œä»£ç å—{1}ï¼Œå¹¶æ²¡æœ‰åƒæˆ‘ä»¬æœŸå¾…çš„é‚£æ ·ç‚¹å‡»çš„æ—¶å€™æ‰§è¡Œåˆ°ä»£ç å—{2}ä¸­å»ã€‚æ²¡æœ‰ç»†ç©¶ï¼Œé€šè¿‡ä¸‹é¢çš„ä»£ç ç›´æ¥è·¨è¿‡å»ï¼š 123456789101112private void initVoiceItem() &#123; viewMusicList.removeAllViews(); int localResource = SysPreferences.getAlarmVoiceResource(); LayoutInflater inflater = LayoutInflater.from(this); for (int i = 0; i &lt; VOICE_KEY.length; i++) &#123; View view = inflater.inflate(R.layout.item_voice_name, null); // TODO: 2017/2/10 view.setOnClickListener(mClickListener); ... viewMusicList.addView(view); &#125;&#125; è™½ç„¶ä¸çŸ¥é“ä»€ä¹ˆåŸå› ï¼Œä½†æ˜¯æ‰¾åˆ°è§£å†³åŠæ³•ï¼Œä¸è¿‡è¿˜æ˜¯æŒºæƒ­æ„§çš„Â·Â·Â·Â·Â·Â· 0x02 åˆ†æå¾ˆå¤šäººå¯èƒ½è·Ÿæˆ‘ä¸€æ ·ï¼Œå¼€å§‹å­¦çš„æ—¶å€™ï¼Œè®°ä½è¯¥æ€ä¹ˆå†™ï¼Œè¿™ä¸ªæ–¹æ³•æ˜¯å¹²å˜›çš„ã€‚ä½†æ˜¯å¾ˆéš¾é¿å…ä¼šè®°é”™æŸä¸ªæ–¹æ³•ï¼Œå°±åƒæˆ‘ä»¬ä¼šå†™é”™æŸä¸ªå­—ä¸€æ ·ï¼Œå½“åˆ«äººçº æ­£çš„æ—¶å€™æ‰çŸ¥é“ï¼Œè¿™ä¸ªå­—è‡ªå·±å·²ç»å†™é”™åå‡ æ´»ç€å‡ åå¹´äº†ã€‚æ¥çœ‹ä¸€ä¸‹ View.inflate() è¿™ä¸ªæ–¹æ³•ï¼š 1234567891011121314/*** Inflate a new view hierarchy from the specified xml resource. Throws* &#123;@link InflateException&#125; if there is an error.* * @param resource ID for an XML layout resource to load (e.g.,* &lt;code&gt;R.layout.main_page&lt;/code&gt;)* @param root Optional view to be the parent of the generated hierarchy.* @return The root View of the inflated hierarchy. If root was supplied,* this is the root View; otherwise it is the root of the inflated* XML file.*/public View inflate(@LayoutRes int resource, @Nullable ViewGroup root) &#123; return inflate(resource, root, root != null);&#125; å¦‚æœæˆ‘ä»¬ä¼ å…¥äº† root Viewï¼Œé‚£ä¹ˆè¿”å›çš„å°±æ˜¯root Viewï¼Œ å¦‚æœä¸ä¼ ï¼Œåˆ™è¿”å›æ ¹æ®å¸ƒå±€æ–‡ä»¶ç”Ÿæˆçš„ Viewã€‚è€Œæ ¹æ®æˆ‘ä¸Šé¢çš„ä»£ç ï¼Œæ˜¾ç„¶è¢«æˆ‘é”™è¯¯çš„ç†è§£ï¼Œæ— è®ºä¼ ä¸ä¼  root Viewï¼Œè¿”å›çš„éƒ½æ˜¯æ ¹æ®å¸ƒå±€æ–‡ä»¶ç”Ÿæˆçš„ Viewï¼Œè€Œæˆ‘å°±è¿™ä¹ˆç›¸å®‰æ— äº‹çš„ç”¨äº†å¥½å‡ å¹´Â·Â·Â·Â·Â·Â· 0x03 ä½ ä»¥ä¸ºè¿™å°±è¿™æ ·ç»“æŸäº†å¦‚æœä½ æ‰§è¡Œæˆ‘çš„é”™è¯¯ä»£ç ï¼Œä½ ä¼šçœ‹åˆ°ä¸‹é¢è¿™ä¸ªå›¾ï¼š è¿™ä¸ªè¿™ä¸ªå›¾æœ‰ä¸¤ä¸ªä¿¡æ¯ï¼š åé¢å‡ ä¸ªItemæ˜¾ç¤ºçš„åç§°æ˜¯é”™è¯¯çš„ ç‚¹å‡»æŸä¸ªItemï¼Œå…¶ä»–å‡ ä¸ªItemçš„checkboxä¹Ÿè¢«é€‰æ‹© æˆ‘ä»¬æŒ‰ç…§é”™è¯¯çš„ä»£ç æ‰§è¡Œçš„é€»è¾‘è¿›è¡Œåˆ†æã€‚é¦–å…ˆï¼š 1234for (int i = 0; i &lt; VOICE_KEY.length; i++) &#123; View view = inflater.inflate(R.layout.item_voice_name, viewMusicList); ...&#125; è¿™æ®µä»£ç ä¼šå¾ªç¯å¤šæ¬¡ï¼Œå°†inflateåçš„å¸ƒå±€æ·»åŠ åˆ°viewMusicListï¼Œè¿™æ ·viewMusicListä¸‹é¢å°±æœ‰å¤šä¸ª item_voice_name å› æ­¤æœ€ç»ˆç»™æˆ‘ä»¬å±•ç°çš„ç»“æœå°±æ˜¯çœ‹åˆ°æœ‰å¤šä¸ªItemã€‚ å¯¹äºç¬¬ä¸€ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬éœ€è¦ä» view.findViewById() è¯´èµ·ï¼Œä»Viewä¸­ä½ ä¼šå‘ç°è¿™ä¸¤æ®µä»£ç ï¼š 1234567891011121314151617181920212223242526/*** Look for a child view with the given id. If this view has the given* id, return this view.** @param id The id to search for.* @return The view that has the given id in the hierarchy or null*/@Nullablepublic final View findViewById(@IdRes int id) &#123; if (id &lt; 0) &#123; return null; &#125; return findViewTraversal(id);&#125;/*** &#123;@hide&#125;* @param id the id of the view to be found* @return the view of the specified id, null if cannot be found*/protected View findViewTraversal(@IdRes int id) &#123; if (id == mID) &#123; return this; &#125; return null;&#125; æ˜¯ä¸æ˜¯å¤ªç®€å•ï¼Œæ ¹æœ¬æ²¡æ‰¾åˆ°æˆ‘ä»¬æœŸå¾…çš„é€»è¾‘â€”â€”ViewGroupä¸­æ€ä¹ˆå¤„ç†ï¼Œç»†å¿ƒçš„ä½ ä¼šå‘ç°ViewGroupé‡å†™äº† findViewTraversal() æ–¹æ³•ï¼š 1234567891011121314151617181920212223@Overrideprotected View findViewTraversal(@IdRes int id) &#123; if (id == mID) &#123; return this; &#125; final View[] where = mChildren; final int len = mChildrenCount; for (int i = 0; i &lt; len; i++) &#123; View v = where[i]; if ((v.mPrivateFlags &amp; PFLAG_IS_ROOT_NAMESPACE) == 0) &#123; v = v.findViewById(id); if (v != null) &#123; return v; &#125; &#125; &#125; return null;&#125; ä»è¿™æ®µä»£ç å¯ä»¥çœ‹å‡ºï¼Œåœ¨ViewGroupä¸­æ ¹æ®IDæŸ¥æ‰¾ï¼Œæ‰¾åˆ°å°±è¿”å›ï¼Œè€Œæ‰¾åˆ°çš„æ°¸è¿œæ˜¯æœ€å‰é¢çš„Viewã€‚è¿™å°±è§£é‡Šäº†ä¸ºä»€ä¹ˆç¬¬ä¸€ä¸ªItemå’Œå…¶ä»–çš„ä¸åŒäº†ã€‚ ï¼ˆå¯¹äºç‚¹å‡»æŸä¸ªItemï¼Œå…¶ä»–Itemä¹Ÿå‡ºç°æ³¢çº¹æ•ˆæœï¼ŒçŒœæµ‹å¯èƒ½æ˜¯å› ä¸ºæ³¢çº¹æ•ˆæœæ˜¯æ ¹æ®IDæ¥å®ç°çš„ã€‚TODO ï¼‰ 0x04 æ€»ç»“ä¸Šé¢é‡åˆ°çš„View inflateæ˜¯æˆ‘ä¸ªäººé‡åˆ°çš„é—®é¢˜ï¼Œä¸»è¦æ˜¯å› ä¸ºå¯¹åŸºç¡€çŸ¥è¯†æŒæ¡æœ‰é—®é¢˜ã€‚å¦å¤–åœ¨ä½¿ç”¨inflateçš„æ—¶å€™ï¼Œå¯èƒ½è¿˜ä¼šé‡åˆ°LayoutParamè®¾ç½®æ— æ•ˆçš„é—®é¢˜ï¼Œè¿™ä¸ªå¯ä»¥é€šè¿‡å¥—ä¸€ä¸ªViewçš„æ–¹å¼è§£å†³ï¼Œä»…æ­¤è®°å½•ã€‚","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"https://ttdevs.github.io/categories/æŠ€æœ¯/"}],"tags":[{"name":"Android","slug":"Android","permalink":"https://ttdevs.github.io/tags/Android/"}]},{"title":"ã€ŒAndroidã€ä»æµè§ˆå™¨ä¸­æ‰“å¼€æˆ‘ä»¬çš„åº”ç”¨","slug":"[Android]ä»æµè§ˆå™¨ä¸­æ‰“å¼€æˆ‘ä»¬çš„åº”ç”¨","date":"1969-12-31T16:00:00.000Z","updated":"2017-04-27T11:07:57.000Z","comments":true,"path":"1970/01/01/[Android]ä»æµè§ˆå™¨ä¸­æ‰“å¼€æˆ‘ä»¬çš„åº”ç”¨/","link":"","permalink":"https://ttdevs.github.io/1970/01/01/[Android]ä»æµè§ˆå™¨ä¸­æ‰“å¼€æˆ‘ä»¬çš„åº”ç”¨/","excerpt":"","text":"0x01 éœ€æ±‚æœ‰æ—¶å€™ä½ ä¼šå‘ç°ï¼Œç”¨Androidç³»ç»Ÿè‡ªå¸¦çš„æµè§ˆå™¨ï¼ˆchromeï¼‰æ‰“å¼€ä¸€ä¸ªwebé¡µé¢ï¼Œå¦‚æœå®‰è£…äº†ç›¸åº”çš„Appï¼Œå°±ä¼šè‡ªåŠ¨æ‰“å¼€è¿™ä¸ªAppå¹¶è¿›å…¥å…·ä½“çš„ç•Œé¢ä¸­ï¼Œæ¯”å¦‚æ‰‹æœºä¸Šæ‰“å¼€ï¼š https://www.zhihu.com/openinapp_instruction?app-id=432274380&amp;app-argument=zhihu://questions/24122524 å¦‚æœæˆ‘ä»¬å®‰è£…äº†çŸ¥ä¹æ‰‹æœºå®¢æˆ·ç«¯ï¼Œè¿™ä¸ªæ—¶å€™ä¼šè‡ªåŠ¨æ‰“å¼€çŸ¥ä¹æ‰‹æœºå®¢æˆ·ç«¯ï¼Œå¹¶ä¸”è¿›å…¥é—®é¢˜å±•ç¤ºç•Œé¢ã€‚è¿˜æ¯”å¦‚ç½‘æ˜“äº‘éŸ³ä¹ï¼Œä»Šæ—¥å¤´æ¡ç­‰ç­‰Appéƒ½æ˜¯æ”¯æŒè¿™ä¸ªåŠŸèƒ½çš„ã€‚ä¹‹å‰æˆ‘ä»¬è‡ªå®¶Appçš„åˆ†äº«éƒ½æ˜¯æ‰“å¼€ä¸€ä¸ªAppä»‹ç»çš„ç•Œé¢ï¼Œå³ä½¿å®‰è£…äº†æ‰‹æœºå®¢æˆ·ç«¯ï¼Œä¹Ÿä¸ä¼šè‡ªåŠ¨æ‰“å¼€æ‰‹æœºå®¢æˆ·ç«¯ã€‚ä¸ºäº†è¿½æ±‚æ›´å¥½çš„ä½“éªŒï¼Œæˆ‘ä»¬éœ€è¦å®ç°è¿™ä¸ªåŠŸèƒ½ã€‚ 0x01 Chromeæµè§ˆå™¨ç ”ç©¶è¿™ä¸ªåŠŸèƒ½ï¼Œè¿˜æ˜¯æŸ¥é˜…äº†ä¸å°‘èµ„æ–™ï¼Œæ¯”å¦‚ app linkã€deep linkã€chrome browserç­‰ç­‰ï¼Œå¦‚æœç´§ç´§æ˜¯å®ç°ä¸Šé¢ä»‹ç»çš„åŠŸèƒ½ï¼Œè¿˜æ˜¯ so easyçš„ï¼Œä»…ä»…éœ€è¦äº†è§£ Chrome æµè§ˆå™¨ åˆ›å»º Intent çš„æ–¹æ³•å³å¯ã€‚ Chromeæ„é€ ä¸€ä¸ª Intent çš„åŸºæœ¬è¯­æ³•å¦‚ä¸‹ï¼š 123456789intent: HOST/URI-path // Optional host #Intent; package=[string]; action=[string]; category=[string]; component=[string]; scheme=[string]; end; æ ¹æ®ä¸Šé¢çš„è¯­æ³•ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªdemoï¼š 123456intent: //article/51348656 #Intent; package=com.ttdevs.android; scheme=ttdevs; end; å¯ä»¥ä½¿ç”¨ä¸‹é¢çš„ html ä»£ç è§¦å‘è¿™ä¸ªäº‹ä»¶ï¼š 1&lt;a href=\"intent://article/51348656/#Intent;scheme=ttdevs;package=com.ttdevs.android;end\"&gt;ttdevs&lt;/a&gt; å¦å¤–è¿˜æœ‰ä¸ªå‚æ•°ï¼š 1S.browser_fallback_url=[encoded_full_url] ä»‹ç»å¦‚ä¸‹ï¼ˆä¸è¿‡æˆ‘æ²¡ææ˜ç™½ï¼‰ï¼š When an intent could not be resolved, or an external application could not be launched, then the user will be redirected to the fallback URL if it was given.Some example cases where Chrome does not launch an external application are as follows: The intent could not be resolved, i.e., no app can handle the intent. JavaScript timer tried to open an application without user gesture.Note that S. is a way to define string extras. S.browser_fallback_url was chosen for backward compatibility, but the target app wonâ€™t see browser_fallback_url value as Chrome removes it. 0x02 Appå†…å¤„ç†æµè§ˆå™¨å‘æ¥çš„Intenté€šè¿‡ä¸Šé¢çš„ä»‹ç»ï¼Œå¦‚æœæˆ‘ä»¬ç‚¹å‡»é“¾æ¥ï¼Œå°±ä¼šè§¦å‘ä¸€ä¸ª Intentï¼Œæœ‰äº†Intentï¼Œæˆ‘ä»¬è¿˜éœ€è¦æ¥å¤„ç†å®ƒã€‚åœ¨ AndroidManifest.xml ä¸­ç›¸åº”çš„ Activity ä¸­çš„é…ç½®ä¸­æ·»åŠ å¦‚ä¸‹filterï¼š 1234567&lt;intent-filter&gt; &lt;action android:name=\"android.intent.action.VIEW\"/&gt; &lt;category android:name=\"android.intent.category.DEFAULT\"/&gt; &lt;category android:name=\"android.intent.category.BROWSABLE\"/&gt; &lt;data android:host=\"article\" android:pathPattern=\"/.*\" android:scheme=\"ttdevs\"/&gt;&lt;/intent-filter&gt; åŒæ—¶åœ¨Activityä¸­å¤„ç†Intentï¼š 1234567891011121314151617public class RouterActivity extends BaseActivity &#123; @Override protected void onCreate(Bundle savedInstanceState) &#123; super.onCreate(savedInstanceState); setContentView(R.layout.activity_router); handleIntent(getIntent()); &#125; private void handleIntent(Intent intent) &#123; String action = intent.getAction(); String data = intent.getDataString(); LogUtils.debug(action); LogUtils.debug(data); &#125;&#125; è¿è¡Œä¸Šé¢çš„ä»£ç ï¼ŒåŒæ—¶ç”¨ç³»ç»Ÿæµè§ˆå™¨æ‰“å¼€ä¸Šé¢çš„htmlï¼Œç‚¹å‡»é“¾æ¥ï¼Œå³å¯è°ƒèµ·æˆ‘ä»¬çš„appã€‚æˆ–è€…ä¹Ÿå¯ä»¥é€šè¿‡ä¸‹é¢çš„adbå‘½ä»¤è§¦å‘ï¼š 1234adb shell am start \\-a android.intent.action.VIEW \\-c android.intent.category.BROWSABLE \\-d &quot;ttdevs://article/12345&quot; com.ttdevs.android åœ¨æˆ‘çš„è®¾å¤‡ï¼ˆé­…æ—MX4 Proï¼‰ä¸Šï¼Œå¦‚æœæ²¡æœ‰å®‰è£…å¤„ç†è¿™ä¸ª Intent çš„Appï¼Œåˆ™ä¼šæ‰“å¼€ç³»ç»Ÿè‡ªå¸¦çš„åº”ç”¨å¸‚åœºã€‚ å¯¹äºä¸€ä¸ªæä¾›æŸ¥è¯¢é£Ÿç‰©æ•°æ®çš„Appï¼Œå¦‚æœæˆ‘ä»¬åˆ†äº«å‡ºå»çš„é£Ÿç‰©ä¿¡æ¯å¸¦ä¸Šäº†ç›¸å…³çš„å‚æ•°ï¼Œåœ¨ç”¨æˆ·ç‚¹å‡»åˆ†äº«é“¾æ¥æ—¶ï¼Œå¦‚æœå®‰è£…äº†æˆ‘ä»¬çš„Appåˆ™å¯ä»¥è·³åˆ°Appä¸­å±•ç¤ºé£Ÿç‰©çš„ç•Œé¢ï¼Œå¦‚æœæ²¡æœ‰å®‰è£…ï¼Œåˆ™ä¼šè·³åˆ°åº”ç”¨å¸‚åœºä¸‹è½½ï¼Œå¾ˆå¥½çš„é€»è¾‘ï½ï½ 0xFF å‚è€ƒ https://developer.chrome.com/multidevice/android/intents","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"https://ttdevs.github.io/categories/æŠ€æœ¯/"}],"tags":[{"name":"Android","slug":"Android","permalink":"https://ttdevs.github.io/tags/Android/"}]},{"title":"ã€ŒAndroidã€ä½¿ç”¨VideoViewå’ŒMediaControllerè¿›è¡Œè§†é¢‘æ’­æ”¾","slug":"[Android]ä½¿ç”¨VideoViewå’ŒMediaControllerè¿›è¡Œè§†é¢‘æ’­æ”¾","date":"1969-12-31T16:00:00.000Z","updated":"2017-04-27T11:07:57.000Z","comments":true,"path":"1970/01/01/[Android]ä½¿ç”¨VideoViewå’ŒMediaControllerè¿›è¡Œè§†é¢‘æ’­æ”¾/","link":"","permalink":"https://ttdevs.github.io/1970/01/01/[Android]ä½¿ç”¨VideoViewå’ŒMediaControllerè¿›è¡Œè§†é¢‘æ’­æ”¾/","excerpt":"","text":"123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119/** * è§†é¢‘æ’­æ”¾çš„activity&lt;br&gt; * ä½¿ç”¨æ–¹æ³•ï¼š&lt;br&gt; * 1ã€AndroidManifest.xmlä¸­æ·»åŠ æ­¤activity&lt;br&gt; * 2ã€Intentä¸­å­˜å…¥å¾…æ’­æ”¾è§†é¢‘çš„URLï¼Œæ”¯æŒæœ¬åœ°å’Œç½‘ç»œ&lt;br&gt; * 3ã€å¯åŠ¨è¿™ä¸ªactivity&lt;br&gt; * &lt;br&gt; * exampleï¼š&lt;br&gt; * String url = \"play url\";&lt;br&gt; * Intent intent = new Intent();&lt;br&gt; * intent.setClass(this, VideoPlayActivity.class);&lt;br&gt; * intent.putExtra(VideoPlayActivity.KEY_URL, url);&lt;br&gt; * startActivity(intent);&lt;br&gt; * * @author ttworking */public class VideoPlayActivity extends Activity implements OnPreparedListener, OnErrorListener &#123; public static final String KEY_URL = \"view_url\"; private static final String TAG = \"VideoPlayActivity\"; private static final int PLAY_RETURN = 2 * 1000; // 2 seconds private static final String KEY_PLAY_POSITON = \"paly_position\"; private static final String TOAST_ERROR_URL = \"Paly url is null, please check parameter:\" + KEY_URL; private static final String TOAST_ERROR_PLAY = \"Paly error, please check url exist!\"; private static final String DIALOG_TITILE = \"å¥‹åŠ›åŠ è½½ä¸­ï¼Œè¯·ç¨å...\"; private static String url; private ProgressDialog progressDialog; private MediaController mc; private VideoView videoView; private LinearLayout llMain; private LayoutParams params = new LayoutParams(LayoutParams.MATCH_PARENT, LayoutParams.MATCH_PARENT); @Override protected void onCreate(Bundle savedInstanceState) &#123; super.onCreate(savedInstanceState); url = getIntent().getStringExtra(KEY_URL); if (url == null &amp;&amp; savedInstanceState != null) &#123; url = savedInstanceState.getString(KEY_URL); &#125; if (url == null) &#123; Toast.makeText(getApplicationContext(), TOAST_ERROR_URL, Toast.LENGTH_LONG).show(); finish(); return; &#125; setTheme(android.R.style.Theme_NoTitleBar_Fullscreen); videoView = new VideoView(this); videoView.setVideoURI(Uri.parse(url)); videoView.requestFocus(); videoView.setOnPreparedListener(this); videoView.setOnErrorListener(this); mc = new MediaController(this); mc.setAnchorView(videoView); mc.setKeepScreenOn(true); videoView.setMediaController(mc); llMain = new LinearLayout(this); llMain.setGravity(Gravity.CENTER_VERTICAL); llMain.setOrientation(LinearLayout.VERTICAL); llMain.setLayoutParams(params); llMain.addView(videoView, params); setContentView(llMain); initDialog(); &#125; @Override protected void onSaveInstanceState(Bundle outState) &#123; super.onSaveInstanceState(outState); int palyPosition = videoView.getCurrentPosition(); if (palyPosition &gt; PLAY_RETURN) &#123; palyPosition -= PLAY_RETURN; &#125; outState.putInt(KEY_PLAY_POSITON, palyPosition); outState.putString(KEY_URL, url); &#125; @Override protected void onRestoreInstanceState(Bundle savedInstanceState) &#123; super.onRestoreInstanceState(savedInstanceState); videoView.seekTo(savedInstanceState.getInt(KEY_PLAY_POSITON)); &#125; @Override public void onPrepared(MediaPlayer mp) &#123; progressDialog.cancel(); videoView.start(); &#125; @Override public boolean onError(MediaPlayer mp, int what, int extra) &#123; Log.d(TAG, \"onError:\" + url); Toast.makeText(getApplicationContext(), TOAST_ERROR_PLAY + \"\\n\" + url, Toast.LENGTH_LONG).show(); progressDialog.cancel(); finish(); return true; &#125; private void initDialog() &#123; progressDialog = new ProgressDialog(this); progressDialog.setProgressStyle(ProgressDialog.STYLE_SPINNER); progressDialog.setMessage(DIALOG_TITILE); progressDialog.setCancelable(false); progressDialog.show(); &#125;&#125;","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"https://ttdevs.github.io/categories/æŠ€æœ¯/"}],"tags":[{"name":"Android","slug":"Android","permalink":"https://ttdevs.github.io/tags/Android/"}]},{"title":"ã€ŒAndroidã€ä»¿è”ç³»äººåˆ—è¡¨ä¸Šçš„å­—æ¯ç´¢å¼•","slug":"[Android]ä»¿è”ç³»äººåˆ—è¡¨ä¸Šçš„å­—æ¯ç´¢å¼•","date":"1969-12-31T16:00:00.000Z","updated":"2017-04-27T11:07:57.000Z","comments":true,"path":"1970/01/01/[Android]ä»¿è”ç³»äººåˆ—è¡¨ä¸Šçš„å­—æ¯ç´¢å¼•/","link":"","permalink":"https://ttdevs.github.io/1970/01/01/[Android]ä»¿è”ç³»äººåˆ—è¡¨ä¸Šçš„å­—æ¯ç´¢å¼•/","excerpt":"","text":"è¿™ä¸ªå°åŠŸèƒ½githubæœ‰å¾ˆå¤šã€‚ä¸åŒçš„åº”ç”¨éœ€æ±‚ä¼šæœ‰å°‘è®¸å·®åˆ«ï¼Œæ¯”å¦‚listviewæ»‘åŠ¨æ—¶å­—æ¯æ˜¯ä¸æ˜¯è·Ÿéšæ»‘åŠ¨ï¼›æ‰‹åŠ¨ç‚¹å‡»å­—æ¯æ˜¯ä¸æ˜¯åœ¨å±å¹•ä¸­é—´æ˜¾ç¤ºä¸€ä¸ªæç¤ºï¼›ç‚¹å‡»æ—¶ç´¢å¼•çš„èƒŒæ™¯æ˜¾ç¤ºå‡ºæ¥ï¼Œç¦»å¼€åèƒŒæ™¯æ¶ˆå¤±ç­‰ç­‰ï¼Œå½“ç„¶è¿™äº›éƒ½æ˜¯ç»†èŠ‚é—®é¢˜ã€‚å®ç°æ€è·¯ä¸Šä¹Ÿå¯ä»¥æœ‰å¤šç§ï¼Œæ¯”å¦‚è‡ªå·±å»drawæ¯ä¸ªå­—æ¯ï¼Œç„¶åå¤„ç†æ»‘åŠ¨ã€å€ŸåŠ©TextViewæ¥å±•ç¤ºå­—æ¯åˆ—è¡¨ç­‰ã€‚çœ‹äº†å‡ ä¸ªdemoï¼Œæ„Ÿè§‰å’Œè‡ªå·±çš„éœ€æ±‚æœ‰äº›å·®åˆ«ï¼Œè€Œä¸”è¿™äº›demoä¸ºäº†å®ç°â€å¤§è€Œå…¨â€æœ‰äº›å¤šä½™çš„ä¸œè¥¿ï¼Œå› æ­¤å†³å®šè‡ªå·±å†™ä¸ªã€‚ 0x01 åˆ†ææˆ‘ä»¬çš„éœ€æ±‚æ˜¯è¿™æ ·çš„ï¼šä¸­æ–‡å‚ä¸ç´¢å¼•ï¼Œå­—æ¯æˆ–è€…å…¶ä»–å¼€å¤´çš„itemä¸å‚ä¸ç´¢å¼•ï¼Œç›´æ¥æ”¾åˆ°ç¬¬ä¸€ä¸ªâ€œ#â€é‡Œï¼›ç‚¹å‡»å­—æ¯ç´¢å¼•å…¶è¢«ç‚¹å‡»å­—æ¯åˆ—è¡¨é¢œè‰²è·Ÿéšå˜åŒ–ï¼›æ‰‹åŠ¨æ»‘åŠ¨listviewå­—æ¯ç´¢å¼•çš„å­—æ¯é¢œè‰²ä¹Ÿè·Ÿéšå˜åŒ–ï¼›è‡ªå·±é¡ºæ‰‹åŠ äº†ä¸ªç‚¹å‡»æŸä¸ªå­—æ¯å¼¹å‡ºæç¤ºçš„æ¥å£ã€‚æœ€åæ•ˆæœå¦‚ä¸‹å›¾ï¼š 0x02 å®ç°å†³å®šç›´æ¥ä½¿ç”¨å‚ç›´æ–¹å‘çš„LinearLayoutåµŒå¥—TextViewæ¥å±•ç¤ºå­—æ¯åˆ—è¡¨ã€‚æ€è·¯å¦‚ä¸‹ï¼šæ ¹æ®ç´¢å¼•é«˜åº¦ï¼Œå¤§æ¦‚è®¡ç®—æ¯ä¸ªå­—æ¯çš„é«˜åº¦ï¼Œç„¶åæ·»åŠ åˆ°Linearlayoutä¸­ï¼›ç„¶åå¤„ç†Linearlayoutçš„touchäº‹ä»¶ï¼Œæ‹¿åˆ°åæ ‡è®¡ç®—å½“å‰åº”è¯¥ç´¢å¼•å“ªä¸ªã€‚å…¶ä¸­é‡åˆ°çš„ä¸»è¦é—®é¢˜æ˜¯å¯¹TextViewçš„æŠŠæ¡ï¼Œæ¯”å¦‚å®ƒçš„é«˜åº¦å¦‚ä½•è®¡ç®—ï¼Ÿï¼ˆçœŸæ­£å®ç°çš„æ—¶å€™ä½ ä¼šå‘ç°å®ƒæœ‰ä¸ªpaddingTopå’ŒpaddingBottomï¼‰å…¶ä»–çš„æ¯”å¦‚æ»‘åŠ¨é€»è¾‘è¿™äº›è°ƒè¯•ä¸‹å³å¯ï¼Œç›´æ¥ä¸Šä»£ç ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238/** * å³ä¾§å­—æ¯ç´¢å¼•ã€‚å¯ä½œä¸ºä¸€ä¸ªç‹¬ç«‹çš„viewæ’å…¥è‡ªå·±çš„å¸ƒå±€ä¸­&lt;br&gt; * &lt;br&gt; * æè¿°ï¼š&lt;br&gt; * çº¿å‹å¸ƒå±€ä¸­åµŒå¥—ä¸€ä¸ªçº¿å‹å¸ƒå±€ï¼ˆç›®çš„ä¸ºäº†å¢å¤§å¯æ»‘åŠ¨åŒºåŸŸçš„é¢ç§¯ï¼Œè‹¥ä¸è€ƒè™‘æ­¤å¯ä¸ä½¿ç”¨åµŒå¥—ï¼‰ã€‚&lt;br&gt; * æ¯ä¸ªå­—æ¯æ’å…¥å†…åµŒçš„çº¿æ€§å¸ƒå±€ä¸­ï¼Œæ ¹æ®æ§ä»¶çš„é«˜åº¦è®¡ç®—æ¯ä¸ªå­—æ¯çš„å°ºå¯¸ã€‚&lt;br&gt; * &lt;br&gt; * ä½¿ç”¨ï¼š&lt;br&gt; * å°†æ­¤viewæ’å…¥ä½ çš„å¸ƒå±€æ–‡ä»¶ä¸­ï¼Œåˆå§‹åŒ–å®Œæˆä¹‹åè®¾ç½®ä½ çš„ListViewå’Œç´¢å¼•ç”¨çš„æ•°æ®æº(éœ€è¦è‡ªå·±ç»„ç»‡æ’åºæ•°æ®æº)å³å¯ã€‚&lt;br&gt; * &lt;br&gt; * æ•°æ®æºçš„ç»„ç»‡ï¼šè‹¥æŸé¡¹ä¸å‚ä¸æ’åºåˆ™æ•°æ®æºä¸­è®¾ç½®ä¸º'0'æˆ–å…¶ä»–å°äº'A'çš„ASCIIå­—ç¬¦ï¼Œå†…éƒ¨ä¼šå°†æ‰€æœ‰å­—ç¬¦è½¬æ¢æˆå¤§å†™ï¼Œæ‰€ä»¥åŠ¡å¿…åœ¨å¤–éƒ¨åšå¥½æ’åºã€‚&lt;br&gt; * &lt;br&gt; * å»ºè®®ï¼šè‹¥ä½ çš„æ•°æ®ä¸­åŒ…æ‹¬ASCIIç ä¸ºa0ã€20çš„å­—ç¬¦ï¼Œå»ºè®®å‰”é™¤ï¼Œå¦‚ï¼š&lt;br&gt; * str.replace(' ', ' '); // a0-&gt;20 str.replaceAll(\" \", \"\");&lt;br&gt; * &lt;br&gt; * å¦‚æœä½ å¤„ç†çš„æ˜¯ä¸­æ–‡ï¼Œå¯ä½¿ç”¨libsä¸­çš„pinyin4jå¤„ç† * * @author ttdevs 2014-07-31 */public class ListViewLetterIndicator extends LinearLayout implements OnScrollListener &#123; private static final String INDICATOR = \"#ABCDEFGHIJKLMNOPQRSTUVWXYZ\"; private LinearLayout llMain; private ListView mListView; // ListView private List&lt;String&gt; mData; // æ•°æ®æº private TextView tvAlert; // æ˜¾ç¤ºå½“å‰çš„å­—æ¯ private int mIndex; // å½“å‰æ‰€å¤„çš„indicatorä½ç½® private boolean scrollable = true; // public ListViewLetterIndicator(Context context) &#123; this(context, null); &#125; public ListViewLetterIndicator(Context context, AttributeSet attrs) &#123; super(context, attrs); setOrientation(LinearLayout.VERTICAL); setBackgroundColor(getResources().getColor(R.color.letter_indicator_background)); // setPadding(8, 8, 8, 8); llMain = new LinearLayout(getContext()); llMain.setOrientation(LinearLayout.VERTICAL); llMain.setGravity(Gravity.CENTER); // llMain.setPadding(2, 2, 2, 2); int width = (int) getResources().getDimension(R.dimen.letter_indicator_width); addView(llMain, width, LinearLayout.LayoutParams.MATCH_PARENT); &#125; /** * è®¾ç½®æ•°æ®æº * * @param lv ç»‘å®šçš„ListView * @param data æ’åºç”¨çš„æ•°æ®æº */ public void setData(ListView lv, List&lt;String&gt; data) &#123; setData(lv, data, null); &#125; /** * è®¾ç½®æ•°æ®æº * * @param lv ç»‘å®šçš„ListView * @param data æ’åºç”¨çš„æ•°æ®æº * @param tv æ˜¾ç¤ºå½“å‰æ‰€å¤„å­—æ¯çš„TextView */ @SuppressLint(\"DefaultLocale\") public void setData(ListView lv, List&lt;String&gt; data, TextView tv) &#123; mListView = lv; mData = data; tvAlert = tv; for (int i = 0; i &lt; mData.size(); i++) &#123; String str = mData.get(i); mData.set(i, str.toUpperCase()); &#125; mListView.setOnScrollListener(this); mIndex = 0; &#125; @Override protected void onLayout(boolean changed, int left, int top, int right, int bottom) &#123; super.onLayout(changed, left, top, right, bottom); initView(); &#125; private void initView() &#123; int childCount = llMain.getChildCount(); if (childCount == INDICATOR.length()) &#123; // llMain.invalidate(); return; &#125; int height = llMain.getHeight(); int textHeight = (int) Math.floor(height / (INDICATOR.length() + 6)); LinearLayout.LayoutParams llpText = new LinearLayout.LayoutParams(LinearLayout.LayoutParams.WRAP_CONTENT, LinearLayout.LayoutParams.WRAP_CONTENT); for (int i = 0; i &lt; INDICATOR.length(); i++) &#123; String str = String.valueOf(INDICATOR.charAt(i)); TextView tvIndicator = new TextView(getContext()); tvIndicator.setText(str); tvIndicator.setIncludeFontPadding(false); tvIndicator.setTextSize(TypedValue.COMPLEX_UNIT_PX, textHeight); tvIndicator.setTextColor(getResources().getColor(R.color.letter_indicator_text_normal)); // tvIndicator.setPadding(0, -4, 0, -4); llMain.addView(tvIndicator, llpText); &#125; &#125; @SuppressLint(\"DefaultLocale\") @Override public boolean dispatchTouchEvent(MotionEvent ev) &#123; int action = ev.getAction(); switch (action) &#123; case MotionEvent.ACTION_DOWN: case MotionEvent.ACTION_MOVE: scrollable = false; float y = ev.getY(); float childY = 0; int index = 0; for (int i = 0; i &lt; INDICATOR.length(); i++) &#123; TextView view = (TextView) llMain.getChildAt(i); childY = view.getTop(); int height = view.getHeight(); if (childY &lt; y &amp;&amp; childY + height &gt; y) &#123; index = i; break; &#125; view = null; // not neccessary &#125; TextView view = (TextView) llMain.getChildAt(INDICATOR.length() - 1); if (y &gt; view.getTop()) &#123; index = INDICATOR.length() - 1; &#125; view = null; changeIndicatorColor(index); char indexIndicator = INDICATOR.charAt(index);// A:65, #:23 if (indexIndicator &lt; 'A') &#123; mListView.setSelection(0); &#125; else &#123; for (int i = 0; i &lt; mData.size(); i++) &#123; if (mData.get(i).charAt(0) &gt;= indexIndicator) &#123; mListView.setSelection(i); return true; &#125; &#125; &#125; break; case MotionEvent.ACTION_UP: postDelayed(new Runnable() &#123; @Override public void run() &#123; scrollable = true; &#125; &#125;, 100); showText(\"\", false); break; default: break; &#125; return true; &#125; @Override public void onScrollStateChanged(AbsListView view, int scrollState) &#123; // invalidate(); &#125; @SuppressLint(\"DefaultLocale\") @Override public void onScroll(AbsListView view, int firstVisibleItem, int visibleItemCount, int totalItemCount) &#123; try &#123; if (!scrollable || null == mData || mData.size() == 0) &#123; return; &#125; if (null != mData) &#123; String str = mData.get(firstVisibleItem); char indicator = str.charAt(0); if (indicator &lt; 'A') &#123; changeIndicatorColor(0); return; &#125; for (int i = 1; i &lt; INDICATOR.length(); i++) &#123; if (INDICATOR.charAt(i) == indicator) &#123; changeIndicatorColor(i); return; &#125; &#125; &#125; &#125; catch (Exception e) &#123; e.printStackTrace(); &#125; &#125; private void changeIndicatorColor(int index) &#123; if (mIndex != 0 &amp;&amp; mIndex == index) &#123; return; &#125; TextView tv = (TextView) llMain.getChildAt(mIndex); tv.setTextColor(getResources().getColor(R.color.letter_indicator_text_normal)); tv = (TextView) llMain.getChildAt(index); tv.setTextColor(getResources().getColor(R.color.letter_indicator_text_select)); mIndex = index; showText(String.valueOf(INDICATOR.charAt(mIndex)), true); &#125; private void showText(String text, boolean isShow) &#123; if (null != tvAlert) &#123; tvAlert.setText(text); tvAlert.setVisibility(isShow ? View.VISIBLE : View.INVISIBLE); &#125; &#125; // private Drawable initBackground() &#123; // float[] roundRect = new float[] &#123; 12, 12, 12, 12, 12, 12, 12, 12 &#125;; // RoundRectShape reoundRechShape = new RoundRectShape(roundRect, null, // null); // ShapeDrawable drawable = new ShapeDrawable(reoundRechShape); // drawable.getPaint().setColor(Color.parseColor(GRAY_AA)); // // drawable.getPaint().setStyle(Paint.Style.FILL); // return drawable; // &#125;&#125; æµ‹è¯•è¿‡ç¨‹ä¸­å‘ç°ï¼Œæœ‰äº›itemæ˜æ˜æ˜¯æ±‰å­—å¼€å¤´çš„ï¼ˆè¿™ä¸ªæ—¶å€™ä½ å¯èƒ½è¿˜éœ€è¦ä¸ªæ±‰å­—è½¬æ‹¼éŸ³çš„å·¥å…·åŒ…ï¼‰ï¼Œå´å‡ºç°åœ¨â€œ#â€é‡Œï¼Œä»”ç»†æ£€æŸ¥ï¼Œä½ ä¼šå‘ç°ï¼Œé‚£ä¸ªå¹¶ä¸æ˜¯ç©ºæ ¼ï¼Œç»†èŠ‚è¯·çœ‹ä»£ç æ³¨é‡Šã€‚ ç”±äºå¾ˆç®€å•ï¼Œä¸åšè¯¦ç»†ä»‹ç»ï¼Œä»…ä»…åšä¸ªè®°å½•ï¼Œæœ‰é—®é¢˜å¯ä»¥ç•™è¨€ä¸€èµ·è®¨è®ºã€‚ 0x04 Demoæœ€åé™„ä¸ªæµ‹è¯•demoï¼š ä¸‹è½½","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"https://ttdevs.github.io/categories/æŠ€æœ¯/"}],"tags":[{"name":"Android","slug":"Android","permalink":"https://ttdevs.github.io/tags/Android/"}]},{"title":"ã€ŒAndroidã€å†…å­˜æ³„æ¼ç›¸å…³å†…å®¹æ€»ç»“(ä¸Š)","slug":"[Android]å†…å­˜æ³„æ¼ç›¸å…³å†…å®¹æ€»ç»“(ä¸Š)","date":"1969-12-31T16:00:00.000Z","updated":"2017-04-27T11:07:57.000Z","comments":true,"path":"1970/01/01/[Android]å†…å­˜æ³„æ¼ç›¸å…³å†…å®¹æ€»ç»“(ä¸Š)/","link":"","permalink":"https://ttdevs.github.io/1970/01/01/[Android]å†…å­˜æ³„æ¼ç›¸å…³å†…å®¹æ€»ç»“(ä¸Š)/","excerpt":"","text":"0x00 å¿æ‚”å¥½ä¹…æ²¡æœ‰è®¤çœŸçš„å†™åšå®¢äº†ï¼Œè‰ç¨¿ç®±ä¸­é™é™èººç€å¥½å‡ ç¯‡ï¼Œä½†æ€»æ˜¯ä¸èƒ½æŠŠä»–ä»¬å†™å®Œï¼Œä¸€ç›´æ²¡æœ‰å†™çš„å¿ƒæƒ…æŠŠï¼Œç½ªè¿‡â€¦ åºŸè¯ä¸€å¥è¯´å®Œï¼Œè¿›å…¥ä»Šå¤©çš„æ­£é¢˜ï¼šå†…å­˜æ³„éœ²çš„ç›¸å…³çŸ¥è¯†ã€‚ 0x01 å†…å­˜é—®é¢˜å¾ˆå¤šæ—¶å€™æˆ‘ä»¬æ˜¯éœ€è¦æŸ¥çœ‹è‡ªå·±çš„åº”ç”¨å†…å­˜å ç”¨æƒ…å†µï¼Œæ¯”å¦‚å½“å‡ºç°é—ªé€€ï¼Œå¼‚å¸¸é€€å‡ºæ—¶ï¼š ç•Œé¢å†…å­˜å ç”¨ï¼šæ¯”å¦‚æˆ‘ä»¬çš„å¯åŠ¨ç”»é¢ï¼Œå¦‚æœå‡ºç°OOMçš„é—®é¢˜ï¼Œè¿™ä¸ªæ—¶å€™å¯ä»¥é€šè¿‡å·®çœ‹å†…å­˜æƒ…å†µï¼Œå¦‚æœç¡®æ˜¯å†…å­˜å ç”¨æ¯”è¾ƒå¤§å°±å¯ä»¥è€ƒè™‘åšç›¸åº”ä¼˜åŒ– å†…å­˜æ³„æ¼çš„åˆæ­¥æŸ¥æ‰¾ï¼šè¿™ä¸ªå’Œç›´æ¥çš„OOMæœ‰äº›å·®åˆ«ï¼Œè™½ç„¶ä»–æœ€ç»ˆä¹Ÿä¼šå¯¼è‡´OOMã€‚æ–¹æ³•ï¼šåå¤æ‰“å¼€ã€å…³é—­å¯èƒ½å†…å­˜æ³„æ¼çš„ç•Œé¢ï¼Œå¦‚æœæ¯æ¬¡æ‰“å¼€å…³é—­ä¹‹åå†…å­˜éƒ½æœ‰æ‰€å¢åŠ ï¼Œå°±å¯ä»¥åˆæ­¥åˆ¤æ–­ä¸ºå†…å­˜æ³„æ¼ã€‚æ­£å¸¸æƒ…å†µåº”ç”¨æ˜¯è¿›å…¥ç•Œé¢å†…å­˜å ç”¨æœ‰æ‰€å¢åŠ ï¼Œä½†æ˜¯ç¦»å¼€åå†…å­˜ä¼šé™åˆ°ä¹‹å‰çš„æ°´å¹³ã€‚ 0x02 å†…å­˜æ³„æ¼ä¸å†…å­˜æº¢å‡º(OOM)çš„åŒºåˆ«ä¸è”ç³»å†…å­˜æº¢å‡ºåšandroidå¼€å‘çš„å„ä½åº”è¯¥æ˜¯æ¯”è¾ƒç†Ÿæ‚‰ï¼Œå›¾ç‰‡åŠ è½½ç¨å¾®ä¸å°å¿ƒå°±ä¼šå¯¼è‡´out of memoryçš„é”™è¯¯ï¼Œè¿™ä¸ªé”™è¯¯å‡ºç°çš„åŸå› å°±æ˜¯æˆ‘ä»¬çš„åº”ç”¨å»ç”³è¯·å†…å­˜æ—¶ç³»ç»Ÿæ— æ³•å†åˆ†é…å¯¼è‡´çš„ã€‚æ‰€ä»¥æˆ‘ä»¬éœ€è¦æœ‰èŠ‚åˆ¶çš„ä½¿ç”¨å†…å­˜ã€‚ å’ŒC++ç›¸æ¯”ï¼Œjavaçš„ä¸€ä¸ªå¾ˆå¤§ç‰¹ç‚¹å°±æ˜¯æœ‰GCï¼Œæˆ‘ä»¬ä¸éœ€è¦å»ä¸“æ³¨å†…å­˜çš„é‡Šæ”¾ä¸å›æ”¶ã€‚ä½†æ˜¯ï¼Œè¿™ä¹Ÿä¸æ˜¯ç»å¯¹çš„ï¼šå½“æˆ‘ä»¬çš„ä»£ç å‡ºç°é—®é¢˜å¯¼è‡´GCæ— æ³•åŠæ—¶çš„å›æ”¶ç›¸å…³çš„å†…å­˜æ—¶å°±ä¼šå¯¼è‡´å†…å­˜æ³„æ¼ã€‚è¿™å¥ä¸ç®—å¤ªè§„èŒƒçš„æè¿°ï¼ˆè¯­æ–‡å¤ªå·®ï¼Œè§è°…ï¼‰ä»–çš„é‡ç‚¹æ˜¯ä»€ä¹ˆå‘¢â€”â€”GCæ— æ³•åŠæ—¶çš„å›æ”¶ç›¸å…³å†…å­˜â€”â€”è¿™å°†å¯¼è‡´æˆ‘ä»¬çš„å†…å­˜å ç”¨è¶Šæ¥è¶Šå¤šâ€”â€”æœ€ç»ˆçš„ä½“ç°å°±æ˜¯OOMã€‚ å¸Œæœ›è¿™ä¸ªç®€å•çš„æè¿°ï¼Œå„ä½å¯ä»¥ç†è§£ä»€ä¹ˆæ˜¯memory leakå’ŒOOMã€‚ 0x03 DDMS ç»™æˆ‘ä»¬çš„æç¤º logcatä¸­çš„ä¿¡æ¯ å…³äºå†…å­˜çš„ä¿¡æ¯ï¼Œlogcatä¼šç»™æˆ‘ä»¬ä¸€äº›æç¤ºä¿¡æ¯ï¼Œæ¯”å¦‚ï¼š 1D/dalvikvm( 9050): GC_CONCURRENT freed 2049K, 65% free 3571K/9991K, external 4703K/5261K, paused 2ms+2ms è¿™è¡Œä¿¡æ¯æ€ä¹ˆç†è§£ï¼Ÿå®ƒåŒ…å«å“ªäº›ä¿¡æ¯å‘¢ï¼Ÿé€šè¿‡ DDMSçš„æ–‡æ¡£ æˆ‘ä»¬å¯ä»¥å¾—çŸ¥è¿™ä¸ªä¿¡æ¯çš„æ ¼å¼å¦‚ä¸‹ï¼š 1D/dalvikvm(dvm pid): &lt;GC_Reason&gt; &lt;Amount_freed&gt;, &lt;Heap_stats&gt;, &lt;External_memory_stats&gt;, &lt;Pause_time&gt; è¿™è¡Œä¿¡æ¯æˆ‘ä»¬ä¸»è¦å…³æ³¨çš„æ˜¯ï¼šGC_Reasonï¼Œä»–ä¸»è¦æœ‰ä¸‹é¢å‡ ç§ï¼š GC_CONCURRENT() A concurrent garbage collection that frees up memory as your heap begins to fill up. GC_FOR_MALLOC(å½“æˆ‘ä»¬çš„åº”ç”¨ç”³è¯·å†…å­˜æ—¶è§¦å‘) A garbage collection caused because your app attempted to allocate memory when your heap was already full, so the system had to stop your app and reclaim memory. GC_HPROF_DUMP_HEAP() A garbage collection that occurs when you create an HPROF file to analyze your heap. GC_EXPLICIT(å½“æˆ‘ä»¬æ‰‹åŠ¨ç‚¹å‡»DDMS&gt;heap&gt;Cause GCæŒ‰é’®æ—¶ä¼šè§¦å‘) An explicit garbage collection, such as when you call gc() (which you should avoid calling and instead trust the garbage collector to run when needed). GC_EXTERNAL_ALLOC() This happens only on API level 10 and lower (newer versions allocate everything in the Dalvik heap). A garbage collection for externally allocated memory (such as the pixel data stored in native memory or NIO byte buffers). å½“æˆ‘ä»¬åœ¨appåœ¨å‡ºç°é—®é¢˜æ—¶å¯ä»¥æ ¹æ®è¿™äº›ä¿¡æ¯åšåˆæ­¥åˆ¤æ–­ã€‚æ¯”å¦‚é¢‘ç¹å‡ºç°GC_FOR_AMLLOCåˆ™é¢„ç¤ºç€æˆ‘ä»¬ä¸€ç›´åœ¨ç”³è¯·å†…å­˜ã€‚ heapé¡µç­¾çš„å†…å­˜ä¿¡æ¯ é€šè¿‡è¿™ä¸ªå·¥å…·è¿™ä¸ªæˆ‘ä»¬å¯ä»¥æ›´è¯¦ç»†çš„çœ‹åˆ°å†…å­˜çš„åˆ†é…ä¸ä½¿ç”¨ã€‚å¯åŠ¨æ–¹æ³•ï¼š ç‚¹å‡»DDMSä¸­æˆ‘ä»¬çš„è¿›ç¨‹ &gt; ä¸Šéƒ¨çš„Update heapæŒ‰é’® &gt; Cause GC å³å¯ï¼Œå¦‚ä¸‹å›¾ï¼š 0x04 é€šè¿‡å†…å­˜å¿«ç…§æ›´ç²¾å‡†çš„æŸ¥æ‰¾å†…å­˜ä¿¡æ¯å½“æˆ‘ä»¬å‡ºç°å†…å­˜æ³„æ¼é—®é¢˜æ˜¯ï¼Œåˆå­¦è€…å¯èƒ½ä¼šä¸€å¤´é›¾æ°´ï¼Œä¸çŸ¥é“å¦‚ä½•è§£å†³ï¼Œä»ä½•ä¸‹æ‰‹ã€‚è¿™ä¸ªæ—¶å€™æˆ‘ä»¬å°±å¯ä»¥è€ƒè™‘ä½¿ç”¨matå¯¹æˆ‘ä»¬çš„å†…å­˜è¿›è¡Œè¯¦ç»†çš„åˆ†æï¼Œæ‰¾åˆ°å†…å­˜æ³„æ¼ç‚¹ï¼Œåšç›¸åº”çš„å¤„ç†ã€‚ Shallow size å’Œ Retained Size åœ¨è¿›è¡Œå†…å­˜åˆ†æä¹‹å‰æˆ‘ä»¬éœ€è¦é¦–å…ˆäº†è§£è¿™ä¸¤ä¸ªæ¦‚å¿µã€‚ Shallow size Shallow sizeå°±æ˜¯å¯¹è±¡æœ¬èº«å ç”¨å†…å­˜çš„å¤§å°ï¼Œä¸åŒ…å«å…¶å¼•ç”¨çš„å¯¹è±¡ã€‚å¸¸è§„å¯¹è±¡ï¼ˆéæ•°ç»„ï¼‰çš„Shallow sizeæœ‰å…¶æˆå‘˜å˜é‡çš„æ•°é‡å’Œç±»å‹å†³å®šã€‚æ•°ç»„çš„shallow sizeæœ‰æ•°ç»„å…ƒç´ çš„ç±»å‹ï¼ˆå¯¹è±¡ç±»å‹ã€åŸºæœ¬ç±»å‹ï¼‰å’Œæ•°ç»„é•¿åº¦å†³å®šã€‚Shallow size of a set of objects represents the sum of shallow sizes of all objects in the set.åœ¨32ä½ç³»ç»Ÿä¸Šï¼Œå¯¹è±¡å¤´å ç”¨8å­—èŠ‚ï¼Œintå ç”¨4å­—èŠ‚ï¼Œä¸ç®¡æˆå‘˜å˜é‡ï¼ˆå¯¹è±¡æˆ–æ•°ç»„ï¼‰æ˜¯å¦å¼•ç”¨äº†å…¶ä»–å¯¹è±¡ï¼ˆå®ä¾‹ï¼‰æˆ–è€…èµ‹å€¼ä¸ºnullå®ƒå§‹ç»ˆå ç”¨4å­—èŠ‚ã€‚æ•…æ­¤ï¼Œå¯¹äºStringå¯¹è±¡å®ä¾‹æ¥è¯´ï¼Œå®ƒæœ‰ä¸‰ä¸ªintæˆå‘˜ï¼ˆ34=12å­—èŠ‚ï¼‰ã€ä¸€ä¸ªchar[]æˆå‘˜ï¼ˆ14=4å­—èŠ‚ï¼‰ä»¥åŠä¸€ä¸ªå¯¹è±¡å¤´ï¼ˆ8å­—èŠ‚ï¼‰ï¼Œæ€»å…±34+14+8=24å­—èŠ‚ã€‚æ ¹æ®è¿™ä¸€åŸåˆ™ï¼Œå¯¹String a=â€rosen jiangâ€æ¥è¯´ï¼Œå®ä¾‹açš„shallow sizeä¹Ÿæ˜¯24å­—èŠ‚ã€‚ Retained Size Retained Size=å½“å‰å¯¹è±¡å¤§å°+å½“å‰å¯¹è±¡å¯ç›´æ¥æˆ–é—´æ¥å¼•ç”¨åˆ°çš„å¯¹è±¡çš„å¤§å°æ€»å’Œ(é—´æ¥å¼•ç”¨çš„å«ä¹‰ï¼šA-&gt;B-&gt;C, Cå°±æ˜¯é—´æ¥å¼•ç”¨)ã€‚æ¢å¥è¯è¯´ï¼ŒRetained Size å°±æ˜¯å½“å‰å¯¹è±¡è¢«GCåï¼Œä»Heapä¸Šæ€»å…±èƒ½é‡Šæ”¾æ‰çš„å†…å­˜ã€‚ä¸è¿‡ï¼Œé‡Šæ”¾çš„æ—¶å€™è¿˜è¦æ’é™¤è¢«GC Rootsç›´æ¥æˆ–é—´æ¥å¼•ç”¨çš„å¯¹è±¡ã€‚ä»–ä»¬æš‚æ—¶ä¸ä¼šè¢«è¢«å½“åšGarbageã€‚ä¸ºäº†æ›´å¥½çš„ç†è§£retained sizeï¼Œä¸å¦¨çœ‹ä¸ªä¾‹å­ã€‚æŠŠå†…å­˜ä¸­çš„å¯¹è±¡çœ‹æˆä¸‹å›¾ä¸­çš„èŠ‚ç‚¹ï¼Œå¹¶ä¸”å¯¹è±¡å’Œå¯¹è±¡ä¹‹é—´äº’ç›¸å¼•ç”¨ã€‚è¿™é‡Œæœ‰ä¸€ä¸ªç‰¹æ®Šçš„èŠ‚ç‚¹GC Rootsï¼Œè¿™å°±æ˜¯reference chainçš„èµ·ç‚¹ã€‚ ä»obj1å…¥æ‰‹ï¼Œä¸Šå›¾ä¸­è“è‰²èŠ‚ç‚¹ä»£è¡¨ä»…ä»…åªæœ‰é€šè¿‡obj1æ‰èƒ½ç›´æ¥æˆ–é—´æ¥è®¿é—®çš„å¯¹è±¡ã€‚å› ä¸ºå¯ä»¥é€šè¿‡GC Rootsè®¿é—®ï¼Œæ‰€ä»¥å·¦å›¾çš„obj3ä¸æ˜¯è“è‰²èŠ‚ç‚¹ï¼›è€Œåœ¨å³å›¾å´æ˜¯è“è‰²ï¼Œå› ä¸ºå®ƒå·²ç»è¢«åŒ…å«åœ¨retainedé›†åˆå†…ã€‚ æ‰€ä»¥å¯¹äºå·¦å›¾ï¼Œobj1çš„retained sizeæ˜¯obj1ã€obj2ã€obj4çš„shallow sizeæ€»å’Œï¼›å³å›¾çš„retained sizeæ˜¯obj1ã€obj2ã€obj3ã€obj4çš„shallow sizeæ€»å’Œã€‚ å¯¹äºobj2ï¼Œå®ƒçš„retained sizeæ˜¯ï¼šåœ¨å·¦å›¾ä¸­ï¼Œæ˜¯obj2å’Œobj4çš„shallow sizeçš„å’Œï¼›åœ¨å³å›¾ä¸­ï¼Œæ˜¯obj2ã€obj3å’Œobj4çš„shallow sizeçš„å’Œã€‚ æ€»ä¹‹ï¼Œretained sizeæ˜¯ä¸€ä¸ªæ•´ä½“åº¦é‡ï¼Œæœ‰åŠ©äºç†è§£å†…å­˜ç»“æ„å’Œå¯¹è±¡å›¾ä¸­çš„ä¾èµ–å…³ç³»å¹¶æ‰¾åˆ°æ ¹èŠ‚ç‚¹ã€‚ HPROF fileâ€”â€”å†…å­˜å¿«ç…§æ–‡ä»¶ é¦–å…ˆè¿™ä¸ªæ–‡ä»¶å¯ä»¥é€šè¿‡ç‚¹å‡» DDMS ä¸­ Update heap å³ä¾§çš„ Dump HPROF file å¾—åˆ°ï¼ˆè¿™ä¸ªæœ‰æ—¶å€™å¯èƒ½ä¼šæ¯”è¾ƒæ…¢ï¼Œç‰¹åˆ«æ˜¯å†…å­˜å ç”¨é«˜çš„æ—¶å€™ï¼Œéœ€è¦ç­‰ä¸€ä¼šï¼Œå‡ºç°hprof: dumping heap strings to â€œ[DDMS]â€.å³ä»£è¡¨å·²ç»è§¦å‘ï¼‰ã€‚ å¾—åˆ°è¿™ä¸ªæ–‡ä»¶ä¹‹åï¼Œæˆ‘ä»¬è¿˜éœ€è¦ä½¿ç”¨SDKçš„platform-toolsæ–‡ä»¶å¤¹ä¸‹çš„â€œhprof-convâ€å·¥å…·è¿›è¡Œè½¬æ¢ï¼Œç„¶åå°±å¯ä»¥ä½¿ç”¨å†…å­˜åˆ†æå·¥å…·æŸ¥çœ‹äº†ã€‚è½¬æ¢æ–¹æ³•ï¼š hprof-conv heap-original.hprof heap-converted.hprof 0x05 å†…å­˜åˆ†æå·¥å…·MATè¿™ä¸ªæ˜¯ä¸“é—¨åšå†…å­˜åˆ†æçš„å·¥å…·ã€‚é€šè¿‡å®ƒæˆ‘ä»¬å¯ä»¥æ‰“å¼€åˆšæ‰è½¬æ¢åçš„åˆ°hprofæ–‡ä»¶ï¼Œè¿›è¡Œå†…å­˜åˆ†æã€‚æ¯æ¬¡éƒ½ç‚¹å‡»ä¿å­˜ï¼Œè½¬æ¢ï¼Œç„¶åæ‰“å¼€è¿˜æ˜¯æ¯”è¾ƒéº»çƒ¦çš„ã€‚è¿™ä¸ªæ—¶å€™æˆ‘ä»¬å¯ä»¥è€ƒè™‘ä½¿ç”¨eclipseçš„matæ’ä»¶ã€‚ è¿™ç¯‡å°±å…ˆå†™åˆ°è¿™é‡Œã€‚ä¸‹ä¸€ç¯‡ç®€å•ä»‹ç»å¦‚ä½•é€šè¿‡MATæŸ¥æ‰¾å†…å­˜æ³„æ¼çš„é—®é¢˜ã€‚ 0xFF å‚è€ƒ https://developer.android.com/tools/debugging/debugging-memory.html http://blog.csdn.net/kingzone_2008/article/details/9083327 http://help.eclipse.org/luna/index.jsp?topic=%2Forg.eclipse.mat.ui.help%2Fconcepts%2Fshallowretainedheap.html&amp;resultof=%22Shallow%22%20%22shallow%22%20%22size%22%20","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"https://ttdevs.github.io/categories/æŠ€æœ¯/"}],"tags":[{"name":"Android","slug":"Android","permalink":"https://ttdevs.github.io/tags/Android/"}]},{"title":"ã€ŒAndroidã€ç”¨support annotationæ›¿ä»£enum","slug":"[Android]ç”¨support annotationæ›¿ä»£enum","date":"1969-12-31T16:00:00.000Z","updated":"2017-04-27T11:07:57.000Z","comments":true,"path":"1970/01/01/[Android]ç”¨support annotationæ›¿ä»£enum/","link":"","permalink":"https://ttdevs.github.io/1970/01/01/[Android]ç”¨support annotationæ›¿ä»£enum/","excerpt":"","text":"Allocation.MipmapControl,Authenticator.RequestorType,AvoidXfermode.Mode,Bitmap.CompressFormat,Bitmap.Config, BlurMaskFilter.Blur,Canvas.EdgeType,Canvas.VertexMode,ClientInfoStatus,ConsoleMessage.MessageLevel,CursorJoiner.Result,and 48 others. ç®€å•çœ‹äº†ä¸‹ï¼ŒAndroidè¿˜æ˜¯æœ‰å¥½å¤šåœ°æ–¹ä½¿ç”¨äº†ã€‚é‚£ä¸ºä»€ä¹ˆè¿˜ä¸å»ºè®®ä½¿ç”¨å‘¢ï¼ŸæŸ¥äº†ä¸€ç•ªï¼Œçœ‹åˆ°googleå®˜æ–¹æœ‰ä¸€æ®µå…³äºenumä½¿ç”¨çš„ä»‹ç»ã€‚æ—¢ç„¶ä½¿ç”¨ä¸å½“å¯èƒ½ä¼šå¯¼è‡´æ€§èƒ½é—®é¢˜ï¼Œé‚£æˆ‘ä»¬æ€ä¹ˆåŠå‘¢ï¼Ÿ è¿™é‡Œä»‹ç»ä¸‹SupportåŒ…ä¸­çš„annotationï¼Œä½¿ç”¨ @IntDef å’Œ @StringDef æ¥è¾¾åˆ°æˆ‘ä»¬æšä¸¾çš„æ•ˆæœã€‚ç”±äº@IntDef çš„ä»‹ç»æ¯”è¾ƒå¤šï¼Œè¿™é‡Œç»™ä¸ª@StringDef çš„Demoï¼š 12345678910111213141516public class MyClient &#123; public static final String ONE = \"one\"; public static final String RECORD = \"record\"; public static final String STATUS = \"status\"; @StringDef(&#123;ONE, RECORD, STATUS&#125;) public @interface Client &#123; &#125; private String mClient; public MyClient(@Client String client) &#123; mClient = client; &#125; ...&#125; è¿™æ ·ï¼Œåœ¨å¤–é¢åˆ›å»ºMyClientå¯¹è±¡çš„æ—¶å€™ï¼Œæ„é€ æ–¹æ³•ä¸­ä¼ å…¥çš„å‚æ•°å°±å¿…é¡»ä¸º ONE, RECORD, STATUS å…¶ä¸­ä¹‹ä¸€ï¼Œä»è€Œè¾¾åˆ°ç±»ä¼¼enumçš„æ•ˆæœã€‚ å‚è€ƒ https://noobcoderblog.wordpress.com/2015/04/12/java-enum-and-android-intdefstringdef-annotation/ The price of ENUMs http://tools.android.com/tech-docs/support-annotations http://developer.android.com/reference/java/lang/Enum.html http://stackoverflow.com/questions/29183904/should-i-strictly-avoid-using-enums-on-android","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"https://ttdevs.github.io/categories/æŠ€æœ¯/"}],"tags":[{"name":"Android","slug":"Android","permalink":"https://ttdevs.github.io/tags/Android/"}]},{"title":"ã€ŒAndroidã€å„ç§å°è®°å½•","slug":"[Android]å„ç§å°è®°å½•","date":"1969-12-31T16:00:00.000Z","updated":"2017-04-27T11:07:57.000Z","comments":true,"path":"1970/01/01/[Android]å„ç§å°è®°å½•/","link":"","permalink":"https://ttdevs.github.io/1970/01/01/[Android]å„ç§å°è®°å½•/","excerpt":"","text":"0x00 å°è®°å½•è¿™é‡Œæ˜¯ä¸€äº›é›¶ç¢çŸ¥è¯†ç‚¹ 0x01 sqliteä¸­å¤„ç†å•å¼•å·æ‰€æœ‰å•å¼•å·æ¢æˆåŒå•å¼•å·ï¼Œå¦‚ï¼š content.replace(&quot;&#39;&quot;, &quot;&#39;&#39;&quot;); è¿™æ ·æ˜¯ä¸è¡Œçš„ï¼Œä¸´æ—¶æŠ±ä½›è„šï¼Œæ¢æˆäº†å¸¦â€ï¼Ÿâ€çš„é€šé…å½¢å¼ 0x02 SimpleCursorAdapter.notifyDataSetChangedæ— æ•ˆå¯ä»¥ä½¿ç”¨SimpleCursorAdapterçš„changeCursoræ–¹æ³•ï¼š http://stackoverflow.com/questions/1985955/android-simplecursoradapter-not-updating-with-database-changes http://stackoverflow.com/questions/14034770/using-notifydatasetchanged-on-simplecursoradapter-does-not-work 0x03 listviewéšè—åˆ†å‰²çº¿ setDriver(null) åœ¨xmlæ–‡ä»¶ä¸­å±æ€§è®¾ç½®ä¸º @null 0x04 sqliteä¸­replace intoæ— æ•ˆä¹‹å‰å†™å¥½çš„ä»£ç è°ƒè¯•éƒ½é€šè¿‡äº†ï¼Œä»Šå¤©çªç„¶å‘ç°ä¸èƒ½è¿è¡Œäº†ï¼š sqliteï¼Œè¡¨ä¸­åˆ›å»ºå”¯ä¸€ç´¢å¼•ï¼Œç„¶åä½¿ç”¨replace intoå®ç°æ’å…¥æˆ–è€…æ›´æ–°ï¼Œç»“æœå˜æˆäº†åªæ’å…¥ æŠ˜è…¾äº†å‡ ä¸ªå°æ—¶ï¼Œæœ€åæ”¹æ‰äº†è¡¨ä¸­ä¸€ä¸ªåä¸ºidçš„å­—æ®µï¼Œå®åœ¨æ˜¯æ— è¯­ 0x05 ä¸´æ—¶å†™javaçš„Threadå°è£…123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113public abstract class BaseThread extends Thread &#123; private volatile boolean mQuit = false; public BaseThread() &#123; &#125; /** * prepare if needed */ public boolean prepare() &#123; return true; &#125; /** * run body */ public abstract void execute() throws Exception; // third modify,second modify maybe not neccessary /** * recycle if needed */ public void recycle() &#123; &#125; /** * stop thread */ public final void quit() &#123; mQuit = true; interrupt(); &#125; @Override public void run() &#123; // TODO Process.setThreadPriority(Process.THREAD_PRIORITY_BACKGROUND); if (!prepare()) &#123; return; &#125; while (true) &#123; if (mQuit) &#123; // second modify recycle(); return; &#125; try &#123; execute(); &#125; catch (Exception e) &#123;// &#125; catch (InterruptedException e) &#123; if (mQuit) &#123; recycle(); return; &#125; continue; &#125; &#125; &#125;&#125;``` ## 0x06 Volleyä¸­è®¾ç½®è¿æ¥è¶…æ—¶è®¾ç½®è¶…æ—¶çš„åœ°æ–¹ï¼šHurlStackï¼š``` java/*** Opens an &#123;@link HttpURLConnection&#125; with parameters.** @param url* @return an open connection* @throws IOException*/private HttpURLConnection openConnection(URL url, Request&lt;?&gt; request) throws IOException &#123; HttpURLConnection connection = createConnection(url); int timeoutMs = request.getTimeoutMs(); connection.setConnectTimeout(timeoutMs); connection.setReadTimeout(timeoutMs); connection.setUseCaches(false); connection.setDoInput(true); // use caller-provided custom SslSocketFactory, if any, for HTTPS if (\"https\".equals(url.getProtocol()) &amp;&amp; mSslSocketFactory != null) &#123; ((HttpsURLConnection) connection).setSSLSocketFactory(mSslSocketFactory); &#125; return connection;&#125;``` HttpClientStackï¼š ``` java@Overridepublic HttpResponse performRequest(Request&lt;?&gt; request, Map&lt;String, String&gt; additionalHeaders) throws IOException, AuthFailureError &#123; HttpUriRequest httpRequest = createHttpRequest(request, additionalHeaders); addHeaders(httpRequest, additionalHeaders); addHeaders(httpRequest, request.getHeaders()); onPrepareRequest(httpRequest); HttpParams httpParams = httpRequest.getParams(); int timeoutMs = request.getTimeoutMs(); // TODO: Reevaluate this connection timeout based on more wide-scale // data collection and possibly different for wifi vs. 3G. HttpConnectionParams.setConnectionTimeout(httpParams, 5000); HttpConnectionParams.setSoTimeout(httpParams, timeoutMs); return mClient.execute(httpRequest);&#125; Requestä¸­ï¼š 123456/*** Sets the retry policy for this request.*/public void setRetryPolicy(RetryPolicy retryPolicy) &#123; mRetryPolicy = retryPolicy;&#125; RetryPolicy ï¼š 123456789101112131415161718192021222324/*** Retry policy for a request.*/public interface RetryPolicy &#123; /** * Returns the current timeout (used for logging). */ public int getCurrentTimeout(); /** * Returns the current retry count (used for logging). */ public int getCurrentRetryCount(); /** * Prepares for the next retry by applying a backoff to the timeout. * * @param error The error code of the last attempt. * @throws VolleyError In the event that the retry could not be performed (for example if we * ran out of attempts), the passed in error is thrown. */ public void retry(VolleyError error) throws VolleyError;&#125; 0x07 Androidä¸å›¾ç‰‡ç›¸å…³http://developer.android.com/training/displaying-bitmaps/index.html 0x08 å°†eclipseé¡¹ç›®ä¸­çš„æ–‡ä»¶å¤¹ç§»é™¤SVNçš„æ§åˆ¶ï¼ˆæ·»åŠ åˆ°svn:ignoreï¼‰ä»¥åˆ é™¤androidé¡¹ç›®ä¸­çš„binæ–‡ä»¶å¤¹ä¸ºä¾‹ aã€å…³é—­é¡¹ç›®çš„è‡ªåŠ¨buildï¼šproject-Build Automaticallybã€åˆ é™¤binæ–‡ä»¶å¤¹cã€æäº¤dã€æ‰“å¼€ é¡¹ç›®çš„è‡ªåŠ¨buildï¼Œè¿™ä¸ªæ—¶å€™ä¼šç”Ÿæˆbinæ–‡ä»¶å¤¹eã€å°†binæ·»åŠ åˆ°svn:ignoreï¼šå³é”®-Team-æ·»åŠ è‡³svn:ignorefã€æäº¤ 0x09 å±å¹•æ—‹è½¬ï¼ŒActivityçš„æˆå‘˜å˜é‡è¢«å…¨éƒ¨é‡Šæ”¾ï¼Ÿï¼è²Œä¼¼æ˜¯è¿™æ ·å­çš„ 0x10 ViewPageré¢‘ç¹è¢«å›æ”¶ViewPager) 12345678910111213141516171819202122232425262728/*** Set the number of pages that should be retained to either side of the* current page in the view hierarchy in an idle state. Pages beyond this* limit will be recreated from the adapter when needed.** &lt;p&gt;This is offered as an optimization. If you know in advance the number* of pages you will need to support or have lazy-loading mechanisms in place* on your pages, tweaking this setting can have benefits in perceived smoothness* of paging animations and interaction. If you have a small number of pages (3-4)* that you can keep active all at once, less time will be spent in layout for* newly created view subtrees as the user pages back and forth.&lt;/p&gt;** &lt;p&gt;You should keep this limit low, especially if your pages have complex layouts.* This setting defaults to 1.&lt;/p&gt;** @param limit How many pages will be kept offscreen in an idle state.*/public void setOffscreenPageLimit(int limit) &#123; if (limit &lt; DEFAULT_OFFSCREEN_PAGES) &#123; Log.w(TAG, \"Requested offscreen page limit \" + limit + \" too small; defaulting to \" + DEFAULT_OFFSCREEN_PAGES); limit = DEFAULT_OFFSCREEN_PAGES; &#125; if (limit != mOffscreenPageLimit) &#123; mOffscreenPageLimit = limit; populate(); &#125;&#125; 0x11 Android SQLite åˆ†é¡µæŸ¥è¯¢ï¼Œå‚æ•°ä¸ºé¡µå¤§å°å’Œèµ·å§‹ç¼–å·å…ˆçœ‹æ•°æ®ï¼š æŸ¥è¯¢ç¬¬0æ¡ä¹‹åçš„5æ¡ï¼šselect * from china_city where province = &#39;åŒ—äº¬&#39; order by code limit 5 offset 0 æŸ¥è¯¢ç¬¬5æ¡ä¹‹åçš„5æ¡ï¼šselect * from china_city where province = &#39;åŒ—äº¬&#39; order by code limit 5 offset 5 0x12 è·å–è¿›ç¨‹å†…å­˜ å’Œ å·²ä½¿ç”¨å†…å­˜ è¿›ç¨‹å†…å­˜ 123int memClass = ((ActivityManager)context.getSystemService(Context.ACTIVITY_SERVICE)).getMemoryClass();int maxMemory = (int) (Runtime.getRuntime().maxMemory() / 1024); å·²ä½¿ç”¨å†…å­˜ Log.i(&quot;tag&quot;, where+&quot;usedMemory: &quot;+Debug.getNativeHeapSize()/ 1048576L); 0x13 ä¸è”ç³»äººç›¸å…³http://developer.android.com/training/contacts-provider/display-contact-badge.html 0x14 è®¾ç½®å­—ä½“å¤§å°å¯ä»¥ç”¨setTextSize()çš„å¦å¤–ä¸€ç§å½¢å¼ï¼Œå¯ä»¥æŒ‡å®šå•ä½ï¼šsetTextSize(int unit, int size) TypedValue.COMPLEX_UNIT_PX: Pixels TypedValue.COMPLEX_UNIT_SP: Scaled Pixels TypedValue.COMPLEX_UNIT_DIP: Device Independent Pixels 0x15 äº¤æ¢ä¸¤ä¸ªå˜é‡çš„å€¼123date3 = date1;date1 = date2;date2 = date3; 12345if (date2 &gt; date1) &#123; date2 = date2 + date1; date1 = date2 - date1; date2 = date2 - date1;&#125; 123date2 = date1 ^ date2;date1 = date1 ^ date2;date2 = date1 ^ date2; 0x16 è·å–URIçœŸå®çš„åœ°å€1234567891011121314151617181920212223242526272829303132333435363738394041424344private String getRealPath(Uri uri) &#123; String path = \"\"; String[] proj = &#123;MediaStore.Images.Media.DATA&#125;; Cursor cursor = getActivity().getContentResolver().query(uri, proj, null, null, null); if (cursor != null &amp;&amp; cursor.moveToFirst()) &#123; path = cursor.getString(cursor.getColumnIndexOrThrow(MediaStore.Images.Media.DATA)); &#125; return path;&#125;``` ## 0x17 è‡ªå®šä¹‰Gridviewï¼Œè§£å†³ScrollViewä¸­åµŒå¥—Gridviewæ˜¾ç¤ºä¸æ­£å¸¸çš„é—®é¢˜ç½‘ä¸Šåˆ°å¤„éƒ½å¯ä»¥æ‰¾åˆ°ä¸‹é¢çš„è§£å†³åŠæ³•ï¼Œä½†æ˜¯è¿™æ ·ä¼šæœ‰ä¸€ä¸ªé—®é¢˜ï¼šå½“å›¾ç‰‡éå¸¸å¤šçš„æ—¶å€™æ˜¯ä¸€æ¬¡åŠ è½½å®Œæ¯•çš„ï¼Œè€Œæˆ‘ä»¬å¸Œæœ›çš„åº”è¯¥æ˜¯æœ¬æ¥çš„GridViewå¯ä»¥é€šè¿‡æ»‘åŠ¨åˆ¤æ–­å½“å‰æ˜¾ç¤ºæ¡ç›®çš„æƒ…å†µï¼Œåœ¨æ­¤è®°å½•ä¸€ä¸‹ã€‚``` java/*** è‡ªå®šä¹‰Gridviewï¼Œè§£å†³ScrollViewä¸­åµŒå¥—Gridviewæ˜¾ç¤ºä¸æ­£å¸¸çš„é—®é¢˜&lt;br&gt;* ä½†æ˜¯ï¼Œè¿™åˆäº§ç”Ÿäº†ä¸€ä¸ªæ–°çš„é—®é¢˜ï¼šæ‰€æœ‰çš„iteméƒ½æ˜¯ä¸€æ¬¡åŠ è½½å®Œæ¯•çš„ï¼Œå†æƒ³æ»‘åŠ¨åŠ è½½å°±ä¸è¡Œäº†** @author ttdevs*/public class ImageGridView extends GridView &#123; public ImageGridView(Context context) &#123; this(context, null); &#125; public ImageGridView(Context context, AttributeSet attrs) &#123; this(context, attrs, 0); &#125; public ImageGridView(Context context, AttributeSet attrs, int defStyle) &#123; super(context, attrs, defStyle); &#125; @Override public void onMeasure(int widthMeasureSpec, int heightMeasureSpec) &#123; //super.onMeasure(widthMeasureSpec, heightMeasureSpec); int expandSpec = MeasureSpec.makeMeasureSpec(Integer.MAX_VALUE &gt;&gt; 2, MeasureSpec.AT_MOST); super.onMeasure(widthMeasureSpec, expandSpec); &#125;&#125; 0x18 .9å›¾ç‰‡çš„åˆ¶ä½œä¸€ä¸ªå›¾ç‰‡åªæƒ³æ¨ªå‘æ‹‰ä¼¸ã€‚æ‰€ä»¥å°±æƒ³å½“ç„¶çš„åªåœ¨å·¦è¾¹ç”»äº†ä¸€æ¡æ¨ªçº¿ï¼Œè¿è¡Œçš„æ—¶å€™æ€ä¹ˆéƒ½æ˜¯æœ‰é»‘çº¿ï¼Œæ²¡æ‹‰ä¼¸ã€‚ æœ€åè§£å†³ï¼šç»™å·¦è¾¹ä¹ŸåŠ ä¸€æ¡ç«–çº¿ï¼ 0x20 listviewç‚¹å‡»èƒŒæ™¯ä¸å˜è¿™ä¸ªåº”è¯¥è¿˜æ˜¯ç„¦ç‚¹çš„é—®é¢˜ï¼Œåœ¨itemçš„viewæœ€ä¸Šå±‚å¸ƒå±€ä¸­æ·»åŠ ä¸€ä¸ªå±æ€§ï¼š android:descendantFocusability=&quot;blocksDescendants&quot; 0x21 Volley Cookieshttp://stackoverflow.com/questions/16680701/using-cookies-with-android-volley-library 0x22 EditTextè®¾ç½®readOnly123et.setCursorVisible(false); et.setFocusable(false); et.setFocusableInTouchMode(false); 0x23 ä¿å­˜å¯¹è±¡åˆ°SharedPreferencesæƒ³ä¿å­˜ä¸€ä¸ªList åˆ°SharedPreferencesã€‚ç½‘ä¸Šæ‰¾äº†ä¸€åœˆæœ‰ä¸€ç§è¯´æ³•åˆ©ç”¨setï¼Œæˆ–è€…base64ï¼Œéƒ½æ„Ÿè§‰ä¸å¥½ã€‚æœ‹å‹ä¸€å¥æç¤ºï¼šjsonã€‚ç„¶åè±ç„¶å¼€æœ—ã€‚ç°è½¬åŒ–æˆjsonï¼Œç„¶åä¿å­˜ï¼Œæ•ˆæœä¸é”™ã€‚ 0x24 è·å–å­—ç¬¦123456789public String getCharacter(String str) &#123; StringBuilder sb = new StringBuilder(); for (int i = 0; i &lt; str.length(); i++) &#123; if (String.valueOf(str.charAt(i)).getBytes().length &gt; 1) &#123; sb.append(str.charAt(i)); &#125; &#125; return sb.toString();&#125; 0x25 Android 4 æŒ‰é’®æ ·å¼style=&quot;?android:attr/buttonBarButtonStyle&quot; 0x26 å‡ ä¸ªsqliteçš„sqlè¯­å¥ select count(*) from notes create table notes_new as select * from notes; select count(*) from notes_new delete from notes_new where word like â€˜% %â€™; delete from notes_new where word like â€˜%-%â€™; delete from notes_new where phonetic like â€˜â€™; create table notes_new_new as select * from notes_new; select count(*) from notes_new_new delete from notes_new_new where _id not in (select min(_id) from notes_new_new group by word) select * from notes_new_new insert into notes_word(word,detail,created,phonetic) select word,detail,created,phonetic from notes_new_new; Create Table: 1234567CREATE TABLE notes_word( _id INTEGER PRIMARY KEY AUTOINCREMENT, word TEXT, detail TEXT, created INT, phonetic TEXT); 0x27 åŠ å¯†ç›¸å…³ http://blog.csdn.net/androidsecurity/article/details/8666954 http://blog.csdn.net/baolong47/article/details/17335227 http://blog.csdn.net/guolin_blog/article/details/11952409 0x28 FaceBookå¼€æºé¡¹ç›® 0x29 ScrollViewä¸é«˜åº¦å›ºå®šçš„GridViewæˆ–è€…ListViewåµŒå¥—æ—¶ï¼Œç•Œé¢ä¸æ˜¾ç¤ºåœ¨æœ€ä¸Šé¢ gvGroup.setFocusable(false); lvGroup.setFocusable(false);åœ¨è®¾ç½®Adapterä¹‹å‰è®©å…¶å¤±å»ç„¦ç‚¹ svMain.fullScroll(ScrollView.FOCUS_UP); åœ¨åˆé€‚çš„æ—¶å€™(å¦‚delay10ms)è®©ScrollViewæ»šåŠ¨åˆ°æœ€é¡¶ç«¯ 0x30 è·å–viewçš„é«˜åº¦123Rect rect = new Rect();getDrawingRect(rect);int height = rect.bottom - rect.top; 0x31 http://hold-on.iteye.com/blog/19434370x32 è°ƒç”¨ç³»ç»Ÿçš„æµè§ˆå™¨æ‰“å¼€ç½‘é¡µåŒºåˆ†å¤§å°å†™ï¼Œhttpå¿…é¡»ä¸ºå°å†™ 1234String url = \"http://www.baidu.com\";Intent intent = new Intent(Intent.ACTION_VIEW);intent.setData(Uri.parse(url));startActivity(intent); 0x33 HTTP POST ä¹±ç 1234567List&lt;NameValuePair&gt; postParameters = new ArrayList&lt;NameValuePair&gt;();postParameters.add(new BasicNameValuePair(\"v\", param));postParameters.add(new BasicNameValuePair(\"s\", Utils.MD5Encode(param, \"\")));postParameters.add(new BasicNameValuePair(\"e\", String.valueOf(encryptType)));UrlEncodedFormEntity formEntity = new UrlEncodedFormEntity(postParameters, \"UTF-8\");mPost.setEntity(formEntity); 0x34 è¯»å–è”ç³»äºº123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119/** * è¯»å–æœ¬åœ°é€šè®¯å½•ï¼ˆæ‰‹æœºï¼‰&lt;br&gt; * ç”¨æˆ·é€šè®¯å½•ï¼š æ‰‹æœºå·ç ã€è”ç³»äººå‘½åã€å¤‡æ³¨ä¿¡æ¯ã€åˆ†ç»„ä¿¡æ¯&lt;br&gt; * è€—æ—¶ * * @param context * @return */@SuppressLint(\"UseSparseArrays\")public static Map&lt;String, ContactInfo&gt; getContracts(Context context) &#123; Map&lt;String, ContactInfo&gt; contactMap = new HashMap&lt;String, ContactInfo&gt;(); try &#123; ContentResolver resolver = context.getContentResolver(); if (null == resolver) &#123; return contactMap; &#125; // æ‰‹æœºï¼šå§“åå’Œæ‰‹æœºå· Cursor curosr = resolver.query(Phone.CONTENT_URI, new String[]&#123;Phone.CONTACT_ID, Phone.DISPLAY_NAME, Phone.NUMBER&#125;, null, null, null); if (null != curosr &amp;&amp; curosr.moveToFirst()) &#123; int keyId = curosr.getColumnIndex(Phone.CONTACT_ID); int keyName = curosr.getColumnIndex(Phone.DISPLAY_NAME); int keyNumber = curosr.getColumnIndex(Phone.NUMBER); do &#123; String id = curosr.getString(keyId); String name = curosr.getString(keyName); String number = curosr.getString(keyNumber); ContactInfo info = new ContactInfo(); info.setName(name); if (!TextUtils.isEmpty(number)) &#123; number = number.replace(\"-\", \"\"); number = number.replace(\" \", \"\"); info.setNumber(number); &#125; contactMap.put(id, info); &#125; while (curosr.moveToNext()); &#125; curosr.close(); // SIMå¡ï¼šå§“åå’Œæ‰‹æœºå· curosr = resolver.query(Uri.parse(\"content://icc/adn\"), new String[]&#123;Phone.CONTACT_ID, Phone.DISPLAY_NAME, Phone.NUMBER&#125;, null, null, null); if (null != curosr &amp;&amp; curosr.moveToFirst()) &#123; int keyId = curosr.getColumnIndex(Phone.CONTACT_ID); int keyName = curosr.getColumnIndex(Phone.DISPLAY_NAME); int keyNumber = curosr.getColumnIndex(Phone.NUMBER); do &#123; String id = curosr.getString(keyId); String name = curosr.getString(keyName); String number = curosr.getString(keyNumber); ContactInfo info = new ContactInfo(); info.setName(name); info.setNumber(number); contactMap.put(id, info); &#125; while (curosr.moveToNext()); &#125; curosr.close(); // å¤‡æ³¨ curosr = resolver.query(Data.CONTENT_URI, new String[]&#123;Data.CONTACT_ID, Data.DATA1&#125;, null, null, null); if (null != curosr &amp;&amp; curosr.moveToFirst()) &#123; int keyId = curosr.getColumnIndex(Data.CONTACT_ID); int keyRemark = curosr.getColumnIndex(Data.DATA1); do &#123; String id = curosr.getString(keyId); String remark = curosr.getString(keyRemark); ContactInfo info = contactMap.get(id); if (null != info) &#123; info.setRemark(remark); &#125; &#125; while (curosr.moveToNext()); &#125; curosr.close(); // è·å–æ‰€æœ‰åˆ†ç»„ Map&lt;String, String&gt; groupData = new HashMap&lt;String, String&gt;(); curosr = resolver.query(Groups.CONTENT_URI, new String[]&#123;Groups._ID, Groups.TITLE&#125;, null, null, null); if (null != curosr &amp;&amp; curosr.moveToFirst()) &#123; int keyId = curosr.getColumnIndex(Groups._ID); int keyGroupName = curosr.getColumnIndex(Groups.TITLE); do &#123; String id = curosr.getString(keyId); String name = curosr.getString(keyGroupName); groupData.put(id, name); &#125; while (curosr.moveToNext()); &#125; curosr.close(); // å…³è”è”ç³»äººå’Œåˆ†ç»„ curosr = resolver.query(Data.CONTENT_URI, new String[]&#123;GroupMembership.CONTACT_ID, GroupMembership.GROUP_ROW_ID&#125;, Data.MIMETYPE + \" = ?\", new String[]&#123;GroupMembership.CONTENT_ITEM_TYPE&#125;, null); if (null != curosr &amp;&amp; curosr.moveToFirst()) &#123; int keyId = curosr.getColumnIndex(GroupMembership.CONTACT_ID); int keyGroupId = curosr.getColumnIndex(GroupMembership.GROUP_ROW_ID); do &#123; String id = curosr.getString(keyId); String groupId = curosr.getString(keyGroupId); String groupName = groupData.get(groupId); ContactInfo info = contactMap.get(id); if (null != info &amp;&amp; !TextUtils.isEmpty(groupName)) &#123; info.setGroup(groupName); &#125; &#125; while (curosr.moveToNext()); &#125; curosr.close(); Iterator&lt;String&gt; iterator = contactMap.keySet().iterator(); while (iterator.hasNext()) &#123; String id = iterator.next(); ContactInfo info = contactMap.get(id); System.out.println(String.format(\"%s, %s, %s, %s.\", info.getName(), info.getNumber(), info.getGroup(), info.getRemark())); &#125; groupData.clear(); groupData = null; &#125; catch (Exception e) &#123; e.printStackTrace(); &#125; return contactMap;&#125; 0x35 å•å…ƒæµ‹è¯•â€”â€”æµ‹è¯•å¼‚æ­¥ä»»åŠ¡1234567891011121314151617public void testAsynchronous() &#123; try &#123; CountDownLatch signal = new CountDownLatch(1); new Thread(new Runnable() &#123; @Override public void run() &#123; Looper.prepare(); signal.countDown(); Looper.loop(); &#125; &#125;).start(); signal.await(); &#125; catch (InterruptedException e) &#123; e.printStackTrace(); &#125;&#125; 0x36 GridLayoutåˆå¹¶123456789101112131415161718192021222324252627282930313233343536373839&lt;GridLayout android:id=\"@+id/glNumber\" android:layout_width=\"wrap_content\" android:layout_height=\"wrap_content\" android:layout_below=\"@+id/etPassword\" android:layout_centerHorizontal=\"true\" android:alignmentMode=\"alignBounds\" android:columnCount=\"3\" android:orientation=\"horizontal\" android:rowCount=\"4\"&gt; &lt;com.ttdevs.blur.CircleButton android:id=\"@+id/cbt1\" android:layout_width=\"64dp\" android:layout_height=\"64dp\" /&gt; &lt;com.ttdevs.blur.CircleButton android:id=\"@+id/cbt2\" android:layout_width=\"64dp\" android:layout_height=\"64dp\" android:layout_margin=\"10dp\" /&gt; &lt;com.ttdevs.blur.CircleButton android:id=\"@+id/cbt3\" android:layout_width=\"64dp\" android:layout_height=\"64dp\" /&gt; &lt;com.ttdevs.blur.CircleButton android:id=\"@+id/cbt0\" android:layout_width=\"64dp\" android:layout_height=\"64dp\" android:layout_columnSpan=\"2\" android:layout_gravity=\"right\" /&gt; &lt;com.ttdevs.blur.CircleButton android:id=\"@+id/cbtDel\" android:layout_width=\"64dp\" android:layout_height=\"64dp\" /&gt;&lt;/GridLayout&gt; 0x37 PopupWindowæ˜¾ç¤ºçš„æ—¶å€™å·¦å³ä¸é è¾¹ï¼ˆæœ‰è¾¹ç¼ï¼‰setBackgroundDrawable(new ColorDrawable(0xa0000000)); 0x38 EditTexté™åˆ¶å¯è¾“å…¥å°æ•°etInput.setInputType(InputType.TYPE_CLASS_NUMBER | InputType.TYPE_NUMBER_FLAG_DECIMAL); 0x39 éšè—é”®ç›˜éšè—é”®ç›˜è²Œä¼¼åœ¨onDestoryä¸­è°ƒç”¨æ— æ•ˆï¼Œæœ€åè‡ªå·±æŠŠå®ƒå†™åœ¨äº†onStopä¸­ 1234567891011/** * å…³é—­é”®ç›˜ * @param context * @param windowToken * @param flag */public static void close(Context context, IBinder windowToken, int flag) &#123; InputMethodManager imm = (InputMethodManager) context .getSystemService(Context.INPUT_METHOD_SERVICE); imm.hideSoftInputFromWindow(windowToken, flag);&#125; 0x40 Android TextView æ˜¾ç¤ºä¸å…¨çš„é—®é¢˜ä»£ç å¦‚ä¸‹ï¼Œå½“ç»™TextViewçš„å±æ€§è®¾ç½®æˆmatch_parentçš„æ—¶å€™ï¼Œtextä¸­è®¾ç½®çš„æ–‡å­—æ¯”è¾ƒé•¿çš„æ—¶å€™ä¼šå‡ºç°æ˜¾ç¤ºä¸å…¨çš„é—®é¢˜ 123456789101112131415161718192021222324&lt;LinearLayout android:layout_width=\"match_parent\" android:layout_height=\"wrap_content\" android:gravity=\"top\" android:orientation=\"horizontal\" android:padding=\"@dimen/global_padding_normal\"&gt; &lt;ImageView android:id=\"@+id/iv_health_light\" android:layout_width=\"@dimen/detail_light_width\" android:layout_height=\"@dimen/detail_light_height\" android:gravity=\"center_horizontal\" /&gt; &lt;TextView android:id=\"@+id/tv_appraise\" android:layout_width=\"match_parent\" android:layout_height=\"wrap_content\" android:layout_marginLeft=\"@dimen/global_margin_normal\" android:gravity=\"left|top\" android:lineSpacingExtra=\"@dimen/global_line_space\" android:textColor=\"@color/global_gray_dark\" android:textSize=\"@dimen/global_font_small\" /&gt;&lt;/LinearLayout&gt; 0x41 æŸ¥çœ‹ç³»ç»Ÿalarm(é—¹é’Ÿ)é˜Ÿåˆ— Alarmäº‹ä»¶é˜Ÿåˆ— adb shell dumpsys alarm æŸ¥çœ‹intent adb shell dumpsys activity intents 0x42 singleTaskä¸onNewIntentsingleTaskä¸onNewIntentåŒæ—¶å­˜åœ¨æ—¶ï¼ŒonNewIntentä¸æ˜¯æ€»è¢«è°ƒç”¨ã€‚æ¯”å¦‚ï¼šå½“å‰Appå¯åŠ¨è¿‡ï¼Œç¬¬ä¸‰æ–¹Appå†æ¬¡å¯åŠ¨æ—¶æ˜¯ä¸ä¼šè°ƒç”¨onNewIntentçš„ï¼Œå†æˆ–è€…æˆ‘ä»¬ä»ä»»åŠ¡åˆ—è¡¨ä¸­å†æ¬¡å¯åŠ¨å½“å‰Appä¹Ÿæ˜¯ä¸ä¼šè§¦å‘onNewIntentçš„ã€‚","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"https://ttdevs.github.io/categories/æŠ€æœ¯/"}],"tags":[{"name":"Android","slug":"Android","permalink":"https://ttdevs.github.io/tags/Android/"}]},{"title":"ã€ŒFlaskã€0x00Welcome","slug":"[Flask]0x00Welcome","date":"1969-12-31T16:00:00.000Z","updated":"2017-04-27T11:07:57.000Z","comments":true,"path":"1970/01/01/[Flask]0x00Welcome/","link":"","permalink":"https://ttdevs.github.io/1970/01/01/[Flask]0x00Welcome/","excerpt":"","text":"0x00 Welcome to Flask Flask is a microframework for Python based on Werkzeug, Jinja 2 and good intentions. And before you ask: Itâ€™s BSD licensed! 0xFF å‚è€ƒ https://pypi.python.org/pypi/Flask/0.10.1 http://flask.pocoo.org/docs/0.10/ https://github.com/pallets/flask","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"https://ttdevs.github.io/categories/æŠ€æœ¯/"}],"tags":[{"name":"Flask","slug":"Flask","permalink":"https://ttdevs.github.io/tags/Flask/"}]},{"title":"ã€ŒAndroidã€é€šè¿‡Intentä¼ é€’æ•°æ®","slug":"[Android]é€šè¿‡Intentä¼ é€’æ•°æ®","date":"1969-12-31T16:00:00.000Z","updated":"2017-04-27T11:07:57.000Z","comments":true,"path":"1970/01/01/[Android]é€šè¿‡Intentä¼ é€’æ•°æ®/","link":"","permalink":"https://ttdevs.github.io/1970/01/01/[Android]é€šè¿‡Intentä¼ é€’æ•°æ®/","excerpt":"","text":"0x00 éœ€æ±‚æ—¥å¸¸å¼€å‘ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸é‡åˆ°é€šè¿‡ Intent æ¥ä¼ é€’æ•°æ®ï¼ˆå¦‚æœä½ ä½¿ç”¨Bundleä¹Ÿæ˜¯ä¸€æ ·çš„ï¼‰ï¼Œé»˜è®¤æƒ…å†µï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°æ”¯æŒçš„æ•°æ®ç±»å‹ï¼š åŸºæœ¬ç±»å‹ booleanã€byteã€char ã€shortã€doubleã€floatã€intã€long å­—ç¬¦ä¸²ç±»å‹ Stringã€String[]ã€CharSequenceã€CharSequence[] åºåˆ—åŒ–ç±»å‹ Serializableã€Parcelable å…¶ä»–ç±»å‹ å…«ç§åŸºæœ¬ç±»å‹çš„æ•°ç»„ã€IntegerArrayã€StringArrayã€CharSequenceArrayã€ParcelableArray å¯¹äºåŸºæœ¬ç±»å‹æˆ‘ä»¬å¯ä»¥ä¸åšä»»ä½•å¤„ç†å³å¯åœ¨Activityæˆ–è€…Serviceä¸­ä¼ é€’ã€‚é‚£ä¹ˆå¯¹äºè‡ªå®šä¹‰ç±»å‹ï¼Œæˆ‘ä»¬æ€ä¹ˆåšå‘¢ï¼Ÿ 0x01 ä½•è°“åºåˆ—åŒ–å½“æˆ‘ä»¬éœ€è¦å¯¹JVMä¸­çš„javaå¯¹è±¡è¿›è¡Œè½¬å‚¨æ—¶ï¼Œå°±éœ€è¦å°†å…¶è½¬åŒ–æˆäºŒè¿›åˆ¶åºåˆ—ï¼Œç„¶åæ‰èƒ½å­˜å‚¨åˆ°å¤–éƒ¨ã€‚è¿™ä¸ªåºåˆ—ä¸­ä¿å­˜äº†javaå¯¹è±¡çš„ç±»å‹ï¼Œæ•°æ®ï¼Œæ•°æ®ç±»å‹ç­‰ã€‚å½“éœ€è¦çš„æ—¶å€™ï¼Œå†å¯¹å­˜å‚¨çš„äºŒè¿›åˆ¶åºåˆ—è¿›è¡Œååºåˆ—åŒ–ï¼Œå³å¯å°†å…¶è¿˜åŸã€‚å¸¸è§çš„åœºæ™¯æ¯”å¦‚ï¼šå­˜å‚¨JVMä¸­å¯¹è±¡ï¼Œé€šè¿‡Socketä¼ é€’javaå¯¹è±¡ï¼ŒRMIç­‰ç­‰ã€‚ 0x02 Stringç±»å‹ ä¸ºä»€ä¹ˆæŠŠè¿™ä¸ªæ”¾åœ¨ç¬¬ä¸€ä½å‘¢ï¼ŸåŸå› å¾ˆç®€å•ï¼šç®€å• åŸºæœ¬ç±»å‹ä¸ç”¨è¯´ï¼Œç›´æ¥ä¼ é€’å³å¯ï¼Œå¯¹äºæˆ‘ä»¬çš„è‡ªå®šä¹‰ç±»å‹ï¼Œå¦‚æœä½ è·Ÿæˆ‘ä¸€æ ·ï¼Œä¸å¤ªå–œæ¬¢ï¼ˆç†Ÿæ‚‰ T-Tï¼‰Serializableå’ŒParcelableï¼Œé‚£ç”¨Stringç±»å‹æœ€ç®€å•äº†ã€‚å…¶å®è¿™ä¸ªè¯´æ³•è¿˜æœ‰ä¸ªå‰æï¼Œå°±æ˜¯æˆ‘ä»¬çš„é¡¹ç›®ä¸­éœ€è¦é›†æˆjsonå·¥å…·ï¼ˆä¸è¿‡è‡³å°‘æœ‰gsonï¼‰ã€‚ä½¿ç”¨æ–¹æ³•å¦‚ä¸‹ï¼šé¦–å…ˆé€šè¿‡jsonå·¥å…·å°†æˆ‘ä»¬çš„Objectè½¬æ¢æˆjsonå­—ç¬¦ä¸²ï¼Œç„¶ååœ¨æ¥æ”¶å¤„åœ¨é€šè¿‡jsonå·¥å…·è¿˜åŸä¸ºObjectã€‚ ä»æ•ˆç‡æ¥çœ‹ï¼Œä¼šæ¯”ä¸‹é¢ä¸¤ç§æƒ…å†µä½ã€‚ä½†æ˜¯å¯¹åˆå­¦è€…æ¥è¯´ï¼Œä¼šæ¯”ä¸‹é¢ä¸¤ç§ç”¨èµ·æ¥ç®€å•ã€‚ç›®å‰è¿˜æ²¡æœ‰é‡åˆ°å‡ºé”™çš„é—®é¢˜ï¼ˆå¯èƒ½æ—¶å› ä¸ºæˆ‘ä¼ é€’çš„æ•°æ®æ¯”è¾ƒå°æ¯”è¾ƒç®€å•å§ï¼‰ã€‚ 0x02 SerializableJavaä¸­ç»å¸¸ä¼šé‡åˆ° Serializableï¼Œæ¯”å¦‚è¿™æ ·ï¼š 123456public class Person implements Serializable &#123; public String name; public int age; public boolean login; public float score;&#125; æœ‰äº›åœ°æ–¹éœ€è¦è¿›è¡Œåºåˆ—åŒ–æ—¶ï¼ŒIDEä¼šæç¤ºæˆ‘ä»¬å®ç°ä¸€ä¸ªæ¥å£ï¼šSerializableï¼Œç„¶åæˆ‘ä»¬ä¹–ä¹–åœ°åŠ ä¸Šè¿™ä¸ªæ¥å£å³å¯ï¼ˆæœ‰æ—¶å€™IDEè¿˜ä¼šè‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªé™æ€å¸¸é‡ï¼šprivate static final long serialVersionUID = 23333333333333333333L;ï¼‰ã€‚å¦‚æœä½ æ²¡æœ‰å»è¿½ç©¶ä¸ºä»€ä¹ˆï¼Œé‚£ä¹ˆäº‹æƒ…å°±æ­¤ç»“æŸã€‚é€šè¿‡Intentä¼ é€’æ•°æ®æ—¶ï¼Œä¹Ÿæ˜¯å¦‚æ­¤ã€‚å¥½äº†ï¼Œæˆ‘ä»¬è¿›å…¥ä¸‹ä¸€éƒ¨åˆ†ï½ï½ å“ˆå“ˆï¼Œå“ªèƒ½è¿™ä¹ˆç®€å•ã€‚ä½ å¯èƒ½ä¼šé—®ï¼Œä¸ºä»€ä¹ˆåŠ ä¸ªè¿™ä¸ªæ¥å£å³å¯ï¼ŸSerializableæ˜¯ä¸€ç§ æ ‡è®°æ¥å£ï¼Œå½“æˆ‘ä»¬å®ç°è¿™ä¸ªæ¥å£ä¹‹åï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨é€šè¿‡åå°„æœºåˆ¶å°†æˆ‘ä»¬å¯¹è±¡çš„æˆå‘˜è¿›è¡Œåºåˆ—åŒ–ã€‚è¿™é‡Œä¼šæ¶‰åŠä¸€äº›å…¶ä»–ä¿¡æ¯ï¼Œæ¯”å¦‚ï¼šserialVersionUIDã€é™æ€å¸¸é‡çš„åºåˆ—åŒ–ç­‰ç­‰ï¼Œæ›´å¤šä¿¡æ¯è¯·å‚è€ƒè¿™é‡Œã€‚ 0x03 ParcelableParcelableæ˜¯androidç‰¹æœ‰çš„å¤„ç†åºåˆ—åŒ–çš„æ–¹æ³•ã€‚å…ˆçœ‹ç®€å•çš„ä½¿ç”¨ï¼š åˆ›å»ºä¸€ä¸ªç±»ï¼š 123456public class User implements Parcelable &#123; public String userName; public int age; public boolean login; public float score;&#125; ä½¿ç”¨AndroidStudioçš„ä»£ç ç”ŸæˆåŠŸèƒ½ç”Ÿæˆå¦‚ä¸‹ æ¨¡ç‰ˆ ä»£ç ï¼š 1234567891011121314151617181920212223242526272829303132333435363738 public class User implements Parcelable &#123; public String userName; public int age; public boolean login; public float score; protected User(Parcel in) &#123; userName = in.readString(); age = in.readInt(); login = in.readByte() != 0; score = in.readFloat(); &#125; @Override public void writeToParcel(Parcel dest, int flags) &#123; dest.writeString(userName); dest.writeInt(age); dest.writeByte((byte) (login ? 1 : 0)); dest.writeFloat(score); &#125; @Override public int describeContents() &#123; return 0; &#125; public static final Creator&lt;User&gt; CREATOR = new Creator&lt;User&gt;() &#123; @Override public User createFromParcel(Parcel in) &#123; return new User(in); &#125; @Override public User[] newArray(int size) &#123; return new User[size]; &#125; &#125;;&#125; å¯¹æ¯”ä¸Šé¢çš„ä¸¤æ®µä»£ç ï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°ï¼š æ„é€ æ–¹æ³•ä¸­æ¥æ”¶ä¸€ä¸ª Parcel å¯¹è±¡ï¼Œé€šè¿‡è¿™ä¸ªå¯¹è±¡å¯¹æˆå‘˜å˜é‡èµ‹å€¼ å®ç°äº† Parcelable æ¥å£çš„æ–¹æ³• åœ¨ writeToParcel æ–¹æ³•ä¸­å°†æˆ‘ä»¬çš„æˆå‘˜å˜é‡å†™å…¥ Parcel åœ¨ describeContents ä¸­è¿”å›ä¸€ä¸ªæ•°å­— 0 Describe the kinds of special objects contained in this Parcelable instanceâ€™s marshaled representation. For example, if the object will include a file descriptor in the output of writeToParcel(Parcel, int), the return value of this method must include the CONTENTS_FILE_DESCRIPTOR bit. åˆ›å»ºäº†ä¸€ä¸ª public static final å¸¸é‡ CREATOR è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥é€šè¿‡Intentä¼ é€’å¯¹è±¡äº†ã€‚ åœ¨androidçš„å¾ˆå¤šæ–‡ç« ä¸­éƒ½å¯ä»¥çœ‹åˆ°ï¼ŒIntentä¸­ä¼ é€’æ•°æ®ï¼Œå¼ºçƒˆæ¨èä½¿ç”¨ Parcelable ä»–çš„æ•ˆç‡ä¼šæ¯” Serializableæ›´é«˜ï¼ˆæ¯”å¦‚åè€…æ²¡æœ‰ä½¿ç”¨åå°„ç­‰ç­‰ï¼‰ã€‚å½“ç„¶æ²¡æœ‰å®Œç¾çš„äº‹æƒ…ï¼ŒParcelable å¹¶ä¸èƒ½å®Œå…¨å–ä»£Serializableï¼Œæ¯”å¦‚å°†JVMå¯¹è±¡å­˜å‚¨åˆ°ç£ç›˜ç­‰ç­‰ã€‚ä½†æ˜¯å¯¹äºAndroidå¼€å‘ä¸­çš„é€šè¿‡Intentä¼ é€’æ•°æ®æ¥è¯´ï¼Œå·²ç»è¶³å¤Ÿã€‚ 0xFF å‚è€ƒ http://stackoverflow.com/questions/3611843/is-using-serializable-in-android-bad/3612364#3612364 http://www.ibm.com/developerworks/cn/java/j-lo-serial/index.html https://developer.android.com/reference/android/os/Parcelable.html http://blog.csdn.net/js931178805/article/details/8268144","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"https://ttdevs.github.io/categories/æŠ€æœ¯/"}],"tags":[{"name":"Android","slug":"Android","permalink":"https://ttdevs.github.io/tags/Android/"}]},{"title":"ã€ŒAndroidã€æ»šè½®åˆ»åº¦å°ºçš„å®ç°","slug":"[Android]æ»šè½®åˆ»åº¦å°ºçš„å®ç°","date":"1969-12-31T16:00:00.000Z","updated":"2017-04-27T11:07:57.000Z","comments":true,"path":"1970/01/01/[Android]æ»šè½®åˆ»åº¦å°ºçš„å®ç°/","link":"","permalink":"https://ttdevs.github.io/1970/01/01/[Android]æ»šè½®åˆ»åº¦å°ºçš„å®ç°/","excerpt":"","text":"0x00 æ»šè½®åˆ»åº¦å°ºï¼ˆå·å°ºï¼‰é‡åˆ°ä¸‹é¢è¿™æ ·ä¸€ä¸ªéœ€æ±‚ï¼š 0x01 é—®é¢˜åˆ†æå·å°ºï¼Œé€šè¿‡å·¦å³æ»‘åŠ¨æ¥é€‰æ‹©ä¸åŒçš„åˆ»åº¦å€¼ã€‚è¿™æ–¹é¢çš„ä¸œè¥¿ä»¥å‰æ²¡å¼„è¿‡ï¼Œä»¥ç›®å‰ä½ çš„èƒ½åŠ›ï¼Œæƒ³äº†å‡ ç§æ€è·¯éƒ½æ­»åœ¨äº†åŠè·¯ä¸Šã€‚æ¯”å¦‚ä¸Šé¢çš„åˆ»åº¦çº¿å¦‚ä½•å¼„ï¼Œæ»‘åŠ¨çš„æ—¶å€™åˆè¯¥å¦‚ä½•å¼„ï¼›ä¸‹é¢çš„æ•°å­—åˆå¦‚ä½•å¼„ï¼›çœ‹èµ·æ¥åƒåœ†åœˆçš„æ•ˆæœè¯¥å¦‚ä½•å¼„ã€‚æ—¶é—´ç´§è¿«ï¼Œå°±ä¿©æ™šä¸Šçš„æ—¶é—´ã€‚æ²¡æœ‰å¥½çš„æ€è·¯å°±å‚è€ƒåˆ«äººçš„å…ˆå§ï¼Œè¯´æ¥ä¹Ÿå·§ï¼Œä¸¤å¤©å‰åˆšçœ‹è¿‡ä¸€ä¸ªæ—¥æœŸé€‰æ‹©æ§ä»¶ï¼Œè¿˜æœ‰ä»¥å‰çœ‹çš„ä¸€ä¸ªä»¿iPhoneæ»šåŠ¨æ§ä»¶ ï¼Œæ•ˆæœç±»ä¼¼ï¼š æœ¬æƒ³æ‰¾ä½œè€…å‚²æ…¢çš„ä¸Šæ ¡äº¤æµä¸‹ï¼Œä½†æ˜¯æ—¶é—´æ¯”è¾ƒç´§ï¼Œæºç éƒ½ç»™äº†ä¹Ÿä¸æ˜¯å¾ˆå¥½æ„æ€ã€‚å¤§è‡´çš„æµè§ˆäº†ä¸‹ï¼Œå¯èƒ½æ¶‰åŠä¸‹é¢å‡ ä¸ªä¸œè¥¿ï¼š èƒŒæ™¯ï¼šè¿™ä¸ªç”¨shapeå®ç°ã€‚ä¹‹å‰æœ‰ç ”ç©¶è¿‡ï¼Œä¹Ÿç”¨è¿‡ï¼Œä½†æ˜¯è¿˜æ²¡å®ç°è¿‡è¦æ±‚çš„æ•ˆæœ åˆ»åº¦å’Œæ•°å­—ï¼šè¿™ä¸ªå°±ä¸è¦ä¹±æƒ³äº†ï¼Œç›´æ¥drawã€‚ç›¸å¯¹æ¥è¯´è¿˜æ˜¯æ¯”è¾ƒç®€å•çš„ï¼Œå°±æ˜¯ç”»ç›´çº¿å’Œå­— æ»šåŠ¨ï¼šæ»šåŠ¨çš„æ—¶å€™ä¸åœçš„é‡ç»˜å®ç°ä¸€ä¸ªæ»šåŠ¨çš„æ•ˆæœã€‚å¼„è¿‡ï¼Œä½†æ˜¯ä¸ç¡®å®šå®ç°çš„æ˜¯å•¥æ ·çš„æ•ˆæœ å¿«é€Ÿæ»šåŠ¨ï¼šScrollerå’ŒVelocityTrackerå¯èƒ½æ˜¯éœ€è¦ç”¨åˆ°çš„ä¸œè¥¿ã€‚å‡ ä¹å®Œå…¨æ²¡å¼„è¿‡ï¼Œéªšå¹´ï¼Œå­¦ä¹ å§ï¼ˆéœ€æ±‚çš„è¦æ±‚ä¸­ï¼Œè¿™ä¸ªä¼˜å…ˆçº§å¯ä»¥æœ€ä½ï¼‰ éœ€æ±‚ï¼šåˆ»åº¦çš„å•ä½æ˜¯å¯ä»¥å˜çš„ï¼Œæ¯”å¦‚åæ ¼ä¸€ä¸ªå•ä½ï¼Œæˆ–è€…ä¸¤æ ¼ä¸€ä¸ªå•ä½ï¼Œåœ¨æˆ–è€…å¯ä»¥æ˜¯ä»»æ„çš„ï¼ˆè¿™ä¸ªå‰æœŸæ€è·¯æ²¡æƒ³å¥½ï¼Œå®ç°èµ·æ¥å°±å›°éš¾äº†ï¼Œæœ€ååªå¼„äº†ä¸¤ç§ï¼‰ å…¶å®ï¼Œåˆ°äº†è¿™ä¸€æ­¥åŸºæœ¬ä¸Šå°±å·²ç»å¯ä»¥å®ç°äº†ï¼Œçœ‹ä¸ªæœ€ç»ˆæ•ˆæœå…ˆï¼š 0x02 å®ç°ä¸‹é¢ä¸€æ­¥ä¸€æ­¥æ¥ã€‚ åœ¨è¿™ä¹‹å‰è¿˜æœ‰ä¸ªåœ°æ–¹è¦è¯´çš„ï¼Œå°±æ˜¯æ§ä»¶çš„æ¥å£ï¼šå¯¹å¤–æä¾›ä¸€ä¸ªæ–¹æ³•å®ç°æ§ä»¶åˆå§‹åŒ–å’Œæ¥æ”¶æ§ä»¶é€‰æ‹©çš„å€¼ï¼šæ˜¾ç¤ºçš„å•ä½ï¼Œæœ€å¤§å€¼ï¼Œæœ€å°å€¼ï¼Œå½“å‰å€¼ï¼Œå›è°ƒæ¥å£ã€‚æœ‰äº†è¿™äº›ï¼Œå…ˆä»æœ€éš¾çš„å…¥æ‰‹ã€‚ å®ç°åˆ»åº¦å’Œæ•°å­—ï¼Œå¹¶å¯ä»¥æ»‘åŠ¨ è¿™ä¸ªåœ°æ–¹å¾ˆå…³é”®ï¼Œæ¯ä¸ªäººæœ‰æ¯ä¸ªäººçš„æ€è·¯ï¼Œè€Œä¸”æ€è·¯çš„å¥½åç›´æ¥å½±å“åˆ°åé¢å¯¹ä¸åŒå•ä½çš„å®ç°ã€‚ç›®å‰çš„æ€è·¯æ˜¯æ ¹æ®å½“å‰æ˜¾ç¤ºçš„æ•°å€¼mValueï¼Œä»æ§ä»¶ä¸­é—´å‘ä¸¤è¾¹ç”»åˆ»åº¦çº¿ï¼Œæ»‘åŠ¨çš„æ—¶å€™åŒæ—¶æ”¹å˜æ˜¾ç¤ºçš„å€¼mValueï¼Œä¸è¶³æœ€å°åˆ»åº¦çš„å››èˆäº”å…¥ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687@Overrideprotected void onDraw(Canvas canvas) &#123; super.onDraw(canvas); drawScaleLine(canvas); // drawWheel(canvas); drawMiddleLine(canvas);&#125;private void drawWheel(Canvas canvas) &#123; Drawable wheel = getResources().getDrawable(R.drawable.bg_wheel); wheel.setBounds(0, 0, getWidth(), getHeight()); wheel.draw(canvas);&#125;/*** ä»ä¸­é—´å¾€ä¸¤è¾¹å¼€å§‹ç”»åˆ»åº¦çº¿** @param canvas*/private void drawScaleLine(Canvas canvas) &#123; canvas.save(); Paint linePaint = new Paint(); linePaint.setStrokeWidth(2); linePaint.setColor(Color.BLACK); TextPaint textPaint = new TextPaint(Paint.ANTI_ALIAS_FLAG); textPaint.setTextSize(TEXT_SIZE * mDensity); int width = mWidth, drawCount = 0; float xPosition = 0, textWidth = Layout.getDesiredWidth(\"0\", textPaint); for (int i = 0; drawCount &lt;= 4 * width; i++) &#123; int numSize = String.valueOf(mValue + i).length(); xPosition = (width / 2 - mMove) + i * mLineDivider * mDensity; if (xPosition + getPaddingRight() &lt; mWidth) &#123; if ((mValue + i) % mModType == 0) &#123; canvas.drawLine(xPosition, getPaddingTop(), xPosition, mDensity * ITEM_MAX_HEIGHT, linePaint); if (mValue + i &lt;= mMaxValue) &#123; switch (mModType) &#123; case MOD_TYPE_HALF: canvas.drawText(String.valueOf((mValue + i) / 2), countLeftStart(mValue + i, xPosition, textWidth), getHeight() - textWidth, textPaint); break; case MOD_TYPE_ONE: canvas.drawText(String.valueOf(mValue + i), xPosition - (textWidth * numSize / 2), getHeight() - textWidth, textPaint); break; default: break; &#125; &#125; &#125; else &#123; canvas.drawLine(xPosition, getPaddingTop(), xPosition, mDensity * ITEM_MIN_HEIGHT, linePaint); &#125; &#125; xPosition = (width / 2 - mMove) - i * mLineDivider * mDensity; if (xPosition &gt; getPaddingLeft()) &#123; if ((mValue - i) % mModType == 0) &#123; canvas.drawLine(xPosition, getPaddingTop(), xPosition, mDensity * ITEM_MAX_HEIGHT, linePaint); if (mValue - i &gt;= 0) &#123; switch (mModType) &#123; case MOD_TYPE_HALF: canvas.drawText(String.valueOf((mValue - i) / 2), countLeftStart(mValue - i, xPosition, textWidth), getHeight() - textWidth, textPaint); break; case MOD_TYPE_ONE: canvas.drawText(String.valueOf(mValue - i), xPosition - (textWidth * numSize / 2), getHeight() - textWidth, textPaint); break; default: break; &#125; &#125; &#125; else &#123; canvas.drawLine(xPosition, getPaddingTop(), xPosition, mDensity * ITEM_MIN_HEIGHT, linePaint); &#125; &#125; drawCount += 2 * mLineDivider * mDensity; &#125; canvas.restore();&#125; æ»‘åŠ¨çš„åŠ é€Ÿé—®é¢˜ è¿™é‡Œç”¨åˆ°ä¸¤ä¸ªç±»Scrollerå’ŒVelocityTrackerï¼Œå…³äºè¿™ä¸¤ä¸ªç±»ä¹‹åæœ‰æœºä¼šä¼šè¯¦ç»†ä»‹ç»ï¼Œè¿™é‡Œç®€å•æä¸‹ï¼šVelocityTrackerçš„ä½œç”¨æ˜¯åœ¨ç”¨æˆ·åŠ é€Ÿæ»‘åŠ¨æ—¶è®¡ç®—è¯¥æ»‘åŠ¨å¤šè¿œï¼Œæ‹¿åˆ°è¿™ä¸ªä¹‹åé€šè¿‡Scrolleræ¥æ‰§è¡Œæ»‘åŠ¨è¿‡ç¨‹çš„è®¡ç®—ï¼Œæœ€åæ˜¯çœŸå®çš„â€œç§»åŠ¨â€â€”â€”æ ¹æ®mValueçš„å€¼è¿›è¡Œé‡ç»˜ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788899091929394959697@Overridepublic boolean onTouchEvent(MotionEvent event) &#123; int action = event.getAction(); int xPosition = (int) event.getX(); if (mVelocityTracker == null) &#123; mVelocityTracker = VelocityTracker.obtain(); &#125; mVelocityTracker.addMovement(event); switch (action) &#123; case MotionEvent.ACTION_DOWN: mScroller.forceFinished(true); mLastX = xPosition; mMove = 0; break; case MotionEvent.ACTION_MOVE: mMove += (mLastX - xPosition); changeMoveAndValue(); break; case MotionEvent.ACTION_UP: case MotionEvent.ACTION_CANCEL: countMoveEnd(); countVelocityTracker(event); return false; // break; default: break; &#125; mLastX = xPosition; return true;&#125;private void countVelocityTracker(MotionEvent event) &#123; mVelocityTracker.computeCurrentVelocity(1000); float xVelocity = mVelocityTracker.getXVelocity(); if (Math.abs(xVelocity) &gt; mMinVelocity) &#123; mScroller.fling(0, 0, (int) xVelocity, 0, Integer.MIN_VALUE, Integer.MAX_VALUE, 0, 0); &#125;&#125;private void changeMoveAndValue() &#123; int tValue = (int) (mMove / (mLineDivider * mDensity)); if (Math.abs(tValue) &gt; 0) &#123; mValue += tValue; mMove -= tValue * mLineDivider * mDensity; if (mValue &lt;= 0 || mValue &gt; mMaxValue) &#123; mValue = mValue &lt;= 0 ? 0 : mMaxValue; mMove = 0; mScroller.forceFinished(true); &#125; notifyValueChange(); &#125; postInvalidate();&#125;private void countMoveEnd() &#123; int roundMove = Math.round(mMove / (mLineDivider * mDensity)); mValue = mValue + roundMove; mValue = mValue &lt;= 0 ? 0 : mValue; mValue = mValue &gt; mMaxValue ? mMaxValue : mValue; mLastX = 0; mMove = 0; notifyValueChange(); postInvalidate();&#125;private void notifyValueChange() &#123; if (null != mListener) &#123; if (mModType == MOD_TYPE_ONE) &#123; mListener.onValueChange(mValue); &#125; if (mModType == MOD_TYPE_HALF) &#123; mListener.onValueChange(mValue / 2f); &#125; &#125;&#125;@Overridepublic void computeScroll() &#123; super.computeScroll(); if (mScroller.computeScrollOffset()) &#123; if (mScroller.getCurrX() == mScroller.getFinalX()) &#123; // over countMoveEnd(); &#125; else &#123; int xPosition = mScroller.getCurrX(); mMove += (mLastX - xPosition); changeMoveAndValue(); mLastX = xPosition; &#125; &#125;&#125; åœ†åœˆèƒŒæ™¯çš„å®ç° è¿™ä¸ªç”¨shapeæ¥åšï¼Œå¯ä»¥ä½¿ç”¨setBackgroundDrawable()æ¥åšï¼Œä¹Ÿå¯ä»¥åœ¨drawä¸­è¿›è¡Œç›´æ¥ç»˜åˆ¶ï¼Œæ•ˆæœç›¸åŒã€‚è¿˜æœ‰ä¸€äº›ç»†èŠ‚é—®é¢˜ï¼Œæ¯”å¦‚æ»‘åŠ¨æ—¶åˆ»åº¦çº¿è¶…è¿‡è¾¹ç•Œï¼Œæ»‘åŠ¨è·ç¦»å¤§æ—¶å€™æ˜¾ç¤ºä¸å®Œæ•´ç­‰é—®é¢˜ï¼Œè¿™ä¸ªåªæœ‰åšäº†æ‰ä¼šå‘ç°ã€‚ä¸‹é¢æ˜¯shapeèƒŒæ™¯çš„ä»£ç ï¼š 123456789101112131415161718&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;&lt;shape xmlns:android=\"http://schemas.android.com/apk/res/android\" android:shape=\"rectangle\" &gt; &lt;!-- two set color way --&gt; &lt;gradient android:angle=\"0\" android:centerColor=\"#66FFFFFF\" android:endColor=\"#66AAAAAA\" android:startColor=\"#66AAAAAA\" /&gt; &lt;corners android:radius=\"6dp\" /&gt; &lt;stroke android:width=\"6dp\" android:color=\"#FF666666\" /&gt; &lt;/shape&gt; ç”¨ä»£ç å¯ä»¥è¿™æ ·å†™ï¼š 12345678910111213141516private GradientDrawable createBackground() &#123; float strokeWidth = 4 * mDensity; // è¾¹æ¡†å®½åº¦ float roundRadius = 6 * mDensity; // åœ†è§’åŠå¾„ int strokeColor = Color.parseColor(\"#FF666666\");// è¾¹æ¡†é¢œè‰² // int fillColor = Color.parseColor(\"#DFDFE0\");// å†…éƒ¨å¡«å……é¢œè‰² setPadding((int) strokeWidth, (int) strokeWidth, (int) strokeWidth, 0); int colors[] = &#123;0xFF999999, 0xFFFFFFFF, 0xFF999999&#125;;// åˆ†åˆ«ä¸ºå¼€å§‹é¢œè‰²ï¼Œä¸­é—´å¤œè‰²ï¼Œç»“æŸé¢œè‰² GradientDrawable bgDrawable = new GradientDrawable(GradientDrawable.Orientation.LEFT_RIGHT, colors);// åˆ›å»ºdrawable // bgDrawable.setColor(fillColor); bgDrawable.setCornerRadius(roundRadius); bgDrawable.setStroke((int) strokeWidth, strokeColor); // setBackgroundDrawable(gd); return bgDrawable;&#125; 0x03 å®Œæ•´çš„ä»£ç 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261262263264265266267268269270271272273274275276277278279280281282283284285286287288289290291292293294295296297298299300301302303304305306307308309310311312313314315316317318319320321322323324325326327328329330331332333334335336337338339340341342343344345346347348349350351352353354355356357358359360361362363364365366367368369370371372373package com.ttdevs.wheel.widget;/** * å·å°ºæ§ä»¶ç±»ã€‚ç”±äºæ—¶é—´æ¯”è¾ƒç´§ï¼Œåªæœ‰ä¸‹ç­åæœ‰æ—¶é—´ï¼Œå› æ­¤åªå®ç°äº†åŸºæœ¬åŠŸèƒ½ã€‚&lt;br&gt; * ç»†èŠ‚é—®é¢˜åŒ…æ‹¬æ»‘åŠ¨è¿‡ç¨‹ä¸­widgetè¾¹ç¼˜çš„åˆ»åº¦æ˜¾ç¤ºé—®é¢˜ç­‰&lt;br&gt; * &lt;p&gt; * å‘¨æœ«æœ‰æ—¶é—´ä¼šç»§ç»­æ›´æ–°&lt;br&gt; * * @author ttdevs * @version createï¼š2014å¹´8æœˆ26æ—¥ */@SuppressLint(\"ClickableViewAccessibility\")public class TuneWheel extends View &#123; public interface OnValueChangeListener &#123; public void onValueChange(float value); &#125; public static final int MOD_TYPE_HALF = 2; public static final int MOD_TYPE_ONE = 10; private static final int ITEM_HALF_DIVIDER = 40; private static final int ITEM_ONE_DIVIDER = 10; private static final int ITEM_MAX_HEIGHT = 50; private static final int ITEM_MIN_HEIGHT = 20; private static final int TEXT_SIZE = 18; private float mDensity; private int mValue = 50, mMaxValue = 100, mModType = MOD_TYPE_HALF, mLineDivider = ITEM_HALF_DIVIDER; // private int mValue = 50, mMaxValue = 500, mModType = MOD_TYPE_ONE, // mLineDivider = ITEM_ONE_DIVIDER; private int mLastX, mMove; private int mWidth, mHeight; private int mMinVelocity; private Scroller mScroller; private VelocityTracker mVelocityTracker; private OnValueChangeListener mListener; @SuppressWarnings(\"deprecation\") public TuneWheel(Context context, AttributeSet attrs) &#123; super(context, attrs); mScroller = new Scroller(getContext()); mDensity = getContext().getResources().getDisplayMetrics().density; mMinVelocity = ViewConfiguration.get(getContext()).getScaledMinimumFlingVelocity(); // setBackgroundResource(R.drawable.bg_wheel); setBackgroundDrawable(createBackground()); &#125; private GradientDrawable createBackground() &#123; float strokeWidth = 4 * mDensity; // è¾¹æ¡†å®½åº¦ float roundRadius = 6 * mDensity; // åœ†è§’åŠå¾„ int strokeColor = Color.parseColor(\"#FF666666\");// è¾¹æ¡†é¢œè‰² // int fillColor = Color.parseColor(\"#DFDFE0\");// å†…éƒ¨å¡«å……é¢œè‰² setPadding((int) strokeWidth, (int) strokeWidth, (int) strokeWidth, 0); int colors[] = &#123;0xFF999999, 0xFFFFFFFF, 0xFF999999&#125;;// åˆ†åˆ«ä¸ºå¼€å§‹é¢œè‰²ï¼Œä¸­é—´å¤œè‰²ï¼Œç»“æŸé¢œè‰² GradientDrawable bgDrawable = new GradientDrawable(GradientDrawable.Orientation.LEFT_RIGHT, colors);// åˆ›å»ºdrawable // bgDrawable.setColor(fillColor); bgDrawable.setCornerRadius(roundRadius); bgDrawable.setStroke((int) strokeWidth, strokeColor); // setBackgroundDrawable(gd); return bgDrawable; &#125; /** * è€ƒè™‘å¯æ‰©å±•ï¼Œä½†æ˜¯æ—¶é—´ç´§è¿«ï¼Œåªå¯ä»¥æ”¯æŒä¸¤ç§ç±»å‹æ•ˆæœå›¾ä¸­ä¸¤ç§ç±»å‹ * * @param value åˆå§‹å€¼ * @param maxValue æœ€å¤§å€¼ * @param model åˆ»åº¦ç›˜ç²¾åº¦ï¼š&lt;br&gt; * &#123;@link MOD_TYPE_HALF&#125;&lt;br&gt; * &#123;@link MOD_TYPE_ONE&#125;&lt;br&gt; */ public void initViewParam(int defaultValue, int maxValue, int model) &#123; switch (model) &#123; case MOD_TYPE_HALF: mModType = MOD_TYPE_HALF; mLineDivider = ITEM_HALF_DIVIDER; mValue = defaultValue * 2; mMaxValue = maxValue * 2; break; case MOD_TYPE_ONE: mModType = MOD_TYPE_ONE; mLineDivider = ITEM_ONE_DIVIDER; mValue = defaultValue; mMaxValue = maxValue; break; default: break; &#125; invalidate(); mLastX = 0; mMove = 0; notifyValueChange(); &#125; /** * è®¾ç½®ç”¨äºæ¥æ”¶ç»“æœçš„ç›‘å¬å™¨ * * @param listener */ public void setValueChangeListener(OnValueChangeListener listener) &#123; mListener = listener; &#125; /** * è·å–å½“å‰åˆ»åº¦å€¼ * * @return */ public float getValue() &#123; return mValue; &#125; @Override protected void onLayout(boolean changed, int left, int top, int right, int bottom) &#123; mWidth = getWidth(); mHeight = getHeight(); super.onLayout(changed, left, top, right, bottom); &#125; @Override protected void onDraw(Canvas canvas) &#123; super.onDraw(canvas); drawScaleLine(canvas); // drawWheel(canvas); drawMiddleLine(canvas); &#125; private void drawWheel(Canvas canvas) &#123; Drawable wheel = getResources().getDrawable(R.drawable.bg_wheel); wheel.setBounds(0, 0, getWidth(), getHeight()); wheel.draw(canvas); &#125; /** * ä»ä¸­é—´å¾€ä¸¤è¾¹å¼€å§‹ç”»åˆ»åº¦çº¿ * * @param canvas */ private void drawScaleLine(Canvas canvas) &#123; canvas.save(); Paint linePaint = new Paint(); linePaint.setStrokeWidth(2); linePaint.setColor(Color.BLACK); TextPaint textPaint = new TextPaint(Paint.ANTI_ALIAS_FLAG); textPaint.setTextSize(TEXT_SIZE * mDensity); int width = mWidth, drawCount = 0; float xPosition = 0, textWidth = Layout.getDesiredWidth(\"0\", textPaint); for (int i = 0; drawCount &lt;= 4 * width; i++) &#123; int numSize = String.valueOf(mValue + i).length(); xPosition = (width / 2 - mMove) + i * mLineDivider * mDensity; if (xPosition + getPaddingRight() &lt; mWidth) &#123; if ((mValue + i) % mModType == 0) &#123; canvas.drawLine(xPosition, getPaddingTop(), xPosition, mDensity * ITEM_MAX_HEIGHT, linePaint); if (mValue + i &lt;= mMaxValue) &#123; switch (mModType) &#123; case MOD_TYPE_HALF: canvas.drawText(String.valueOf((mValue + i) / 2), countLeftStart(mValue + i, xPosition, textWidth), getHeight() - textWidth, textPaint); break; case MOD_TYPE_ONE: canvas.drawText(String.valueOf(mValue + i), xPosition - (textWidth * numSize / 2), getHeight() - textWidth, textPaint); break; default: break; &#125; &#125; &#125; else &#123; canvas.drawLine(xPosition, getPaddingTop(), xPosition, mDensity * ITEM_MIN_HEIGHT, linePaint); &#125; &#125; xPosition = (width / 2 - mMove) - i * mLineDivider * mDensity; if (xPosition &gt; getPaddingLeft()) &#123; if ((mValue - i) % mModType == 0) &#123; canvas.drawLine(xPosition, getPaddingTop(), xPosition, mDensity * ITEM_MAX_HEIGHT, linePaint); if (mValue - i &gt;= 0) &#123; switch (mModType) &#123; case MOD_TYPE_HALF: canvas.drawText(String.valueOf((mValue - i) / 2), countLeftStart(mValue - i, xPosition, textWidth), getHeight() - textWidth, textPaint); break; case MOD_TYPE_ONE: canvas.drawText(String.valueOf(mValue - i), xPosition - (textWidth * numSize / 2), getHeight() - textWidth, textPaint); break; default: break; &#125; &#125; &#125; else &#123; canvas.drawLine(xPosition, getPaddingTop(), xPosition, mDensity * ITEM_MIN_HEIGHT, linePaint); &#125; &#125; drawCount += 2 * mLineDivider * mDensity; &#125; canvas.restore(); &#125; /** * è®¡ç®—æ²¡æœ‰æ•°å­—æ˜¾ç¤ºä½ç½®çš„è¾…åŠ©æ–¹æ³• * * @param value * @param xPosition * @param textWidth * @return */ private float countLeftStart(int value, float xPosition, float textWidth) &#123; float xp = 0f; if (value &lt; 20) &#123; xp = xPosition - (textWidth * 1 / 2); &#125; else &#123; xp = xPosition - (textWidth * 2 / 2); &#125; return xp; &#125; /** * ç”»ä¸­é—´çš„çº¢è‰²æŒ‡ç¤ºçº¿ã€é˜´å½±ç­‰ã€‚æŒ‡ç¤ºçº¿ä¸¤ç«¯ç®€å•çš„ç”¨äº†ä¸¤ä¸ªçŸ©å½¢ä»£æ›¿ * * @param canvas */ private void drawMiddleLine(Canvas canvas) &#123; // TOOD å¸¸é‡å¤ªå¤šï¼Œæš‚æ—¶æ”¾è¿™ï¼Œæœ€ç»ˆä¼šæ”¾åœ¨ç±»çš„å¼€å§‹ï¼Œæ”¾è¿œäº†æ€•å¾ˆå¿«å¿˜è®° int gap = 12, indexWidth = 8, indexTitleWidth = 24, indexTitleHight = 10, shadow = 6; String color = \"#66999999\"; canvas.save(); Paint redPaint = new Paint(); redPaint.setStrokeWidth(indexWidth); redPaint.setColor(Color.RED); canvas.drawLine(mWidth / 2, 0, mWidth / 2, mHeight, redPaint); Paint ovalPaint = new Paint(); ovalPaint.setColor(Color.RED); ovalPaint.setStrokeWidth(indexTitleWidth); canvas.drawLine(mWidth / 2, 0, mWidth / 2, indexTitleHight, ovalPaint); canvas.drawLine(mWidth / 2, mHeight - indexTitleHight, mWidth / 2, mHeight, ovalPaint); // RectF ovalRectF = new RectF(mWidth / 2 - 10, 0, mWidth / 2 + 10, 4 * // mDensity); //TODO æ¤­åœ† // canvas.drawOval(ovalRectF, ovalPaint); // ovalRectF.set(mWidth / 2 - 10, mHeight - 8 * mDensity, mWidth / 2 + // 10, mHeight); //TODO Paint shadowPaint = new Paint(); shadowPaint.setStrokeWidth(shadow); shadowPaint.setColor(Color.parseColor(color)); canvas.drawLine(mWidth / 2 + gap, 0, mWidth / 2 + gap, mHeight, shadowPaint); canvas.restore(); &#125; @Override public boolean onTouchEvent(MotionEvent event) &#123; int action = event.getAction(); int xPosition = (int) event.getX(); if (mVelocityTracker == null) &#123; mVelocityTracker = VelocityTracker.obtain(); &#125; mVelocityTracker.addMovement(event); switch (action) &#123; case MotionEvent.ACTION_DOWN: mScroller.forceFinished(true); mLastX = xPosition; mMove = 0; break; case MotionEvent.ACTION_MOVE: mMove += (mLastX - xPosition); changeMoveAndValue(); break; case MotionEvent.ACTION_UP: case MotionEvent.ACTION_CANCEL: countMoveEnd(); countVelocityTracker(event); return false; // break; default: break; &#125; mLastX = xPosition; return true; &#125; private void countVelocityTracker(MotionEvent event) &#123; mVelocityTracker.computeCurrentVelocity(1000); float xVelocity = mVelocityTracker.getXVelocity(); if (Math.abs(xVelocity) &gt; mMinVelocity) &#123; mScroller.fling(0, 0, (int) xVelocity, 0, Integer.MIN_VALUE, Integer.MAX_VALUE, 0, 0); &#125; &#125; private void changeMoveAndValue() &#123; int tValue = (int) (mMove / (mLineDivider * mDensity)); if (Math.abs(tValue) &gt; 0) &#123; mValue += tValue; mMove -= tValue * mLineDivider * mDensity; if (mValue &lt;= 0 || mValue &gt; mMaxValue) &#123; mValue = mValue &lt;= 0 ? 0 : mMaxValue; mMove = 0; mScroller.forceFinished(true); &#125; notifyValueChange(); &#125; postInvalidate(); &#125; private void countMoveEnd() &#123; int roundMove = Math.round(mMove / (mLineDivider * mDensity)); mValue = mValue + roundMove; mValue = mValue &lt;= 0 ? 0 : mValue; mValue = mValue &gt; mMaxValue ? mMaxValue : mValue; mLastX = 0; mMove = 0; notifyValueChange(); postInvalidate(); &#125; private void notifyValueChange() &#123; if (null != mListener) &#123; if (mModType == MOD_TYPE_ONE) &#123; mListener.onValueChange(mValue); &#125; if (mModType == MOD_TYPE_HALF) &#123; mListener.onValueChange(mValue / 2f); &#125; &#125; &#125; @Override public void computeScroll() &#123; super.computeScroll(); if (mScroller.computeScrollOffset()) &#123; if (mScroller.getCurrX() == mScroller.getFinalX()) &#123; // over countMoveEnd(); &#125; else &#123; int xPosition = mScroller.getCurrX(); mMove += (mLastX - xPosition); changeMoveAndValue(); mLastX = xPosition; &#125; &#125; &#125;&#125;","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"https://ttdevs.github.io/categories/æŠ€æœ¯/"}],"tags":[{"name":"Android","slug":"Android","permalink":"https://ttdevs.github.io/tags/Android/"}]},{"title":"ã€ŒAndroidã€å¯¹Appè¿›è¡Œä»£ç æ··æ·†","slug":"[Android]å¯¹Appè¿›è¡Œä»£ç æ··æ·†","date":"1969-12-31T16:00:00.000Z","updated":"2017-04-27T11:07:57.000Z","comments":true,"path":"1970/01/01/[Android]å¯¹Appè¿›è¡Œä»£ç æ··æ·†/","link":"","permalink":"https://ttdevs.github.io/1970/01/01/[Android]å¯¹Appè¿›è¡Œä»£ç æ··æ·†/","excerpt":"","text":"æ¥åˆ°ä¸€ä¸ªæ–°çš„ä»»åŠ¡ï¼Œå¯¹ç°æœ‰é¡¹ç›®è¿›è¡Œä»£ç æ··æ·†ã€‚ä¹‹å‰å¯¹æ··æ·†æœ‰è¿‡ä¸€äº›äº†è§£ï¼Œä½†æ˜¯ä¸å¤Ÿè¯¦ç»†å’Œå®Œæ•´ï¼ŒçŸ¥é“æœ‰äº›ä¸œè¥¿æ··æ·†èµ·æ¥è¿˜æ˜¯æ¯”è¾ƒæ£˜æ‰‹çš„ã€‚ä¸è¿‡å¹¸å¥½ç›®å‰çš„é¡¹ç›®ä¸æ˜¯å¤ªå¤æ‚ï¼ˆé’ˆå¯¹æ··æ·†è¿™å—æ¥è¯´ï¼‰ï¼Œæå‰å®Œæˆï½ï½ ç°æ€»ç»“ä¹‹ã€‚ 0x01 ç¬¬ä¸€éƒ¨åˆ†ä»‹ç»ä¸‹æ“ä½œæµç¨‹ï¼ˆeclipseï¼‰ï¼š æ‰“å¼€æ··æ·†å™¨ æ‰¾åˆ°é¡¹ç›®æ ¹ç›®å½•ä¸‹çš„ project.properties æ–‡ä»¶ #proguard.config=${sdk.dir}/tools/proguard/proguard-android.txt:proguard-project.txt å°†ä¸Šé¢è¿™è¡Œå‰çš„ # åˆ é™¤å³å¯ ä¿®æ”¹æ··æ·†é…ç½®æ–‡ä»¶ æ‰¾åˆ°é¡¹ç›®æ ¹ç›®å½•ä¸‹çš„ proguard-project.txt æ–‡ä»¶ï¼Œä¿®æ”¹å…¶ä¸­ä»£ç ï¼Œè¿™éƒ¨åˆ†æ˜¯æœ€å…³é”® ä¿å­˜ç›¸å…³æ–‡ä»¶ä¾›ä»¥åå‡ºé”™æ—¶ä½¿ç”¨ ä¸»è¦æœ‰å¯¼å‡ºçš„apkæ–‡ä»¶ã€é¡¹ç›®æ ¹ç›®å½•ä¸‹çš„proguardç›®å½•ä¸‹çš„æ–‡ä»¶ï¼ˆä¸»è¦çš„æ˜¯mapping.txtï¼‰å’Œé¡¹ç›®æºç  é¡¹ç›®è¿è¡Œè¿‡ç¨‹å‡ºé”™å¤„ç† æ ¹æ®é”™è¯¯ä¿¡æ¯å’Œç¬¬3æ­¥ä¸­ä¿å­˜çš„mappingå®šä½é”™è¯¯ä½ç½® çŸ¥é“è¿™äº›ä¹‹åï¼Œæˆ‘ä»¬å¯¹å…¶è¿›è¡Œå±•å¼€ã€‚ æ‰“å¼€eclipseç„¶åæ–°å»ºä¸€ä¸ªé¡¹ç›®ï¼Œé»˜è®¤ä¼šåˆ›å»º proguard-project.txt å’Œproject.propertiesã€‚ç¼–å†™æˆ‘ä»¬çš„ä»£ç ï¼Œä¿®æ”¹ proguard-project.txt ï¼š #proguard.config=${sdk.dir}/tools/proguard/proguard-android.txt :proguard-project.txt å°†è¿™è¡Œå‰çš„ # åˆ é™¤ï¼Œæœ€åå¯¼å‡ºå³å¯å®ç°å¯¹ä»£ç çš„æ··æ·†ï¼ˆå³ä½¿æˆ‘ä»¬æ²¡æœ‰å»ç¼–å†™proguard-project.txtä¸­çš„å†…å®¹ï¼‰ã€‚ä¸‹é¢æ˜¯æˆ‘çš„æµ‹è¯•ä»£ç ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970public class MainActivity extends Activity &#123; private String mName; @Override protected void onCreate(Bundle savedInstanceState) &#123; super.onCreate(savedInstanceState); setContentView(R.layout.activity_main); mName = \"ttdevs\"; getString(mName); setName(mName); showDialog(); // testError(); &#125; public String getString(String name) &#123; return \"hello \" + name; &#125; public void setName(String name) &#123; System.out.println(\"I'm \" + name); &#125; private void showDialog() &#123; new Handler().postDelayed(new Runnable() &#123; @Override public void run() &#123; ScoreAlertDialog.showDialog(MainActivity.this); &#125; &#125;, 2000); &#125; public static class ScoreAlertDialog &#123; public static void showDialog(final Activity activity) &#123; if (activity.isFinishing()) &#123; return; &#125; try &#123; AlertDialog.Builder builder = new AlertDialog.Builder(activity); builder.setTitle(\"alert_title\"); builder.setNegativeButton(\"cancel\", null); builder.setPositiveButton(\"submit\", new DialogInterface.OnClickListener() &#123; @Override public void onClick(DialogInterface dialog, int which) &#123; try &#123; Toast.makeText(activity, \"Welcome\", Toast.LENGTH_LONG).show(); &#125; catch (Exception e) &#123; e.printStackTrace(); &#125; &#125; &#125;); builder.show(); &#125; catch (Exception e) &#123; e.printStackTrace(); &#125; &#125; &#125; private void testError() &#123; try &#123; int error = 1 / 0; &#125; catch (Exception e) &#123; e.printStackTrace(); &#125; &#125;&#125; æ‰“åŒ…ï¼Œåç¼–è¯‘ï¼Œæœ€åæˆ‘ä»¬å¾—åˆ°å¦‚ä¸‹çš„ä»£ç ï¼š åˆ†æä¸Šé¢çš„ä»£ç æˆ‘ä»¬ä¼šå‘ç°ï¼Œè‡ªå®šä¹‰çš„æ–¹æ³•åéƒ½è¢«æ›¿æ¢æˆæ— ç‰¹æ®Šæ„ä¹‰çš„çŸ­å­—æ¯ï¼Œè€Œactivityçš„onCreate()æ–¹æ³•å´æ²¡å˜ï¼›æœ€åä¸€ä¸ªtestError()æ–¹æ³•ç”±äºæˆ‘ä»¬æ²¡æœ‰è°ƒç”¨ä¹Ÿè¢«å‰”é™¤æ‰äº†ã€‚è¿™äº›å°±æ˜¯é»˜è®¤çš„æ··æ·†å¤„ç†ç­–ç•¥ã€‚çœ‹åˆ°è¿™é‡Œï¼Œæ„Ÿè§‰æ··æ·†è¿˜æ˜¯å°caseçš„å“ˆï½ï½ ç»§ç»­å¾€ä¸‹ï¼Œæˆ‘ä»¬å°†æ³¨é”€çš„testError()æ‰“å¼€ï¼Œæ‰“åŒ…è¿è¡Œè¿™ä¸ªæ—¶å€™ä¼šæŠ¥é”™ï¼Œé”™è¯¯ä¿¡æ¯å¦‚ä¸‹ï¼š 1234567891011121314151617java.lang.ArithmeticException: divide by zero at com.ttdevs.proguard.MainActivity.b(Unknown Source) at com.ttdevs.proguard.MainActivity.onCreate(Unknown Source) at android.app.Activity.performCreate(Activity.java:4531) at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1071) at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2150) at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2229) at android.app.ActivityThread.access$600(ActivityThread.java:139) at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1261) at android.os.Handler.dispatchMessage(Handler.java:99) at android.os.Looper.loop(Looper.java:154) at android.app.ActivityThread.main(ActivityThread.java:4945) at java.lang.reflect.Method.invokeNative(Native Method) at java.lang.reflect.Method.invoke(Method.java:511) at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784) at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551) at dalvik.system.NativeStart.main(Native Method) ç”±äºè¿™ä¸ªä¾‹å­æ¯”è¾ƒç®€å•ï¼Œå¾ˆå®¹æ˜“çœ‹å‡ºæ¥æ˜¯ä½•åœ°æ–¹å‡ºäº†é—®é¢˜ï¼Œä¸è¿‡è¿˜æ˜¯å¯ä»¥ç”¨æ¥è¯´æ˜æˆ‘ä»¬æƒ³è¡¨è¾¾çš„é—®é¢˜ï¼šå¦‚ä½•è¿˜åŸæ··æ·†åçš„ä»£ç çš„é”™è¯¯ä¿¡æ¯ï¼Ÿä¸ºäº†è¾¾åˆ°è¿™ä¸ªç›®çš„ï¼Œæˆ‘ä»¬éœ€è¦ä¸‰ä¸ªæ–‡ä»¶: android-sdk-windows\\tools\\proguard\\bin\\retrace.bat mapping.txt log.infoï¼ˆä¸Šé¢çš„é”™è¯¯ä¿¡æ¯ï¼‰ ç„¶åæ‰§è¡Œä¸‹é¢çš„å‘½ä»¤ï¼ˆwindowç³»ç»Ÿï¼‰ retrace.bat mapping.txt log.txt ä»ä¸Šå›¾ä¸­å¯ä»¥å¾ˆæ¸…æ¥šçš„çœ‹åˆ°é”™è¯¯æ—¥å¿—ä¸­çš„b()æ–¹æ³•ä¸ºæˆ‘ä»¬å®é™…ä»£ç ä¸­çš„setName()æ–¹æ³•ã€‚ è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯æ¯æ¬¡å¯¼å‡ºapkéƒ½ä¼šåœ¨é¡¹ç›®ä¸­ç›®å½•ä¸‹çš„proguardæ–‡ä»¶å¤¹ä¸‹ç”Ÿæˆä¸€ä¸ªå¯¹åº”çš„mapping.txt æ–‡ä»¶ï¼Œæ‰€ä»¥å¯¹äºæ¯ä¸ªapkæˆ‘ä»¬éƒ½éœ€è¦ä¿å­˜ä¸ä¹‹å¯¹åº”çš„mapping.txtæ–‡ä»¶ã€‚è‡³æ­¤æ•´ä¸ªæ··æ·†çš„æµç¨‹ä»‹ç»å®Œæ¯•ã€‚ å‚è€ƒ å®˜æ–¹æ–‡æ¡£ http://developer.android.com/tools/help/proguard.html å®˜æ–¹æ–‡æ¡£çš„ç¿»è¯‘ http://www.cnblogs.com/over140/archive/2011/04/22/2024528.html ï¼ˆæœ¬æƒ³è‡ªå·±å»ç¿»ä¸€ä¸ªï¼Œç»“æœå‘ç°å¾ˆä¹…ä»¥å‰å†œæ°‘ä¼¯ä¼¯å·²ç»ç¿»è¯‘ï¼Œåœ¨æ­¤ç›´æ¥å¼•ç”¨å¹¶æ„Ÿè°¢ä¹‹ï¼‰ 0x02 ç¬¬äºŒéƒ¨åˆ†ç¬¬ä¸€éƒ¨åˆ†è®²äº†å¦‚ä½•æ“ä½œï¼Œå‚ç…§å®˜æ–¹æ–‡æ¡£ï¼ŒåŸºæœ¬éƒ½ä¼šæŒæ¡ã€‚å‰©ä¸‹çš„ä¹Ÿæ˜¯æœ€éš¾çš„å°±æ˜¯ proguard-project.txt æ–‡ä»¶çš„ç¼–å†™ã€‚å¯¹äºè¿™éƒ¨åˆ†ï¼Œä¸¤ç§å¤„ç†ç­–ç•¥ï¼šè‡ªå·±ç¼–å†™å’Œä½¿ç”¨åˆ«äººå†™å¥½çš„ã€‚å…ˆè¯´å¦‚ä½•ä½¿ç”¨åˆ«äººå†™å¥½çš„ï¼Œæˆ‘ä»¬å¼•ç”¨çš„ç¬¬ä¸‰æ–¹åº“æ— è®ºå¼€æºè¿˜æ˜¯é—­æºå¦‚æœ‰ç‰¹æ®Šæƒ…å†µæˆ‘ä»¬éƒ½å¯ä»¥åœ¨ä»–çš„User Guideä¸­æ‰¾åˆ°æ··æ·†ä»£ç çš„é…ç½®ï¼Œå¦‚æˆ‘ä»¬å¼•ç”¨çš„å¤§åé¼é¼çš„ guillep PullToRefresh ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ä»–çš„æ–‡æ¡£ ä¸­æ‰¾åˆ°å¦‚ä¸‹çš„ä»£ç ï¼š 123456789101112131415161718192021222324252627282930313233343536-optimizationpasses 5-dontusemixedcaseclassnames-dontskipnonpubliclibraryclasses-dontpreverify-verbose-optimizations !code/simplification/arithmetic,!field/*,!class/merging/* -keep public class * extends android.app.Activity-keep public class * extends android.app.Application-keep public class * extends android.app.Service-keep public class * extends android.content.BroadcastReceiver-keep public class * extends android.content.ContentProvider-keep public class * extends android.app.backup.BackupAgentHelper-keep public class * extends android.preference.Preference-keep public class com.android.vending.licensing.ILicensingService -keepclasseswithmembernames class * &#123; native &lt;methods&gt;;&#125; -keepclasseswithmembernames class * &#123; public &lt;init&gt;(android.content.Context, android.util.AttributeSet);&#125; -keepclasseswithmembernames class * &#123; public &lt;init&gt;(android.content.Context, android.util.AttributeSet, int);&#125; -keepclassmembers enum * &#123; public static **[] values(); public static ** valueOf(java.lang.String);&#125; -keep class * implements android.os.Parcelable &#123; public static final android.os.Parcelable$Creator *;&#125; æœ‰äº†è¿™éƒ¨åˆ†ä»£ç æˆ‘ä»¬å°±å¯ä»¥ç›´æ¥copyæ’å…¥æˆ‘ä»¬çš„é¡¹ç›®ä¸­å³å¯ã€‚è¿™ç§æ–¹å¼è¿˜æ˜¯copyå¼çš„ã€‚é‚£ä¸‹é¢æˆ‘ä»¬ä¸¾ä¸ªå°ä¾‹å­çœ‹çœ‹å¦‚ä½•è‡ªå·±å†™ä»£ç æ§åˆ¶æ˜¯å¦æ··æ·†ã€‚è¿˜æ˜¯ç”¨ç¬¬ä¸€éƒ¨åˆ†çš„ä¾‹å­ï¼Œæˆ‘ä»¬åœ¨è¿™ä¸ªé¡¹ç›®çš„ proguard-project.txt æ–‡ä»¶ä¸­ï¼ˆä¹‹å‰ä¸ºç©ºï¼‰åŠ å…¥å¦‚ä¸‹å‡ è¡Œï¼ˆproguard-project.txtä¸­â€œ#â€ä»£è¡¨æ³¨é‡Šï¼‰ï¼š 123456# -keep public class com.ttdevs.proguard.** &#123; *; &#125;# -keepclasseswithmembers public class com.ttdevs.proguard.** &#123; *; &#125; -keep public class com.ttdevs.proguard.MainActivity &#123;java.lang.String getString(java.lang.String);&#125; ç„¶åæˆ‘ä»¬å¯¼å‡ºapkå†åç¼–è¯‘ï¼Œå¾—åˆ°å¦‚ä¸‹ä»£ç ï¼š å’Œä¹‹å‰çš„å¯¹æ¯”ï¼Œæˆ‘ä»¬å‘ç°å…¶ä¸­çš„getStringæ–¹æ³•æ²¡æœ‰è¢«æ··æ·†ã€‚æ²¡é”™ï¼Œä¸Šé¢ proguard-project.txtçš„æ„æ€å°±æ˜¯ä¿æŒMainActivityçš„getString()æ–¹æ³•ä¸è¦è¢«æ··æ·†ã€‚å¤§å®¶ä¹Ÿå¯ä»¥è¯•è¯•ä¸Šè¿°æ··æ·†ä»£ç ä¸­è¢«æ³¨é‡Šçš„ä¸¤è¡Œåˆ†åˆ«æ˜¯ä»€ä¹ˆæ•ˆæœã€‚ è®²åˆ°è¿™é‡Œå·²ç»å¼€å§‹æ¶‰åŠProGuardçš„æ ¸å¿ƒéƒ¨åˆ†äº†ï¼Œå‰©ä¸‹çš„å°±æ˜¯ç ”è¯» ProGuardçš„æ–‡æ¡£ ï¼ŒæŒæ¡çš„ä»–çš„è¯­æ³•å¹¶ä½¿ç”¨ä¹‹ã€‚æœ¬æƒ³æ‰¾ä¸€ä¸ªå®Œæ•´çš„ProGuardçš„ç¿»è¯‘æ–‡æ¡£ï¼Œä½†æ˜¯æ‰¾äº†Nä¹…æ²¡æœ‰å‘ç°ä¸€ä¸ªï¼Œè€Œä¸”è¿é›¶é›¶æ•£æ•£çš„ç¿»è¯‘ä¹Ÿéå¸¸çš„å°‘ï¼Œæœ€è¿‘æ—¶é—´å¾ˆç´§ï¼ŒåŠ ä¹‹èƒ½åŠ›æœ‰é™ï¼Œæƒ³ç¿»è¯‘ä¸€ä¸‹å¸¸ç”¨çš„å‡ ä¸ªå‘½ä»¤ä¹Ÿæ˜¯å¾ˆå›°ï¼Œæ‰€ä»¥ç»†è¯»çš„æƒ³æ³•åªèƒ½æš‚æ—¶å¾€åæ¨äº†ã€‚è¿™é‡Œå…ˆç®€å•ä»‹ç»ä¸‹keepå‘½ä»¤ï¼š -keep [,modifier,â€¦] class_specification åœ¨ä½ çš„ä»£ç ä¸­æŒ‡å®šä½œä¸ºåˆ‡å…¥ç‚¹è€Œè¢«ä¿ç•™çš„ç±»æˆ–è€…ç±»çš„æˆå‘˜ï¼ˆå±æ€§å’Œæ–¹æ³•ï¼‰ã€‚ä¾‹å¦‚ï¼Œä¸ºäº†ä¿æŒä¸€ä¸ªåº”ç”¨ï¼Œä½ å¯ä»¥æŒ‡å®šä¸»ç±»å’Œä»–çš„mainæ–¹æ³•ã€‚ä¸ºäº†å¤„ç†ä¸€ä¸ªåº“ï¼Œä½ éœ€è¦è¯¦ç»†è¯´æ˜ä»–çš„publicè®¿é—®çš„å…ƒç´ ã€‚ å¦å¤–è¿˜æœ‰keepçš„ç®€å•æ¦‚è¿° å’Œ è¯­æ³•ä¸­è§„èŒƒ ã€‚ Class Specificationä¸­ä¼šå‘Šè¯‰ä½ å¦‚ä½•è¡¨ç¤ºæ„é€ æ–¹æ³•ï¼Œå±æ€§å’Œæ–¹æ³•ï¼Œ* ä¸**çš„åŒºåˆ«ç­‰ç­‰ã€‚æ¯”å¦‚ * è¡¨ç¤ºåŒ¹é…ä»»ä½•çš„ç±»åä½†æ˜¯ä¸åŒ…æ‹¬åŒ…çš„åˆ†éš”ç¬¦ï¼Œè€Œ ** åˆ™æ˜¯åŒ¹é…ä»»ä½•çš„ç±»åå¹¶ä¸”åŒ…æ‹¬ä»»æ„æ•°é‡çš„åŒ…åˆ†éš”ç¬¦ï¼Œå› æ­¤ä¸Šé¢æˆ‘ä»¬æ³¨é‡Šæ‰çš„ä»£ç æ„æ€å¦‚ä¸‹ï¼š ç¬¬ä¸€è¡Œ ä¿æŒcom.ttdevs.proguardä¸‹çš„æ‰€æœ‰ç±»å’Œå­åŒ…ä¸‹çš„ç±»çš„æ‰€æœ‰æ–¹æ³•éƒ½ä¸æ··æ·† ç¬¬äºŒè¡Œ ä¿æŒcom.ttdevs.proguardä¸‹çš„æ‰€æœ‰ç±»å’Œå­åŒ…ä¸‹çš„ç±»çš„æ‰€æœ‰æ–¹æ³•å’Œæˆå‘˜å˜é‡éƒ½ä¸æ··æ·†ã€‚ // TODO ç»†èŠ‚è¿˜æœ‰å¾ˆå¤šï¼Œæ¯”å¦‚-libraryjarsã€-dontwarnã€-keepattributesç­‰ç­‰ï¼Œè¿™äº›å¾…ç»­å§ å‚è€ƒ ProGuard 5.0 ProGuard 5.0 ProGuard 4.7 ProGuard 4.7","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"https://ttdevs.github.io/categories/æŠ€æœ¯/"}],"tags":[{"name":"Android","slug":"Android","permalink":"https://ttdevs.github.io/tags/Android/"}]},{"title":"ã€ŒFlaskã€0x01FlaskMail","slug":"[Flask]0x01FlaskMail","date":"1969-12-31T16:00:00.000Z","updated":"2017-04-27T11:07:57.000Z","comments":true,"path":"1970/01/01/[Flask]0x01FlaskMail/","link":"","permalink":"https://ttdevs.github.io/1970/01/01/[Flask]0x01FlaskMail/","excerpt":"","text":"0x00 ç®€ä»‹ Welcome to Flask-Mail, you can use to send mail in your web site. Flask-Mail æä¾›äº†ä¸€ä¸ªç®€å•çš„æ¥å£ï¼Œè®©æˆ‘ä»¬å¯ä»¥æ–¹ä¾¿çš„åœ¨ Flask åº”ç”¨ä¸­ä½¿ç”¨ SMTPåè®® å‘é€é‚®ä»¶ã€‚ 0x01 å®‰è£…pip install Flask-Mail ç›®å‰æœ€æ–°ç‰ˆæœ¬æ˜¯ 0.9.1 ï¼Œä» Flask-Mailçš„githubåœ°å€å¯ä»¥å‘ç°ï¼Œä¸¤å¹´æ²¡æœ‰æ›´æ–°äº†ã€‚ä¸è¿‡è¿™ä¸ªå¹¶ä¸å½±å“æˆ‘ä»¬ä½¿ç”¨ï¼Œæ¯•ç«Ÿå‘é€é‚®ä»¶æ˜¯ä¸ªæ¯”è¾ƒæˆç†Ÿçš„ä¸œè¥¿ï¼Œåªç¥ˆæ±‚å’Œæœ€æ–°çš„Flaskä¸è¦å‡ºç°å…¼å®¹é—®é¢˜å³å¯ã€‚ å¦‚æœä½ ä¸æƒ³ä½¿ç”¨è¿™ä¸ªå·¥å…·ï¼Œå¯ä»¥æ‰¾æ‰¾å…¶ä»–çš„ï¼Œä¸è¿‡ä½ ä¼šå‘ç°ï¼Œå…¶ä»–çš„å¯èƒ½æ›´è€ï¼Œä¹Ÿæ˜¯é†‰äº†=_= å¦‚æœæ—¶é—´å……è¶³ï¼Œæˆ‘ä»¬å¯ä»¥å»è¯»è¯» Flask-Mail çš„æºç ï¼Œä½ ä¼šå‘ç°ï¼Œæœ€ç»ˆæ˜¯ç”¨ç³»ç»Ÿè‡ªå¸¦çš„ smtplib å®ç°çš„ã€‚ 0x02 ä½¿ç”¨ä¸€å¥è¯æ€»ç»“ï¼šFlask-Mail çš„ä½¿ç”¨è¿˜æ˜¯ç›¸å½“easyçš„ã€‚ é…ç½®Flask-Mail ä½¿ç”¨ Flask æ ‡å‡†çš„é…ç½® API è¿›è¡Œé…ç½®ã€‚ä¸‹é¢æ˜¯æ‰€æœ‰çš„é…ç½®é€‰é¡¹ï¼š MAIL_SERVER : é»˜è®¤ä¸º â€˜127.0.0.1â€™ MAIL_PORT : é»˜è®¤ä¸º 25 MAIL_USE_TLS : é»˜è®¤ä¸º False MAIL_USE_SSL : é»˜è®¤ä¸º False MAIL_DEBUG : é»˜è®¤ä¸º app.debug MAIL_USERNAME : é»˜è®¤ä¸º None MAIL_PASSWORD : é»˜è®¤ä¸º None MAIL_DEFAULT_SENDER : é»˜è®¤ä¸º None MAIL_MAX_EMAILS : é»˜è®¤ä¸º None MAIL_SUPPRESS_SEND : é»˜è®¤ä¸º app.testing MAIL_ASCII_ATTACHMENTS : é»˜è®¤ä¸º False è¿™ä¸ªé…ç½®çš„å‚æ•°æˆ‘ä»¬å¯ä»¥åœ¨è¿™é‡Œçœ‹åˆ°ã€‚ åˆå§‹åŒ–å¯ä»¥ä½¿ç”¨ä¸‹é¢çš„ä¸¤ç§æ–¹å¼è¿›è¡Œåˆå§‹åŒ–ï¼š ç¬¬ä¸€ç§æ–¹å¼ï¼š ä½¿ç”¨ä¼ å…¥åˆ° Mail å®ä¾‹ä¸­çš„åº”ç”¨ç¨‹åºçš„é…ç½®é¡¹è¿›è¡Œé‚®ä»¶å‘é€ 12345from flask import Flaskfrom flask_mail import Mailapp = Flask(__name__)mail = Mail(app) ç¬¬äºŒç§æ–¹å¼ï¼š ä½¿ç”¨ Flask çš„ current_app ä¸­çš„é…ç½®é¡¹è¿›è¡Œé‚®ä»¶å‘é€ï¼Œå¦‚æœæˆ‘ä»¬æœ‰å¤šä¸ª ä¸åŒé…ç½®çš„åº”ç”¨ç¨‹åº åˆ™ä½¿ç”¨æ­¤ç§æ–¹å¼æ¯”è¾ƒæ–¹ä¾¿ 1234mail = Mail()app = Flask(__name__)mail.init_app(app) å‘é€å‘é€ä¹‹å‰æˆ‘ä»¬éœ€è¦å…ˆæ„å»ºä¸€ä¸ª Message å¯¹è±¡ï¼Œå¦‚ä¸‹ï¼š 123from flask_mail import Messagemsg = Message(\"Hello Flask\", sender=\"ttdevs@gmail.com\", recipients=[\"ttdevs@live.com\"]) æˆ‘ä»¬ä¹Ÿå¯ä»¥åŒæ—¶æŒ‡å®šå¤šä¸ªæ”¶ä»¶äºº 12msg.recipients = [\"ttdevs@gmail.com\", \"ttdevs@foxmail.com\"]msg.add_recipient(\"ttdevs@live.com\") å¦‚æœæˆ‘ä»¬é…ç½®äº† MAIL_DEFAULT_SENDER å­—æ®µï¼Œå°±å¯ä»¥ä¸å†è®¾ç½® sender ï¼Œè¿™ä¸ªæ—¶å€™ä¼šä½¿ç”¨ MAIL_DEFAULT_SENDER ä¸­æŒ‡å®šçš„å‘ä»¶äººï¼Œåƒè¿™æ ·ï¼š 1msg = Message(\"Hello Flask\", recipients=[\"ttdevs@live.com\"]) å¦‚æœæˆ‘ä»¬å¸Œæœ›åœ¨æ”¶ä»¶åˆ—è¡¨ä¸­æ˜¾ç¤ºä¸€ä¸ªåå­—ï¼Œå¯ä»¥é€šè¿‡ä¸€ä¸ªäºŒå…ƒç¥–æ¥æŒ‡å®šï¼š 1msg = Message(\"Hello\", sender=(\"ttdevs\", \"ttdevs@live.com\")) åŒæ—¶ï¼Œ æˆ‘ä»¬è¿˜å¯ä»¥æŒ‡å®šä¸‹é¢ä¸¤ä¸ªå­—æ®µï¼š 12msg.body = \"this is body string\"msg.html = \"&lt;h2&gt;this is html message&lt;/b&gt;\" æœ€åå°±æ˜¯å‘é€ï¼š 1mail.send(msg) å‘é€å®Œæ¯•åï¼Œä¸é‚®ä»¶æœåŠ¡å™¨çš„é“¾æ¥å°±ä¼šå…³é—­ã€‚ å‘é€å¤§é‡é‚®ä»¶å¦‚æœæˆ‘ä»¬ä¸€æ¬¡å‘é€å¤§é‡çš„é‚®ä»¶ï¼Œå¯ä»¥é€šè¿‡ä¸‹é¢çš„æ–¹å¼å‘é€ï¼š 12345678with mail.connect() as conn: for user in users: message = '...' subject = \"hello, %s\" % user.name msg = Message(recipients=[user.email], body=message, subject=subject) conn.send(msg) ä¸ç”µå­é‚®ä»¶æœåŠ¡å™¨çš„è¿æ¥ä¼šä¸€ç›´ä¿æŒç›´åˆ°æ‰€æœ‰çš„é‚®ä»¶éƒ½å·²ç»å‘é€å®Œæ¯•æ‰ä¼šæ–­å¼€ã€‚ Some mail servers set a limit on the number of emails sent in a single connection. You can set the max amount of emails to send before reconnecting by specifying theMAIL_MAX_EMAILS setting. æ·»åŠ é™„ä»¶åœ¨é‚®ä»¶ä¸­æ·»åŠ é™„ä»¶åŒæ ·éå¸¸ç®€å•ï¼š 123image = 'umbrella.jpg'with app.open_resource(image) as fp: msg.attach(image, 'image/jpg', fp.read()) 0x03 Demoä¸‹é¢æ˜¯ä¸€ä¸ªç®€å•çš„Demoï¼Œè£…å¥½ç›¸å…³çš„ç±»åº“ï¼Œ ç›´æ¥å¯ä»¥è·‘ï¼Œå¤§å®¶å¯ä»¥å‚è€ƒï¼š 1234567891011121314151617181920212223242526272829303132#!/usr/bin/env python3# coding:utf-8from flask import Flaskfrom flask_mail import Mailfrom flask_mail import Messageapp = Flask(__name__)app.config['MAIL_SERVER'] = 'smtp.qq.com'app.config['MAIL_PORT'] = 465app.config['MAIL_USE_SSL'] = Trueapp.config['MAIL_USERNAME'] = 'iot.raspi@qq.com'app.config['MAIL_PASSWORD'] = '********'app.config['MAIL_DEFAULT_SENDER'] = 'iot.raspi@qq.com'mail = Mail(app)@app.route('/')def welcome(): msg = Message('è¿™æ˜¯ä¸€å°æµ‹è¯•é‚®ä»¶Header', recipients=['56532799@qq.com']) msg.body = 'è¿™æ˜¯ä¸€å°æµ‹è¯•é‚®ä»¶ bodyer' msg.html = 'è¿™æ˜¯ä¸€å°æµ‹è¯•é‚®ä»¶ htmler' image = 'umbrella_ä¼.jpg' with app.open_resource(image) as fp: msg.attach(image, 'image/jpg', fp.read()) mail.send(msg) return 'Hello world!'if __name__ == '__main__': app.run(debug=tuple) é‚®ä»¶å‚æ•°è¯´æ˜ä¸Šé¢çš„Demoä¸­ç”¨åˆ°QQé‚®ç®±ï¼Œè¿™é‡Œç®€å•ä»‹ç»ä¸‹ã€‚ç”±äºQQé‚®ç®±éœ€è¦å®‰å…¨éªŒè¯ï¼Œæ‰€ä»¥æˆ‘ä»¬é…ç½®ä¸‹é¢å‡ ä¸ªå‚æ•°ï¼š MAIL_SERVER SMTPåœ°å€ï¼šsmtp.qq.com MAIL_PORT ç”±äºéœ€è¦å®‰å…¨éªŒè¯ï¼Œæ‰€ä»¥æ­¤å¤„ç”¨465 MAIL_USE_SSLï¼šTrue SSLï¼Œèµ°åŠ å¯†æ–¹å¼ MAIL_USERNAME iot.raspi@qq.com MAIL_PASSWORD è¿™ä¸ªåœ°æ–¹æˆ‘ä»¬éœ€è¦ä½¿ç”¨æˆæƒç ï¼š æ‰“å¼€ QQé‚®ç®± &gt; è®¾ç½® &gt; POP3/IMAP/SMTP/Exchange/CardDAV/CalDAVæœåŠ¡ &gt; ç”Ÿæˆæˆæƒç  æœ€ååˆ«å¿˜äº†æ‰“å¼€SMTPæœåŠ¡ï½ï½ 0x04 å…¶ä»–ï¼ˆTODO ç•™å‘ï¼Œå…¶å®æš‚æ—¶è¿˜æ²¡å­¦åˆ°ï½ï½ï¼‰ å•å…ƒæµ‹è¯•ç¦æ­¢å‘é€é‚®ä»¶å¤´æ³¨å…¥ä¿¡å·é‡API0xFF å‚è€ƒ http://pythonhosted.org/Flask-Mail/ http://www.pythondoc.com/flask-mail/ https://pypi.python.org/pypi/Flask-Mail/","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"https://ttdevs.github.io/categories/æŠ€æœ¯/"}],"tags":[{"name":"Flask","slug":"Flask","permalink":"https://ttdevs.github.io/tags/Flask/"}]},{"title":"ã€ŒFlaskã€0x03æ ‘è“æ´¾ä¸Šä½¿ç”¨Nginxå’ŒuWSGIéƒ¨ç½²Flaskåº”ç”¨","slug":"[Flask]0x03æ ‘è“æ´¾ä¸Šä½¿ç”¨Nginxå’ŒuWSGIéƒ¨ç½²Flaskåº”ç”¨","date":"1969-12-31T16:00:00.000Z","updated":"2017-04-27T11:07:57.000Z","comments":true,"path":"1970/01/01/[Flask]0x03æ ‘è“æ´¾ä¸Šä½¿ç”¨Nginxå’ŒuWSGIéƒ¨ç½²Flaskåº”ç”¨/","link":"","permalink":"https://ttdevs.github.io/1970/01/01/[Flask]0x03æ ‘è“æ´¾ä¸Šä½¿ç”¨Nginxå’ŒuWSGIéƒ¨ç½²Flaskåº”ç”¨/","excerpt":"","text":"0x00 éƒ¨ç½²ï¼šuWSGI å’Œ Nginx ä»‹ç»Deploy Flask Application with Nginx and uWSGI è€ƒè™‘åˆ°éƒ¨ç½²çš„é—®é¢˜ï¼Œç›¸ä¿¡æ‚¨å·²ç»å®Œæˆäº†è‡ªå·±Flaskåº”ç”¨çš„å¼€å‘å·¥ä½œï¼Œæˆ–è€…è·Ÿæˆ‘ä¸€æ ·ï¼Œä¸€ä¸ªdemo åº”ç”¨å·²ç»å®Œæˆã€‚å¥½å¥‡è‡ªå·±çš„åº”ç”¨å¦‚ä½•å‘å¸ƒå‡ºå»ã€‚æ¥ä¸‹æ¥ï¼Œé€šè¿‡ä»‹ç»ä¸€äº›å¸¸ç”¨çš„å·¥å…·æ¥å®Œæˆæˆ‘ä»¬åº”ç”¨çš„éƒ¨ç½²ã€‚å…ˆç®€å•ä»‹ç»ä¸‹æˆ‘çš„ç¯å¢ƒï¼š ä¸€å°å†…ç½‘ä¸­çš„æ ‘è“æ´¾ ä¸€ä¸ªèŠ±ç”Ÿæ£’(98RMBä¹°çš„ç¡¬ä»¶) ä½¿ç”¨èŠ±ç”Ÿæ£’åšäº†å†…ç½‘çš„ç«¯å£æ˜ å°„ï¼Œå¯¹å¤–æš´éœ²80ç«¯å£æä¾›httpæœåŠ¡ï¼Œè‡³äºä¸ºä»€ä¹ˆè¿™ä¹ˆåšï¼Œè¯·å‚è€ƒè¿™é‡Œã€‚ å¥½äº†ï¼Œæ¥ä¸‹æ¥è¿›å…¥æ­£é¢˜ã€‚ uWSGIä½œä¸ºWebæœåŠ¡å™¨ä½¿ç”¨ï¼Œnginxåšåå‘ä»£ç†ã€‚ uWSGIuWSGIåšWebæœåŠ¡å™¨ ã€ŠFlask Webå¼€å‘ï¼šåŸºäºPythonçš„Webåº”ç”¨å¼€å‘å®æˆ˜ã€‹æœ‰ä¸‹é¢ä¸¤æ®µæè¿°ï¼š å…¶ä¸€ï¼š Flaskè‡ªå¸¦çš„å¼€å‘WebæœåŠ¡å™¨ä¸å¤Ÿå¼ºå¥ã€å®‰å…¨å’Œé«˜æ•ˆï¼Œæ— æ³•åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ä½¿ç”¨ã€‚ å…¶äºŒï¼š Flaskè‡ªå¸¦çš„å¼€å‘WebæœåŠ¡å™¨è¡¨ç°å¾ˆå·®ï¼Œå› ä¸ºå®ƒä¸æ˜¯ä¸ºç”Ÿäº§ç¯å¢ƒè®¾è®¡çš„æœåŠ¡å™¨ã€‚æœ‰ä¸¤ä¸ªå¯ä»¥åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ä½¿ç”¨ã€æ€§èƒ½è‰¯å¥½ä¸”æ”¯æŒFlaskç¨‹åºçš„æœåŠ¡å™¨ï¼Œåˆ†åˆ«æ˜¯Gunicorn(http://gunicorn.org/) å’Œ uWSGI(http://uwsgi-docs.readthedocs.org/en/latest/) ã€‚ å…ˆä»‹ç»ä¸€ä¸‹WSGIï¼ˆfromï¼šç»´åŸºç™¾ç§‘ï¼‰ï¼š WebæœåŠ¡å™¨ç½‘å…³æ¥å£ï¼ˆPython Web Server Gateway Interfaceï¼Œç¼©å†™ä¸ºWSGIï¼‰æ˜¯ä¸ºPythonè¯­è¨€å®šä¹‰çš„WebæœåŠ¡å™¨å’ŒWebåº”ç”¨ç¨‹åºæˆ–æ¡†æ¶ä¹‹é—´çš„ä¸€ç§ç®€å•è€Œé€šç”¨çš„æ¥å£ã€‚è‡ªä»WSGIè¢«å¼€å‘å‡ºæ¥ä»¥åï¼Œè®¸å¤šå…¶å®ƒè¯­è¨€ä¸­ä¹Ÿå‡ºç°äº†ç±»ä¼¼æ¥å£ã€‚ä»¥å‰ï¼Œå¦‚ä½•é€‰æ‹©åˆé€‚çš„Webåº”ç”¨ç¨‹åºæ¡†æ¶æˆä¸ºå›°æ‰°Pythonåˆå­¦è€…çš„ä¸€ä¸ªé—®é¢˜ï¼Œè¿™æ˜¯å› ä¸ºï¼Œä¸€èˆ¬è€Œè¨€ï¼ŒWebåº”ç”¨æ¡†æ¶çš„é€‰æ‹©å°†é™åˆ¶å¯ç”¨çš„WebæœåŠ¡å™¨çš„é€‰æ‹©ï¼Œåä¹‹äº¦ç„¶ã€‚é‚£æ—¶çš„Pythonåº”ç”¨ç¨‹åºé€šå¸¸æ˜¯ä¸ºCGIï¼ŒFastCGIï¼Œmod_pythonä¸­çš„ä¸€ä¸ªè€Œè®¾è®¡ï¼Œç”šè‡³æ˜¯ä¸ºç‰¹å®šWebæœåŠ¡å™¨çš„è‡ªå®šä¹‰çš„APIæ¥å£è€Œè®¾è®¡çš„ã€‚WSGI[1] ï¼ˆæœ‰æ—¶å‘éŸ³ä½œâ€™wiz-geeâ€™ï¼‰æ˜¯ä½œä¸ºWebæœåŠ¡å™¨ä¸Webåº”ç”¨ç¨‹åºæˆ–åº”ç”¨æ¡†æ¶ä¹‹é—´çš„ä¸€ç§ä½çº§åˆ«çš„æ¥å£ï¼Œä»¥æå‡å¯ç§»æ¤Webåº”ç”¨å¼€å‘çš„å…±åŒç‚¹ã€‚WSGIæ˜¯åŸºäºç°å­˜çš„CGIæ ‡å‡†è€Œè®¾è®¡çš„ã€‚ å› æ­¤æˆ‘ä»¬éœ€è¦ä¸ºæˆ‘ä»¬çš„Flaskåº”ç”¨é…ç½®ä¸€ä¸ª WebæœåŠ¡å™¨ ã€‚ã€ŠFlask Webå¼€å‘ã€‹ä¸­ä»‹ç»çš„éƒ¨ç½²åˆ°Herokué€‰æ‹©çš„æ˜¯Gunicornã€‚Gunicorn å’Œ uWSGI çš„æ¯”è¾ƒç½‘ä¸Šå¾ˆå¤šï¼Œä¸»è¦çš„é—®é¢˜å¯èƒ½å°±æ˜¯è°çš„å‘å¤šå‘å°‘ã€‚ç»è¿‡æ¯”å¯¹ï¼Œè¿™é‡Œæˆ‘é€‰æ‹©uWSGIã€‚ uWSGI ä¸ä»…ä»…æ˜¯ä¸€ä¸ªåè®®ï¼ŒåŒæ—¶ä¹Ÿæ˜¯ä¸€ä¸ªåº”ç”¨æœåŠ¡å™¨ï¼Œå¯ä»¥æœåŠ¡äºuWSGIã€FastCGIå’ŒHTTPåè®®ã€‚uWSGIå®˜æ–¹æ–‡æ¡£å¯å‚è€ƒè¿™é‡Œ ã€‚ æ”¯æŒWSGIçš„Webåº”ç”¨æ¡†æ¶å¾ˆå¤šï¼Œæ¯”å¦‚ï¼š Django Flask web.py web2py Werkzeug Tornado and so on Nginxnginxåšåå‘ä»£ç† Nginxï¼ˆå‘éŸ³åŒengine xï¼‰æ˜¯ä¸€ä¸ªç½‘é¡µæœåŠ¡å™¨ï¼Œå®ƒèƒ½åå‘ä»£ç†HTTP, HTTPS, SMTP, POP3, IMAPçš„åè®®é“¾æ¥ï¼Œä»¥åŠä¸€ä¸ªè´Ÿè½½å‡è¡¡å™¨å’Œä¸€ä¸ªHTTPç¼“å­˜ã€‚ Nginxæ˜¯ä¸€æ¬¾é¢å‘æ€§èƒ½è®¾è®¡çš„HTTPæœåŠ¡å™¨ï¼Œç›¸è¾ƒäºApacheã€lighttpdå…·æœ‰å æœ‰å†…å­˜å°‘ï¼Œç¨³å®šæ€§é«˜ç­‰ä¼˜åŠ¿ã€‚ä¸æ—§ç‰ˆæœ¬ï¼ˆ&lt;=2.2ï¼‰çš„Apacheä¸åŒï¼Œnginxä¸é‡‡ç”¨æ¯å®¢æˆ·æœºä¸€çº¿ç¨‹çš„è®¾è®¡æ¨¡å‹ï¼Œè€Œæ˜¯å……åˆ†ä½¿ç”¨å¼‚æ­¥é€»è¾‘ï¼Œå‰Šå‡äº†ä¸Šä¸‹æ–‡è°ƒåº¦å¼€é”€ï¼Œæ‰€ä»¥å¹¶å‘æœåŠ¡èƒ½åŠ›æ›´å¼ºã€‚æ•´ä½“é‡‡ç”¨æ¨¡å—åŒ–è®¾è®¡ï¼Œæœ‰ä¸°å¯Œçš„æ¨¡å—åº“å’Œç¬¬ä¸‰æ–¹æ¨¡å—åº“ï¼Œé…ç½®çµæ´»ã€‚ åœ¨Linuxæ“ä½œç³»ç»Ÿä¸‹ï¼Œnginxä½¿ç”¨epolläº‹ä»¶æ¨¡å‹ï¼Œå¾—ç›Šäºæ­¤ï¼Œnginxåœ¨Linuxæ“ä½œç³»ç»Ÿä¸‹æ•ˆç‡ç›¸å½“é«˜ã€‚åŒæ—¶Nginxåœ¨OpenBSDæˆ–FreeBSDæ“ä½œç³»ç»Ÿä¸Šé‡‡ç”¨ç±»ä¼¼äºepollçš„é«˜æ•ˆäº‹ä»¶æ¨¡å‹kqueueã€‚ Nginxåœ¨å®˜æ–¹æµ‹è¯•çš„ç»“æœä¸­ï¼Œèƒ½å¤Ÿæ”¯æŒäº”ä¸‡ä¸ªå¹³è¡Œè¿æ¥ï¼Œè€Œåœ¨å®é™…çš„è¿ä½œä¸­ï¼Œæ˜¯å¯ä»¥æ”¯æŒäºŒä¸‡è‡³å››ä¸‡ä¸ªå¹³è¡Œé“¾æ¥ã€‚ ä»¥ä¸Šæ¥ä¿¡æ¯è‡ªç»´åŸºç™¾ç§‘ã€‚ åå‘ä»£ç†ï¼š ä½¿ç”¨ä»£ç†æœåŠ¡å™¨å¯ä»¥å°†è¯·æ±‚è½¬å‘ç»™å†…éƒ¨çš„WebæœåŠ¡å™¨ï¼Œä½¿ç”¨è¿™ç§åŠ é€Ÿæ¨¡å¼æ˜¾ç„¶å¯ä»¥æå‡é™æ€ç½‘é¡µçš„è®¿é—®é€Ÿåº¦ã€‚å› æ­¤ä¹Ÿå¯ä»¥è€ƒè™‘ä½¿ç”¨è¿™ç§æŠ€æœ¯ï¼Œè®©ä»£ç†æœåŠ¡å™¨å°†è¯·æ±‚ å‡åŒ€è½¬å‘ç»™å¤šå°å†…éƒ¨WebæœåŠ¡å™¨ä¹‹ä¸€ä¸Šï¼Œä»è€Œè¾¾åˆ°è´Ÿè½½å‡è¡¡çš„ç›®çš„ã€‚è¿™ç§ä»£ç†æ–¹å¼ä¸æ™®é€šçš„ä»£ç†æ–¹å¼æœ‰æ‰€ä¸åŒï¼Œæ ‡å‡†ä»£ç†æ–¹å¼æ˜¯å®¢æˆ·ä½¿ç”¨ä»£ç†è®¿é—®å¤šä¸ªå¤–éƒ¨Web æœåŠ¡å™¨ï¼Œè€Œè¿™ç§ä»£ç†æ–¹å¼æ˜¯å¤šä¸ªå®¢æˆ·ä½¿ç”¨å®ƒè®¿é—®å†…éƒ¨WebæœåŠ¡å™¨ï¼Œå› æ­¤ä¹Ÿè¢«ç§°ä¸ºåå‘ä»£ç†æ¨¡å¼ã€‚ å‚è€ƒï¼šhttp://www.bing.com/knows/åå‘ä»£ç†è´Ÿè½½å‡è¡¡ è™½ç„¶ä½ å¯èƒ½ä¸çŸ¥é“Nginxæ˜¯åšä»€ä¹ˆçš„ï¼Œä½†æ˜¯ä½ åº”è¯¥å¬è¿‡ï¼Œå†æˆ–è€…ä½ è‡³å°‘å¬è¿‡Apacheï¼Œä»–ä»¬éƒ½æ˜¯HTTPæœåŠ¡å™¨ã€‚æ•æˆ‘èƒ½åŠ›æœ‰é™ï¼Œç›®å‰ä¸ºæ­¢å¹¶ä¸èƒ½å¾ˆå¥½çš„è§£é‡Šä¸ºä»€ä¹ˆéå¾—ç”¨Nginxï¼Œèƒ½å‘Šè¯‰å¤§å®¶çš„æ˜¯ï¼šNginxå¸®æˆ‘ä»¬å¤„ç†å¾ˆå¤šé™æ€èµ„æºï¼ŒåŒæ—¶å°†åŠ¨æ€è¯·æ±‚è½¬å‘ç»™ä¸åŒçš„WebæœåŠ¡å™¨ï¼ˆè´Ÿè½½å‡è¡¡ï¼‰ã€‚æ­¤å¤„ç•™å‘ï¼Œç­‰ä»¥åè¡¥ä¸Šã€‚ æ¥ä¸‹æ¥é€šè¿‡æœ€ç®€å•çš„é…ç½®ï¼Œå°†æˆ‘ä»¬çš„Flaskåº”ç”¨éƒ¨ç½²åˆ°æˆ‘ä»¬çš„æ ‘è“æ´¾ä¸Šï¼Œè¾¾åˆ°å¯¹éƒ¨ç½²çš„æµç¨‹æœ‰ä¸ªæ€»ä½“æŠŠæ¡çš„ç›®çš„ã€‚å¦‚æœä½ éœ€è¦æ›´å¤šçš„é…ç½®ï¼Œå¯ä»¥å‚è€ƒå„è‡ªéƒ¨åˆ†çš„å®˜æ–¹æ–‡æ¡£ã€‚ 0x01 uWSGI å®‰è£… å…ˆä»å®‰è£…è¯´èµ·ï¼špip install uwsgi é…ç½® åœ¨æˆ‘ä»¬é¡¹ç›®çš„æ ¹ç›®å½•ä¸‹ï¼Œåˆ›å»º uwsgi.ini æ–‡ä»¶ï¼Œ å†…å®¹å¦‚ä¸‹ï¼š 12345678910[uwsgi]socket = 127.0.0.1:5000processes = 4threads = 2plugins = python3master = truevenv = venvpythonpath = .module = managecallable = application é…ç½®å‚æ•°è¯´æ˜ï¼š socketï¼šåº”ç”¨ç¨‹åºæ‰€åœ¨åœ°å€ï¼ŒIPåŠ ç«¯å£å·ï¼Œå½“ç„¶ï¼Œä¹Ÿå¯ä»¥æœ‰å…¶ä»–çš„å½¢å¼ processesï¼šå¼€å¯çš„è¿›ç¨‹æ•°é‡ threadsï¼šæ¯ä¸ªè¿›ç¨‹çš„çº¿ç¨‹æ•° pluginsï¼šåŠ è½½çš„æ’ä»¶ moduleï¼šåŠ è½½æŒ‡å®šçš„python WSGIæ¨¡å— callableï¼šåœ¨æ”¶åˆ°è¯·æ±‚æ—¶ï¼ŒuWSGIåŠ è½½çš„æ¨¡å—ä¸­å“ªä¸ªå˜é‡å°†è¢«è°ƒç”¨ï¼Œé»˜è®¤æ˜¯åå­—ä¸ºâ€œapplicationâ€çš„å˜é‡ã€‚ é¡ºä¾¿è´´ä¸€ä¸‹æˆ‘çš„Flaské¡¹ç›®æ–‡ä»¶ï¼šmanage.py 123456789#!/usr/bin/env python3# coding:utf-8from flask.ext.script import Managerconfig = 'development'application = create_app(config)manager = Manager(application)...if __name__ == '__main__': manager.run() æ“ä½œ å¯åŠ¨ï¼šuwsgi uwsig.iniã€‚å¦‚æœå¯åŠ¨æˆåŠŸï¼Œä¼šçœ‹åˆ°ç±»ä¼¼ä¸‹é¢çš„logï¼š 123456789101112131415161718192021222324252627282930313233343536(venv)pi@raspberrypi:~/raspi $ uwsgi uwsgi.ini[uWSGI] getting INI configuration from uwsgi.iniopen(&quot;./python3_plugin.so&quot;): No such file or directory [core/utils.c line 3684]!!! UNABLE to load uWSGI plugin: ./python3_plugin.so: cannot open shared object file: No such file or directory !!!*** Starting uWSGI 2.0.13.1 (32bit) on [Sun Jul 3 22:35:08 2016] ***compiled with version: 4.9.2 on 27 May 2016 15:15:57os: Linux-4.1.19-v7+ #858 æ ‘è“æ´¾ Tue Mar 15 15:56:00 GMT 2016nodename: raspberrypimachine: armv7lclock source: unixdetected number of CPU cores: 4current working directory: /home/pi/raspidetected binary path: /home/pi/raspi/venv/bin/uwsgi!!! no internal routing support, rebuild with pcre support !!!your processes number limit is 6831your memory page size is 4096 bytesdetected max file descriptor number: 65536lock engine: pthread robust mutexesthunder lock: disabled (you can enable it with --thunder-lock)uwsgi socket 0 bound to TCP address 127.0.0.1:5000 fd 3Python version: 3.4.2 (default, Oct 19 2014, 14:03:53) [GCC 4.9.1]Set PythonHome to venvPython main interpreter initialized at 0xbaf828python threads support enabledyour server socket listen backlog is limited to 100 connectionsyour mercy for graceful operations on workers is 60 secondsmapped 358400 bytes (350 KB) for 8 cores*** Operational MODE: preforking+threaded ***added ./ to pythonpath.WSGI app 0 (mountpoint=&apos;&apos;) ready in 5 seconds on interpreter 0xbaf828 pid: 3418 (default app)*** uWSGI is running in multiple interpreter mode ***spawned uWSGI master process (pid: 3418)spawned uWSGI worker 1 (pid: 3428, cores: 2)spawned uWSGI worker 2 (pid: 3429, cores: 2)spawned uWSGI worker 3 (pid: 3431, cores: 2)spawned uWSGI worker 4 (pid: 3432, cores: 2) - åœæ­¢ - å¦‚æœè¿˜åœ¨åŒä¸€ä¸ªshellä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥æŒ‰ `Ctrl + C` - å¦‚æœä¸åœ¨åŒä¸€ä¸ªshellä¸­ï¼Œå¯ä»¥è¿™æ ·ç»“æŸæ‰ `killall -9 uwsgi` å¯åŠ¨æˆåŠŸä¹‹åå°±å¯ä»¥è®¿é—®æˆ‘ä»¬çš„Webåº”ç”¨äº†ï¼Œé»˜è®¤åœ°å€æ˜¯ï¼šhttp://127.0.0.1:5000 ï¼ˆè¿™ä¸ªåœ°å€å’Œç«¯å£å·æ˜¯åœ¨æˆ‘ä»¬çš„Flaskåº”ç”¨ä¸­é…é…ç½®çš„ï¼Œè¿™é‡Œä¸åšä»‹ç»ï¼‰ã€‚å¦‚æœå‡ºç° `invalid request block size: 21573 (max 4096)...skip`è¿™ä¸ªé”™è¯¯ï¼Œè¯·å°†é…ç½®ä¸­çš„ `socket` æ”¹ä¸º `http`ï¼Œå…·ä½“å¯ä»¥å‚è€ƒ[è¿™é‡Œ](http://stackoverflow.com/questions/15878176/uwsgi-invalid-request-block-size)ã€‚ 0x02 Nginx å®‰è£… sudo apt-get install ngnix æ“ä½œ å¯åŠ¨ sudo /etc/init.d/nginx start sudo service nginx start åœæ­¢ sudo /etc/init.d/nginx stop sudo service nginx stop é‡å¯ sudo /etc/init.d/nginx restart sudo service nginx restart å¦‚æœæ²¡é—®é¢˜ï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬å°±å¯ä»¥æ‰“å¼€æµè§ˆå™¨è®¿é—®ï¼š127.0.0.1ï¼Œåº”è¯¥ä¼šçœ‹åˆ°ä¸€ä¸ªé™æ€é¡µé¢ã€‚ é…ç½® nginx çš„é…ç½®æ–‡ä»¶æ—¶ä½äº /etc/nginx/sites-available ç›®å½•ä¸‹çš„ default æ–‡ä»¶ï¼Œæˆ‘ä»¬å¤åˆ¶ä¸€ä»½åšä¿®æ”¹ï¼Œè¿™é‡ŒåŒæ ·ç»™ä¸€ä»½æœ€ç®€å•çš„é…ç½®ï¼š 12345678910111213server &#123; listen 80; server_name ttdevs.vicp.net; # access_log logs/access.log compression; #é»˜è®¤è¯·æ±‚ location / &#123; include uwsgi_params; uwsgi_pass 127.0.0.1:5000; &#125;&#125; é…ç½®å¥½è¿™äº›ä¹‹åé‡å¯æˆ‘ä»¬çš„nginxæœåŠ¡ï¼š`sudo service nginx restart`ã€‚å³å¯è®¿é—®æˆ‘ä»¬çš„webåº”ç”¨äº†ã€‚ 0x03 æ€»ç»“å¦‚æœä¸­é—´æ²¡æœ‰å‡ºé”™ï¼Œä½ çš„Flaskåº”ç”¨å·²ç»éƒ¨ç½²æˆåŠŸã€‚åˆ°æ­¤ï¼Œæˆ‘ä»¬æ¥æ¢³ç†ä¸‹è¿™ä¸ªæµç¨‹ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬å®‰è£…Nginxï¼Œä»–ç›´æ¥å¤„ç†ç”¨æˆ·å‘é€çš„HTTPè¯·æ±‚ï¼ˆHTTPæœåŠ¡å™¨ï¼‰ï¼Œå¹¶å°†è¯·æ±‚æŒ‰ç…§æˆ‘ä»¬çš„é…ç½®ï¼ˆnginxä¸­çš„é…ç½®ï¼‰äº¤ç»™uWSGIæœåŠ¡å™¨ï¼ˆWebæœåŠ¡å™¨ï¼‰ï¼Œæœ€åuWSGIå°†è¯·æ±‚äº¤ç»™æˆ‘ä»¬çš„Flaskåº”ç”¨ï¼Œç”±Flaskåº”ç”¨è¿›è¡Œé€»è¾‘å¤„ç†ï¼Œå¤„ç†å®Œä¹‹åå†å°†ç»“æœè¿”å›ç»™ç”¨æˆ·ã€‚è¿™äº›ï¼Œå°±æ˜¯æˆ‘å¯¹è¿™ä¸ªæµç¨‹çš„ç†è§£ï¼Œç›¸ä¿¡ä¸­é—´è‚¯å®šæœ‰é”™è¯¯æˆ–è€…ä¸åˆ°ä½çš„åœ°æ–¹ï¼Œåœ¨å¯¹è¿™äº›çŸ¥è¯†æœ‰æ›´è¿›ä¸€æ­¥ç†è§£çš„æ—¶å€™æˆ‘ä¼šè¿”å›åŠæ—¶æ›´æ–°ã€‚åŒæ—¶ä¹Ÿæ¬¢è¿å„ä½æŒ‡æ­£ï½ï½ 0xFF å‚è€ƒ http://docs.jinkan.org/docs/flask/deploying/uwsgi.html http://www.cnblogs.com/zhouej/archive/2012/03/25/2379646.html http://www.cnblogs.com/Ray-liang/p/4173923.html https://github.com/nginx/nginx/blob/master/conf/uwsgi_params http://docs.jinkan.org/docs/flask/deploying/wsgi-standalone.html#deploying-proxy-setups","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"https://ttdevs.github.io/categories/æŠ€æœ¯/"}],"tags":[{"name":"Flask","slug":"Flask","permalink":"https://ttdevs.github.io/tags/Flask/"}]},{"title":"ã€ŒPythonã€ä½¿ç”¨requestså¤„ç†cookie","slug":"[Python]ä½¿ç”¨requestså¤„ç†cookie","date":"1969-12-31T16:00:00.000Z","updated":"2017-04-27T11:07:57.000Z","comments":true,"path":"1970/01/01/[Python]ä½¿ç”¨requestså¤„ç†cookie/","link":"","permalink":"https://ttdevs.github.io/1970/01/01/[Python]ä½¿ç”¨requestså¤„ç†cookie/","excerpt":"","text":"0x00 éœ€æ±‚å¸¸è§çš„ application/json è¯·æ±‚ï¼Œå¦‚æœtokenè¿›è¡ŒéªŒè¯ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨headeræˆ–è€…bodyä¸­ç›´æ¥æ·»åŠ ï¼Œå¯¹äºä½¿ç”¨cookieè¿›è¡ŒéªŒè¯çš„è¯·æ±‚ï¼Œè™½ç„¶å¯ä»¥è‡ªå·±ç»´æŠ¤cookieï¼Œä½†æ˜¯ä¼šæ¯”tokenéº»çƒ¦å¾ˆå¤šã€‚ ä¹‹å‰çš„å¿˜äº†è¯·æ±‚éƒ½æ˜¯ä½¿ç”¨python3çš„urllibè¿›è¡Œï¼Œå½“å¤„ç†cookieæ—¶ï¼Œå‘ç°æ¯”è¾ƒå›°éš¾ï¼Œå› æ­¤ç€æ‰‹å¦å¯»ä»–æ³•ï¼Œè¿™æ ·å°±å‘ç°äº†requestsã€‚ç®€å•çœ‹äº†ä¸‹ï¼Œä½¿ç”¨èµ·æ¥æ¯”urllibæ–¹ä¾¿äº†å¥½å¤šï¼Œå¥½å¤šã€‚ä¸ç´§ç´§å®ç°äº†æ‰‹åŠ¨æ·»åŠ cookieçš„éœ€æ±‚ï¼Œå…¶ä»–æ¥å£ä½¿ç”¨ä¹Ÿæ˜¯ç›¸å½“å‹å¥½ã€‚æœ‰æ—¶é—´æ‰“ç®—å§ä¹‹å‰çš„ä»£ç é‡æ„ä¸€ä¸‹ã€‚ ä¸‹é¢ç®€å•ä»‹ç»ä¸‹requestsçš„ä½¿ç”¨ã€‚ 0x01 requestsRequest GET æ— å‚æ•° 1&gt;&gt;&gt; r = requests.get(&apos;https://api.github.com/events&apos;)` - urlå‚æ•° 1234&gt;&gt;&gt; payload = &#123;&apos;key1&apos;: &apos;value1&apos;, &apos;key2&apos;: &apos;value2&apos;&#125;&gt;&gt;&gt; r = requests.get(&apos;http://httpbin.org/get&apos;, params=payload)&gt;&gt;&gt; print(r.url)http://httpbin.org/get?key2=value2&amp;key1=value1 è¾“å‡ºï¼š 12&gt;&gt;&gt; print(r.url)http://httpbin.org/get?key2=value2&amp;key1=value1 POST - formå‚æ•° 1r = requests.post(&apos;http://httpbin.org/post&apos;, data = &#123;&apos;key&apos;:&apos;value&apos;&#125;) - jsonå‚æ•° 1234567891011121314151617181920212223&gt;&gt;&gt; import json&gt;&gt;&gt; url = &apos;https://api.github.com/some/endpoint&apos;&gt;&gt;&gt; payload = &#123;&apos;some&apos;: &apos;data&apos;&#125;&gt;&gt;&gt; r = requests.post(url, data=json.dumps(payload)) ``` - file `TODO`- Other: - PUT: `r = requests.put(&apos;http://httpbin.org/put&apos;, data = &#123;&apos;key&apos;:&apos;value&apos;&#125;)` - DELETE: `r = requests.delete(&apos;http://httpbin.org/delete&apos;)` - HEAD: `r = requests.head(&apos;http://httpbin.org/get&apos;)` - OPTIONS: `r = requests.options(&apos;http://httpbin.org/get&apos;)` - HEADER ``` shell&gt;&gt;&gt; url = &apos;https://api.github.com/some/endpoint&apos;&gt;&gt;&gt; headers = &#123;&apos;user-agent&apos;: &apos;my-app/0.0.1&apos;&#125;&gt;&gt;&gt; r = requests.get(url, headers=headers) COOKIES è¯·æ±‚ï¼š 123&gt;&gt;&gt; url = &apos;http://httpbin.org/cookies&apos;&gt;&gt;&gt; cookies = dict(cookies_are=&apos;working&apos;)&gt;&gt;&gt; r = requests.get(url, cookies=cookies) è¯·æ±‚çš„æ•°æ®ï¼š 1234567GET /cookies HTTP/1.1Host: httpbin.orgConnection: keep-aliveUser-Agent: python-requests/2.12.4Accept-Encoding: gzip, deflateAccept: */*Cookie: cookies_are=working Response12&gt;&gt;&gt; import requests&gt;&gt;&gt; response = requests.get(&apos;https://api.github.com/events&apos;) response.url response.encoding ç¼–ç  response.status_code çŠ¶æ€å— response.headers headers response.text è¿”å›çš„æ–‡æœ¬ response.json() json response.raw åŸå§‹æ•°æ® response.raise_for_status() é”™è¯¯è¯·æ±‚ä¿¡æ¯ response.cookies response.history 0x03 æ€»ç»“ä½¿ç”¨è¿‡urllibçš„è¯ï¼Œæ¥çœ‹requestsä½ ä¼šå‘ç°ç®€å•å¥½å¤šï¼ŒåŒæ—¶æ”¯æŒpython2 å’Œ python3ã€‚ 0xFF å‚è€ƒ https://pypi.python.org/pypi/requests http://docs.python-requests.org/en/master/ https://github.com/kennethreitz/requests","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"https://ttdevs.github.io/categories/æŠ€æœ¯/"}],"tags":[{"name":"Python","slug":"Python","permalink":"https://ttdevs.github.io/tags/Python/"}]},{"title":"ã€ŒJavaã€Javaä¸­è·å–æœ¬åœ°IPå’ŒPort","slug":"[Java]Javaä¸­è·å–æœ¬åœ°IPå’ŒPort","date":"1969-12-31T16:00:00.000Z","updated":"2017-04-27T11:07:57.000Z","comments":true,"path":"1970/01/01/[Java]Javaä¸­è·å–æœ¬åœ°IPå’ŒPort/","link":"","permalink":"https://ttdevs.github.io/1970/01/01/[Java]Javaä¸­è·å–æœ¬åœ°IPå’ŒPort/","excerpt":"","text":"0x00 é—®é¢˜é¡¹ç›®ä¸­è¦ç”¨åˆ°DatagramSocketï¼ŒåŒæ—¶ä¹Ÿè¦è·å–æœ¬åœ°çš„IPå’ŒPORTï¼Œç›´æ¥åˆ›å»ºå¹¶è·å–ç«¯å£è·å–çš„IPæ€»æ˜¯0.0.0.0ï¼Œä»£ç å¦‚ä¸‹ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445private static void testGetDatagramSocket() &#123; try &#123; DatagramSocket socket = new DatagramSocket(); System.out.println(socket.getLocalSocketAddress()); socket.close(); &#125; catch (SocketException e) &#123; e.printStackTrace(); &#125;&#125;``` è¾“å‡ºç»“æœï¼š`0.0.0.0/0.0.0.0:55816`## 0x01 è§£å†³æŸ¥äº†äº›èµ„æ–™ï¼Œæ¯”å¦‚æŸ¥è¯¢å¯ç”¨ç«¯å£å¹¶ç»‘å®šï¼Œæ²¡æœ‰ç°æˆæ–¹æ³•ï¼Œå¥½åƒå®ç°ä¸äº†ã€‚ä¸ªä¸­åŸå› ä¹Ÿæ²¡å¤ªå¤šæ—¶é—´å»ç»†ç©¶ï¼Œå¥½åƒæ˜¯è¿˜æ²¡å’Œç½‘å¡å…³è”ï¼ˆçº¯å±ä¸ªäººYYï¼‰ã€‚ç”±äºé¡¹ç›®å¯¹æœ¬åœ°ç«¯å£æ²¡æœ‰ç‰¹åˆ«è¦æ±‚ï¼Œè‡ªå·±å†™äº†ä¸€ä¸ªæ–¹æ³•è·å–DatagramSocketï¼Œå¦‚ä¸‹ï¼š``` java/** * ä»æœ€å¤§ç«¯å£å¼€å§‹å‘ä¸‹éå†ï¼Œæœ‰å¯èƒ½ç«¯å£å°±è¿”å› * * @return DatagramSocket, ä¸ºnullçš„å¯èƒ½æ€§æå° */public static DatagramSocket getDatagramSocket() &#123; DatagramSocket socket = null; int port = 65535; while (port &gt; 0) &#123; try &#123; socket = new DatagramSocket(new InetSocketAddress(InetAddress.getLocalHost(), --port)); System.out.println(port); break; &#125; catch (SocketException e) &#123; e.printStackTrace(); continue; &#125; catch (UnknownHostException e) &#123; e.printStackTrace(); continue; &#125; &#125; return socket;&#125; å‡ºç°å¼‚å¸¸ç»§ç»­è¿è¡Œï¼Œä»£ä»·ä½¿ç”¨è€…è‡ªè¡Œæ–Ÿé…Œã€‚ 0x02 æµ‹è¯•123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657public class MainTest &#123; public static void main(String[] args) &#123; testGetDatagramSocket(); testGetUDPSocketInfo(); testGetLocalHost(); &#125; private static void testGetDatagramSocket() &#123; try &#123; DatagramSocket socket = new DatagramSocket(); System.out.println(socket.getLocalSocketAddress()); socket.close(); &#125; catch (SocketException e) &#123; e.printStackTrace(); &#125; &#125; private static void testGetUDPSocketInfo() &#123; DatagramSocket socket = getDatagramSocket(); System.out.println(socket.getLocalSocketAddress()); socket.close(); &#125; /** * ä»æœ€å¤§ç«¯å£å¼€å§‹å‘ä¸‹éå†ï¼Œæœ‰å¯èƒ½ç«¯å£å°±è¿”å› * * @return DatagramSocket, ä¸ºnullçš„å¯èƒ½æ€§æå° */ public static DatagramSocket getDatagramSocket() &#123; DatagramSocket socket = null; int port = 65535; while (port &gt; 0) &#123; try &#123; socket = new DatagramSocket(new InetSocketAddress(InetAddress.getLocalHost(), --port)); System.out.println(port); break; &#125; catch (SocketException e) &#123; e.printStackTrace(); continue; &#125; catch (UnknownHostException e) &#123; e.printStackTrace(); continue; &#125; &#125; return socket; &#125; private static void testGetLocalHost() &#123; try &#123; InetAddress address = InetAddress.getLocalHost(); System.out.println(address.getHostAddress()); &#125; catch (UnknownHostException e) &#123; e.printStackTrace(); &#125; &#125;&#125;","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"https://ttdevs.github.io/categories/æŠ€æœ¯/"}],"tags":[{"name":"Java","slug":"Java","permalink":"https://ttdevs.github.io/tags/Java/"}]},{"title":"ã€ŒPythonã€Pythonä¸­çš„Thread Local","slug":"[Python]Pythonä¸­çš„Thread Local","date":"1969-12-31T16:00:00.000Z","updated":"2017-04-27T11:07:57.000Z","comments":true,"path":"1970/01/01/[Python]Pythonä¸­çš„Thread Local/","link":"","permalink":"https://ttdevs.github.io/1970/01/01/[Python]Pythonä¸­çš„Thread Local/","excerpt":"","text":"åœ¨çº¿ç¨‹å†…éƒ¨ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šç”¨åˆ°çº¿ç¨‹å†…éƒ¨çš„å…¨å±€å˜é‡ï¼Œè¿™ä¸ªä¹Ÿæ˜¯æ¯”è¾ƒå¸¸ç”¨çš„ï¼Œå› ä¸ºå¯ä»¥å…¨å±€è®¿é—®ã€‚ä½†æ˜¯ï¼Œå¦‚æœçº¿ç¨‹å†…éƒ¨çš„æ–¹æ³•æ¯”è¾ƒå¤šï¼Œè¿™ä¸ªæ—¶å€™å°±éœ€è¦æˆ‘ä»¬ä¸€å±‚å±‚çš„ä¼ é€’ï¼Œä¸€å±‚è¿˜å¥½ï¼ŒäºŒå±‚ä¸‰å±‚ç”šè‡³æ›´å¤šçš„æ—¶å€™å°±æ¯”è¾ƒéƒé—·äº†ã€‚å¦‚æœä¸ä¼ é€’ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯èƒ½å¾ˆéš¾æ‹¿åˆ°çº¿ç¨‹å†…éƒ¨çš„å…¨å±€å˜é‡ï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬å°±å¸Œæœ›æœ‰ä¸ªåº”ç”¨å†…çš„å…¨å±€å˜é‡ï¼Œä¾›æˆ‘ä»¬éšæ—¶è°ƒç”¨ï¼Œthread localå°±å¯ä»¥æ»¡è¶³æˆ‘ä»¬çš„éœ€æ±‚ã€‚çœ‹ä¸€ä¸ªdemoï¼š 12345678910111213141516171819202122232425import threadinglocal = threading.local()def end_learning(): print('%s is finish.(Current Thread: %s)' % (local.name, threading.current_thread().name))def start_learning(): print('%s is learning.(Current Thread: %s)' % (local.name, threading.current_thread().name)) end_learning()def learn_python(name): local.name = name start_learning()if __name__ == '__main__': thread1 = threading.Thread(target=learn_python, args=('ttdevs1',), name='Thread-A') thread1.start() thread2 = threading.Thread(target=learn_python, args=('ttdevs2',), name='Thread-B') thread2.start() æ‰§è¡Œç»“æœå¦‚ä¸‹ï¼š123456ttdevs1 is learning.(Current Thread: Thread-A)ttdevs1 is finish.(Current Thread: Thread-A)ttdevs2 is learning.(Current Thread: Thread-B)ttdevs2 is finish.(Current Thread: Thread-B)Process finished with exit code 0 ä»ä¸Šé¢çš„demoä¸­ï¼Œæˆ‘ä»¬å¯ä»¥è¿˜å¯ä»¥çœ‹åˆ°ï¼šçº¿ç¨‹Aå’Œçº¿ç¨‹Bä¹‹é—´çš„æ•°æ®æ˜¯æ²¡æœ‰ç›¸äº’å¹²æ‰°çš„ã€‚ çœ‹åˆ°è¿™é‡Œä½ å¯èƒ½ä¼šæ„Ÿè§‰è¿™ä¸ªä¸æ˜¯ç‰¹åˆ«ç®€å•å˜›ã€‚æ˜¯çš„ï¼Œè¿™ä¸ªå°±æ˜¯å¾ˆç®€å•ï¼Œé€šè¿‡æŸ¥çœ‹æºç æˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œä»–çš„å®ç°å°±æ˜¯é€šè¿‡ä¸€ä¸ªå­—å…¸æ¥å­˜æ”¾æˆ‘ä»¬ä¸åŒçº¿ç¨‹çš„æ•°æ®ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥è‡ªå·±å®ç°çš„ã€‚æ—¢ç„¶ç³»ç»Ÿå®ç°äº†ï¼Œæˆ‘ä»¬å°±å¯ä»¥ç›´æ¥æ‹¿æ¥ç”¨äº†ã€‚ æ¯”å¦‚ï¼Œåœ¨å®é™…çš„åº”ç”¨ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä¸ºæ¯ä¸ªçº¿ç¨‹ä¿å­˜ä¸€ä¸ªæ•°æ®åº“è¿æ¥ï¼Œåœ¨çº¿ç¨‹çš„ä¸åŒæ–¹æ³•ä¸­ä½¿ç”¨å°±éå¸¸çš„æ–¹ä¾¿äº†ã€‚","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"https://ttdevs.github.io/categories/æŠ€æœ¯/"}],"tags":[{"name":"Python","slug":"Python","permalink":"https://ttdevs.github.io/tags/Python/"}]},{"title":"ã€ŒFlaskã€0x02ç»™æˆ‘ä»¬çš„Flaskåº”ç”¨é…ç½®Supervisor","slug":"[Flask]0x02ç»™æˆ‘ä»¬çš„Flaskåº”ç”¨é…ç½®Supervisor","date":"1969-12-31T16:00:00.000Z","updated":"2017-04-27T11:07:57.000Z","comments":true,"path":"1970/01/01/[Flask]0x02ç»™æˆ‘ä»¬çš„Flaskåº”ç”¨é…ç½®Supervisor/","link":"","permalink":"https://ttdevs.github.io/1970/01/01/[Flask]0x02ç»™æˆ‘ä»¬çš„Flaskåº”ç”¨é…ç½®Supervisor/","excerpt":"","text":"0x00 åœºæ™¯ Nginx ï¼‹ uWSGI ï¼‹ Flask çš„åœºæ™¯ä¸­ï¼Œå½“æˆ‘ä»¬çš„ä»£ç å‡ºç°å¼‚å¸¸æˆ–è€…å…¶ä»–ä¸€äº›åŸå› å¯¼è‡´æœåŠ¡æŒ‚æ‰ï¼Œæˆ‘ä»¬ä¼šå¸Œæœ›èƒ½è‡ªåŠ¨é‡å¯ uWSGI è¿™ä¸ªæ—¶å€™æˆ‘ä»¬æˆ‘ä»¬å¯ä»¥è€ƒè™‘ä½¿ç”¨ supervisoræ¥è¾¾åˆ°æˆ‘ä»¬çš„ç›®çš„ã€‚æ­¤æ–‡æ¥ä¸Šä¸€ç¯‡ï¼Œå› æ­¤æˆ‘çš„ç³»ç»Ÿè¿˜æ˜¯Raspbian(Debian)ã€‚è¿™é‡Œåˆ†äº«ä¸€äº›ç®€å•çš„é…ç½®ä½¿ç”¨ã€‚å…ˆçœ‹ä¸€ä¸‹ supervisor çš„ä»‹ç»ï¼š Supervisor is a client/server system that allows its users to monitor and control a number of processes on UNIX-like operating systems. 0x01 å®‰è£…è¿™ä¸ªæ¯”è¾ƒç®€å•ï¼Œæˆ‘ä»¬ç›´æ¥ä½¿ç”¨ apt-get å³å¯å®‰è£…ã€‚ pi@raspberrypi:~ $ sudo apt-get install supervisor (å¸è½½ç”¨ï¼šapt-get remove) å½“ç„¶ï¼Œä½ ä¹Ÿå¯ä»¥ç”¨ pip è¿›è¡Œå®‰è£…ï¼š sudo pip install supervisor 0x02 é…ç½®supervisor çš„é…ç½®æ–‡ä»¶ä½äº /etc/supervisor/ ä¸‹ï¼Œå¦‚ï¼š 12pi@raspberrypi:/etc/supervisor $ lsconf.d supervisord.conf supervisord.conf æ˜¯é»˜è®¤çš„é…ç½®æ–‡ä»¶ï¼Œæˆ‘ä»¬æ— éœ€ä¿®æ”¹ï¼Œåœ¨ conf.d ç›®å½•ä¸‹ï¼Œæˆ‘ä»¬åˆ›å»ºè‡ªå·±çš„é…ç½®æ–‡ä»¶å³å¯ï¼Œè¿™é‡Œæˆ‘å»ºäº†ä¸€ä¸ª uwsgi.conf æ–‡ä»¶ï¼š 123pi@raspberrypi:/etc/supervisor $ cd conf.d/pi@raspberrypi:/etc/supervisor/conf.d $ touch uwsgi.confpi@raspberrypi:/etc/supervisor/conf.d $ sudo nano uwsgi.conf uwsgi.conf æ–‡ä»¶å†…å®¹ï¼š 12345678[program:raspi]command=/home/pi/raspi/venv/bin/uwsgi /home/pi/raspi/uwsgi.inidirectory=/home/pi/raspiuser=piautostart=trueautorestart=truestdout_logfile=/home/pi/raspi/logs/uwsgi_supervisor.logstderr_logfile=/home/pi/raspi/logs/uwsgi_supervisor_err.log commandï¼šæ‰§è¡Œçš„å‘½ä»¤ directoryï¼šå·¥ä½œçš„ç›®å½•ï¼Œåœ¨æ‰§è¡Œå‰ä¼šè¿›è¡Œåˆ‡æ¢ï¼Œç”±äºä¸Šé¢æˆ‘ä½¿ç”¨çš„ç»å¯¹è·¯å¾„ï¼Œå¯ä»¥ä¸é…ç½® stdout_logfile å’Œ stderr_logfile é…ç½®æˆ‘ä»¬æ—¥å¿—è¾“å‡ºä½ç½® è¿™ä¸ªé…ç½®æ–‡ä»¶çš„æ›´å¤šå¯é€‰å‚æ•°å¯å‚è€ƒè¿™é‡Œã€‚ supervisor è¿˜æä¾›äº†ä¸€ä¸ªwebç®¡ç†ç•Œé¢ï¼Œæˆ‘ä»¬éœ€è¦å…ˆå¯¹å…¶è¿›è¡Œé…ç½®ï¼Œä¿®æ”¹ /etc/supervisor/supervisord.conf æ–‡ä»¶ï¼Œå¢åŠ å¦‚ä¸‹å†…å®¹å³å¯ï¼š 123456789101112131415161718 [supervisorctl]serverurl=unix:///var/run/supervisor.sock ; use a unix:// URL for a unix socketserverurl=http://192.168.1.56:9000username=ttdevs ; (default is no username (open server))password=admin ; (default is no password (open server)); The [include] section can just contain the &quot;files&quot; setting. This; setting can list multiple files (separated by whitespace or; newlines). It can also contain wildcards. The filenames are; interpreted as relative to this file. Included files *cannot*; include files themselves.[include]files = /etc/supervisor/conf.d/*.conf[inet_http_server] ; inet (TCP) server disabled by defaultport=192.168.1.56:9000 ; (ip_address:port specifier, *:port for all iface)username=ttdevs ; (default is no username (open server))password=admin ; (default is no password (open server)) 0x03 æ“ä½œå®‰è£…å¥½ä»¥åï¼Œæˆ‘ä»¬æœ‰ä¸¤ä¸ªå‘½ä»¤å¯ä»¥ä½¿ç”¨ï¼Œä¸€ä¸ªæ˜¯ supervisordï¼Œå¦ä¸€ä¸ªæ˜¯ supervisorctlï¼Œsupervisord è´Ÿè´£å¯åŠ¨æœåŠ¡ï¼Œsupervisorctl è´Ÿè´£æ“ä½œæœåŠ¡ï¼ŒC/Sæ¨¡å¼ã€‚ å¯åŠ¨ supervisorï¼š sudo supervisord æ›´å¤šçš„å¯åŠ¨å‚æ•°å¯ä»¥å‚è€ƒè¿™é‡Œã€‚ å¯åŠ¨/é‡å¯/åœæ­¢æŸä¸ªæˆ‘ä»¬é…ç½®çš„è¿›ç¨‹ï¼šsupervisorctl start/restart/stop programABC å¦å¤–åœ¨ä¸Šé¢çš„é…ç½®ä¸­ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨æµè§ˆå™¨è®¿é—® http://192.168.1.56:9000/å¯¹æˆ‘ä»¬çš„è¿›ç¨‹è¿›è¡Œç®¡ç†ã€‚ 0xFF å‚è€ƒ http://blog.chinaunix.net/uid-26000296-id-4759916.html http://liyangliang.me/posts/2015/06/using-supervisor/ http://www.restran.net/2015/10/04/supervisord-tutorial/","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"https://ttdevs.github.io/categories/æŠ€æœ¯/"}],"tags":[{"name":"Flask","slug":"Flask","permalink":"https://ttdevs.github.io/tags/Flask/"}]},{"title":"ã€ŒAndroidã€è®©RecyclerViewæ”¯æŒåŠ è½½æ›´å¤š(Endless RecyclerView)","slug":"[Android]è®©RecyclerViewæ”¯æŒåŠ è½½æ›´å¤š(Endless RecyclerView)","date":"1969-12-31T16:00:00.000Z","updated":"2017-04-27T11:07:57.000Z","comments":true,"path":"1970/01/01/[Android]è®©RecyclerViewæ”¯æŒåŠ è½½æ›´å¤š(Endless RecyclerView)/","link":"","permalink":"https://ttdevs.github.io/1970/01/01/[Android]è®©RecyclerViewæ”¯æŒåŠ è½½æ›´å¤š(Endless RecyclerView)/","excerpt":"","text":"0x00 é—®é¢˜å¥½ä¹…æ²¡æœ‰å†™åšå®¢ï¼Œæœ€è¿‘æ­£å¥½æœ‰æ—¶é—´ï¼Œæ‰“ç®—æŠŠä¹‹å‰å¾ˆé•¿å¾ˆé•¿ä¸€æ®µæ—¶é—´è½ä¸‹çš„å‘éƒ½ç»™å¡«äº†ã€‚ åœ¨Androidçš„SupportåŒ…ä¸­æˆ‘ä»¬æœ‰å¾ˆå¤šæ–°çš„ç»„ä»¶å¯ä»¥ä½¿ç”¨ï¼Œæ¯”å¦‚ä»£æ›¿ListViewçš„RecyclerViewã€‚ä½¿ç”¨RecyclerViewå’ŒSwipeRefreshLayoutç»„åˆï¼Œæˆ‘ä»¬å¯ä»¥å®ç°å¾ˆé…·ç‚«çš„ä¸‹æ‹‰åˆ·æ–°çš„åŠŸèƒ½ã€‚ä½†æ˜¯ï¼Œäº‹æƒ…æ€»ä¸æ˜¯é‚£ä¹ˆç¾å¥½ï¼Œæœ‰äº†ä¸‹æ‹‰åˆ·æ–°ï¼Œå´æ‰¾ä¸åˆ°ä¸Šæ‹‰åŠ è½½æ›´å¤šï¼ˆæˆ‘ä»¬å·²ç»ä¹ æƒ¯äº†PullToRefreshï¼‰ï¼Œæœ€ç»ˆè¿˜æ˜¯æ”¾å¼ƒäº†ä½¿ç”¨RecyclerViewã€‚ç°åœ¨çœ‹æ¥ï¼Œè‡ªå·±å®åœ¨æ˜¯å¤ªæ‡’äº†ã€‚å¥½äº†ï¼Œä»Šå¤©å°±è®©æˆ‘ä»¬çš„RecyclerViewæ”¯æŒåŠ è½½æ›´å¤šã€‚ 0x01 Endless RecyclerViewRecyclerViewçš„çš„ä½¿ç”¨å¤šæ•°æ˜¯ä¸SwipeRefreshLayoutè¿›è¡Œç»„åˆï¼Œå½“ç„¶ï¼Œä½ ä¹Ÿå¯ä»¥ç®—ä¸ŠCardViewã€‚ä½¿ç”¨SwipeRefreshLayoutæ—¶ï¼Œå—PullToRefreshçš„å½±å“ï¼Œå¾ˆè‡ªç„¶çš„ä¼šæƒ³åˆ°ç»™SwipeRefreshLayoutåŠ ä¸ªä¸Šæ‹‰åŠ è½½æ›´å¤šçš„åŠŸèƒ½ã€‚å¦‚æœä½ ä¹Ÿè¿™ä¹ˆæƒ³ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±ä¸€èµ·æ¥YYä¸‹googleä¸ºä»€ä¹ˆæ²¡æœ‰å®˜æ–¹æ”¯æŒè¿™ä¹ˆåšã€‚ ç»™SwipeRefreshLayoutæ·»åŠ åŠ è½½æ›´å¤šåŠŸèƒ½ï¼šæˆ‘ä»¬æœŸæœ›çš„(æ¯”å¦‚ï¼šSwipeRefreshLayout + RecyclerViewï¼Œä½†æ˜¯googleæ²¡è¿™ä¹ˆåš)ã€‚å¦‚æœSwipeRefreshLayoutä¸­æ˜¯TextViewæˆ–è€…è‡ªå®šä¹‰çš„Viewï¼Œå¾ˆæ˜¾ç„¶ï¼Œæˆ‘ä»¬å¹¶ä¸èƒ½ä¿è¯è¿™ä¸ªåŠ è½½æ›´å¤šæ˜¯å¯ä»¥å®ç°çš„ï¼ˆå³ä½¿å®ç°äº†ï¼Œä»–ä»¬è€¦åˆä¹Ÿä¼šå¾ˆé«˜ï¼‰ã€‚ ç»™RecyclerViewæ·»åŠ åŠ è½½æ›´å¤šåŠŸèƒ½ï¼šè¿™ä¸ªæ–¹æ¡ˆæ˜¯å¯è¡Œçš„ ç»™å…¶ä»–æ›´å¤šSwipeRefreshLayoutåŒ…å«çš„viewæ·»åŠ åŠ è½½æ›´å¤šåŠŸèƒ½ï¼šç¬¬äºŒç§æƒ…å†µçš„æ‰©å±•ï¼Œè¿™ä¸ªæ ¹æ®å…·ä½“çš„viewæ¥è®¨è®º å› æ­¤ï¼Œæˆ‘ä»¬åº”è¯¥æŠŠåŠ è½½æ›´å¤šæ”¾åˆ°å…·ä½“çš„viewä¸­ã€‚ 0x02 å®ç°ä¸‹é¢æ˜¯æˆ‘ä»¬æ”¯æŒåŠ è½½æ›´å¤šçš„ä»£ç ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950/* * Created by ttdevs 9/3/15 1:31 PM. https://github.com/ttdevs * Copyright (c) 2015 ttdevs, Inc. All rights reserved. */package com.ttdevs.support.recycler;import android.support.v7.widget.LinearLayoutManager;import android.support.v7.widget.RecyclerView;import com.ttdevs.utils.LogUtils;/** * RecyclerViewåŠ è½½æ›´å¤šçš„ç±»,æ”¯æŒLinearLayoutManagerå’ŒGridLayoutManager * ä½¿ç”¨: * RecyclerView.addOnScrollListener(new OnRecyclerLoadMoreListener()&#123; * public void onLoadMore()&#123;...&#125; * &#125;); */public abstract class OnRecyclerLoadMoreListener extends RecyclerView.OnScrollListener &#123; private LinearLayoutManager mLayoutManager; private int mItemCount, mLastCompletely, mLastLoad; /** * load more */ public abstract void onLoadMore(); @Override public void onScrolled(RecyclerView recyclerView, int dx, int dy) &#123; if (recyclerView.getLayoutManager() instanceof LinearLayoutManager) &#123; mLayoutManager = (LinearLayoutManager) recyclerView.getLayoutManager(); mItemCount = mLayoutManager.getItemCount(); mLastCompletely = mLayoutManager.findLastCompletelyVisibleItemPosition(); &#125; else &#123; return; &#125; if (mLastLoad != mItemCount &amp;&amp; mItemCount == mLastCompletely + 1) &#123; LogUtils.debug(String.format(\"****************load more****************\")); LogUtils.debug(String.format(\"mItemCount:%d \\t mLastCompletely:%d\", mItemCount, mLastCompletely)); LogUtils.debug(String.format(\"****************load more****************\")); mLastLoad = mItemCount; onLoadMore(); &#125; &#125;&#125;","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"https://ttdevs.github.io/categories/æŠ€æœ¯/"}],"tags":[{"name":"Android","slug":"Android","permalink":"https://ttdevs.github.io/tags/Android/"}]},{"title":"ã€ŒPythonã€æ–‡ä»¶æ‹·è´å·¥å…·Shutilä»‹ç»","slug":"[Python]æ–‡ä»¶æ‹·è´å·¥å…·Shutilä»‹ç»","date":"1969-12-31T16:00:00.000Z","updated":"2017-04-27T11:07:57.000Z","comments":true,"path":"1970/01/01/[Python]æ–‡ä»¶æ‹·è´å·¥å…·Shutilä»‹ç»/","link":"","permalink":"https://ttdevs.github.io/1970/01/01/[Python]æ–‡ä»¶æ‹·è´å·¥å…·Shutilä»‹ç»/","excerpt":"","text":"ä¸€å“¥ä»¬è®©å¸®å†™ä¸ªè„šæœ¬ï¼šä»ä¸€ä¸ªæ–‡ä»¶å¤¹ä¸­æŒ‰ç…§æŒ‡å®šçš„è§„åˆ™æ‹·è´éƒ¨åˆ†æ–‡ä»¶ã€‚ç»™åŠå°æ—¶æ—¶é—´ï¼Œè™½ç„¶æ°´å¹³å¾ˆèœæ²¡æœ‰ä¿¡å¿ƒï¼Œä½†è¿˜æ˜¯åº”ä¸‹äº†è¿™ä¸ªéœ€æ±‚ã€‚ 0x01 åˆ†æé¦–å…ˆæƒ³åˆ°çš„å°±æ˜¯osï¼Œsysè¿™äº›ç³»ç»Ÿåº“å®Œæˆè¿™äº›æ“ä½œï¼Œç”±äºä¸ç†Ÿæ‚‰è¿™å‡ ä¸ªåº“ï¼Œè¿˜æ˜¯googleä¸€ä¸‹ã€‚ä¸è¿‡åœ¨æœç´¢çš„æ—¶å€™å‘ç°äº†è¿™ä¸ªåº“ï¼š shutilã€‚æŸ¥çœ‹äº†ä¸‹ç®€ç›´å¤ªç®€å•ï¼Œä¸€è¡Œä»£ç å®Œæˆæ‹·è´ã€‚è‡ªå·±ä¹‹å‰è¿˜æƒ³ç€åˆ›å»ºç›®å½•ï¼Œæ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨ï¼Œæ–‡ä»¶è¯»å†™ï¼Œå„ç§é—®é¢˜â€¦â€¦ 0x02 shutilshutilæ˜¯ä¸€ä¸ªpythonæä¾›çš„é«˜çº§æ–‡ä»¶æ“ä½œå·¥å…·ï¼Œä»–å¯ä»¥å¸®åŠ©æˆ‘ä»¬å¿«é€Ÿçš„è¿›è¡Œå¸¸è§„æ–‡ä»¶æ“ä½œã€‚æ–‡ä»¶æ‹·è´æ“ä½œå¦‚ä¸‹ï¼š shutil.copyfile(src, dst, *, follow_symlinks=True) ç¬¬ä¸€ä¸ªå‚æ•°åŸæ–‡ä»¶ï¼Œç¬¬äºŒä¸ªå‚æ•°ç›®æ ‡æ–‡ä»¶ä½ç½®ã€‚ç®€å•å§ï¼Œæƒ³æƒ³å¦‚æœjavaå†™çš„è¯ï¼Œå„ç§åˆ¤æ–­ï¼Œå„ç§iostreamï¼Œå„ç§è›‹ç–¼å•Šï¼Œpythonå°±ä¸€è¡Œå•Šå•Šå•Šå•Šâ€¦â€¦ æ–¹æ³•è¯´æ˜ copy(src, dst) å°†æ–‡ä»¶srcå¤åˆ¶åˆ°æ–‡ä»¶dstï¼ŒåŒ…å«æƒé™ copy2(src, dst) åŒcopyï¼ŒåŒæ—¶å¤åˆ¶æ–‡ä»¶å…ƒæ•°æ® copyfile(src, dst) å°†æ–‡ä»¶srcå¤åˆ¶åˆ°æ–‡ä»¶dstï¼Œä½†ä¸åŒ…å«å…ƒæ•°æ® copymode(src, dst) å¤åˆ¶æ–‡ä»¶æƒé™ copystat(src, dst) å°†æƒé™ä½ã€ æœ€åå­˜å–æ—¶é—´ã€ æœ€åä¿®æ”¹æ—¶é—´å’Œæ ‡å¿—ä»srcå¤åˆ¶åˆ°dst copytree(src, dst, symlinks=False, ignore=None) é€’å½’å¤åˆ¶ç›®å½• rmtree(path[, ignore_errors[, onerror]]) åˆ é™¤ç›®å½• move(src, dst) é€’å½’ç§»åŠ¨ç›®å½• Demo1234567891011121314151617import shutil SOURCE = &#123; \"1f604\", ... \"1f349\"&#125; def replace(): base_path = \"drawable/\" dest_path = \"drawable_dest/\" for name in SOURCE: file_name = base_path + \"emoji_\" + name + \".png\" dest_name = dest_path + \"emoji_\" + name + \".png\" shutil.copy(file_name, dest_name) if __name__ == '__main__': replace()","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"https://ttdevs.github.io/categories/æŠ€æœ¯/"}],"tags":[{"name":"Python","slug":"Python","permalink":"https://ttdevs.github.io/tags/Python/"}]},{"title":"ã€ŒRetrofitã€0x01è¯·æ±‚å‚æ•°","slug":"[Retrofit]0x01è¯·æ±‚å‚æ•°","date":"1969-12-31T16:00:00.000Z","updated":"2017-04-27T11:07:57.000Z","comments":true,"path":"1970/01/01/[Retrofit]0x01è¯·æ±‚å‚æ•°/","link":"","permalink":"https://ttdevs.github.io/1970/01/01/[Retrofit]0x01è¯·æ±‚å‚æ•°/","excerpt":"","text":"0x00 è¯·æ±‚å‚æ•°å¸¸è§çš„Httpè¯·æ±‚ï¼Œé™¤äº†æŒ‡å®šçš„è¯·æ±‚åœ°å€ï¼Œå¾ˆå¤šæ—¶å€™æˆ‘ä»¬è¿˜éœ€è¦åŠ ä¸Šä¸€äº›è¯·æ±‚å‚æ•°ï¼Œè¿™äº›å‚æ•°å¯èƒ½æ˜¯å›ºå®šçš„ï¼Œä¹Ÿå¯èƒ½æ˜¯åŠ¨æ€æ·»åŠ çš„ã€‚åœ¨Retrofitä¸­ï¼Œæˆ‘ä»¬è¯¥å¦‚ä½•å¤„ç†å‘¢ï¼Ÿè¿™é‡Œä»¥GETæ–¹å¼ä¸­æ·»åŠ è¯·æ±‚å‚æ•°ä¸ºä¾‹ã€‚ 0x01 å›ºå®šè¯·æ±‚å‚æ•°è¿™é‡Œè¯´çš„å›ºå®šè¯·æ±‚å‚æ•°æ˜¯æŒ‡æ¯æ¬¡è¯·æ±‚æˆ‘ä»¬éƒ½åœ¨Urlä¸­æ·»åŠ ç›¸åŒçš„è¯·æ±‚çš„å‚æ•°ã€‚è¿™ç§åœºæ™¯å¤šå‡ºç°åœ¨éœ€è¦è®¤è¯çš„æƒ…å†µï¼Œæ¯”å¦‚æ·»åŠ  Token å­—æ®µç­‰ã€‚ åœ¨ä¹‹å‰çš„æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬æœ‰æåˆ°åœ¨æ„å»ºOkHttpClientå¯¹è±¡çš„æ—¶å€™ä½¿ç”¨è¿‡ Interceptor ï¼Œåœ¨ Interceptor çš„é€»è¾‘ä¸­ï¼Œæˆ‘ä»¬ä¼šé‡æ–°åˆ›å»ºä¸€ä¸ª Request å¯¹è±¡ï¼Œåœ¨è¿™ä¸ªå¯¹è±¡ä¸­æˆ‘ä»¬å¯ä»¥ä¼ å…¥ä¸€ä¸ª HttpUrl ï¼Œåœ¨è¿™ä¸ªå¯¹è±¡ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä¼ å…¥ä¸€äº›éœ€è¦çš„è¯·æ±‚å‚æ•°ã€‚é€šè¿‡ä¹‹å‰å¯¹ Interceptor äº†è§£ï¼Œæˆ‘ä»¬åº”è¯¥çŸ¥é“ï¼Œè¿™é‡Œåšçš„æ“ä½œæ˜¯å¯¹æ‰€æœ‰çš„è¯·æ±‚éƒ½æœ‰æ•ˆçš„ã€‚è¿™æ ·å°±å¯ä»¥å®Œæˆæˆ‘ä»¬ä¸ºæ¯ä¸ªè¯·æ±‚æ·»åŠ å›ºå®šè¯·æ±‚å‚æ•°çš„ç›®çš„ã€‚ä»£ç å¦‚ä¸‹ï¼š 123456789101112131415161718192021222324OkHttpClient client = new OkHttpClient.Builder() .addInterceptor(new Interceptor() &#123; @Override public okhttp3.Response intercept(Chain chain) throws IOException &#123; Request original = chain.request(); HttpUrl originalHttpUrl = original.url(); HttpUrl url = originalHttpUrl .newBuilder() .addQueryParameter(\"token\", \"I_am_user_token\") .addQueryParameter(\"user_key\", \"I_am_user_user_key\") .build(); Request request = original .newBuilder() .url(url) .build(); okhttp3.Response response = chain.proceed(request); return response; &#125; &#125;) .build(); 0x02 åŠ¨æ€è¯·æ±‚å‚æ•°è¿™ä¸ªæŒ‡æˆ‘ä»¬åœ¨ä¸åŒçš„è¯·æ±‚ä¸­æ·»åŠ ä¸åŒè¿‡çš„è¯·æ±‚å‚æ•°ã€‚æ¯”å¦‚ï¼Œåœ¨è¯·æ±‚ç”¨æˆ·ä¿¡æ¯çš„æ¥å£ä¸­æˆ‘ä»¬å¯èƒ½éœ€è¦ä¼ å…¥ç”¨æˆ·IDï¼Œåœ¨è¯·æ±‚è®°å½•çš„æ¥å£ä¸­æˆ‘ä»¬éœ€è¦ä¼ å…¥èµ·æ­¢æ—¶é—´ç­‰ã€‚ç”±äºè¿™æ ·çš„å‚æ•°æ˜¯é’ˆå¯¹æ¥å£çš„ï¼Œå› æ­¤æˆ‘ä»¬å°±éœ€è¦åœ¨æ¯ä¸€ä¸ªæ¥å£åšä¸­å¤„ç†ã€‚ @Query æ·»åŠ ä¸€ä¸ªè¯·æ±‚å‚æ•° 123// http://119.29.29.29/d?dn=ttdevs.vicp.com@GET(\"/d\")public Call&lt;ResponseBody&gt; singleParams(@Query(\"dn\") String domain); é€šè¿‡ä¸Šé¢çš„æ–¹å¼ï¼Œæˆ‘ä»¬å‘å‡ºçš„è¯·æ±‚å°±æ˜¯ï¼š `http://119.29.29.29/d?dn={domain}` @QueryMap æ·»åŠ ä¸€ç»„è¯·æ±‚å‚æ•° 12@GET(\"/record\") public Call&lt;ResponseBody&gt; multiParams(@QueryMap(encoded = true) Map&lt;String, String&gt; options); ä¸Šé¢æˆ‘ä»¬å‘å‡ºçš„è¯·æ±‚æ˜¯ï¼š http://ttdevs.vicp.net/record?p1=v1&amp;p2=v2 è¿™ä¸ªè¿™ä¸ªä¾‹å­ä¸­è¿˜å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†ä¸€ä¸ªå‚æ•°ï¼šencoded = trueï¼Œè¿™ä¸ªå‚æ•°çš„æ„æ€æ˜¯ï¼Œå¯¹æˆ‘ä»¬çš„å‚æ•°è¿›è¡ŒURL Encodeã€‚ 0x03 æ€»ç»“é€šè¿‡ä¸Šé¢çš„ä»‹ç»ï¼Œæˆ‘ä»¬å¯ä»¥äº†è§£ï¼Œå¦‚æœæ·»åŠ æˆ‘ä»¬çš„è¯·æ±‚å‚æ•°ã€‚å½“éœ€è¦ç»™æ¯ä¸€ä¸ªè¯·æ±‚éƒ½æ·»åŠ ç›¸åŒå‚æ•°æ—¶è¯¥å¦‚ä½•å°è£…ï¼ŒæŠŠRetrofitæ‰“é€ æˆæ›´é€‚åˆæˆ‘ä»¬ä½¿ç”¨çš„å·¥å…·ã€‚","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"https://ttdevs.github.io/categories/æŠ€æœ¯/"}],"tags":[{"name":"Retrofit","slug":"Retrofit","permalink":"https://ttdevs.github.io/tags/Retrofit/"}]},{"title":"ã€ŒRetrofitã€0x02Headeré—®é¢˜è¡¥å……","slug":"[Retrofit]0x02Headeré—®é¢˜è¡¥å……","date":"1969-12-31T16:00:00.000Z","updated":"2017-04-27T11:07:57.000Z","comments":true,"path":"1970/01/01/[Retrofit]0x02Headeré—®é¢˜è¡¥å……/","link":"","permalink":"https://ttdevs.github.io/1970/01/01/[Retrofit]0x02Headeré—®é¢˜è¡¥å……/","excerpt":"","text":"0x00 Retrofit Headerä¸Šä¸€ç¯‡ä¸­æˆ‘ä»¬ä»‹ç»Retrofitçš„ä¸€ä¸ªç®€å•çš„Demoå’Œæ·»åŠ Headeræ–¹æ³•ï¼Œè¿™ä¸€ç¯‡åœ¨è¡¥å……ä¸€ä¸‹Headerçš„å¦å¤–å‡ ç§å¤„ç†æ–¹æ³•ã€‚ 0x01 Header ä½¿ç”¨OkHTTPçš„Interceptoræ¥å¤„ç†Headerä¿¡æ¯ï¼Œè¿™ç§æ–¹æ³•æ˜¯éœ€è¦æˆ‘ä»¬åœ¨å°è£…Retrofitçš„æ—¶å€™è€ƒè™‘çš„ã€‚ä½†æ˜¯æœ‰æ—¶å€™æˆ‘ä»¬è¿˜å¸Œæœ›èƒ½çµæ´»çš„æ§åˆ¶æ¯ä¸€ä¸ªè¯·æ±‚çš„Headerä¿¡æ¯ï¼Œæ¥ä¸‹æ¥çš„å‡ ç§æ–¹æ³•æ»¡è¶³æˆ‘ä»¬è¿™æ ·çš„è¦æ±‚ã€‚ä»–ä»¬éƒ½æ˜¯åœ¨å„è‡ªçš„Serviceæ–¹æ³•ä¸Šæ·»åŠ æ³¨è§£æ¥è¾¾åˆ°æ·»åŠ Headerçš„ç›®çš„ã€‚ æ·»åŠ å•ä¸ªHeaderå­—æ®µ123@Headers(\"User-Agent: Your-App-Name\")@GETpublic Call&lt;ResponseBody&gt; weatherReport(String cityCode); æ·»åŠ å¤šä¸ªHeaderå­—æ®µ123456@Headers(&#123; \"Accept: application/json\", \"User-Agent: ttdevs\"&#125;)@GETpublic Call&lt;ResponseBody&gt; weatherReport(String cityCode); ä½¿ç”¨Mapæ·»åŠ å•ä¸ªHeaderå­—æ®µ12@GETpublic Call&lt;ResponseBody&gt; requestWithHeaderMap(@HeaderMap Map&lt;String, String&gt; header); æºç å‚è€ƒï¼šttdevs 0xFF å‚è€ƒ https://github.com/square/retrofit http://square.github.io/retrofit/ https://futurestud.io/","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"https://ttdevs.github.io/categories/æŠ€æœ¯/"}],"tags":[{"name":"Retrofit","slug":"Retrofit","permalink":"https://ttdevs.github.io/tags/Retrofit/"}]},{"title":"ã€ŒRetrofitã€0x03åŒæ­¥ä¸å¼‚æ­¥è¯·æ±‚","slug":"[Retrofit]0x03åŒæ­¥ä¸å¼‚æ­¥è¯·æ±‚","date":"1969-12-31T16:00:00.000Z","updated":"2017-04-27T11:07:57.000Z","comments":true,"path":"1970/01/01/[Retrofit]0x03åŒæ­¥ä¸å¼‚æ­¥è¯·æ±‚/","link":"","permalink":"https://ttdevs.github.io/1970/01/01/[Retrofit]0x03åŒæ­¥ä¸å¼‚æ­¥è¯·æ±‚/","excerpt":"","text":"0x00 è¯·æ±‚çš„å½¢å¼æˆ‘ä»¬æ­£å¸¸çš„ç½‘ç»œè¯·æ±‚æœ‰ä¸¤ç§å½¢å¼ï¼šåŒæ­¥æ–¹å¼å’Œå¼‚æ­¥æ–¹å¼ã€‚æ‰€è°“åŒæ­¥æ–¹å¼ï¼Œæ˜¯æŒ‡æˆ‘ä»¬åœ¨åœ¨å‘å‡ºç½‘ç»œè¯·æ±‚ä¹‹åå½“å‰çº¿ç¨‹å‘—é˜»å¡ï¼Œç›´åˆ°è¯·æ±‚çš„ç»“æœï¼ˆæˆåŠŸæˆ–è€…å¤±è´¥ï¼‰åˆ°æ¥ï¼Œæ‰ç»§ç»­å‘ä¸‹æ‰§è¡Œã€‚æ‰€è°“å¼‚æ­¥ï¼Œæ˜¯æŒ‡æˆ‘ä»¬çš„ç½‘ç»œè¯·æ±‚å‘å‡ºä¹‹åï¼Œä¸å¿…ç­‰å¾…è¯·æ±‚ç»“æœçš„åˆ°æ¥ï¼Œå°±å¯ä»¥å»åšå…¶ä»–çš„äº‹æƒ…ï¼Œå½“è¯·æ±‚ç»“æœåˆ°æ¥æ—¶ï¼Œæˆ‘ä»¬åœ¨åšå¤„ç†ç»“æœçš„åŠ¨ä½œã€‚å½“æ—¶æ— è®ºæ˜¯åŒæ­¥è¿˜æ˜¯å¼‚æ­¥ï¼Œæœ€ç»ˆéƒ½æ˜¯åŒæ­¥è¯·æ±‚ã€‚ 0x01 åŒæ­¥è¯·æ±‚Retrofitçš„åŒæ­¥è¯·æ±‚æ¯”è¾ƒç®€å•ï¼Œç›´æ¥è°ƒç”¨ Call çš„executeæ–¹æ³•å³å¯ã€‚è¿™ä¸ªæ—¶å€™æˆ‘ä»¬ä¼šæ‹¿åˆ°è¯·æ±‚çš„ç»“æœã€‚ 12345678@Test public void synchronousRequest() throws Exception &#123; Retrofit retrofit = RetrofitManager.getRetrofit(); GitHubService service = retrofit.create(GitHubService.class); Call&lt;User&gt; example = service.userInfo(\"ttdevs\"); Response&lt;User&gt; response = example.execute(); print(response.body().getName()); &#125; 0x02 å¼‚æ­¥è¯·æ±‚ä¹‹å‰æ–‡ç« çš„è¯·æ±‚éƒ½æ˜¯å¼‚æ­¥æ–¹å¼ï¼Œåœ¨è¯·æ±‚çš„å›è°ƒä¸­æˆ‘ä»¬ä¼šæ‹¿åˆ°è¯·æ±‚ç»“æœï¼Œæ¥ä¸‹æ¥ å¤„ç†è¿™ä¸ªç»“æœå³å¯ã€‚ 1234567891011121314151617181920212223242526272829303132333435363738394041@Test public void requestHeader() throws Exception &#123; OkHttpClient client = RetrofitManager.getClient(new Interceptor() &#123; @Override public okhttp3.Response intercept(Chain chain) throws IOException &#123; Request original = chain.request(); Request request = original.newBuilder() .header(\"Time-Zone\", \"Asia/Shanghai\") //https://developer.github.com/v3/#timezones .header(\"user_key\", \"I_am_user_key\") .method(original.method(), original.body()) .build(); okhttp3.Response response = chain.proceed(request); return response; &#125; &#125;); Retrofit retrofit = RetrofitManager.getRetrofit(client); ExampleService service = retrofit.create(ExampleService.class); String url = \"http://www.weather.com.cn/adat/sk/101020100.html\"; Call&lt;ResponseBody&gt; example = service.requestWithHeader(url); final CountDownLatch countDownLatch = new CountDownLatch(1); example.enqueue(new Callback&lt;ResponseBody&gt;() &#123; @Override public void onResponse(Call&lt;ResponseBody&gt; call, Response&lt;ResponseBody&gt; response) &#123; try &#123; print(response.body().string()); &#125; catch (IOException e) &#123; e.printStackTrace(); &#125; countDownLatch.countDown(); &#125; @Override public void onFailure(Call&lt;ResponseBody&gt; call, Throwable t) &#123; countDownLatch.countDown(); &#125; &#125;); countDownLatch.await(); &#125; æ€»ç»“ç”±äºåŒæ­¥è¯·æ±‚ä¼šé˜»å¡å½“å‰çº¿ç¨‹ï¼Œandroidçš„è®¾è®¡é€»è¾‘ä¸èƒ½åœ¨ä¸»çº¿ç¨‹ä¸­å‘èµ·ç½‘ç»œè¯·æ±‚ï¼ˆå¯èƒ½ä¼šå¯¼è‡´ANRï¼‰ï¼Œæ‰€ä»¥æˆ‘ä»¬æ¯”è¾ƒå¸¸è§çš„éƒ½æ˜¯å¼‚æ­¥å½¢å¼çš„ç½‘ç»œè¯·æ±‚ã€‚ä½†æ˜¯ï¼Œæœ‰æ—¶å€™æˆ‘ä»¬åœ¨å·¥ä½œçº¿ç¨‹ä¸­å¤„ç†ä¸€äº›ç½‘ç»œè¯·æ±‚çš„æ—¶å€™ï¼Œå¯ä»¥æ¥å—é˜»å¡çš„æƒ…å†µï¼ˆè¿™ä¸ªæ—¶å€™ä½¿ç”¨å›è°ƒå¾€å¾€ä¼šä½¿é—®é¢˜å¤æ‚åŒ–ï¼‰ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨åŒæ­¥çš„æ–¹å¼æ¥å‘èµ·ç½‘ç»œè¯·æ±‚ï¼Œæ¯”å¦‚ï¼Œåœ¨ä½¿ç”¨Rxjavaå°è£…æŸä¸ªç½‘ç»œåŠŸèƒ½çš„é€»è¾‘æ˜¯ï¼ˆå¦‚å›¾ç‰‡ä¸Šä¼ ï¼‰æˆ‘ä»¬å°±å¯ä»¥åŒæ­¥å½¢å¼çš„ç½‘ç»œè¯·æ±‚ã€‚","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"https://ttdevs.github.io/categories/æŠ€æœ¯/"}],"tags":[{"name":"Retrofit","slug":"Retrofit","permalink":"https://ttdevs.github.io/tags/Retrofit/"}]},{"title":"ã€ŒRetrofitã€0x04POSTæ–¹å¼æäº¤JSONæ•°æ®","slug":"[Retrofit]0x04POSTæ–¹å¼æäº¤JSONæ•°æ®","date":"1969-12-31T16:00:00.000Z","updated":"2017-04-27T11:07:57.000Z","comments":true,"path":"1970/01/01/[Retrofit]0x04POSTæ–¹å¼æäº¤JSONæ•°æ®/","link":"","permalink":"https://ttdevs.github.io/1970/01/01/[Retrofit]0x04POSTæ–¹å¼æäº¤JSONæ•°æ®/","excerpt":"","text":"0x00 HTTP Methodï¼šPOSTPOSTè¯·æ±‚å†æ—¥å¸¸çš„ä½¿ç”¨ä¸­å¾ˆå¸¸è§ï¼Œæ¯”å¦‚ç™»å½•ï¼Œä¸Šä¼ æ•°æ®ä¸­ä½¿ç”¨ã€‚ä¹‹å‰ä»‹ç»äº†GETæ–¹å¼ï¼Œä»Šå¤©ç®€å•ä»‹ç»ä¸‹å¦‚ä½•ä½¿ç”¨POSTæ¥æäº¤æ•°æ®ã€‚ 0x01 å¸¸ç”¨çš„POSTæ–¹å¼POSTæ–¹å¼æäº¤æ•°æ®å†æµè§ˆå™¨ä¸­çš„è¡¨ç°ä¸»è¦æ˜¯ä½¿ç”¨Formï¼Œåœ¨å®¢æˆ·ç«¯ä¸­å›½ä¸­çš„ä¸»è¦è¡¨ç°æ˜¯æäº¤JSONæ•°æ®ã€‚å½“ç„¶ï¼Œå…·ä½“æ˜¯ä»€ä¹ˆæ•°æ®æ ¼å¼å¹¶ä¸é‡è¦ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡æŠ“åŒ…æ¥åˆ†æï¼šæœ€ç»ˆæ•°æ®éƒ½æ˜¯ä¸€æ ·çš„ã€‚ ä½¿ç”¨Modelå¯¹è±¡é¦–å…ˆæ–°å»ºä¸€ä¸ªmodelå¯¹è±¡ï¼Œæ¯”å¦‚ï¼šUserï¼Œæ·»åŠ å¸¸ç”¨çš„ç†Ÿæ‚‰å’Œgetï¼setæ–¹æ³•ã€‚æ–°å»ºæˆ‘ä»¬çš„Serviceï¼š 12@POST(\"/send\")public Call&lt;ResponseBody&gt; modelPost(@Url String url, @Body User user); æµ‹è¯•ä»£ç ï¼š 1234567891011121314151617181920212223242526272829303132333435@Testpublic void modelPost() throws Exception &#123; HttpLoggingInterceptor logging = new HttpLoggingInterceptor(); logging.setLevel(HttpLoggingInterceptor.Level.BASIC); OkHttpClient client = RetrofitManager.getClient(logging); Retrofit retrofit = RetrofitManager.getRetrofit(client); ExampleService service = retrofit.create(ExampleService.class); String url = \"http://www.remoteurl.com\"; User user = new User(); user.setName(\"ttdevs\"); Call&lt;ResponseBody&gt; example = service.modelPost(url, user); final CountDownLatch countDownLatch = new CountDownLatch(1); example.enqueue(new Callback&lt;ResponseBody&gt;() &#123; @Override public void onResponse(Call&lt;ResponseBody&gt; call, Response&lt;ResponseBody&gt; response) &#123; try &#123; print(response.body().string()); &#125; catch (IOException e) &#123; e.printStackTrace(); &#125; countDownLatch.countDown(); &#125; @Override public void onFailure(Call&lt;ResponseBody&gt; call, Throwable t) &#123; countDownLatch.countDown(); &#125; &#125;); countDownLatch.await();&#125; ä½¿ç”¨RequestBodyå¯¹è±¡è¿™é‡Œæˆ‘ä»¬æ¥æäº¤ä¸€ä»½JSONæ•°æ®ï¼Œé¦–å…ˆè¿˜æ˜¯å†Serviceä¸­åˆ›å»ºä¸€ä¸ªæ–¹æ³•ï¼š 12@POST(\"/send\")public Call&lt;ResponseBody&gt; withRequestBody(@Url String url, @Body RequestBody body); å†æ¥ç€åˆ›å»ºæˆ‘ä»¬çš„è¯·æ±‚ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041@Testpublic void withRequestBody() throws Exception &#123; HttpLoggingInterceptor logging = new HttpLoggingInterceptor(); logging.setLevel(HttpLoggingInterceptor.Level.BASIC); OkHttpClient client = RetrofitManager.getClient(logging); Retrofit retrofit = RetrofitManager.getRetrofit(client); ExampleService service = retrofit.create(ExampleService.class); String url = \"http://www.remoteurl.com\"; JSONObject result = new JSONObject(); try &#123; result.put(\"record\", \"hello\"); &#125; catch (JSONException e) &#123; e.printStackTrace(); &#125; RequestBody body = RequestBody.create(MediaType.parse(\"application/json\"), result.toString()); Call&lt;ResponseBody&gt; example = service.withRequestBody(url, body); final CountDownLatch countDownLatch = new CountDownLatch(1); example.enqueue(new Callback&lt;ResponseBody&gt;() &#123; @Override public void onResponse(Call&lt;ResponseBody&gt; call, Response&lt;ResponseBody&gt; response) &#123; try &#123; print(response.body().string()); &#125; catch (IOException e) &#123; e.printStackTrace(); &#125; countDownLatch.countDown(); &#125; @Override public void onFailure(Call&lt;ResponseBody&gt; call, Throwable t) &#123; countDownLatch.countDown(); &#125; &#125;); countDownLatch.await();&#125; 0x02 æ€»ç»“ç¬¬ä¸€ç§æ–¹æ³•ï¼Œæˆ‘ä»¬éœ€è¦ä¸ºæ¯ä¸€ä¸ªè¯·æ±‚çš„å¯¹è±¡åˆ›å»ºä¸€ä¸ªModelï¼Œå¦‚æœä½ ä¸æƒ³åˆ›å»ºmodelåˆ™å¯ä»¥é€‰æ‹©ç¬¬äºŒç§æ–¹å¼ï¼Œç›´æ¥åˆ›å»ºä¸€ä¸ªJSONå­—ç¬¦ä¸²ï¼Œç„¶åæäº¤å³å¯ã€‚è¿˜æ˜¯ç›¸å½“ç®€ç­”çš„ã€‚","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"https://ttdevs.github.io/categories/æŠ€æœ¯/"}],"tags":[{"name":"Retrofit","slug":"Retrofit","permalink":"https://ttdevs.github.io/tags/Retrofit/"}]},{"title":"ã€ŒJavaã€(==)ä¸(equals)","slug":"[Java](==)ä¸(equals)","date":"1969-12-31T16:00:00.000Z","updated":"2017-04-27T11:07:57.000Z","comments":true,"path":"1970/01/01/[Java](==)ä¸(equals)/","link":"","permalink":"https://ttdevs.github.io/1970/01/01/[Java](==)ä¸(equals)/","excerpt":"","text":"0x01 ä¸¤ç§æ¯”è¾ƒæ–¹æ³• == åŸºæœ¬ç±»å‹ å¯¹äºåŸºæœ¬ç±»å‹ï¼Œ== çš„åŠŸèƒ½æ˜¯æ¯”è¾ƒå€¼ã€‚ Object æ¯”è¾ƒå¯¹è±¡åœ¨å†…å­˜ä¸­çš„åœ°å€ã€‚ equals åŸºæœ¬ç±»å‹æ— equalsæ–¹æ³•ã€‚Objectå¯¹è±¡é»˜è®¤equalsçš„å®ç°å¦‚ä¸‹ï¼š 1234567891011/** * ... * @param obj the reference object with which to compare. * @return &#123;@code true&#125; if this object is the same as the obj * argument; &#123;@code false&#125; otherwise. * @see #hashCode() * @see java.util.HashMap */public boolean equals(Object obj) &#123; return (this == obj);&#125; æœ‰å¾ˆé•¿ä¸€æ®µæ³¨é‡Šï¼Œæœ€ç»ˆçš„å®ç°æˆ‘ä»¬å¯ä»¥çœ‹åˆ°è¿˜æ˜¯ç”¨çš„ `==` æ¥æ¯”è¾ƒä¸¤ä¸ªå¯¹è±¡åœ¨å†…å­˜ä¸­çš„åœ°å€ã€‚ 0x02 equals() &amp; hashCode()å¯¹äºequalsçš„é»˜è®¤å®ç°â€”â€”æ¯”è¾ƒå¯¹è±¡åœ¨å†…å­˜ä¸­çš„åœ°å€â€”â€”æœ‰æ—¶å€™å¯èƒ½å¹¶ä¸æ˜¯æˆ‘ä»¬æœŸæœ›çš„ï¼Œæ¯”å¦‚æœ‰ä¸€ä¸ªStudentç±»ï¼š 12345678910class Student&#123; private int id; private String name; public Student(int id)&#123; this.id = id; &#125; // ... getter and setter&#125; å½“ Student.id ç›¸åŒæ—¶ï¼Œæˆ‘ä»¬æ›´æ„¿æ„è®¤ä¸ºè¿™æ˜¯åŒä¸€ä¸ªå­¦ç”Ÿï¼Œè€Œä¸‹é¢è¿™ä¸ªæµ‹è¯•æ˜¯æ— æ³•é€šè¿‡çš„ï¼š 1234567@Testpublic void equalsStudent() throws Exception &#123; Student st1 = new Student(2333); Student st2 = new Student(2333); assertEquals(st1, st2); // assertNotEquals(st1, st2);&#125; ä¸ºäº†è¾¾åˆ°æˆ‘ä»¬çš„ç›®çš„â€”â€”ç›¸åŒçš„å­¦å·å°±è®¤ä¸ºæ˜¯åŒä¸€ä¸ªäººâ€”â€”æˆ‘ä»¬å¯ä»¥é‡å†™Studentç±»çš„ equals æ–¹æ³•ï¼š 12345678910111213141516171819202122class Student &#123; private int id; private String name; public Student(int id) &#123; this.id = id; &#125; @Override public boolean equals(Object o) &#123; if (null == o) &#123; return false; &#125; Student std = (Student) o; if (this.id == std.id) &#123; return true; &#125; return super.equals(o); &#125; // ... getter and setter&#125; ä¿®æ”¹ä¹‹åä¸Šé¢çš„æµ‹è¯•å°±å¯ä»¥é€šè¿‡äº†ã€‚Demoæ¯•ç«Ÿæ˜¯ç®€å•çš„ï¼Œå½“æˆ‘ä»¬åœ¨å®é™…çš„ä½¿ç”¨ä¸­éœ€è¦é‡å†™equalsæ–¹æ³•æ—¶è¿˜æ˜¯éœ€è¦éµå®ˆå®ƒçš„ç”Ÿæˆè§„åˆ™ï¼Œè¿™é‡Œè´´å‡ºæ¥ä¾›å‚è€ƒï¼š 12345678910111213141516171819202122232425262728293031323334353637public boolean equals(Object obj) æŒ‡ç¤ºå…¶ä»–æŸä¸ªå¯¹è±¡æ˜¯å¦ä¸æ­¤å¯¹è±¡â€œç›¸ç­‰â€ã€‚ equals æ–¹æ³•åœ¨éç©ºå¯¹è±¡å¼•ç”¨ä¸Šå®ç°ç›¸ç­‰å…³ç³»ï¼š è‡ªåæ€§ï¼šå¯¹äºä»»ä½•éç©ºå¼•ç”¨å€¼ xï¼Œx.equals(x) éƒ½åº”è¿”å› trueã€‚ å¯¹ç§°æ€§ï¼šå¯¹äºä»»ä½•éç©ºå¼•ç”¨å€¼ x å’Œ yï¼Œå½“ä¸”ä»…å½“ y.equals(x) è¿”å› true æ—¶ï¼Œx.equals(y) æ‰åº”è¿”å› trueã€‚ ä¼ é€’æ€§ï¼šå¯¹äºä»»ä½•éç©ºå¼•ç”¨å€¼ xã€y å’Œ zï¼Œå¦‚æœ x.equals(y) è¿”å› trueï¼Œå¹¶ä¸” y.equals(z) è¿”å› trueï¼Œé‚£ä¹ˆ x.equals(z) åº”è¿”å› trueã€‚ ä¸€è‡´æ€§ï¼šå¯¹äºä»»ä½•éç©ºå¼•ç”¨å€¼ x å’Œ yï¼Œå¤šæ¬¡è°ƒç”¨ x.equals(y) å§‹ç»ˆè¿”å› true æˆ–å§‹ç»ˆè¿”å› falseï¼Œå‰ææ˜¯å¯¹è±¡ä¸Š equals æ¯”è¾ƒä¸­æ‰€ç”¨çš„ä¿¡æ¯æ²¡æœ‰è¢«ä¿®æ”¹ã€‚ å¯¹äºä»»ä½•éç©ºå¼•ç”¨å€¼ xï¼Œx.equals(null) éƒ½åº”è¿”å› falseã€‚ Object ç±»çš„ equals æ–¹æ³•å®ç°å¯¹è±¡ä¸Šå·®åˆ«å¯èƒ½æ€§æœ€å¤§çš„ç›¸ç­‰å…³ç³»ï¼›å³ï¼Œå¯¹äºä»»ä½•éç©ºå¼•ç”¨å€¼ x å’Œ yï¼Œå½“ä¸”ä»…å½“ x å’Œ y å¼•ç”¨åŒä¸€ä¸ªå¯¹è±¡æ—¶ï¼Œæ­¤æ–¹æ³•æ‰è¿”å› trueï¼ˆx == y å…·æœ‰å€¼ trueï¼‰ã€‚ æ³¨æ„ï¼šå½“æ­¤æ–¹æ³•è¢«é‡å†™æ—¶ï¼Œé€šå¸¸æœ‰å¿…è¦é‡å†™ hashCode æ–¹æ³•ï¼Œä»¥ç»´æŠ¤ hashCode æ–¹æ³•çš„å¸¸è§„åå®šï¼Œè¯¥åå®šå£°æ˜ç›¸ç­‰å¯¹è±¡å¿…é¡»å…·æœ‰ç›¸ç­‰çš„å“ˆå¸Œç ã€‚ å‚æ•°ï¼š obj - è¦ä¸ä¹‹æ¯”è¾ƒçš„å¼•ç”¨å¯¹è±¡ã€‚ è¿”å›ï¼š å¦‚æœæ­¤å¯¹è±¡ä¸ obj å‚æ•°ç›¸åŒï¼Œåˆ™è¿”å› trueï¼›å¦åˆ™è¿”å› falseã€‚ å¦è¯·å‚è§ï¼š hashCode(), Hashtable``` äº‹æƒ…è¿˜æ²¡æœ‰ç»“æŸã€‚çœ‹ä¸‹é¢ä»£ç ï¼š``` java@Testpublic void studentSet() throws Exception &#123; Student st1 = new Student(2333); Student st2 = new Student(2333); Set&lt;Student&gt; stds = new HashSet&lt;&gt;(); stds.add(st1); stds.add(st2); assertEquals(1, stds.size());&#125; ä½ ä¼šå‘ç°è¿™æ®µä»£ç æµ‹è¯•ä¸é€šè¿‡ã€‚setä¸æ˜¯é‡å¤å¯¹è±¡åªä¼šä¿ç•™ä¸€ä»½å—ï¼Œä¸ºä»€ä¹ˆä¸æ˜¯ 1 å‘¢ï¼Ÿ è¿™é‡Œå°±è¦ä»‹ç» hashCode() æ–¹æ³•ï¼š 12345678910111213141516public int hashCode() è¿”å›è¯¥å¯¹è±¡çš„å“ˆå¸Œç å€¼ã€‚æ”¯æŒæ­¤æ–¹æ³•æ˜¯ä¸ºäº†æé«˜å“ˆå¸Œè¡¨ï¼ˆä¾‹å¦‚ java.util.Hashtable æä¾›çš„å“ˆå¸Œè¡¨ï¼‰çš„æ€§èƒ½ã€‚ hashCode çš„å¸¸è§„åå®šæ˜¯ï¼š åœ¨ Java åº”ç”¨ç¨‹åºæ‰§è¡ŒæœŸé—´ï¼Œåœ¨å¯¹åŒä¸€å¯¹è±¡å¤šæ¬¡è°ƒç”¨ hashCode æ–¹æ³•æ—¶ï¼Œå¿…é¡»ä¸€è‡´åœ°è¿”å›ç›¸åŒçš„æ•´æ•°ï¼Œå‰ææ˜¯å°†å¯¹è±¡è¿›è¡Œ equals æ¯”è¾ƒæ—¶æ‰€ç”¨çš„ä¿¡æ¯æ²¡æœ‰è¢«ä¿®æ”¹ã€‚ä»æŸä¸€åº”ç”¨ç¨‹åºçš„ä¸€æ¬¡æ‰§è¡Œåˆ°åŒä¸€åº”ç”¨ç¨‹åºçš„å¦ä¸€æ¬¡æ‰§è¡Œï¼Œè¯¥æ•´æ•°æ— éœ€ä¿æŒä¸€è‡´ã€‚ å¦‚æœæ ¹æ® equals(Object) æ–¹æ³•ï¼Œä¸¤ä¸ªå¯¹è±¡æ˜¯ç›¸ç­‰çš„ï¼Œé‚£ä¹ˆå¯¹è¿™ä¸¤ä¸ªå¯¹è±¡ä¸­çš„æ¯ä¸ªå¯¹è±¡è°ƒç”¨ hashCode æ–¹æ³•éƒ½å¿…é¡»ç”Ÿæˆç›¸åŒçš„æ•´æ•°ç»“æœã€‚ å¦‚æœæ ¹æ® equals(java.lang.Object) æ–¹æ³•ï¼Œä¸¤ä¸ªå¯¹è±¡ä¸ç›¸ç­‰ï¼Œé‚£ä¹ˆå¯¹è¿™ä¸¤ä¸ªå¯¹è±¡ä¸­çš„ä»»ä¸€å¯¹è±¡ä¸Šè°ƒç”¨ hashCode æ–¹æ³•ä¸ è¦æ±‚ä¸€å®šç”Ÿæˆä¸åŒçš„æ•´æ•°ç»“æœã€‚ä½†æ˜¯ï¼Œç¨‹åºå‘˜åº”è¯¥æ„è¯†åˆ°ï¼Œä¸ºä¸ç›¸ç­‰çš„å¯¹è±¡ç”Ÿæˆä¸åŒæ•´æ•°ç»“æœå¯ä»¥æé«˜å“ˆå¸Œè¡¨çš„æ€§èƒ½ã€‚ å®é™…ä¸Šï¼Œç”± Object ç±»å®šä¹‰çš„ hashCode æ–¹æ³•ç¡®å®ä¼šé’ˆå¯¹ä¸åŒçš„å¯¹è±¡è¿”å›ä¸åŒçš„æ•´æ•°ã€‚ï¼ˆè¿™ä¸€èˆ¬æ˜¯é€šè¿‡å°†è¯¥å¯¹è±¡çš„å†…éƒ¨åœ°å€è½¬æ¢æˆä¸€ä¸ªæ•´æ•°æ¥å®ç°çš„ï¼Œä½†æ˜¯ JavaTM ç¼–ç¨‹è¯­è¨€ä¸éœ€è¦è¿™ç§å®ç°æŠ€å·§ã€‚ï¼‰ è¿”å›ï¼š æ­¤å¯¹è±¡çš„ä¸€ä¸ªå“ˆå¸Œç å€¼ã€‚ å¦è¯·å‚è§ï¼š equals(java.lang.Object), Hashtable å½“æˆ‘ä»¬ä½¿ç”¨ç”¨å“ˆå¸Œè¡¨å®ç°çš„å·¥å…·ç±»æ—¶ï¼Œè¿™ä¸ªæ–¹æ³•çš„ä»·å€¼å°±ä½“ç°äº†ã€‚ç”±äºä¹‹å‰æˆ‘ä»¬æ²¡æœ‰é‡å†™è¿™ä¸ªæ–¹æ³•ï¼ŒæŠŠStudentå¯¹è±¡å­˜å…¥HashSetæ—¶è¿˜æ˜¯æŒ‰ç…§ä¹‹å‰ç³»ç»Ÿé»˜è®¤çš„æ–¹å¼è®¡ç®—ä»–ä»¬çš„hashå€¼ï¼Œå¯¼è‡´Setä¸­å­˜åœ¨ä¸¤ä¸ªStudentå¯¹è±¡ã€‚ ä¸‹é¢åšä¸€ä¸ªç®€å•ä¿®æ”¹ï¼š 12345678910111213141516171819202122232425262728293031323334353637class Student &#123; private int id; private String name; public Student(int id) &#123; this.id = id; &#125; @Override public boolean equals(Object o) &#123; if (null == o) &#123; return false; &#125; // æœ‰æ—¶å€™instanceofä¸åˆé€‚çš„æ—¶å€™å¯ä»¥è€ƒè™‘ç”¨getClass()æ–¹æ³• if (getClass() != o.getClass()) &#123; return false; &#125; if (o instanceof Student) &#123; Student std = (Student) o; if (this.id == std.id) &#123; return true; &#125; &#125; return super.equals(o); &#125; @Override public int hashCode() &#123; return this.id; // return super.hashCode(); &#125; // ... getter and setter&#125; å†è¿è¡Œä¸‹é¢çš„æµ‹è¯•ï¼Œä½ ä¼šå‘ç°å’Œæˆ‘ä»¬æœŸå¾…çš„ä¸€è‡´äº†ï¼š 12345678910@Testpublic void studentSet() throws Exception &#123; Student st1 = new Student(2333); Student st2 = new Student(2333); Set&lt;Student&gt; stds = new HashSet&lt;&gt;(); stds.add(st1); stds.add(st2); assertEquals(1, stds.size());&#125; Demoä¸­ç›´æ¥å°†idä½œä¸ºhashcodeè¿”å›ä¸æ˜¯ä¸€ç§å¥½çš„ç”Ÿæˆæ–¹å¼ï¼Œå…·ä½“çš„ç”Ÿæˆè§„åˆ™è¯·å‚è€ƒä¸Šé¢çš„æ³¨é‡Šã€‚ 0x03 Demoå†æ¥çœ‹ä¸€ä¸ªdemoï¼š 123456789101112@Testpublic void stringTest() throws Exception &#123; String str1 = \"abc\"; String str2 = \"abc\"; String str3 = new String(\"abc\"); System.out.println(str1 == str2); System.out.println(str1 == str3); assertEquals(str1, str2); assertEquals(str1, str3);&#125; ç»“æœä¼šæ€æ ·ï¼Ÿæ²¡é”™ï¼Œæµ‹è¯•é€šè¿‡ï¼Œè¾“å‡ºï¼štrueï¼Œfalseã€‚ é¦–å…ˆæˆ‘ä»¬æ¥çœ‹ä¸‹Stringç±»é‡å†™çš„equals()å’ŒhashCOde(): 123456789101112131415161718192021222324252627282930313233343536373839@Override public boolean equals(Object other) &#123; if (other == this) &#123; return true; &#125; if (other instanceof String) &#123; String s = (String)other; int count = this.count; if (s.count != count) &#123; return false; &#125; if (hashCode() != s.hashCode()) &#123; return false; &#125; for (int i = 0; i &lt; count; ++i) &#123; if (charAt(i) != s.charAt(i)) &#123; return false; &#125; &#125; return true; &#125; else &#123; return false; &#125;&#125;@Override public int hashCode() &#123; int hash = hashCode; if (hash == 0) &#123; if (count == 0) &#123; return 0; &#125; for (int i = 0; i &lt; count; ++i) &#123; hash = 31 * hash + charAt(i); &#125; hashCode = hash; &#125; return hash;&#125; ä»ä¸Šé¢å¯ä»¥çœ‹å‡ºï¼ŒStringç±»é‡å†™äº†è¿™ä¸¤ä¸ªæ–¹æ³•ï¼Œequals()ä¸­çš„é€»è¾‘æ˜¯æ¯”è¾ƒå­—ç¬¦ä¸²ä¸­æ¯ä¸ªå­—ç¬¦æ˜¯å¦ç›¸åŒã€‚å› æ­¤ str1, str2, str3ç›¸åŒå°±å¯ä»¥ç†è§£äº†ã€‚å¯¹äº str1 == str2 å’Œ str1 != str3 è¿™æ¶‰åŠåˆ°ä¸åŒå­—ç¬¦ä¸²åˆ›å»ºæ–¹æ³•ã€‚ åœ¨å¼€å§‹è¿™ä¸ªä¾‹å­ä¹‹å‰ï¼ŒåŒå­¦ä»¬éœ€è¦çŸ¥é“JVMå¤„ç†Stringçš„ä¸€äº›ç‰¹æ€§ã€‚Javaçš„è™šæ‹Ÿæœºåœ¨å†…å­˜ä¸­å¼€è¾Ÿå‡ºä¸€å—å•ç‹¬çš„åŒºåŸŸï¼Œç”¨æ¥å­˜å‚¨å­—ç¬¦ä¸²å¯¹è±¡ï¼Œè¿™å—å†…å­˜åŒºåŸŸè¢«ç§°ä¸ºå­—ç¬¦ä¸²ç¼“å†²æ± ã€‚å½“ä½¿ç”¨ String a = â€œabcâ€è¿™æ ·çš„è¯­å¥è¿›è¡Œå®šä¹‰ä¸€ä¸ªå¼•ç”¨çš„æ—¶å€™ï¼Œé¦–å…ˆä¼šåœ¨å­—ç¬¦ä¸²ç¼“å†²æ± ä¸­æŸ¥æ‰¾æ˜¯å¦å·²ç»ç›¸åŒçš„å¯¹è±¡ï¼Œå¦‚æœå­˜åœ¨ï¼Œé‚£ä¹ˆå°±ç›´æ¥å°†è¿™ä¸ªå¯¹è±¡çš„å¼•ç”¨è¿”å›ç»™aï¼Œå¦‚æœä¸å­˜åœ¨ï¼Œåˆ™éœ€è¦æ–°å»ºä¸€ä¸ªå€¼ä¸ºâ€abcâ€çš„å¯¹è±¡ï¼Œå†å°†æ–°çš„å¼•ç”¨è¿”å›aã€‚String a = new String(â€œabcâ€);è¿™æ ·çš„è¯­å¥æ˜ç¡®å‘Šè¯‰JVMæƒ³è¦äº§ç”Ÿä¸€ä¸ªæ–°çš„Stringå¯¹è±¡ï¼Œå¹¶ä¸”å€¼ä¸ºâ€abcâ€ï¼Œäºæ˜¯å°±åœ¨å †å†…å­˜ä¸­çš„æŸä¸€ä¸ªå°è§’è½å¼€è¾Ÿäº†ä¸€ä¸ªæ–°çš„Stringå¯¹è±¡ã€‚","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"https://ttdevs.github.io/categories/æŠ€æœ¯/"}],"tags":[{"name":"Java","slug":"Java","permalink":"https://ttdevs.github.io/tags/Java/"}]},{"title":"ã€ŒJavaã€NumberFormatExceptionä¹‹InvalidFloatåˆ†æ","slug":"[Java]NumberFormatExceptionä¹‹InvalidFloatåˆ†æ","date":"1969-12-31T16:00:00.000Z","updated":"2017-04-27T11:07:57.000Z","comments":true,"path":"1970/01/01/[Java]NumberFormatExceptionä¹‹InvalidFloatåˆ†æ/","link":"","permalink":"https://ttdevs.github.io/1970/01/01/[Java]NumberFormatExceptionä¹‹InvalidFloatåˆ†æ/","excerpt":"","text":"0x00 é—®é¢˜æ–°ç‰ˆæœ¬ä¸Šçº¿ï¼Œ4å¤©æ—¶é—´ä¸€ä¸ªé”™è¯¯å‡ºç°ä¸€ç™¾å¤šæ¬¡ï¼Œå¦‚ä¸‹ï¼š 12345java.lang.NumberFormatException: Invalid float: \"55,4\" at java.lang.StringToReal.invalidReal(StringToReal.java:63) at java.lang.StringToReal.initialParse(StringToReal.java:164) at java.lang.StringToReal.parseFloat(StringToReal.java:323) at java.lang.Float.parseFloat(Float.java:306) 0x01 åˆ†æå‘ç°æ­¤é—®é¢˜åæ„Ÿè§‰å¾ˆç†Ÿæ‚‰ï¼Œä»¥å‰åº”è¯¥æ˜¯è§è¿‡ï¼Œä½†æ˜¯å¿˜è®°æ€ä¹ˆè§£å†³çš„äº†ï¼Œæ²¡åŠæ³•ï¼Œè¸©è¿‡çš„å‘å†è¸©ä¸€éã€‚æ¶‰åŠçš„ä»£ç å¦‚ä¸‹ï¼š 12345678910111213141516public class OnePreference&#123; ... public static void setLatestWeight(float weight) &#123; getInstance(MyApplication.getContext()).putFloat(PREFS_LATEST_WEIGHT, Float.parseFloat(NumberUtils.formatFloatWithOneDot(weight))); &#125; ...&#125;public class NumberUtils &#123; ... public static String formatFloatWithOneDot(float number) &#123; number = Math.round(number * 10) / 10f; return String.format(\"%.1f\", number); &#125; ...&#125; ç¡®è®¤é—®é¢˜ androidæ— æ³•å¤ç°ï¼ŒiOSåå°æœªæŠ¥æ­¤é”™è¯¯ æ€€ç–‘æ˜¯æ•°æ®çš„é—®é¢˜ è¿™æ˜¯ä¸€ä¸ªè®°å½•ä½“é‡çš„åŠŸèƒ½ï¼Œæ–°ç‰ˆä½“é‡è¾“å…¥å·²ç»åšäº†é™åˆ¶ï¼Œæ‰€ä»¥æ€€ç–‘å¯èƒ½æ˜¯è€æ•°æ®çš„é—®é¢˜ã€‚å› æ­¤æ‰¾åç«¯çš„åŒäº‹é™æ­¤æ•°æ®åšå¤„ç†ï¼šå¦‚æœæ­¤å­—æ®µæ— æ³•è§£æä¸ºæ•°å­—åˆ™è¿‡æ»¤æ‰ã€‚ ä½†æ˜¯é—æ†¾çš„ï¼Œåç«¯å‘å¸ƒä¹‹åé—®é¢˜ä¾ç„¶å­˜åœ¨ã€‚ åˆ†æä»£ç  setLatestWeight(float weight) è¿™ä¸ªä¼ å…¥çš„æ˜¯floatï¼Œæ‰€ä»¥ä¹‹å‰çš„å‡è®¾æ˜¯é”™è¯¯çš„ â€”â€” å¦‚æœæ˜¯æ•°æ®çš„é—®é¢˜ï¼Œé‚£æ ¹æœ¬èµ°ä¸åˆ°æ–¹æ³•é‡Œã€‚ è¿™æ ·çš„è¯é‚£å°±æ˜¯ formatFloatWithOneDot(float number) è¿™ä¸ªæ–¹æ³•çš„é—®é¢˜ï¼Œä½†æ˜¯æƒ³äº†ä¸‹ä¹‹å‰éƒ½æœ‰è¿™ä¹ˆå†™è¿‡ â€”â€” å°†floatç±»å‹æ ¼å¼åŒ–ä¸ºä¸€ä½å°æ•°çš„å­—ç¬¦ä¸²ï¼Œåº”è¯¥æ²¡é—®é¢˜å•Šã€‚é‚£ä¼šæ˜¯æ€æ ·å‘¢ï¼Ÿå¯èƒ½å¾ˆè‡ªç„¶ä¼šæƒ³åˆ°å›½é™…åŒ–çš„é—®é¢˜ã€‚é‚ä½œäº†ä¸€ä¸ªç®€å•çš„æµ‹è¯•ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445public class ExampleUnitTest &#123; @Test public void testStringLocale() throws Exception &#123; Locale[] locales = new Locale[]&#123; Locale.CANADA, Locale.CANADA_FRENCH, Locale.CHINESE, Locale.ENGLISH, Locale.FRANCE, Locale.GERMAN, Locale.GERMANY, Locale.ITALIAN, Locale.ITALY, Locale.JAPAN, Locale.JAPANESE, Locale.KOREA, Locale.KOREAN, Locale.PRC, Locale.ROOT, Locale.SIMPLIFIED_CHINESE, Locale.TAIWAN, Locale.TRADITIONAL_CHINESE, Locale.UK, Locale.US &#125;; String weightString = null; for (Locale locale : locales) &#123; try &#123; weightString = formatFloatWithOneDot(locale, 55.4f); float weight = Float.parseFloat(weightString); &#125; catch (NumberFormatException e) &#123; System.out.println(locale + \"&gt;&gt;&gt;&gt;&gt;\" + weightString + \"&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; error\"); continue; &#125; System.out.println(locale + \"&gt;&gt;&gt;&gt;&gt;\" + weightString); &#125; &#125; public static String formatFloatWithOneDot(Locale locale, float number) &#123; number = Math.round(number * 10) / 10f; return String.format(locale, \"%.1f\", number); &#125;&#125; è¾“å‡ºç»“æœå¦‚ä¸‹ï¼š 12345678910111213141516171819202122en_CA&gt;&gt;&gt;&gt;&gt;55.4fr_CA&gt;&gt;&gt;&gt;&gt;55,4&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; errorzh&gt;&gt;&gt;&gt;&gt;55.4en&gt;&gt;&gt;&gt;&gt;55.4fr_FR&gt;&gt;&gt;&gt;&gt;55,4&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; errorde&gt;&gt;&gt;&gt;&gt;55,4&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; errorde_DE&gt;&gt;&gt;&gt;&gt;55,4&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; errorit&gt;&gt;&gt;&gt;&gt;55,4&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; errorit_IT&gt;&gt;&gt;&gt;&gt;55,4&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; errorja_JP&gt;&gt;&gt;&gt;&gt;55.4ja&gt;&gt;&gt;&gt;&gt;55.4ko_KR&gt;&gt;&gt;&gt;&gt;55.4ko&gt;&gt;&gt;&gt;&gt;55.4zh_CN&gt;&gt;&gt;&gt;&gt;55.4&gt;&gt;&gt;&gt;&gt;55.4zh_CN&gt;&gt;&gt;&gt;&gt;55.4zh_TW&gt;&gt;&gt;&gt;&gt;55.4zh_TW&gt;&gt;&gt;&gt;&gt;55.4en_GB&gt;&gt;&gt;&gt;&gt;55.4en_US&gt;&gt;&gt;&gt;&gt;55.4Process finished with exit code 0 æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œåœ¨ä¸åŒçš„è¯­è¨€ä¸‹ `String.format(locale, &quot;%.1f&quot;, number)` æ ¼å¼åŒ–çš„ç»“æœæ˜¯ä¸ä¸€æ ·çš„ï¼Œ55.4å¯èƒ½ä¼šè¢«æ ¼å¼åŒ–ä¸º55,4ï¼Œç„¶åå°±å‡ºç°äº†ä¸Šé¢çš„é”™è¯¯ã€‚å°†æˆ‘ä»¬çš„æµ‹è¯•æœºè¯­è¨€è®¾ç½®æˆå‡ºé”™çš„è¯­è¨€ï¼Œé—®é¢˜å¯ä»¥å¤ç°ã€‚ å†æ¥çœ‹ä¸‹åå°çš„é”™è¯¯ï¼š ![é”™è¯¯ä¿¡æ¯]() - å¤§éƒ¨åˆ†æ˜¯åä¸ºçš„è®¾å¤‡ï¼Œç„¶åæ˜¯ä¸‰æ˜Ÿï¼Œç´¢å°¼ - å„ä¸ªç‰ˆæœ¬éƒ½æœ‰ï¼Œä»4.4åˆ°æœ€æ–°çš„7.0 - ä¸åŒçš„æ¸ é“éƒ½æœ‰ï¼Œä¸»è¦çš„æ¸ é“æ¥è‡ªåä¸º è¿™äº›ä¿¡æ¯ä¹Ÿä»ä¾§é¢åæ˜ äº†é—®é¢˜çš„åŸå› ã€‚çœ‹æ¥åä¸ºçš„å›½é™…åŒ–ä¹‹è·¯è¿˜æ˜¯å¾ˆå±Œçš„ã€‚ 0x02 è§£å†³ ç”±äºæˆ‘ä»¬å¹¶æ²¡æœ‰åšå›½é™…åŒ–çš„é€‚é…ï¼Œå› æ­¤è¿™é‡Œæ”¹èµ·æ¥è¿˜æ˜¯å¾ˆæ–¹ä¾¿çš„ï¼Œç›´æ¥ç»™ String.format() æ–¹æ³•æŒ‡å®šLocaleä¿¡æ¯ï¼š String.format(Locale.ENGLISH, &quot;%.1f&quot;, number); or String.format(Locale.CHINA, &quot;%.1f&quot;, number); NumberFormat(DecimalFormat)","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"https://ttdevs.github.io/categories/æŠ€æœ¯/"}],"tags":[{"name":"Java","slug":"Java","permalink":"https://ttdevs.github.io/tags/Java/"}]},{"title":"ã€ŒRetrofitã€0x00åˆæ¢","slug":"[Retrofit]0x00åˆæ¢","date":"1969-12-31T16:00:00.000Z","updated":"2017-04-27T11:07:57.000Z","comments":true,"path":"1970/01/01/[Retrofit]0x00åˆæ¢/","link":"","permalink":"https://ttdevs.github.io/1970/01/01/[Retrofit]0x00åˆæ¢/","excerpt":"","text":"0x00 Retrofitå¾ˆä¹…ä»¥å‰å°±è®¡åˆ’è¦ç ”ç©¶ä¸€ä¸‹ï¼Œä½†æ˜¯ä¸€ç›´æ‹–åˆ°ç°åœ¨ï¼Œä¸çŸ¥é“æ˜¯å› ä¸ºä¼˜å…ˆçº§æ”¾çš„æ¯”è¾ƒä½è¿˜æ˜¯å› ä¸ºæ‹–å»¶ç—‡ã€‚æ€»åªï¼Œç°åœ¨è¦å®Œæ•´çš„çœ‹ä¸€éã€‚ ç”±äºè¿™ä¸ªå·²ç»å‡ºæ¥å¾ˆä¹…äº†ï¼Œæ‰€ä»¥æˆ‘å°±ç›´æ¥é€‰æ‹©äº†Refrofit2ï¼Œæ²¡æœ‰å»å…³æ³¨Refrofit1ï¼Œç­‰çœ‹å®ŒRefrofit2æœ‰æ—¶é—´çš„è¯å†å»çœ‹çœ‹Refrofit1ï¼Œçœ‹çœ‹å®ƒä»¬çš„å˜è¿ã€‚å¥½äº†ï¼Œå…ˆä»Refrofit2å¼€å§‹å§ã€‚ 0x01 ç®€ä»‹ç®€ä»‹å¦‚æœä½ æ¥è§¦Androidæ—¶é—´æ¯”è¾ƒé•¿ï¼Œä»æœ€åˆçš„è‡ªå·±å°è£…çº¿ç¨‹ï¼Œåˆ°ä½¿ç”¨å¼‚æ­¥ä»»åŠ¡ï¼Œåˆ°å¼€æºçš„å„ç§ç¬¬ä¸‰æ–¹ç½‘ç»œè¯·æ±‚æ¡†æ¶å¦‚xUtilsï¼Œåˆ°è°·æ­Œçš„Volleyï¼Œandroideræ€»åœ¨æ¢ç´¢ä¸€ç§æ›´å¥½çš„ç½‘ç»œè¯·æ±‚å½¢å¼ã€‚Retrofitå°±æ˜¯è¿™æ ·çš„ä¸€æ¬¾äº§å“ã€‚ PSï¼šä»ä¸Šé¢ä¸€å¥è¯ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥çœ‹åˆ°ï¼Œandroidç”Ÿæ€åœ¨ä¸æ–­çš„è¿›æ­¥å’Œå®Œå–„ï½ï½ å¼•å…¥ä¸¤ä¸ªé—®é¢˜ï¼Œgradleå’Œæ··æ·†ï¼š Gradleï¼š Retrofitï¼š compile &#39;com.squareup.retrofit2:retrofit:2.1.0&#39; JSONè§£æå™¨ï¼š compile &#39;com.squareup.retrofit2:converter-gson:2.1.0&#39; Proguardï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647-dontwarn retrofit2.**-keep class retrofit2.** &#123; *; &#125;-keepattributes Signature-keepattributes Exceptions ``` ## 0x02 ä»ä¸€ä¸ªdemoå¼€å§‹``` java public class ExampleUnitTest &#123; @Test public void test_retrofit() throws Exception&#123; String url = &quot;http://api.github.com/&quot;; OkHttpClient client = new OkHttpClient.Builder() .build(); Retrofit.Builder builder = new Retrofit.Builder() .client(client) .baseUrl(url) .addConverterFactory(GsonConverterFactory.create()); Retrofit retrofit = builder.build(); GitHubService github = retrofit.create(GitHubService.class); Call&lt;User&gt; ttdevs = github.userInfo(&quot;ttdevs&quot;); final CountDownLatch countDownLatch = new CountDownLatch(1); ttdevs.enqueue(new Callback&lt;User&gt;() &#123; @Override public void onResponse(Call&lt;User&gt; call, Response&lt;User&gt; response) &#123; User ttdevs = response.body(); String message = String.format( &quot;I&apos;m %s.\\n%s&quot;, ttdevs.getName(), ttdevs.getHtml_url()); System.out.println(message); countDownLatch.countDown(); &#125; @Override public void onFailure(Call&lt;User&gt; call, Throwable t) &#123; countDownLatch.countDown(); &#125; &#125;); countDownLatch.await(); &#125;&#125; 0x03 ç¬¬ä¸€ä¸ªé—®é¢˜ï¼šHeaderæ‰§è¡Œä¸Šé¢çš„å°demoï¼Œæˆ‘ä»¬é€šè¿‡æŠ“åŒ…å‘ç°å®ƒçš„headerä¿¡æ¯å¦‚ä¸‹ï¼š 123Host: api.github.com:443Proxy-Connection: Keep-AliveUser-Agent: okhttp/3.3.0 è¿™ä¸ªheaderä¿¡æ¯æ˜¯ä¸æ˜¯å¾ˆç®€å•ï¼Œå¦‚æœä½ ç”¨è¿™æ ·çš„è¯·æ±‚å»å†™çˆ¬è™«çš„è¯ï¼Œå¤šæ•°æƒ…å†µä¸‹æ˜¯å¾—ä¸åˆ°ç»“æœçš„ã€‚è€Œå®é™…æƒ…å†µä¹Ÿæ˜¯ï¼šæˆ‘ä»¬éœ€è¦åœ¨headerä¸­ä½¿ç”¨æ ‡å‡†httpå¤´ä¿¡æ¯ï¼Œä¹Ÿå¯èƒ½éœ€è¦åŠ å…¥è‡ªå®šä¹‰çš„å¤´ä¿¡æ¯ï¼Œæ¯”å¦‚tokenç­‰ã€‚Retrofit2æ²¡æœ‰ç›´æ¥ç»™ä»–ä»¬æä¾›è¿™æ ·çš„æ–¹æ³•ï¼Œä½†æ˜¯æˆ‘ä»¬çŸ¥é“ï¼ŒRetrofit2ç”¨çš„æ˜¯Okhttp3ï¼Œå› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥ä»Okhttp3ä¸­ä¸‹æ‰‹ï¼Œä»£ç å¦‚ä¸‹ï¼š åˆ›å»º HeadersInterceptor ç±»ï¼Œä»£ç å¦‚ä¸‹ï¼š 123456789101112131415161718192021222324252627282930public class HeadersInterceptor implements Interceptor &#123; @Override public Response intercept(Chain chain) throws IOException &#123; Request original = chain.request(); Request request = original.newBuilder() .header(\"User-Agent\", \"ttdevs\") .header(\"Content-Type\", \"application/json; charset=utf-8\") .header(\"Accept\", \"application/json\") .header(\"token\", \"abcdefg_ttdevs_hijklmn\") .header(\"user_key\", \"ttdevs\") .method(original.method(), original.body()) .build(); long t1 = System.nanoTime(); String requestHeader = String.format(\"&gt;&gt;&gt;&gt;&gt;Sending request %s on %s%n%s\", request.url(), chain.connection(), request.headers()) System.out.println(requestHeader); Response response = chain.proceed(request); long t2 = System.nanoTime(); System.out.println(String.format(\"&gt;&gt;&gt;&gt;&gt;Received response for %s in %.1fms%n%s\", response.request().url(), (t2 - t1) / 1e6d, response.headers())); System.out.println(\"=====================================================\"); return response; &#125;&#125; åœ¨ Okhttp ä¸­åŠ å…¥ HeadersInterceptor 1234567891011String url = \"http://api.github.com/\";OkHttpClient client = new OkHttpClient.Builder() .addInterceptor(new HeadersInterceptor()) .build();Retrofit.Builder builder = new Retrofit.Builder() .client(client) .baseUrl(url) .addConverterFactory(GsonConverterFactory.create());Retrofit retrofit = builder.build();GitHubService github = retrofit.create(GitHubService.class);Call&lt;User&gt; ttdevs = github.userInfo(\"ttdevs\"); è¿™æ ·åœ¨è¿è¡Œä¸Šé¢çš„ä»£ç ï¼Œæˆ‘ä»¬å°±å¯ä»¥åœ¨ Http è¯·æ±‚çš„ Header ä¸­çœ‹åˆ°æˆ‘ä»¬åŠ å…¥çš„ä¿¡æ¯äº†ã€‚ æºç å‚è€ƒï¼šttdevs 0xFF å‚è€ƒ https://github.com/square/retrofit http://square.github.io/retrofit/ https://futurestud.io/blog/retrofit-add-custom-request-header","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"https://ttdevs.github.io/categories/æŠ€æœ¯/"}],"tags":[{"name":"Retrofit","slug":"Retrofit","permalink":"https://ttdevs.github.io/tags/Retrofit/"}]},{"title":"ã€ŒVolleyã€0x04ä¸€äº›ç»†èŠ‚","slug":"[Volley]0x04ä¸€äº›ç»†èŠ‚","date":"1969-12-31T16:00:00.000Z","updated":"2017-04-27T11:07:57.000Z","comments":true,"path":"1970/01/01/[Volley]0x04ä¸€äº›ç»†èŠ‚/","link":"","permalink":"https://ttdevs.github.io/1970/01/01/[Volley]0x04ä¸€äº›ç»†èŠ‚/","excerpt":"","text":"æœ€è¿‘åˆæŠŠvolleyæ‹¿å‡ºæ¥æ•´ç†äº†ä¸‹ã€‚ä¹‹å‰æ²¡æœ‰é‡åˆ°è¿‡çš„ä¸€äº›å°é—®é¢˜åˆæ¥äº†ï¼Œåœ¨æ­¤è®°å½•ä¸‹ï¼š 1ã€HttpUrlConnection DELETE æ–¹å¼æ— æ³•æ·»åŠ bodyçš„é—®é¢˜ï¼šjava.net.ProtocolException:DELETE does not support writing è¿™ä¸ªå¯ä»¥ç®—æ˜¯ä¸€ä¸ªç³»ç»Ÿçº§çš„bugï¼Œä¸ºä»€ä¹ˆè¿™ä¹ˆè¯´ï¼Œè¯·çœ‹è¿™é‡Œï¼Œè¿™ä¸ªé—®é¢˜åœ¨java8ä¸­æ‰å¾—ä»¥è§£å†³ã€‚æ²¡åŠæ³•ç›´æ¥è¿‡å»ï¼Œå’±å°±ç»•è¿‡å»ã€‚æŸ¥çœ‹HttpUrlConnectionï¼Œæˆ‘ä»¬å‘ç°ä»–æ˜¯ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œå› æ­¤å¯ä»¥è¯•è¯•èƒ½ä¸èƒ½é€šè¿‡å®ƒçš„å…¶ä»–å®ç°æ¥è¾¾åˆ°æˆ‘ä»¬çš„ç›®çš„ã€‚æœ€ç»ˆæˆ‘ä»¬å†³å®šä½¿ç”¨ okhttp è¿™ä¸ªå®ç°ã€‚åœ°å€ä¸ºï¼š https://github.com/square/okhttp ã€‚ æ¥ç€æˆ‘ä»¬è¿˜å¾—å»çœ‹çœ‹volleyçš„æºç ï¼Œç”±äºæˆ‘ä»¬çš„appå…¼å®¹çš„æœ€ä½ç‰ˆæœ¬æ˜¯4.0ï¼Œå› æ­¤æˆ‘ä»¬çŸ¥é“æœ€ç»ˆè°ƒç”¨çš„æ˜¯HurlStackï¼š public static RequestQueue newRequestQueue(Context context, HttpStack stack) { ... if (stack == null) { if (Build.VERSION.SDK_INT &gt;= 9) { stack = new HurlStack(); } else { // Prior to Gingerbread, HttpUrlConnection was unreliable. // See: http://android-developers.blogspot.com/2011/09/androids-http-clients.html stack = new HttpClientStack(AndroidHttpClient.newInstance(userAgent)); } } ... } å› æ­¤æˆ‘ä»¬åªéœ€è¦å°†HurlStackçš„ç›¸å…³ä»£ç ä¿®æ”¹å³å¯ï¼Œå¦‚ä¸‹ï¼š volley.java public static RequestQueue newRequestQueue(Context context, HttpStack stack) { ... if (stack == null) { if (Build.VERSION.SDK_INT &gt;= 9) { // old way: stack = new HurlStack(); // http://square.github.io/okhttp/ stack = new HurlStack(null, null, new OkUrlFactory(new OkHttpClient())); } else { // Prior to Gingerbread, HttpUrlConnection was unreliable. // See: http://android-developers.blogspot.com/2011/09/androids-http-clients.html stack = new HttpClientStack(AndroidHttpClient.newInstance(userAgent)); } } ... } HurlStack.java /** * An {@link HttpStack} based on {@link HttpURLConnection}. */ public class HurlStack implements HttpStack { private final OkUrlFactory mOkUrlFactory; /** * @param urlRewriter Rewriter to use for request URLs * @param sslSocketFactory SSL factory to use for HTTPS connections * @param okUrlFactory solution delete body(https://github.com/square/okhttp) */ public HurlStack(UrlRewriter urlRewriter, SSLSocketFactory sslSocketFactory, OkUrlFactory okUrlFactory) { mUrlRewriter = urlRewriter; mSslSocketFactory = sslSocketFactory; mOkUrlFactory = okUrlFactory; } /** * Create an {@link HttpURLConnection} for the specified {@code url}. */ protected HttpURLConnection createConnection(URL url) throws IOException { if(null != mOkUrlFactory){ return mOkUrlFactory.open(url); } return (HttpURLConnection) url.openConnection(); } @SuppressWarnings(&quot;deprecation&quot;) /* package */ static void setConnectionParametersForRequest(HttpURLConnection connection, Request&lt;?&gt; request) throws IOException, AuthFailureError { switch (request.getMethod()) { ... case Method.DELETE: connection.setRequestMethod(&quot;DELETE&quot;); addBodyIfExists(connection, request); break; ... default: throw new IllegalStateException(&quot;Unknown method type.&quot;); } } ... } 2015-04-26æ›´æ–°ï¼š å†æ¬¡ä½¿ç”¨åˆ°éœ€è¦ä½¿ç”¨åˆ°okhttpï¼Œå›å¤´çœ‹ä¸‹ä¸Šé¢çš„ä»£ç ï¼Œä¸çŸ¥é“å½“æ—¶æ€ä¹ˆæƒ³çš„ï¼Œä½¿ç”¨è¿™ä¹ˆå¤æ‚çš„æ–¹æ³•å¼•å…¥Okhttpï¼Œä¼°è®¡æ˜¯è„‘è¢‹è¿›æ°´äº†ã€‚å†æ¥çœ‹ä¸‹è¿™ä¸ªæ–¹æ³•ï¼šnewRequestQueue(Context context, HttpStackstack)ï¼Œæœ‰ä¸¤ä¸ªå‚æ•°ï¼šcontextå’ŒHttpStackï¼Œè¿™é‡Œæ˜¯è¦ä¼ å…¥è‡ªå·±çš„HttpStackå°±å¥½äº†ã€‚é‚£ä¹ˆæˆ‘ä»¬ç”¨OKhttpçš„å®ç°ï¼š /** * An {@link com.android.volley.toolbox.HttpStack HttpStack} implementation which * uses OkHttp as its transport. */ public class OkHttpStack extends HurlStack { private final OkHttpClient client; public OkHttpStack() { this(new OkHttpClient()); } public OkHttpStack(OkHttpClient client) { if (client == null) { throw new NullPointerException(&quot;Client must not be null.&quot;); } this.client = client; } @Override protected HttpURLConnection createConnection(URL url) throws IOException { return client.open(url); } } å‚è€ƒï¼š https://gist.github.com/JakeWharton/5616899 2ã€å…³äºï¼ˆä¿®æ”¹ï¼‰volleyçš„ç¼“å­˜volleyæœ‰å®Œæ•´çš„ä¸€å¥—ç¼“å­˜æœºåˆ¶ã€‚è€Œç›®å‰æˆ‘ä»¬æƒ³åšä¸ªç®€å•çš„éœ€æ±‚ï¼šéƒ¨åˆ†ç•Œé¢ï¼ˆå‡ ä¹ä¸ä¼šæ”¹åŠ¨çš„ï¼‰ç®€å•çš„åšä¸€å®šæ—¶é—´çš„ç¼“å­˜ï¼Œç ”ç©¶äº†ä¸‹ä»£ç å‘ç°å¾ˆå®¹æ˜“ä¿®æ”¹è¾¾åˆ°è‡ªå·±çš„ç›®çš„ï¼ˆæœ‰æ—¶é—´åœ¨åˆ†æä¸‹volleyçš„ç¼“å­˜æœºåˆ¶ï¼Œè¿™ä¸ªä¸€å®šè¦åšï¼‰ã€‚ç®€å•æ¥è¯´ä¿®æ”¹ä¸€ä¸ªåœ°æ–¹ï¼šrequest. parseNetworkResponseä¸­çš„ HttpHeaderParserï¼ˆæ­¤å¤„çªç„¶æ„Ÿæ…¨volleyçš„è®¾è®¡TMDçµæ´»äº†ï¼Œæƒ³æ€ä¹ˆæ”¹å°±æ€ä¹ˆæ”¹ï¼‰ã€‚ HttpHeaderParserä¿®æ”¹åçš„ä»£ç å¦‚ä¸‹ï¼š /** * ä¿®æ”¹åçš„ï¼Œç”¨æˆ·å¤„ç†ç¼“å­˜ */ public class BHHttpHeaderParser { /** * Extracts a {@link Cache.Entry} from a {@link NetworkResponse}. * * @param response The network response to parse headers from * @return a cache entry for the given response, or null if the response is not cacheable. */ public static Cache.Entry parseCacheHeaders(NetworkResponse response, boolean isCustomCache) { ... if(isCustomCache){ softExpire = now + Config.HTTP_CACHE_TTL; } else { if (hasCacheControl) { softExpire = now + maxAge * 1000; } else if (serverDate &gt; 0 &amp;&amp; serverExpires &gt;= serverDate) { // Default semantic for Expire header in HTTP specification is softExpire. softExpire = now + (serverExpires - serverDate); } } Cache.Entry entry = new Cache.Entry(); entry.data = response.data; entry.etag = serverEtag; entry.softTtl = softExpire; entry.ttl = entry.softTtl; entry.serverDate = serverDate; entry.responseHeaders = headers; return entry; } ... } æ­¤å¤„å¤§å®¶å¯ä»¥å‘ç°ï¼Œæˆ‘ä»¬ä¸»è¦æ˜¯æ ¹æ®è‡ªå®šä¹‰çš„å˜é‡å†³å®šå¦‚ä½•ä¿®æ”¹cacheçš„TTLæ¥è¾¾åˆ°è‡ªå·±çš„ç›®çš„ã€‚ 3ã€HttpUrlConnectionä¸PATCHï¼ˆ2015-04-26ï¼‰åœ¨ä½¿ç”¨Volleyå‘é€PATCHè¯·æ±‚çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šé‡åˆ°è¿™æ ·çš„é—®é¢˜ï¼šUnknown method â€˜PATCHâ€™; must be one of[OPTIONS, GET, HEAD, POST, PUT, DELETE, TRACE]ã€‚è¿™ä¸ªæ—¶å€™ä½ çš„ç¬¬ä¸€ååº”æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿæ˜¯Volleyä¸æ”¯æŒPATCHè¯·æ±‚å—ï¼Ÿæ¢æˆOkHttpæ˜¯ä¸æ˜¯å¯ä»¥å‘¢ï¼ŸæŸ¥çœ‹äº†ä¸‹Volleyçš„æºç ï¼Œåœ¨HurlHttp.javaä¸­å‘ç°å¦‚ä¸‹ä¸€æ®µï¼š /* package */ static void setConnectionParametersForRequest(HttpURLConnection connection, Request&lt;?&gt; request) throws IOException, AuthFailureError { switch (request.getMethod()) { case Method.DEPRECATED_GET_OR_POST: // This is the deprecated way that needs to be handled for backwards compatibility. // If the request&apos;s post body is null, then the assumption is that the request is // GET. Otherwise, it is assumed that the request is a POST. byte[] postBody = request.getPostBody(); if (postBody != null) { // Prepare output. There is no need to set Content-Length explicitly, // since this is handled by HttpURLConnection using the size of the prepared // output stream. connection.setDoOutput(true); connection.setRequestMethod(&quot;POST&quot;); connection.addRequestProperty(HEADER_CONTENT_TYPE, request.getPostBodyContentType()); DataOutputStream out = new DataOutputStream(connection.getOutputStream()); out.write(postBody); out.close(); } break; case Method.GET: // Not necessary to set the request method because connection defaults to GET but // being explicit here. connection.setRequestMethod(&quot;GET&quot;); break; case Method.DELETE: connection.setRequestMethod(&quot;DELETE&quot;); break; case Method.POST: connection.setRequestMethod(&quot;POST&quot;); addBodyIfExists(connection, request); break; case Method.PUT: connection.setRequestMethod(&quot;PUT&quot;); addBodyIfExists(connection, request); break; case Method.HEAD: connection.setRequestMethod(&quot;HEAD&quot;); break; case Method.OPTIONS: connection.setRequestMethod(&quot;OPTIONS&quot;); break; case Method.TRACE: connection.setRequestMethod(&quot;TRACE&quot;); break; case Method.PATCH: connection.setRequestMethod(&quot;PATCH&quot;); addBodyIfExists(connection, request); break; default: throw new IllegalStateException(&quot;Unknown method type.&quot;); } } é€šè¿‡è¿™æ®µä»£ç ï¼Œæˆ‘ä»¬çŸ¥é“ï¼ŒVolleyå¯¹PATCHè¿˜æ˜¯æ”¯æŒçš„ã€‚åœ¨ç»†çœ‹ä¸‹é”™è¯¯è¿™ä¸ªæ˜¯æœ‰HttpUrlConnectionæŠ›å‡ºçš„ã€‚å› æ­¤æˆ‘ä»¬éœ€è¦åœ¨è¿™æ–¹é¢ä¸‹æ‰‹ã€‚è¿™é‡Œæœ‰ä¸€ä¸ªå‚è€ƒï¼š https://github.com/adriancole/retrofit/commit/e704b800878b2e37f5ac98b0139cb4994618ace0 ä»¥åæœ‰å…¶ä»–å…³äºvolleyçš„æ€»ç»“éƒ½è®°å½•åœ¨æ­¤ã€‚","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"https://ttdevs.github.io/categories/æŠ€æœ¯/"}],"tags":[{"name":"Volley","slug":"Volley","permalink":"https://ttdevs.github.io/tags/Volley/"}]},{"title":"ã€ŒWechatã€å¾®ä¿¡å…¬ä¼—å·å¼€å‘æµç¨‹","slug":"[Wechat]å¾®ä¿¡å…¬ä¼—å·å¼€å‘æµç¨‹","date":"1969-12-31T16:00:00.000Z","updated":"2017-04-27T11:07:57.000Z","comments":true,"path":"1970/01/01/[Wechat]å¾®ä¿¡å…¬ä¼—å·å¼€å‘æµç¨‹/","link":"","permalink":"https://ttdevs.github.io/1970/01/01/[Wechat]å¾®ä¿¡å…¬ä¼—å·å¼€å‘æµç¨‹/","excerpt":"","text":"0x01ç”³è¯·è®¢é˜…å·æˆ–è€…æœåŠ¡å·å¾®ä¿¡æœ‰ä¸‰ç§å·ï¼šè®¢é˜…å·ï¼Œå…¬ä¼—å·ï¼ŒæœåŠ¡å·ï¼Œæ‰€æœ‰äººéƒ½å¯ä»¥æ³¨å†Œè®¢é˜…å·ï¼Œä¸ªäººå¾ˆéš¾æ³¨å†Œå…¬ä¼—å·å’ŒæœåŠ¡å·ï¼›è®¢é˜…å·ä¸èƒ½è®¤è¯ï¼Œå¼€æ”¾çš„æ¥å£ä¹Ÿæ˜¯æœ€å°‘çš„ã€‚æ—¢ç„¶åšå¼€å‘ï¼Œè¿™ç§è‚¯å®šä¸å¥½ä½¿ã€‚å› æ­¤æˆ‘ä»¬éœ€è¦é€‰æ‹©è®¢é˜…å·æˆ–è€…æœåŠ¡å·æ¥åšå¼€å‘ã€‚è‡ªå·±æ²¡åŠæ³•æ³¨å†Œï¼Œå¯ä»¥è€ƒè™‘ä¸‡èƒ½çš„æ·˜å®ã€‚æˆ–è€…æˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨æµ‹è¯•è´¦å· 0x02 æœåŠ¡å™¨åŠŸèƒ½å¼€å‘é…ç½®è‡ªå·±çš„æœåŠ¡å™¨åœ¨å¼€å‘ä¹‹å‰æˆ‘ä»¬éœ€è¦è¿›è¡ŒæœåŠ¡å™¨çš„é…ç½®ï¼Œè¿™ä¸ªä¸æ¶‰åŠå…·ä½“çš„è¯­è¨€ã€‚ç™»å½•å¾®ä¿¡åå°ï¼Œåœ¨ å¼€å‘ &gt; åŸºæœ¬é…ç½® &gt; æœåŠ¡å™¨é…ç½® ä¸­è¿›è¡Œé…ç½®ã€‚è¿™é‡Œéœ€è¦é…ç½®å››ä¸ªå‚æ•°ï¼š URL è¿™ä¸ªæ˜¯æˆ‘ä»¬æœåŠ¡å™¨çš„åœ°å€ï¼Œå¿…é¡»æ˜¯80ç«¯å£ã€‚å¾®ä¿¡ä¼šæŠŠæ‰€æœ‰çš„äº‹ä»¶å’Œæ¶ˆæ¯ç­‰éƒ½æ¨é€åˆ°è¿™ä¸ªåœ°å€ä¸Šã€‚ Token è¿™ä¸ªTokenæ˜¯æˆ‘ä»¬åˆ†é…ç»™å¾®ä¿¡çš„ EncodingAESKey å¾®ä¿¡æ¶ˆæ¯çš„åŠ å¯†ç§˜é’¥ æ¶ˆæ¯åŠ è§£å¯†æ–¹å¼ æ²¡æœ‰ç‰¹æ®Šè¦æ±‚æˆ‘ä»¬å¯ä»¥é€‰æ‹©æ˜æ–‡æ¨¡å¼ æ›´å¤šä¿¡æ¯å¯ä»¥å‚è€ƒè¿™é‡Œã€‚ å¾®ä¿¡æœåŠ¡å™¨éªŒè¯å¦‚æœæˆ‘ä»¬ç›´æ¥é…ç½®äº†ä¸Šé¢çš„å‚æ•°ï¼Œæ˜¯æ— æ³•ä¿å­˜çš„ï¼Œåªæœ‰åœ¨æˆ‘ä»¬é…ç½®çš„åœ°å€æ­£ç¡®å¤„ç†äº†å¾®ä¿¡çš„éªŒè¯è¯·æ±‚ä¹‹åæ‰å¯ä»¥ä¿å­˜æˆåŠŸã€‚è¿‡ç¨‹æ˜¯è¿™æ ·çš„ï¼Œå¾®ä¿¡ä¼šä»¥getæ–¹å¼å‘æˆ‘ä»¬é…ç½®çš„åœ°å€å‘ä¸€ä¸ªè¯·æ±‚ï¼Œè¿™ä¸ªè¯·æ±‚å¸¦äº†éªŒè¯ä¿¡æ¯ï¼Œå’Œè¿”å›çš„å­—ç¬¦ä¸²ï¼Œä»–ä»¬åˆ†åˆ«æ˜¯ signatureã€ timestampã€ nonceã€ echostrï¼Œå‰ä¸‰ä¸ªå‚æ•°ç”¨äºéªŒè¯ï¼Œåä¸€ä¸ªç”¨äºè¿”å›å¾®ä¿¡ã€‚å¦‚æœæˆ‘ä»¬æŒ‰ç…§è§„åˆ™éªŒè¯å‚æ•°æ˜¯æ­£ç¡®çš„ï¼ˆè¿™é‡Œä¼šç”¨åˆ°æˆ‘ä»¬é…ç½®çš„Tokenï¼‰ï¼Œå°†echostrå­—æ®µçš„ä¿¡æ¯è¿”å›ï¼Œè¿™æ ·å°±å¯ä»¥ä¿å­˜äº†ã€‚å½“ç„¶ï¼Œä½ ä¹Ÿå¯ä»¥ä¸åšéªŒè¯ç›´æ¥è¿”å›echostrå‚æ•°å†…å®¹ä¹Ÿæ˜¯å¯ä»¥ï¼Œä½†æ˜¯ä¸æ¨èè¿™æ ·åšã€‚æ›´å¤šä¿¡æ¯å¯ä»¥å‚è€ƒè¿™é‡Œã€‚ å¾®ä¿¡äº‹ä»¶å¤„ç†é…ç½®äº†ä¸Šé¢çš„å‚æ•°æˆ‘ä»¬å°±å¯ä»¥å¤„ç†å¾®ä¿¡å‘ç»™æˆ‘ä»¬çš„å„ç§ä¿¡æ¯äº†ã€‚å¾®ä¿¡æ‰€æœ‰ä¿¡æ¯éƒ½æ˜¯ä»¥POSTçš„æ–¹å¼å‘é€åˆ°æˆ‘ä»¬ä¹‹å‰é…ç½®çš„åœ°å€ä¸Šã€‚åœ¨URLå‚æ•°ä¸­ä¼šæºå¸¦å››ä¸ªå‚æ•°signatureã€ timestampã€ nonceå’Œopenidï¼Œæ•°æ®éƒ¨åˆ†åœ¨bodyä¸­ã€‚æŒ‰ç…§å¾®ä¿¡çš„æ¥å£åè®®ï¼Œæˆ‘ä»¬å°±å¯ä»¥å¼€å§‹å¾®ä¿¡åŠŸèƒ½å¼€å‘äº†ã€‚ æœ€åï¼Œæ— è®ºæ˜¯å®ç”¨çš„æ˜¯ä»€ä¹ˆè¯­è¨€ï¼Œéƒ½å»ºè®®ä½ å»æ‰¾ä¸€ä»½å°è£…çš„SDKæ¥ä½¿ç”¨ã€‚è¿™æ ·å¯ä»¥å¤§å¤§çš„å¢åŠ ä½ çš„å¼€å‘æ•ˆç‡ï¼Œå½“ç„¶ï¼Œå¦‚æœä½ æ˜¯åƒæˆ‘ä¸€æ ·ä¸ºäº†å­¦ä¹ ï¼Œå¯ä»¥è‡ªå·±å»è§£æè¿™äº›xmlæ ¼å¼çš„æ¶ˆæ¯ï½ï½","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"https://ttdevs.github.io/categories/æŠ€æœ¯/"}],"tags":[{"name":"Wechat","slug":"Wechat","permalink":"https://ttdevs.github.io/tags/Wechat/"}]},{"title":"ã€ŒmacOSã€Crontabå®šæ—¶ä»»åŠ¡","slug":"[macOS]Crontabå®šæ—¶ä»»åŠ¡","date":"1969-12-31T16:00:00.000Z","updated":"2017-04-27T11:07:57.000Z","comments":true,"path":"1970/01/01/[macOS]Crontabå®šæ—¶ä»»åŠ¡/","link":"","permalink":"https://ttdevs.github.io/1970/01/01/[macOS]Crontabå®šæ—¶ä»»åŠ¡/","excerpt":"","text":"æˆ‘ä»¬å¯ä»¥ä½¿ç”¨crontabæ‰§è¡Œä¸€äº›å‘¨æœŸä»»åŠ¡ 0x01 crontabå‘½ä»¤crontab [-u user] file crontab [-u user] { -e | -l | -r } crontab file_name å°†fileåšä¸ºcrontabçš„ä»»åŠ¡åˆ—è¡¨æ–‡ä»¶å¹¶è½½å…¥crontab crontab -e ç¼–è¾‘crontabæ–‡ä»¶å†…å®¹ crontab -l æ˜¾ç¤ºcrontabæ–‡ä»¶å†…å®¹ crontab -r åˆ é™¤è½½å…¥åçš„crontabæ–‡ä»¶å†…å®¹ 0x02 crontabæ–‡ä»¶ åˆ† æ—¶ æ—¥ æœˆ æ˜ŸæœŸ è¦è¿è¡Œçš„å‘½ä»¤ ç¬¬1åˆ— åˆ†é’Ÿ1ï½59 ç¬¬2åˆ— å°æ—¶1ï½23ï¼ˆ0è¡¨ç¤ºå­å¤œï¼‰ ç¬¬3åˆ— æ—¥1ï½31 ç¬¬4åˆ— æœˆ1ï½12 ç¬¬5åˆ— æ˜ŸæœŸ0ï½7ï¼ˆ0,7è¡¨ç¤ºæ˜ŸæœŸå¤©ï¼‰ ç¬¬6åˆ— è¦è¿è¡Œçš„å‘½ä»¤ å‡ ä¸ªç‰¹æ®Šç¬¦å·ï¼š/ - , / æ¯(per): */2 æ¯ä¸¤ä¸ªå•ä½ - è¿ç»­: 1-5 1,2,3,4,5 , éè¿ç»­: 1,2,5 1å’Œ2å’Œ5 0x03 Demo1234567891011121314151617181920# æ¯åˆ†é’Ÿå‘ç”¨æˆ·ç›®å½•ä¸‹çš„log.txtå†™å…¥å½“æ—¶æ—¥æœŸ* * * * * /bin/date &gt;&gt; ~/log.txt # æ¯åˆ†é’Ÿ* * * * * /bin/date &gt;&gt; ~/log.txt# æ¯5åˆ†é’Ÿ*/5 * * * * /bin/date &gt;&gt; ~/log.txt# æ¯å°æ—¶çš„ç¬¬äº”åˆ†é’Ÿ5 * * * * /bin/date &gt;&gt; ~/log.txt # 4æœˆ1æ—¥æ—©ä¸Š8ç‚¹0 8 1 4 * /bin/date &gt;&gt; ~/log.txt # 4å’Œ5æœˆ 1æ—¥æ—©ä¸Š8ç‚¹0 8 1 4,5 * /bin/date &gt;&gt; ~/log.txt # 1230623-7 * * * * /bin/date &gt;&gt; ~/log.txt æ›´æ–°(2015-03-26)0x01 crontabè¾…åŠ©å·¥å…·è¿™ä¸ªå·¥å…·å¯ä»¥ç”Ÿæˆcrontabæ–‡ä»¶ã€‚æ¯”å¦‚æˆ‘ä»¬æŒ‰ç…§è‡ªå·±çš„æƒ³æ³•é€‰æ‹©äº†ä»»åŠ¡çš„æ—¶é—´ï¼Œå¯ä»¥ä½¿ç”¨å®ƒå¸®åŠ©æˆ‘ä»¬ç”Ÿæˆå¯¹åº”çš„crontabæ–‡ä»¶ã€‚ åœ°å€ï¼šhttp://www.crontab-generator.org/ 0x02 crontabçš„è°ƒè¯•è¿™ä¸ªå»ºè®®åœ¨å‘½ä»¤çš„åé¢åŠ ä¸Š ... &gt;&gt; ~/log.txt 2&gt;&amp;1ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥åœ¨ç”¨æˆ·ç›®å½•ä¸‹çœ‹åˆ°crontabæ‰§è¡Œçš„æ—¥å¿—äº†ã€‚å¦‚ï¼š 1* * * * * /bin/date &gt;&gt; ~/log.txt &gt;&gt; ~/log.txt 2&gt;&amp;1 0x03 ç¯å¢ƒå˜é‡è™½ç„¶æˆ‘ä»¬çŸ¥é“crontabæ‰§è¡Œæ—¶æ˜¯æ²¡æœ‰ç¯å¢ƒå˜é‡çš„ï¼Œä½†æ˜¯è¿™ä¸ªç¡®æ˜¯ä¸ªè®¨åŒçš„ä¸œè¥¿ã€‚æˆ‘ä»¬åœ¨æœ¬åœ°è°ƒè¯•å¥½äº†ç›¸å…³çš„ä»£ç ï¼Œç”¨crontabå´æ€ä¹ˆæ‰§è¡Œä¹Ÿä¸æ­£ç¡®ï¼Œæ¯”å¦‚æ‰§è¡Œä¸‹é¢çš„shellï¼š 1234#!/bin/bashpy3=$(which python3)echo py3... é»˜è®¤æƒ…å†µä»€ä¹ˆä¹Ÿä¸ä¼šè¾“å‡ºã€‚ä¸‹é¢çš„é€»è¾‘è‡ªç„¶å°±æ˜¯é”™çš„äº†ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨æœ€å¼€å§‹åŠ ä¸Šè¿™ä¹ˆä¸€è¡Œ source /etc/profile ï¼Œç„¶ååœ¨æ‰§è¡Œå°±å¯ä»¥é¡ºåˆ©æ‹¿åˆ°æˆ‘ä»¬çš„å€¼äº†ï¼š 12345#!/bin/bashsource /etc/profilepy3=$(which python3)echo py3...","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"https://ttdevs.github.io/categories/æŠ€æœ¯/"}],"tags":[{"name":"macOS","slug":"macOS","permalink":"https://ttdevs.github.io/tags/macOS/"}]},{"title":"ã€ŒmacOSã€Macä¸€å¥è¯åˆ†äº«","slug":"[macOS]Macä¸€å¥è¯åˆ†äº«","date":"1969-12-31T16:00:00.000Z","updated":"2017-04-27T11:07:57.000Z","comments":true,"path":"1970/01/01/[macOS]Macä¸€å¥è¯åˆ†äº«/","link":"","permalink":"https://ttdevs.github.io/1970/01/01/[macOS]Macä¸€å¥è¯åˆ†äº«/","excerpt":"","text":"windowä¸‹ç›´æ¥è¾“å…¥msconfigæ‰“å¼€ç³»ç»Ÿé…ç½®å³å¯ï¼Œåœ¨è¿™é‡Œå¯ä»¥é…ç½®æ˜¯å¦å…è®¸å¼€æœºè‡ªå¯åŠ¨ã€‚MACä¸‹æœ€è¿‘è£…äº†å‡ ä¸ªè½¯ä»¶ï¼Œå‘ç°æ¯æ¬¡å¼€æœºéƒ½ä¼šè‡ªåŠ¨è¿è¡Œï¼Œæ¯”è¾ƒçƒ¦èºï¼Œé‚å¹²æ‰ä¹‹ï¼š æ‰“å¼€ç³»ç»Ÿåå¥½è®¾ç½®&gt;é€‰æ‹©ç”¨æˆ·ä¸ç¾¤ç»„&gt;åœ¨å½“å‰ç”¨æˆ·çš„å³ä¾§é€‰æ‹©ç™»å½•é¡¹ï¼Œåœ¨è¿™é‡Œå³å¯æ·»åŠ åˆ é™¤æˆ‘ä»¬è¦çš„ç¨‹åºã€‚","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"https://ttdevs.github.io/categories/æŠ€æœ¯/"}],"tags":[{"name":"macOS","slug":"macOS","permalink":"https://ttdevs.github.io/tags/macOS/"}]},{"title":"ã€ŒWebSocketã€ä½¿ç”¨Websocketå®ç°æ¶ˆæ¯æ¨é€(ä¸‹)","slug":"[WebSocket]ä½¿ç”¨Websocketå®ç°æ¶ˆæ¯æ¨é€(ä¸‹)","date":"1969-12-31T16:00:00.000Z","updated":"2017-04-27T11:07:57.000Z","comments":true,"path":"1970/01/01/[WebSocket]ä½¿ç”¨Websocketå®ç°æ¶ˆæ¯æ¨é€(ä¸‹)/","link":"","permalink":"https://ttdevs.github.io/1970/01/01/[WebSocket]ä½¿ç”¨Websocketå®ç°æ¶ˆæ¯æ¨é€(ä¸‹)/","excerpt":"","text":"0x00 WebSocketä¸Šä¸€ç¯‡ä½¿ç”¨ Java-WebSocket å†™äº†ä¸€å¥— WebSocket çš„Demoï¼Œè¿™ä¸€ç¯‡ç€é‡åˆ†æä¸‹WebSocket çš„ä¸€äº›å®ç°ç»†èŠ‚ï¼Œæ›´åŠ è¯¦ç»†çš„åè®®ç»†èŠ‚å¯å‚è€ƒ RFC6455ã€‚ 0x01 WebSocketåè®® WebSocket åè®®: å¯å‚è€ƒRFC6455 æŠ“åŒ…å·¥å…·ï¼šCharles å’Œ WireShark æµ‹è¯•ä»£ç ï¼šå‚è€ƒä¸Šä¸€ç¯‡Demo 0x02 æ•°æ®ä¼ è¾“ è¿æ¥å’Œæ–­å¼€ å½“ Client å‘ Server å‘èµ· ws è¿æ¥è¯·æ±‚åï¼Œä¼šå…ˆä½¿ç”¨ HTTP åè®®å»ºç«‹ TCP é•¿é“¾æ¥ï¼Œé€šè¿‡æŠ“åŒ…ï¼Œæˆ‘ä»¬ä¼šçœ‹åˆ°ç±»ä¼¼è¿™æ ·çš„ä¿¡æ¯ï¼š Requestï¼š Responseï¼š è¿™é‡Œç®€å•ä»‹ç»å‡ ä¸ªå…³é”®çš„Headerå­—æ®µï¼š upgrade:websocket connection:Upgrade sec-websocket-version:13 sec-websocket-key:xxxxxx sec-websocket-accept: è¿™äº›å­—æ®µçš„ä¿¡æ¯å¯å‚è€ƒè¿™é‡Œã€‚ æ•°æ®ä¼ è¾“ å½“ HTTP è¿æ¥å»ºç«‹ä¹‹åï¼Œå°±å¯ä»¥é€šè¿‡è¿™ä¸ªé•¿é“¾æ¥è¿›è¡Œæ•°æ®ä¼ è¾“äº†ã€‚å¦‚æœä½ ä½¿ç”¨ Charles è¿›è¡Œæ•°æ®æŠ“åŒ…çš„è¯ï¼Œå¯ä»¥çœ‹åˆ°ç±»ä¼¼ä¸‹å›¾ä¸­è¿™æ ·çš„èŠå¤©å†…å®¹ï¼š åœ¨åŒä¸€ä¸ª HTTP è¯·æ±‚ä¸­ï¼Œæˆ‘ä»¬çœ‹åˆ°ä¸æ–­æœ‰æ•°æ®äº¤äº’ï¼Œè€Œä¸æ˜¯åƒä¹‹å‰çš„ HTTP è¯·æ±‚é‚£æ ·ï¼Œæ¯å‘é€ä¸€æ¡æ•°æ®ï¼Œéƒ½éœ€è¦å‘èµ·ä¸€æ¬¡æ–°çš„è¯·æ±‚ã€‚ ä¸‹é¢æˆ‘ä»¬æ¥å°è¯•åˆ†æä¸€ä¸‹ã€‚è¿™é‡Œè¦ç”¨åˆ°Wiresharkã€‚å¯èƒ½ä½ ä¼šä¸ºä»€ä¹ˆæ¢äº†Wiresharkè€Œä¸ç”¨Charlesäº†ï¼ŸåŸå› å¾ˆç®€å•ï¼ŒCharlesç»™æˆ‘ä»¬å‘ˆç°çš„æ˜¯åº”ç”¨å±‚æœ€ç»ˆçš„ç»“æœï¼Œè€Œä¼ è¾“å±‚çš„å…·ä½“çš„æ•°æ®åŒ…å‘é€æ¥æ”¶å´ä¸èƒ½å±•ç¤ºï¼Œè¿™ä¸ªæ—¶å€™å°±éœ€è¦å€ŸåŠ©Wiresharkæ¥å¯¹TCPæ•°æ®åŒ…è¿›è¡Œåˆ†æäº†ã€‚ é¦–å…ˆï¼ŒæŸ¥è¯¢ RFC6455æ–‡æ¡£ï¼Œæˆ‘ä»¬å¾—çŸ¥ ws åè®®çš„æ•°æ®åŒ…æ ¼å¼å¦‚ä¸‹ï¼š æœ‰äº†è¿™ä¸ªå‚è€ƒï¼Œæˆ‘ä»¬å°±å¯ä»¥è¿›è¡Œæ•°æ®åˆ†æäº†ã€‚ä¸‹é¢æ˜¯æˆ‘çš„ä¸€æ¬¡æ•°æ®æ”¶å‘è¿‡ç¨‹ï¼šå®¢æˆ·ç«¯å‘æœåŠ¡ç«¯å‘é€æ•°æ®ï¼š123456789ï¼Œç„¶åæœåŠ¡ç«¯åŸæ ·å‘å›ï¼ŒæŠ“åŒ…å¦‚ä¸‹ï¼š Senderï¼š Receiverï¼š ä¸‹é¢æˆ‘ä»¬ç€é‡å¯¹è¿™ä¸¤ä¸ªæ•°æ®åŒ…è¿›è¡Œåˆ†æã€‚ç»†å¿ƒçš„ä½ å¯èƒ½ä¼šå‘ç°ï¼Œæˆªå›¾ä¸­æœ‰å››æ¡æ•°æ®ï¼Œå¦‚æœä½ å¯¹TCPçš„ä¼ è¾“æœ‰æ‰€äº†è§£ï¼Œç¬¬äºŒæ¡å’Œç¬¬ä¸‰æ¡æ˜¯ç¡®è®¤æŠ¥æ–‡ã€‚ æˆ‘ä»¬å…ˆçœ‹ä¸‹æ¥æ”¶åˆ°æ•°æ®ã€‚ç‚¹å‡»æ•°æ®ä¸­çš„ Data(11bytes) éƒ¨åˆ†ï¼Œä¸‹æ–¹æ˜¯è‡ªåŠ¨é€‰æ‹©äº†æ•°æ®éƒ¨åˆ†ï¼š8109313233343536373839ã€‚ï¼ˆåœ¨æ­¤ä¹‹å‰æ˜¯TCPæŠ¥æ–‡çš„Headeréƒ¨åˆ†ï¼Œæˆ‘ä»¬å¯ä»¥å¿½ç•¥ï¼‰æ ¹æ® ws åè®®ï¼Œæˆ‘ä»¬å°†å…¶å±•å¼€ï¼š 1234567891011121314151617181920212223242581 09: 10000001 00001001 31 32: 00110001 0011001033 34: 00110011 0011010035 36: 00110101 0011011037 38: 00110111 0011100039 : 00111001``` 0ï¼š1ï¼Œè¿™æ˜¯æœ€åä¸€å¸§1ï½3ï¼šå…¨ä¸º04ï½7ï¼š001ï¼Œé™„åŠ æ•°æ®å¸§8ï¼š0ï¼ŒPlayloadDataæœªç»è¿‡æ©ç  9ï½15ï¼š0001001 = 9 &lt; 125ï¼Œå› æ­¤æ•°æ®é•¿åº¦ä½9 å‰©ä¸‹çš„ï¼š313233343536373839å³ä¸ºæ•°æ® 123456789å†æ¥çœ‹çœ‹å‘é€çš„æ•°æ®ã€‚ç‚¹å‡» Data(15bytes) éƒ¨åˆ†ï¼Œä¸‹æ–¹çš„æ•°æ®éƒ¨åˆ†ï¼š818911eb9db220d9ae8624ddaa8a28ï¼Œå±•å¼€ï¼š``` shell81 89 : 10000001 10001001 11 eb : 00010001 111010119d b2 : 10011101 1011001020 d9 : 00100000 11011001ae 86 : 10101110 1000011024 dd : 00100100 11011101aa 8a : 10101010 1000101028 : 00101000 0ï¼š1ï¼Œè¿™æ˜¯æœ€åä¸€å¸§ 1ï½3ï¼šå…¨ä¸º0 4ï½7ï¼š001ï¼Œé™„åŠ æ•°æ®å¸§ 8ï¼š1ï¼ŒPlayloadDataç»è¿‡æ©ç ï¼Œï¼ˆæ‰€æœ‰çš„ç”±å®¢æˆ·ç«¯å‘å¾€æœåŠ¡ç«¯çš„å¸§æ­¤æ•°ä½éƒ½è¢«è®¾ç½®æˆ 1ã€‚ï¼‰ 9ï½15ï¼š0001001 = 9 &lt; 125ï¼Œå› æ­¤æ•°æ®é•¿åº¦ä½9 11 eb 9d b2ï¼šæ©ç  20 d9 ae 86 24 dd aa 8a 28ï¼šæ•°æ® å…³äºæ©ç çš„è®¡ç®—ï¼š è¿æ¥ä¿æŒ é™¤äº†æ­£å¸¸çš„æ•°æ®ä¼ è¾“ä¹‹å¤–ï¼ŒSocketç¼–ç¨‹è¿˜æœ‰ä¸€ä¸ªé‡è¦çš„ç»„æˆéƒ¨åˆ†ï¼šå¿ƒè·³ä¿æŒã€‚wsåè®®ä¸­å®šä¹‰äº†ä¸“é—¨çš„æ•°æ®åŒ…ï¼š Control frames are identified by opcodes where the most significant bit of the opcode is 1. Currently defined opcodes for control frames include 0x8 (Close), 0x9 (Ping), and 0xA (Pong). Opcodes 0xB-0xF are reserved for further control frames yet to be defined.Control frames are used to communicate state about the WebSocket. Control frames can be interjected in the middle of a fragmented message.All control frames MUST have a payload length of 125 bytes or less and MUST NOT be fragmented. å…¶ä»– ä¸€ä¸ªåè®®ä¸å¯èƒ½å°±è¿™ä¹ˆç®€å•ï¼Œå¦‚æœä½ è¿˜æƒ³äº†è§£æ›´å¤šï¼Œå¯å‚è€ƒRFC6455ã€‚ 0xFF å‚è€ƒ http://www.jianshu.com/p/867274a5e054 http://www.jianshu.com/p/fc09b0899141 https://datatracker.ietf.org/doc/rfc6455/ https://developer.mozilla.org/zh-CN/docs/WebSockets/Writing_WebSocket_servers","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"https://ttdevs.github.io/categories/æŠ€æœ¯/"}],"tags":[{"name":"WebSocket","slug":"WebSocket","permalink":"https://ttdevs.github.io/tags/WebSocket/"}]},{"title":"ã€ŒWebSocketã€ä½¿ç”¨Websocketå®ç°æ¶ˆæ¯æ¨é€(å¿ƒè·³)","slug":"[WebSocket]ä½¿ç”¨Websocketå®ç°æ¶ˆæ¯æ¨é€(å¿ƒè·³)","date":"1969-12-31T16:00:00.000Z","updated":"2017-04-27T11:07:57.000Z","comments":true,"path":"1970/01/01/[WebSocket]ä½¿ç”¨Websocketå®ç°æ¶ˆæ¯æ¨é€(å¿ƒè·³)/","link":"","permalink":"https://ttdevs.github.io/1970/01/01/[WebSocket]ä½¿ç”¨Websocketå®ç°æ¶ˆæ¯æ¨é€(å¿ƒè·³)/","excerpt":"","text":"0x00 å¿ƒè·³æœ¬æ¥ä»¥ä¸ºå†™å®Œäº†ï¼Œç»“æœæœ€è¿‘å’Œä¸€ä¸ªåŒäº‹åœ¨è®¨è®ºå¿ƒè·³çš„äº‹æƒ…ï¼Œè¿™é‡Œå†åšä¸€ä¸ªè¡¥å……ã€‚å…ˆè¯´æˆ‘çš„ç»“è®ºï¼š WebSocketåè®®å·²ç»è®¾è®¡äº†å¿ƒè·³ï¼Œè¿™ä¸ªåŠŸèƒ½å¯ä»¥åˆ°è¾¾æ£€æµ‹é“¾æ¥æ˜¯å¦å¯ç”¨ å¿ƒè·³æ˜¯ç”¨æ¥æ£€æµ‹é“¾æ¥æ˜¯å¦å¯ç”¨çš„ï¼Œä¸ä¸€å®šæ”¯æŒæºå¸¦æ•°æ®ï¼Œå¯è¦çœ‹å…·ä½“å®ç° å¦‚æœéè¦å¿ƒè·³ä¸­å¸¦ä¸Šå¤æ‚æ•°æ®ï¼Œé‚£è¿™ä¸ªå¯ä½œä¸ºåº”ç”¨å±‚çš„ä¸€ä¸ªåŠŸèƒ½è‡ªå·±å»å®ç°ã€‚ 0x01 WebSocketåè®®çš„æ§åˆ¶å¸§ä¸Šä¸€ç¯‡çš„æœ€åç®€å•æåˆ°äº†å¿ƒè·³ï¼Œä¸‹é¢æ˜¯å¯¹websocketåè®®æ§åˆ¶å¸§çš„æè¿°ï¼š 5.5. Control Frames Control frames are identified by opcodes where the most significant bit of the opcode is 1. Currently defined opcodes for control frames include 0x8 (Close), 0x9 (Ping), and 0xA (Pong). Opcodes 0xB-0xF are reserved for further control frames yet to be defined. Control frames are used to communicate state about the WebSocket. Control frames can be interjected in the middle of a fragmented message. All control frames MUST have a payload length of 125 bytes or less and MUST NOT be fragmented. Pingçš„åè®®å¤´æ˜¯0x9ï¼ŒPongçš„åè®®å¤´æ˜¯0xA æ§åˆ¶å¸§æœ€å¤§è½½è·ä¸º125bytesä¸”ä¸èƒ½æ‹†åˆ† 0x02 WebSocketåè®®çš„å¿ƒè·³ä¸‹é¢å†æ¥çœ‹çœ‹å¯¹å¿ƒè·³çš„è§„å®šï¼š 5.5.2. Ping The Ping frame contains an opcode of 0x9. A Ping frame MAY include &quot;Application data&quot;. // æ³¨ï¼šPingå¸§ä¸­å¯èƒ½ä¼šæºå¸¦æ•°æ® Upon receipt of a Ping frame, an endpoint MUST send a Pong frame in response, unless it already received a Close frame. It SHOULD respond with Pong frame as soon as is practical. Pong frames are discussed in Section 5.5.3. // æ³¨ï¼šåœ¨æ”¶åˆ°Pingå¸§åï¼Œç«¯ç‚¹å¿…é¡»å‘é€Pongå¸§å“åº”ï¼Œé™¤éå·²ç»æ”¶åˆ°äº†Closeå¸§ã€‚åœ¨å®é™…ä¸­åº”å°½å¯èƒ½å¿«çš„å“åº”ã€‚ An endpoint MAY send a Ping frame any time after the connection is established and before the connection is closed. NOTE: A Ping frame may serve either as a keepalive or as a means to verify that the remote endpoint is still responsive. 5.5.3. Pong The Pong frame contains an opcode of 0xA. Section 5.5.2 details requirements that apply to both Ping and Pong frames. A Pong frame sent in response to a Ping frame must have identical &quot;Application data&quot; as found in the message body of the Ping frame being replied to. // æ³¨ï¼šåœ¨å“åº”Pingå¸§çš„çš„Pongå¸§ä¸­ï¼Œå¿…é¡»æºå’Œè¢«å“åº”çš„Pingå¸§ä¸­ç›¸åŒçš„æ•°æ®ã€‚ If an endpoint receives a Ping frame and has not yet sent Pong frame(s) in response to previous Ping frame(s), the endpoint MAY elect to send a Pong frame for only the most recently processed Ping frame. ä»ä¸Šé¢çš„æè¿°æˆ‘ä»¬å¯ä»¥å¾—åˆ°å¦‚ä¸‹ç»“è®ºï¼š å¿ƒè·³åŒ…ä¸­å¯èƒ½ä¼šæºå¸¦æ•°æ® å½“æ”¶åˆ°Pingå¸§çš„æ—¶å€™éœ€è¦ç«‹å³è¿”å›ä¸€ä¸ªPongå¸§ åœ¨è¿æ¥å»ºç«‹ä¹‹åï¼Œéšæ—¶éƒ½å¯ä»¥å‘é€Pingå¸§ å¿ƒè·³æ˜¯ç”¨æ¥æµ‹è¯•é“¾æ¥æ˜¯å¦å­˜åœ¨å’Œå¯¹æ–¹æ˜¯å¦åœ¨çº¿ åœ¨å“åº”Pingå¸§çš„çš„Pongå¸§ä¸­ï¼Œå¿…é¡»æºå’Œè¢«å“åº”çš„Pingå¸§ä¸­ç›¸åŒçš„æ•°æ® 0x03 æµ‹è¯•å’Œä¹‹å‰ä¸€æ ·ï¼Œè‡ªå·±æœ¬åœ°æ­å»ºçš„æœåŠ¡å™¨ï¼Œç”¨çš„åº“æ˜¯ org.java_websocketã€‚åœ¨å…¶æºç ä¸­æˆ‘ä»¬å¯ä»¥æ‰¾åˆ°è¿™æ ·ä¸€æ®µï¼š 12345678910111213141516package org.java_websocket;public abstract class WebSocketAdapter implements WebSocketListener &#123; ... public void onWebsocketPing(WebSocket conn, Framedata f) &#123; FramedataImpl1 resp = new FramedataImpl1(f); resp.setOptcode(Opcode.PONG); conn.sendFrame(resp); &#125; public void onWebsocketPong(WebSocket conn, Framedata f) &#123; &#125; ...&#125; å®¢æˆ·ç«¯ä¹Ÿå¯ä»¥ä½¿ç”¨è¿™ä¸ªåº“ï¼Œç›¸åŒçš„é€»è¾‘ï¼Œä»£ç ä¹Ÿæ˜¯è¿™ä¸€ä»½ã€‚ ç„¶åæˆ‘ä»¬å†æ¢ä¸€ä¸ªåº“ï¼Œcom.squareup.okhttp3:okhttp-ws:3.4.2ï¼Œä»–çš„å®ç°å¦‚ä¸‹ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142package okhttp3.internal.ws;public abstract class RealWebSocket implements WebSocket &#123; ... public RealWebSocket(boolean isClient, BufferedSource source, BufferedSink sink, Random random, final Executor replyExecutor, final WebSocketListener listener, final String url) &#123; this.listener = listener; writer = new WebSocketWriter(isClient, sink, random); reader = new WebSocketReader(isClient, source, new FrameCallback() &#123; @Override public void onMessage(ResponseBody message) throws IOException &#123; listener.onMessage(message); &#125; @Override public void onPing(final Buffer buffer) &#123; replyExecutor.execute(new NamedRunnable(\"OkHttp %s WebSocket Pong Reply\", url) &#123; @Override protected void execute() &#123; try &#123; writer.writePong(buffer); &#125; catch (IOException ignored) &#123; &#125; &#125; &#125;); &#125; @Override public void onPong(Buffer buffer) &#123; listener.onPong(buffer); &#125; @Override public void onClose(final int code, final String reason) &#123; readerSentClose = true; replyExecutor.execute(new NamedRunnable(\"OkHttp %s WebSocket Close Reply\", url) &#123; @Override protected void execute() &#123; peerClose(code, reason); &#125; &#125;); &#125; &#125;); &#125;...&#125; åœ¨å¤„ç†Pingå¸§çš„æ—¶å€™ï¼Œä¹Ÿæ˜¯å°†åè®®å­—æ®µæ”¹ä¸ºPongç„¶åè¿”å›ã€‚ å¯¹å¿ƒè·³çš„æµ‹è¯•ä»£ç å·²ç»ä¸Šä¼ åˆ°Githubï¼šttdevsWebSocketActivity.javaWebSocketOKActivity.javaSocketServer.java åœ¨å®é™…çš„æµ‹è¯•ä¸­ï¼Œå¯èƒ½ä¼šé‡åˆ°ä¸€äº›å¼‚å¸¸ï¼Œæ¯”å¦‚åœ¨æˆ‘ä»¬è‡ªå·±çš„ç”Ÿäº§ç¯å¢ƒï¼šå½“å®¢æˆ·ç«¯å‘é€å¸¦äº†ç®€å•æ•°æ®çš„Pingå¸§åï¼ŒæœåŠ¡å™¨ç«‹é©¬è¿”å›Pongå¸§ï¼Œä½†æ˜¯å®ƒä¼šå°†æºå¸¦çš„æ•°æ®ä¸¢å¼ƒã€‚è¿™ä¸ªå°±æ˜¯æœåŠ¡ç«¯çš„é—®é¢˜äº†ã€‚ 0xFF å‚è€ƒ RFC6455: https://datatracker.ietf.org/doc/rfc6455/","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"https://ttdevs.github.io/categories/æŠ€æœ¯/"}],"tags":[{"name":"WebSocket","slug":"WebSocket","permalink":"https://ttdevs.github.io/tags/WebSocket/"}]},{"title":"ã€ŒmacOSã€ç”¨Homebrewå®‰è£…Mysql","slug":"[macOS]ç”¨Homebrewå®‰è£…Mysql","date":"1969-12-31T16:00:00.000Z","updated":"2017-04-27T11:07:57.000Z","comments":true,"path":"1970/01/01/[macOS]ç”¨Homebrewå®‰è£…Mysql/","link":"","permalink":"https://ttdevs.github.io/1970/01/01/[macOS]ç”¨Homebrewå®‰è£…Mysql/","excerpt":"","text":"0x00 éœ€æ±‚ç®€å•è®°å½•macä¸‹mysqlå®‰è£…ã€‚è¿™é‡Œéœ€è¦ä¸€ä¸ªå‰æâ€”â€”å…ˆå®‰è£… homebrewï¼Œå…·ä½“å¯ä»¥å‚è€ƒè¿™é‡Œã€‚ 0x01 å®‰è£…123456789101112âœ ~ brew install mysqlï¼ƒ ä»¥ä¸‹ä¸ºåˆ é™¤ä¸Šä¸ªç‰ˆæœ¬çš„é—ç•™âœ ~ cd /usr/local/var/mysqlâœ mysql git:(master) lsauto.cnf ib_buffer_pool mysql server-cert.pemca-key.pem ib_logfile0 mysqld_safe.pid server-key.pemca.pem ib_logfile1 performance_schema sysclient-cert.pem ibdata1 private_key.pem ttdevs.local.errclient-key.pem ibtmp1 public_key.pem ttdevs.local.pidâœ mysql git:(master) rm -rf ttdevs.local.errâœ mysql git:(master) cd ~ï¼ƒ ä»¥ä¸Šä¸ºåˆ é™¤ä¸Šä¸ªç‰ˆæœ¬çš„é—ç•™ å¸è½½ï¼š brew uninstall mysql 0x02 é…ç½®12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758âœ ~ /usr/local/opt/mysql/bin/mysql_secure_installationSecuring the MySQL server deployment.Connecting to MySQL using a blank password.VALIDATE PASSWORD PLUGIN can be used to test passwordsand improve security. It checks the strength of passwordand allows the users to set only those passwords which aresecure enough. Would you like to setup VALIDATE PASSWORD plugin?Press y|Y for Yes, any other key for No:Please set the password for root here.New password:Re-enter new password:By default, a MySQL installation has an anonymous user,allowing anyone to log into MySQL without having to havea user account created for them. This is intended only fortesting, and to make the installation go a bit smoother.You should remove them before moving into a productionenvironment.Remove anonymous users? (Press y|Y for Yes, any other key for No) : ySuccess.Normally, root should only be allowed to connect from&apos;localhost&apos;. This ensures that someone cannot guess atthe root password from the network.Disallow root login remotely? (Press y|Y for Yes, any other key for No) : ySuccess.By default, MySQL comes with a database named &apos;test&apos; thatanyone can access. This is also intended only for testing,and should be removed before moving into a productionenvironment.Remove test database and access to it? (Press y|Y for Yes, any other key for No) : y - Dropping test database...Success. - Removing privileges on test database...Success.Reloading the privilege tables will ensure that all changesmade so far will take effect immediately.Reload privilege tables now? (Press y|Y for Yes, any other key for No) : ySuccess.All done!âœ ~ mysql.server startStarting MySQL SUCCESS! 0x03 å¯åŠ¨åœæ­¢ brew services start/stop mysql mysql.server start/stop ä¸¤ç§æ–¹å¼éƒ½å¯ä»¥ï¼Œä½†æ˜¯ä¸å¯ä»¥äº¤å‰ä½¿ç”¨ï¼Œæ¯”å¦‚ç”¨ brew services start mysql å¯åŠ¨ å´ä¸èƒ½ç”¨ mysql.server stop åœæ­¢ã€‚ 0x04 GUIå®¢æˆ·ç«¯ Sequel Pro å…è´¹ Navicat For Mysql æ”¶è´¹ 0x05 ç®€å•å‘½ä»¤çºªå½• ç™»å½•ï¼šmysql -u username -p æ¨å‡ºï¼šexit; é»˜è®¤ data ç›®å½•ï¼š/usr/local/var/mysql Emojiè¡¨æƒ…çš„æ”¯æŒè¯·ä½¿ç”¨ç¼–ç ï¼šutf8mb4 TODO 2016-09-07 0xFF å‚è€ƒ https://segmentfault.com/q/1010000000475470 http://pein0119.github.io/2015/03/25/MySQL%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%90%AF%E5%8A%A8%E9%94%99%E8%AF%AF-The-server-quit-without-updating-PID-file/","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"https://ttdevs.github.io/categories/æŠ€æœ¯/"}],"tags":[{"name":"macOS","slug":"macOS","permalink":"https://ttdevs.github.io/tags/macOS/"}]},{"title":"ã€ŒmacOSã€macOSå®‰è£…","slug":"[macOS]macOSå®‰è£…","date":"1969-12-31T16:00:00.000Z","updated":"2017-04-27T11:07:57.000Z","comments":true,"path":"1970/01/01/[macOS]macOSå®‰è£…/","link":"","permalink":"https://ttdevs.github.io/1970/01/01/[macOS]macOSå®‰è£…/","excerpt":"","text":"0x00 è¦ä¸è¦é‡è£…ï¼Ÿå¯¹äºé‡è£…ç³»ç»Ÿï¼Œæˆ‘æ˜¯æ‹’ç»çš„ã€‚ æƒ³èµ·åˆšä¹°Macé‚£ä¼šï¼Œæ€»æ˜¯ç”¨Windowçš„æ€ç»´æ¥ç†è§£Macï¼Œè´¹äº†è€å¤§çš„åŠ²æ¥å¯¹ç£ç›˜è¿›è¡Œåˆ†åŒºï¼Œæœ€ååˆ†äº†ä¸¤ä¸ªåŒºï¼šç”¨æˆ·ç›®å½•æ”¾åœ¨ä¸€ä¸ªåŒºï¼Œå…¶ä»–æ–‡ä»¶æ”¾åœ¨å¦ä¸€åŒºã€‚æ„Ÿè§‰è‡ªå·±å¥½å±Œï¼Œä½†æ˜¯æ²¡è¿‡å¤šä¹…å‘ç°ä¸‹é¢ä¸¤ä¸ªé—®é¢˜ï¼š é‡è£…ç³»ç»Ÿï¼Œä¹‹å‰ç”¨æˆ·ç›®å½•çš„æ–‡ä»¶è¯»å–æƒé™å¯èƒ½ä¼šæœ‰é—®é¢˜ åˆ«é—®æˆ‘ä¸ºä»€ä¹ˆï¼ŒçŸ¥é“é‡è£…å¯ä»¥è§£å†³å¤§éƒ¨åˆ†é—®é¢˜å°±å¥½äº† éšç€æ—¶é—´çš„æµé€ï¼Œå¼€å§‹é¢„ç•™ç»™ ç³»ç»Ÿæ–‡ä»¶å’ŒAppæ‰€åœ¨åˆ†åŒº è¶Šæ¥è¶Šä¸å¤Ÿç”¨ æœ€åæ€»ç»“ï¼šMac å¾ˆå°‘åï¼Œæ‰€ä»¥ï¼Œåˆ†åŒºå¹¶æ²¡ä»€ä¹ˆåµç”¨ï¼Œåªä¼šç»™æ‚¨çš„ä½¿ç”¨å¸¦æ¥éº»çƒ¦ã€‚ å¥½äº†ï¼Œè¨€å½’æ­£ä¼ ï¼Œè‡ªä»å‡çº§äº†macOS å°±å‡ºç°å„ç§å°é—®é¢˜ï¼Œpythonç”¨ä¸äº†äº†ï¼Œadbç»å¸¸æ–­ï¼Œç³»ç»Ÿå˜å¡äº†ï¼Œæ¯ä¸ªå°é—®é¢˜éƒ½è¦å»æ•´ä¸€ä¸‹ã€‚æƒ³æƒ³è¿˜æ˜¯ç®—äº†ï¼ŒèŠ±ç‚¹æ—¶é—´ï¼Œåœ¨å¦ä¸€å° Mac Mini ä¸Šé‡æ–°å®‰è£…ï¼Œç„¶åç”¨ Time Machine è¿˜åŸåˆ° Mac Bookä¸Šã€‚ 0x01 ç³»ç»Ÿå®‰è£…ç”µè„‘ä¸Šæœ‰ä¸€ä»½æœ€æ–°çš„macOSå®‰è£…æ–‡ä»¶ï¼Œæ‰“ç®—å»åšå®‰è£…Uç›˜ã€‚ä¸‹ç­å›å»å‡†å¤‡æ“ä½œçš„æ—¶å€™ï¼Œå‘ç°åšUç›˜å®‰è£…ç›˜çš„é€Ÿåº¦å¥½æ…¢æ…¢å¥½æ…¢å•Šã€‚æƒ³ï¼Œè¿˜æ˜¯ç®—äº†å§ï¼Œç¡è§‰ä¹‹å‰ä½¿ç”¨ç½‘ç»œå®‰è£…ï¼Œç¬¬äºŒå¤©é†’æ¥åº”è¯¥å¯ä»¥è£…å¥½ã€‚ è¿™é‡Œé™„ä¸€ä¸ª macOS å®‰è£…æ–‡ä»¶ä¸‹è½½åœ°å€ï¼šInstall macOS Sierra.appã€‚ ç½‘ç»œå®‰è£…å¼€æœºæŒ‰ä½ Option(Alt) é”®ï¼Œè¿›å…¥å¯åŠ¨å¼•å¯¼ï¼Œé€‰æ‹©é‚£ä¸ªè™šæ‹Ÿç›˜ï¼ˆå¯èƒ½éœ€è¦è¾“å…¥WIFIå¯†ç ï¼Œæˆ‘ç”¨çš„ç½‘çº¿ï¼‰ï¼Œå…ˆå°†ä¸»ç¡¬ç›˜æ ¼å¼åŒ–ï¼ˆè¿™å°†ä¸¢å¤±æ‰€æœ‰æ•°æ®ï¼Œè¯·æå‰åšå¥½å¤‡ä»½ï¼‰ï¼Œç„¶åé€‰æ‹©ç¬¬äºŒé¡¹å®‰è£…ç³»ç»Ÿï¼ŒæŒ‰ç…§æç¤ºç‚¹å‡»å„ç§ ç»§ç»­ã€åŒæ„ ä¹‹ç±»ï¼Œå°±å¯ä»¥å»ç¡è§‰äº†ã€‚ ç¬¬äºŒå¤©èµ·åºŠï¼Œå‘ç°å·²ç»å®‰è£…å¥½äº†ã€‚æŒ‰ç…§æç¤ºï¼Œè¿›è¡Œåˆå§‹åŒ–æ“ä½œï¼Œæ¯”å¦‚ç™»å½•icloudè´¦å·ï¼Œè®¾ç½®ç”¨æˆ·åç­‰ç­‰ã€‚ç„¶åæ–°çš„ç³»ç»Ÿå°±å¯ä»¥ç”¨äº†ã€‚ æ—¥å¸¸ä½¿ç”¨å·¥å…·å®‰è£…è¿™é‡ŒåªæŒ‰ç…§ä¸ªäººéœ€è¦ï¼Œæµæ°´è´¦ä¸€æ ·çš„è®°å½•ä¸‹ã€‚ iTerm2 è¿™ä¸ªæ˜¯ç”¨æ¥æ›¿ä»£Terminalï¼Œå¯ä»¥åšå¾ˆå¤šä¸ªæ€§åŒ–çš„è®¾ç½®ï¼Œç”¨èµ·æ¥æ›´é¡ºæ‰‹ã€‚ITå¿…å¤‡å§ã€‚ ä¸‹è½½åœ°å€ï¼šhttp://www.iterm2.com/index.html oh-my-zsh é»˜è®¤æƒ…å†µiTerm2å’ŒTerminalä¸€æ ·ï¼Œç•Œé¢éƒ½æ˜¯æ¯”è¾ƒä¸‘çš„ã€‚è¿™ä¸ªå¯ä»¥æ›´æ”¹iTerm2çš„ä¸»é¢˜ã€‚åŒæ—¶è¿˜é›†æˆäº†å„ç§å‘½ä»¤çš„ç®€å†™ã€‚ ä¸‹è½½åœ°å€ï¼šhttp://ohmyz.sh go2shell æœ‰æœ‹å‹æ¨èä¸€äº›å·¥å…·æ¥æ›¿ä»£Finderï¼Œè£…ä¸ªè¿™ä¸ªå°å·¥å…·ä¹‹åï¼ŒåŸºæœ¬ä¸Šå°±æ‡’å¾—å†å»å­¦ä¸€ä¸ª ç±»Finder äº†ã€‚å®ƒçš„åŠŸèƒ½è¶…çº§ç®€å•ï¼Œç‚¹å‡»ä¸€ä¸ªæŒ‰é’®ï¼Œåœ¨å½“å‰ä½ç½®æ‰“å¼€ä¸€ä¸ªTerminalçª—å£ã€‚ ä¸‹è½½åœ°å€ï¼šhttp://zipzapmac.com/Go2Shell ï¼ˆä¸å»ºè®®ä»App Storeä¸‹è½½ï¼‰ homebrew è¿™ä¸ªç”¨æ¥ç®¡ç†è½¯ä»¶çš„ï¼Œç±»ä¼¼wgetç­‰ã€‚ä¹‹å‰å®‰è£…è½¯ä»¶ï¼Œéƒ½æ˜¯åˆ°å„å®¶å®˜ç½‘å»æ‰¾å®‰è£…åŒ…ï¼Œè‡ªä»æœ‰äº†è¿™ä¸ªï¼Œå¾ˆå¤šè½¯ä»¶å†ä¹Ÿä¸ç”¨åˆ°å¤„å»æ‰¾äº†ã€‚ ä¸‹è½½åœ°å€ï¼šhttp://brew.sh alfred å¦‚æœä½ ä½¿ç”¨ Spotlight ï¼Œalfredå¯èƒ½æ˜¯ä¸€ä¸ªæ›´å¥½çš„é€‰æ‹©ã€‚ ä¸‹è½½åœ°å€ï¼šå¯ä»¥ç›´æ¥åœ¨App Storeä¸‹è½½ã€‚ Firefoxï¼ˆè¿™é‡Œä»…ä»…è®°å½•å‡ ä¸ªå¸¸ç”¨çš„æ’ä»¶ï¼‰ Adblock Plus å¹¿å‘Šå·²æˆå¾€äº‹ BingDcit æ²¡æ‰¾åˆ°æ›´å¥½çš„ç¿»è¯‘æ›¿ä»£å·¥å…· JSONView ç½‘é¡µæŸ¥çœ‹jsonæ•°æ®æ›´å‹å¥½ Octotree è®¿é—®Githubæ—¶ï¼Œä¼šåœ¨å·¦ä¾§åˆ—å‡ºæ–‡ä»¶åˆ—è¡¨ï¼Œä¸‹è½½æµè§ˆæ›´æ–¹ä¾¿ User-Agent Switcher è®¿é—®ä¸€ä¸‹æ‰‹æœºç½‘é¡µä¼šæ›´æ–¹ä¾¿ TabTrekker ä¸€ä¸ªé…·ç‚«çš„æ¡Œé¢æ’ä»¶ï¼Œæ¯å¤©ç»™ä½ ä¸åŒçš„å£çº¸ Chromeï¼ˆè¿™é‡Œä»…ä»…è®°å½•å‡ ä¸ªå¸¸ç”¨çš„æ’ä»¶ï¼‰ Adblock Plus JSONView ç½‘é¡µæŸ¥çœ‹jsonæ•°æ®æ›´å‹å¥½ Octotree è®¿é—®Githubæ—¶ï¼Œä¼šåœ¨å·¦ä¾§åˆ—å‡ºæ–‡ä»¶åˆ—è¡¨ï¼Œä¸‹è½½æµè§ˆæ›´æ–¹ä¾¿ OneTab Pocket Translt ä¸€ä¸ªç¿»è¯‘æ’ä»¶ï¼ŒåŒå‡»å³å¯ç¿»è¯‘ï¼Œä½“éªŒå¾ˆæ£’ Unsplash Instant å’ŒTabTrekkerå¾ˆåƒ PSï¼šChromeæ’ä»¶è™½å¥½ï¼Œä½†è¯·æŒ‰éœ€é€‰æ‹©ï¼Œé™¤éä½ çš„å†…å­˜å¤§å¤§çš„ã€‚ python å’Œ python3 macç³»ç»Ÿè‡ªå¸¦äº†python2.7ï¼Œè¿™é‡Œæˆ‘è¿˜æ˜¯é€‰æ‹©äº†ä½¿ç”¨brewå®‰è£…äº†pythonå’Œpython3ã€‚ IntelliJ IDEA (Plugins) GsonFormat Android ButterKnife Zelezny CodeGlance å…¶ä»–å¼€å‘å·¥å…· è¿™ä¸ªå°±çœ‹å„ä½éœ€è¦äº†ï¼Œæˆ‘è£…äº†ä¸€å †ã€‚ æ”¶è´¹App mweb Inboard Day One 1Password Affinity Designer macOS Server Apple Remote Desktop Polarr PCalc å°å† Inbox for Gmail Paste å¯æ„è§†é¢‘ TODO è¿˜æœ‰å¾ˆå¤šæ²¡åˆ—å‡ºæ¥ åˆ«é—®æˆ‘æ˜¯ä¸æ˜¯è£…äº†è¿™é‡Œæ‰€æœ‰è½¯ä»¶ï¼Œå‘Šè¯‰ä½ æˆ‘è£…äº†ï¼Œä½†ä¸è¦å´‡æ‹œå“¥ï¼Œä¸‡èƒ½çš„æ·˜å®å¯ä»¥å®ç°ä½ çš„æ¢¦æƒ³ğŸ™ˆ ç¯å¢ƒé…ç½® ç¯å¢ƒå˜é‡ å®‰è£…å¥½oh-my-shä¹‹åï¼Œå°±å¯ä»¥æ·»åŠ è‡ªå·±çš„ç¯å¢ƒå˜é‡é…ç½®äº†ï¼Œè¿™é‡Œç®€å•è¯´äº›æˆ‘çš„é…ç½®ã€‚é¦–å…ˆæˆ‘é€‰æ‹©åœ¨ä¸€ä¸ªå•ç‹¬çš„æ–‡ä»¶ä¸­~/.bash_profile å†™è‡ªå·±çš„é…ç½®ï¼Œç„¶åå°†æ­¤æ–‡ä»¶æ·»åŠ åˆ° ~/.zshrc çš„æœ€å source ~/.bash_profileã€‚.bash_profileçš„å†…å®¹å¦‚ä¸‹ï¼š 123456789101112131415export JAVA_HOME=/Library/Java/JavaVirtualMachines/jdk1.8.0_101.jdk/Contents/Homeexport GRADLE_HOME=$HOME/android/gradle/gradle-2.14.1export ANDROID_HOME=$HOME/android/android-sdk-macosxexport NDK_HOME=$ANDROID_HOME/ndk-bundleexport PATH=$&#123;PATH&#125;:$&#123;ANDROID_HOME&#125;/platform-tools:$&#123;ANDROID_HOME&#125;/tools:$&#123;NDK_HOME&#125;/:$&#123;GRADLE_HOME&#125;/bin:$&#123;JAVA_HOME&#125;/bin:$&#123;JAVA_HOME&#125;/lib:## Aliases# Create by ttdevs 2016-03-31#alias oi=&apos;open -a iterm .&apos;alias of=&apos;open -a Finder .&apos;alias vv=&apos;virtualenv&apos;alias weather=&apos;curl http://wttr.in/shanghai&apos; 0x02 ç»§ç»­è£…é€¼é‡è£…ç³»ç»Ÿï¼Œæˆ‘ä»æ˜¯æ‹’ç»çš„ã€‚ æ­¤æ–‡ä¸å®šæœŸæ›´æ–°ã€‚ æœ€åï¼ŒApp Storeçš„è½¯ä»¶è¿˜æ˜¯æ¯”è¾ƒè´µçš„ï¼Œå…¥å‘éœ€è°¨æ… å•Š å•Š å•Š","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"https://ttdevs.github.io/categories/æŠ€æœ¯/"}],"tags":[{"name":"macOS","slug":"macOS","permalink":"https://ttdevs.github.io/tags/macOS/"}]},{"title":"ã€ŒWebSocketã€ä½¿ç”¨Websocketå®ç°æ¶ˆæ¯æ¨é€(ä¸Š)","slug":"[WebSocket]ä½¿ç”¨Websocketå®ç°æ¶ˆæ¯æ¨é€(ä¸Š)","date":"1969-12-31T16:00:00.000Z","updated":"2017-04-27T11:07:57.000Z","comments":true,"path":"1970/01/01/[WebSocket]ä½¿ç”¨Websocketå®ç°æ¶ˆæ¯æ¨é€(ä¸Š)/","link":"","permalink":"https://ttdevs.github.io/1970/01/01/[WebSocket]ä½¿ç”¨Websocketå®ç°æ¶ˆæ¯æ¨é€(ä¸Š)/","excerpt":"","text":"0x00 Websocketè”ç³»å®¢æœåŠŸèƒ½åœ¨é¡¹ç›®ä¸­å¾ˆéš¾é¿å…ï¼Œä¸€èˆ¬æœ‰ä¸‹é¢ä¸‰ç§å®ç°æ–¹å¼ï¼š ä½¿ç”¨httpçš„getæ–¹å¼è½®è¯¢ æ¥å…¥ç¬¬ä¸‰æ–¹IMç³»ç»Ÿ è‡ªå·±çš„IMç³»ç»Ÿ åŸºäºsocket åŸºäºwebsocket ç¬¬ä¸€ç§æ–¹å¼ï¼Œæœ€lowçš„ï¼Œå®ç°ç®€å•ï¼Œä½†æ˜¯æµªè´¹ç”¨æˆ·æµé‡ï¼›ç¬¬äºŒç§æ–¹å¼ï¼Œæ¥å…¥ç®€å•ï¼ŒåŠŸèƒ½å¼ºå¤§ï¼Œä½†æ˜¯å¯èƒ½éœ€è¦ä¸€å®šçš„æˆæœ¬ï¼ˆæ¯”å¦‚ä»˜è´¹ï¼‰ï¼›ç¬¬ä¸‰ç§æ–¹å¼ï¼Œéœ€è¦ä¸€å®šçš„å¼€å‘æˆæœ¬ï¼ˆæœåŠ¡å™¨æ‰˜ç®¡è´¹ç”¨å¿½ç•¥ï¼‰ã€‚å¯¹äºç¬¬ä¸‰ç§æƒ…å†µçš„ socketï¼Œå®ç°IMçš„æ–‡å­—åŠ éŸ³è§†é¢‘èŠå¤©ï¼Œåšè¿‡çš„è¯ä½ å¯ä»¥ä¹Ÿä¼šç›´æ¥æ‡µé€¼ã€‚ä½†æ˜¯ï¼Œç®€å•çš„æ–‡å­—èŠå¤©è¿˜å¥½ï¼Œä¸è¿‡ä½ è¿˜æ˜¯éœ€è¦å»å®šä¹‰ä¸€äº›åè®®æ¥å®ç°è¿™æ ·ä¸€ä¸ªåŠŸèƒ½ã€‚å¦‚æœæˆ‘ä»¬ä½¿ç”¨websocketï¼Œé‚£äº‹æƒ…å°±å˜çš„ç®€å•å¾ˆå¤šã€‚ WebSocketä¸€ç§åœ¨å•ä¸ª TCP è¿æ¥ä¸Šè¿›è¡Œå…¨åŒå·¥é€šè®¯çš„åè®®ã€‚WebSocketé€šä¿¡åè®®äº2011å¹´è¢«IETFå®šä¸ºæ ‡å‡†RFC 6455ï¼Œå¹¶è¢«RFC7936æ‰€è¡¥å……è§„èŒƒï¼ŒWebSocketAPIè¢«W3Cå®šä¸ºæ ‡å‡†ã€‚ WebSocket æ˜¯ç‹¬ç«‹çš„ã€åˆ›å»ºåœ¨ TCP ä¸Šçš„åè®®ï¼Œå’Œ HTTP çš„å”¯ä¸€å…³è”æ˜¯ä½¿ç”¨ HTTP åè®®çš„101çŠ¶æ€ç è¿›è¡Œåè®®åˆ‡æ¢ï¼Œä½¿ç”¨çš„ TCP ç«¯å£æ˜¯80ï¼Œå¯ä»¥ç”¨äºç»•è¿‡å¤§å¤šæ•°é˜²ç«å¢™çš„é™åˆ¶ã€‚ WebSocket ä½¿å¾—å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´çš„æ•°æ®äº¤æ¢å˜å¾—æ›´åŠ ç®€å•ï¼Œå…è®¸æœåŠ¡ç«¯ç›´æ¥å‘å®¢æˆ·ç«¯æ¨é€æ•°æ®è€Œä¸éœ€è¦å®¢æˆ·ç«¯è¿›è¡Œè¯·æ±‚ï¼Œåœ¨ WebSocket API ä¸­ï¼Œæµè§ˆå™¨å’ŒæœåŠ¡å™¨åªéœ€è¦å®Œæˆä¸€æ¬¡æ¡æ‰‹ï¼Œä¸¤è€…ä¹‹é—´å°±ç›´æ¥å¯ä»¥åˆ›å»ºæŒä¹…æ€§çš„è¿æ¥ï¼Œå¹¶å…è®¸æ•°æ®è¿›è¡ŒåŒå‘ä¼ é€ã€‚ ç›®å‰å¸¸è§çš„æµè§ˆå™¨å¦‚ Chromeã€IEã€Firefoxã€Safariã€Opera ç­‰éƒ½æ”¯æŒ WebSocketï¼ŒåŒæ—¶éœ€è¦æœåŠ¡ç«¯ç¨‹åºæ”¯æŒ WebSocketã€‚ æ¥è‡ªç»´åŸºç™¾ç§‘ https://zh.wikipedia.org/wiki/WebSocket websocketåªæ˜¯ä¸€ç§åè®®ï¼Œç±»ä¼¼httpï¼Œå› æ­¤ä¸è¯­è¨€æ— å…³ã€‚è¿™é‡Œæˆ‘ä½¿ç”¨javaæ¥åšæœåŠ¡ç«¯ï¼ŒåŒæ—¶æä¾›androidå’Œhtmlçš„å®¢æˆ·ç«¯ï¼Œé€šè¿‡ä¸€ä¸ªç®€å•çš„demoæ¥ä»‹ç»websocketçš„ä½¿ç”¨ï¼Œæ¥ä¸‹æ¥çš„ä¸€ç¯‡ä¼šå¯¹websocketè¿›è¡Œåˆ†æã€‚ 0x01 æœåŠ¡ç«¯è¿™é‡Œæˆ‘ä½¿ç”¨ Java-WebSocket è¿™ä¸ªåº“æ¥å®ç° websocket serverã€‚éœ€è¦çš„jaråŒ…ä½äºé¡¹ç›®çš„ /Java-WebSocket/dist/java-websocket.jar ä½ç½®ã€‚æ•ˆæœå¦‚ä¸‹ï¼š ä»£ç å¦‚ä¸‹ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788public class SocketServer extends WebSocketServer &#123; private static final int PORT = 2333; public static void main(String[] args) &#123; SocketServer server = new SocketServer(PORT); server.start(); try &#123; String ip = InetAddress.getLocalHost().getHostAddress(); int port = server.getPort(); print(String.format(\"æœåŠ¡å·²å¯åŠ¨: %s:%d\", ip, port)); &#125; catch (UnknownHostException e) &#123; e.printStackTrace(); &#125; InputStreamReader in = new InputStreamReader(System.in); BufferedReader reader = new BufferedReader(in); while (true) &#123; try &#123; String msg = reader.readLine(); server.broadcastMessage(msg); &#125; catch (Exception e) &#123; e.printStackTrace(); &#125; &#125; &#125; public SocketServer(int port) &#123; super(new InetSocketAddress(port)); &#125; public SocketServer(InetSocketAddress address) &#123; super(address); &#125; @Override public void onOpen(WebSocket webSocket, ClientHandshake clientHandshake) &#123; String address = webSocket.getRemoteSocketAddress().getAddress().getHostAddress(); String message = String.format(\"(%s) &lt;åŠ å…¥&gt;\", address); broadcastMessage(message); print(message); &#125; @Override public void onClose(WebSocket webSocket, int code, String reason, boolean remote) &#123; String address = webSocket.getRemoteSocketAddress().getAddress().getHostAddress(); String message = String.format(\"(%s) &lt;ç¦»å¼€&gt;\", address); broadcastMessage(message); print(message); &#125; @Override public void onMessage(WebSocket webSocket, String msg) &#123; String address = webSocket.getRemoteSocketAddress().getAddress().getHostAddress(); String message = String.format(\"(%s) %s\", address, msg); broadcastMessage(message); print(message); &#125; @Override public void onError(WebSocket webSocket, Exception e) &#123; if (null != webSocket) &#123; if (!webSocket.isClosed()) &#123; webSocket.close(0); &#125; &#125; e.printStackTrace(); &#125; /** * å¹¿æ’­æ”¶åˆ°æ¶ˆæ¯ * * @param msg */ private void broadcastMessage(String msg) &#123; Collection&lt;WebSocket&gt; connections = connections(); synchronized (connections) &#123; for (WebSocket client : connections) &#123; client.send(msg); &#125; &#125; &#125; private static void print(String msg) &#123; System.out.println(String.format(\"[%d] %s\", System.currentTimeMillis(), msg)); &#125;&#125; 0x02 å®¢æˆ·ç«¯ Android è¿™é‡Œä¹Ÿæ˜¯ç”¨java-websocketè¿™ä¸ªåº“ï¼Œæ•ˆæœå¦‚ä¸‹ï¼š æ ¸å¿ƒä»£ç ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183 public class WebSocketActivity extends BaseActivity &#123; private static final int STATUS_CLOSE = 0; private static final int STATUS_CONNECT = 1; private static final int STATUS_MESSAGE = 2; @Bind(R.id.etIP) EditText etIP; @Bind(R.id.etPort) EditText etPort; @Bind(R.id.tvStatus) TextView tvStatus; @Bind(R.id.tvMsg) TextView tvMsg; @Bind(R.id.rgVersion) RadioGroup rgVersion; @Bind(R.id.etMessage) EditText etMessage; @Bind(R.id.svContent) ScrollView svContent; @Bind(R.id.viewMain) View viewMain; @Bind(R.id.btConnect) Button btConnect; @Bind(R.id.btDisconnect) Button btDisconnect; @Bind(R.id.btSend) Button btSend; @OnClick(&#123;R.id.btConnect, R.id.btDisconnect, R.id.btSend&#125;) public void onClick(View view) &#123; switch (view.getId()) &#123; case R.id.btConnect: connectToServer(); break; case R.id.btDisconnect: if (null != mClient) &#123; mClient.close(); &#125; break; case R.id.btSend: if (null != mClient) &#123; String msg = etMessage.getText().toString(); if (!TextUtils.isEmpty(msg)) &#123; try &#123; mClient.send(msg); &#125; catch (NotYetConnectedException e) &#123; e.printStackTrace(); return; &#125; etMessage.setText(\"\"); &#125; &#125; break; default: break; &#125; &#125; private Client mClient; private Handler mHandle = new Handler() &#123; @Override public void handleMessage(Message msg) &#123; String message = String.format(\"[%d] %s\\n\", System.currentTimeMillis(), msg.obj.toString()); tvMsg.append(message); switch (msg.what) &#123; case STATUS_CONNECT: btConnect.setEnabled(false); btDisconnect.setEnabled(true); btSend.setEnabled(true); break; case STATUS_CLOSE: btConnect.setEnabled(true); btDisconnect.setEnabled(false); btSend.setEnabled(false); break; case STATUS_MESSAGE: // TODO: 16/8/24 break; default: break; &#125; svContent.postDelayed(new Runnable() &#123; @Override public void run() &#123; svContent.fullScroll(View.FOCUS_DOWN); &#125; &#125;, 100); &#125; &#125;; @Override protected void onCreate(Bundle savedInstanceState) &#123; super.onCreate(savedInstanceState); setContentView(R.layout.activity_web_socket); ButterKnife.bind(this); System.setProperty(\"java.net.preferIPv6Addresses\", \"false\"); System.setProperty(\"java.net.preferIPv4Stack\", \"true\"); &#125; private void connectToServer() &#123; String ip = etIP.getText().toString(); String port = etPort.getText().toString(); if (TextUtils.isEmpty(ip) || TextUtils.isEmpty(port)) &#123; Snackbar.make(viewMain, \"IP and Port ä¸èƒ½ä¸ºç©º\", Snackbar.LENGTH_LONG).show(); return; &#125; String address = String.format(\"ws://%s:%s\", ip, port); Draft draft = null; switch (rgVersion.getCheckedRadioButtonId()) &#123; case R.id.rbDraft10: draft = new Draft_10(); break; case R.id.rbDraft17: draft = new Draft_17(); break; case R.id.rbDraft75: draft = new Draft_75(); break; case R.id.rbDraft76: draft = new Draft_76(); break; default: draft = new Draft_17(); break; &#125; try &#123; URI uri = new URI(address); mClient = new Client(uri, draft); mClient.connect(); &#125; catch (URISyntaxException e) &#123; e.printStackTrace(); return; &#125; tvStatus.setText(address); &#125; private class Client extends WebSocketClient &#123; public Client(URI serverURI) &#123; super(serverURI); &#125; public Client(URI serverUri, Draft draft) &#123; super(serverUri, draft); &#125; @Override public void onOpen(ServerHandshake handShakeData) &#123; Message msg = new Message(); msg.what = STATUS_CONNECT; msg.obj = String.format(\"[Welcomeï¼š%s]\", getURI()); mHandle.sendMessage(msg); &#125; @Override public void onMessage(String message) &#123; Message msg = new Message(); msg.what = STATUS_MESSAGE; msg.obj = message; mHandle.sendMessage(msg); &#125; @Override public void onClose(int code, String reason, boolean remote) &#123; Message msg = new Message(); msg.what = STATUS_CLOSE; msg.obj = String.format(\"[Byeï¼š%s]\", getURI()); mHandle.sendMessage(msg); &#125; @Override public void onError(Exception ex) &#123; ex.printStackTrace(); &#125; &#125;&#125; Html H5ä½¿ç”¨äº†è¿™ä¸ªåº“ï¼šsstephenson/prototypeï¼Œæ•ˆæœå¦‚ä¸‹ï¼š æ ¸å¿ƒä»£ç å¦‚ä¸‹ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455&lt;script type=\"text/javascript\"&gt; document.observe(\"dom:loaded\", function () &#123; function log(text) &#123; var value = (new Date).getTime(); value += \": \"; value += text.escapeHTML(); value += $(\"log\").innerHTML; $(\"log\").innerHTML = value; &#125; if (!window.WebSocket) &#123; alert(\"æµè§ˆå™¨ä¸æ”¯æŒ,æ¢ä¸€ä¸ªå§\"); &#125; var ws; $(\"connectForm\").observe(\"submit\", function (e) &#123; e.stop(); ws = new WebSocket($F(\"uri\")); ws.onopen = function () &#123; log(\"è¿æ¥åˆ°æœåŠ¡å™¨\\n\"); &#125; ws.onmessage = function (e) &#123; log(\"æœåŠ¡å™¨ä¿¡æ¯: \" + e.data + \"\\n\"); &#125; ws.onclose = function () &#123; log(\"æ–­å¼€æœåŠ¡å™¨è¿æ¥\\n\"); $(\"uri\", \"connect\").invoke(\"enable\"); $(\"close\").disable(); ws = null; &#125; $(\"uri\", \"connect\").invoke(\"disable\"); $(\"close\").enable(); &#125;); $(\"close\").observe(\"click\", function (e) &#123; e.stop(); if (ws) &#123; ws.close(); ws = null; &#125; &#125;); $(\"sendForm\").observe(\"submit\", function (e) &#123; e.stop(); if (ws) &#123; var message = $(\"message\"); ws.send(message.value); message.value = \"\"; message.focus(); &#125; &#125;); &#125;);&lt;/script&gt; æ‰€æœ‰çš„ä»£ç éƒ½å¯ä»¥åˆ°githubæŸ¥çœ‹ï¼šttdevsã€‚ ä¸‹ä¸€ç¯‡å°†é€šè¿‡å¯¹websocketåè®®çš„åˆ†æï¼Œæ¥å¯¹å…¶åšè¿›ä¸€æ­¥çš„äº†è§£ã€‚ 0xFF å‚è€ƒ https://github.com/sstephenson/prototype https://github.com/TooTallNate/Java-WebSocket/ http://www.cnblogs.com/wlfcolin/p/5193583.html","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"https://ttdevs.github.io/categories/æŠ€æœ¯/"}],"tags":[{"name":"WebSocket","slug":"WebSocket","permalink":"https://ttdevs.github.io/tags/WebSocket/"}]},{"title":"ã€ŒmacOSã€macOSå®‰è£…Python","slug":"[macOS]macOSå®‰è£…Python","date":"1969-12-31T16:00:00.000Z","updated":"2017-04-27T11:07:57.000Z","comments":true,"path":"1970/01/01/[macOS]macOSå®‰è£…Python/","link":"","permalink":"https://ttdevs.github.io/1970/01/01/[macOS]macOSå®‰è£…Python/","excerpt":"","text":"0x00 ä¸ºä»€ä¹ˆè¦è£…(Bi)è£…é€¼é­é›·åŠˆã€‚ ä¸Šä¸€ç¯‡ä»‹ç»äº†é‡è£…macOSçš„æ–¹æ³•ã€‚ä¸ºä»€ä¹ˆä¼šæœ‰ä¸Šä¸€ç¯‡ï¼Ÿè¯´åˆ°åº•å°±ä¸€ä¸ªå­—ï¼šè·‘ python web åº”ç”¨å‡ºé—®é¢˜äº†ã€‚æŠŠmacOSä»æ—§ç‰ˆæœ¬å‡çº§åˆ°æ–°ç‰ˆæœ¬ 10.12ï¼Œä¹‹å‰è·‘çš„å¥½å¥½çš„webåº”ç”¨ç°åœ¨å„ç§é—®é¢˜ï¼Œæ‰€ä»¥ï¼Œé‡è£…å§ã€‚ç„¶å¹¶åµï¼Œé‡è£…åé—®é¢˜ä¾æ—§ ğŸ˜¢ï¼Œæ¯”å¦‚ï¼š ImportError: No module named &#39;_sqlite3&#39;ImportError: No module named &#39;pysqlite2&#39; ç­‰ç­‰ä¸€å †é—®é¢˜ã€‚å¥½å§ï¼ŒåºŸè¯è¯´å¤šäº†ï¼Œè¿™é‡Œä»‹ç»ä¸‹è¯¥æ€ä¹ˆåŠã€‚ 0x01 å®‰è£…æƒ…å†µæ˜¯è¿™æ ·çš„ï¼Œå…¨æ–°å®‰è£…macOSï¼ŒåŒæ—¶å‡çº§ xcode åˆ°æœ€æ–°ç‰ˆ8 (8A218a)ï¼Œä½¿ç”¨ homebrew å®‰è£… python3 ï¼š brew install python3 è£…å¥½ä¹‹åè¿˜æ˜¯å„ç§modelæ‰¾ä¸åˆ°ï¼Œç¼ºå°‘å¾ˆå¤šä¸œè¥¿ï¼Œå°è¯•äº†å„ç§æ–¹æ³•ï¼Œä¾ç„¶æ— æ³•è§£å†³ã€‚ åœ¨åå¤é‡è£… python3 çš„æ—¶å€™ï¼Œçœ‹åˆ°è¿™æ ·ä¸€ä¸ªæç¤ºï¼šxcode-select --installã€‚è™½ç„¶ä¸çŸ¥é“è¿™ä¸ªé¬¼ä¸œè¥¿æ˜¯å¹²å˜›ï¼Œä½†æ˜¯ç¡®å®šä¸€ç‚¹ï¼Œä¹‹å‰æˆ‘æœ‰å®‰è£…è¿‡ã€‚æ‰€ä»¥ï¼Œå°±åœ¨å‘½ä»¤è¡Œæ‰§è¡Œäº†ä¸€ä¸‹ï¼Œç„¶åå†é‡æ–°å®‰è£… python3ï¼Œä»– å°±ï¼Œå°±ï¼Œå°± å¯ä»¥äº†â€¦â€¦ 0x02 Command Line Toolsxcode-select --install è¿™æ¡å‘½ä»¤æ˜¯çš„ä½œç”¨æ˜¯å®‰è£… Command Line Toolsã€‚æ‰¾äº†åŠå¤©ï¼Œæ²¡çœ‹åˆ°å“ªæœ‰è¯¦ç»†çš„ä»‹ç»ï¼Œåœ¨è¿™é‡Œçœ‹åˆ°ä¸€ä¸ªç®€çŸ­çš„ä»‹ç»ï¼š The Command Line Tools Package is a small self-contained package available for download separately from Xcode and that allows you to do command line development in OS X. It consists of two components: OS X SDK and command-line tools such as Clang, which are installed in /usr/bin. ç®€å•æ¥è¯´ï¼Œåº”è¯¥å°±æ˜¯ä¸€å¥—å·¥å…·é›†åˆã€‚ä»–ä¼šè¢«å®‰è£…åœ¨ä¸‹é¢ä¸¤ä¸ªä½ç½®ï¼š /Library/Developer/CommandLineTools/usr/bin/usr/bin åœ¨è¿™é‡Œä½ ä¼šçœ‹åˆ°ä¸€å †å¸¸è§çš„å‘½ä»¤ã€‚çœ‹åˆ°è¿™äº›ä¹‹åï¼Œæç„¶å¤§æ‚Ÿï¼Œhomebrewå¥½åƒæ˜¯ä¸‹çš„python3çš„æºç ï¼Œç„¶åæœ¬åœ°ç¼–è¯‘å®‰è£…çš„ã€‚å¦‚æœç¼ºå°‘äº†è¿™äº›å‘½ä»¤ï¼Œå¯èƒ½å°±ä¼šå‡ºé”™ã€‚ å¥½äº†ï¼Œç»ˆäºå¯ä»¥æ„‰å¿«çš„ä½¿ç”¨ python äº†ã€‚","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"https://ttdevs.github.io/categories/æŠ€æœ¯/"}],"tags":[{"name":"macOS","slug":"macOS","permalink":"https://ttdevs.github.io/tags/macOS/"}]},{"title":"ã€Œç©è½¬æ ‘è“æ´¾ã€0x00æ¬¢è¿æ¥åˆ°æ ‘è“æ´¾çš„ä¸–ç•Œ","slug":"[ç©è½¬æ ‘è“æ´¾]0x00æ¬¢è¿æ¥åˆ°æ ‘è“æ´¾çš„ä¸–ç•Œ","date":"1969-12-31T16:00:00.000Z","updated":"2017-04-27T11:07:57.000Z","comments":true,"path":"1970/01/01/[ç©è½¬æ ‘è“æ´¾]0x00æ¬¢è¿æ¥åˆ°æ ‘è“æ´¾çš„ä¸–ç•Œ/","link":"","permalink":"https://ttdevs.github.io/1970/01/01/[ç©è½¬æ ‘è“æ´¾]0x00æ¬¢è¿æ¥åˆ°æ ‘è“æ´¾çš„ä¸–ç•Œ/","excerpt":"","text":"0x00 åˆè¡·Welcome to Raspberry Pi world ä¹‹å‰åŠ å…¥çš„ä¸€ä¸ªæ ‘è“æ´¾ç¾¤æœ€è¿‘çªç„¶æ´»è·ƒèµ·æ¥ï¼Œç»è¿‡è§‚å¯Ÿå‘ç°æ˜¯æ–°ç‰ˆçš„æ ‘è“æ´¾å‘å¸ƒäº† â€”â€” Raspberry Pi 3ã€‚å¾ˆé«˜å…´çš„æ˜¯ï¼Œå„ä½å°ä¼™ä¼´çš„æ´»è·ƒæœ‰äº›è¶…å‡ºæˆ‘çš„æ„æ–™ã€‚ è§‚å¯Ÿä¸€æ®µæ—¶é—´ä¹‹åå‘ç°ï¼Œå¾ˆå¤šå°ä¼™ä¼´åœ¨é—®ä¸€äº›å¾ˆåŸºç¡€çš„é—®é¢˜ï¼Œå¼€å§‹å°è¯•å»å¸®ä»–ä»¬è§£ç­”ï¼Œåæ¥å‘ç°æ ¹æœ¬å›ç­”ä¸è¿‡æ¥ï¼Œåˆšå›ç­”å®Œåˆæœ‰å°ä¼™ä¼´æ¥é—®ï¼Œå› æ­¤å†³å®šå°è¯•ç€åšä¸€äº›åŸºç¡€æ€»ç»“ï¼Œç»™å„ä½åˆšå…¥é—¨çš„å°ä¼™ä¼´æä¾›ä¸€äº›å‚è€ƒã€‚ ä¸ºä»€ä¹ˆä¹°æ ‘è“æ´¾å‘¢ï¼Ÿå¾ˆæ—©å°±å¬è¯´è¿‡æ ‘è“æ´¾ï¼ŒArduinoè¿™äº›å°æ¿å­ï¼Œä½†æ˜¯å†³å®šå…¥æ‰‹æ ‘è“æ´¾è¿˜æ˜¯å› ä¸ºçŸ¥ä¹çš„ä¸€ä¸ªå›ç­”ï¼šæ ‘è“æ´¾ (Raspberry Pi) æ˜¯ä»€ä¹ˆï¼Ÿæ™®é€šäººæ€ä¹ˆç©ï¼Ÿ çœ‹å®Œåå¾ˆå…´å¥‹ï¼Œè¿™ä¸ªå°æ¿è¿˜å¯ä»¥è¿™æ ·ç©ï¼Œé‚å…¥æ‰‹ã€‚ç®—èµ·æ¥ä»å…¥æ‰‹åˆ°ç°åœ¨å·²ç»åŠå¹´å·¦å³ã€‚ç®€å•çš„å…¥é—¨æ“ä½œéƒ½æŠ˜è…¾äº†ä¸€éï¼Œè¿˜ä¹°äº†ä¸€å¤§å †ç¡¬ä»¶ï¼Œä½†æ˜¯å¾ˆé—æ†¾ï¼Œä¸å°‘ç¡¬ä»¶æ²¡æœ‰æŠ˜è…¾æˆåŠŸã€‚æœŸé—´å­¦äº†ä¸€äº›pythonåŸºç¡€çŸ¥è¯†ï¼Œåšäº†ä¸€äº›ç®€å•çš„æœåŠ¡åœ¨ä¸Šé¢è·‘ï¼Œç„¶åå°±è®©ä»–é™é™çš„èººåœ¨äº†è§’è½é‡Œï¼Œæ²¡æœ‰å†æŠ˜è…¾ã€‚ä½†æœ‰ä¸€ä»¶äº‹è®©æˆ‘éå¸¸çš„å…´å¥‹ï¼Œè¿™ä¸ªå°æ¿å­æœ€é•¿ä¸€æ¬¡50å¤šå¤©æ²¡å…³æœºï¼ï¼ï¼è¿™å¤§å¤§çš„å‡ºä¹æˆ‘çš„æ„æ–™ ä¸ºä»€ä¹ˆä¼šè¯´éå¸¸å…´å¥‹å‘¢ï¼Ÿè·‘äº†50å¤šå¤©åæ˜¯æˆ‘ä¸»åŠ¨å…³æœºçš„ã€‚ä¸€ä¸ªæ™®é€šçš„ç”¨æˆ·ï¼Œæ— è®ºä½ æ˜¯Windowsï¼ŒLinuxè¿˜æ˜¯Macï¼Œä½œä¸ºæ—¥å¸¸ä½¿ç”¨çš„è®¾å¤‡ï¼Œè¿˜æ˜¯ä¼šç»å¸¸é‡å¯çš„ï¼Œç‰¹åˆ«æ˜¯Windowsç³»ç»Ÿã€‚ä¸€å—æ”¾åœ¨åºŠå¤´çš„å°æ¿å­ï¼Œå¯ä»¥ç¨³å®šçš„è·‘ä¸Šå‡ å¤©ï¼Œå‡ å‘¨ï¼Œå‡ ä¸ªæœˆï¼Œæœ‰è¿™ä¹ˆç¨³å®šçš„ä¸€ä¸ªç³»ç»Ÿï¼Œè¿˜æœ‰é‚£äº›GPIOï¼Œæ˜¯ä¸æ˜¯ç»™æˆ‘ä»¬æ›´å¤šçš„æŠ˜è…¾æä¾›äº†éå¸¸å¥½çš„åŸºç¡€! å†³å®šå†™è¿™äº›å…¥é—¨æ–‡ç« ï¼Œæˆ‘ä¼šæœ¬ç€ç›´æ¥å‘Šè¯‰ä½ ä¸€ä¸ªç»“æœçš„åŸåˆ™ï¼Œå¾ªåºæ¸è¿›çš„æŠŠä½ æ­£é¢å¯¹æˆ–è€…å°†ä¼šé‡åˆ°çš„é—®é¢˜å±•ç°å‡ºæ¥ã€‚å¦‚æœè®²çš„å¤ªç²—ï¼Œå„ä½å¯ä»¥ç›´æ¥æé—®ï¼Œæˆ‘å†è¡¥å……ã€‚æœ€åå¸Œæœ›æˆ‘ä¼šåšæŒæŠŠè¿™äº›ä¸œè¥¿å†™ä¸‹å»ã€‚ 0x01 ä»€ä¹ˆæ˜¯æ ‘è“æ´¾æ ‘è“æ´¾(Raspberry Pi) æ˜¯ä»€ä¹ˆï¼Œæ¥çœ‹çœ‹ç»´åŸºç™¾ç§‘çš„ä»‹ç»ï¼š æ ‘è“æ´¾ï¼ˆè‹±è¯­ï¼šRaspberry Piï¼‰ï¼Œæ˜¯ä¸€æ¬¾åŸºäºLinuxçš„å•æ¿æœºç”µè„‘ã€‚å®ƒç”±è‹±å›½çš„æ ‘è“æ´¾åŸºé‡‘ä¼šæ‰€å¼€å‘ï¼Œç›®çš„æ˜¯ä»¥ä½ä»·ç¡¬ä»¶åŠè‡ªç”±è½¯ä»¶åˆºæ¿€åœ¨å­¦æ ¡çš„åŸºæœ¬è®¡ç®—æœºç§‘å­¦æ•™è‚²ã€‚æ ‘è“æ´¾çš„ç”Ÿäº§æ˜¯é€šè¿‡æœ‰ç”Ÿäº§è®¸å¯çš„ä¸¤å®¶å…¬å¸ï¼šElement 14/Premier Farnellå’ŒRS Componentsã€‚è¿™ä¸¤å®¶å…¬å¸éƒ½åœ¨ç½‘ä¸Šå‡ºå”®æ ‘è“æ´¾ã€‚æ ‘è“æ´¾é…å¤‡ä¸€æšåšé€šï¼ˆBroadcomï¼‰å‡ºäº§çš„ARMæ¶æ„700MHz BCM2835å¤„ç†å™¨ï¼Œ256MBå…§å­˜ï¼ˆBå‹å·²å‡çº§åˆ°512MBå†…å­˜ï¼‰ï¼Œä½¿ç”¨SDå¡å½“ä½œå­˜å‚¨åª’ä½“ï¼Œä¸”æ‹¥æœ‰ä¸€ä¸ªEthernetã€ä¸¤ä¸ªUSBæ¥å£ã€ä»¥åŠHDMIï¼ˆæ”¯æŒå£°éŸ³è¾“å‡ºï¼‰å’ŒRCAç«¯å­è¾“å‡ºæ”¯æŒã€‚æ ‘è“æ´¾åªæœ‰ä¸€å¼ ä¿¡ç”¨å¡å¤§å°ï¼Œä½“ç§¯å¤§æ¦‚æ˜¯ä¸€ä¸ªç«æŸ´ç›’å¤§å°ï¼Œå¯ä»¥è¿è¡Œåƒã€Šé›·ç¥ä¹‹é”¤IIIç«æŠ€åœºã€‹çš„æ¸¸æˆå’Œè¿›è¡Œ1080pè§†é¢‘çš„æ’­æ”¾ã€‚æ“ä½œç³»ç»Ÿé‡‡ç”¨å¼€æºçš„Linuxç³»ç»Ÿå¦‚Debianã€ArchLinuxï¼Œè‡ªå¸¦çš„Iceweaselã€KOfficeç­‰è½¯ä»¶ï¼Œèƒ½å¤Ÿæ»¡è¶³åŸºæœ¬çš„ç½‘ç»œæµè§ˆã€æ–‡å­—å¤„ç†ä»¥åŠç”µè„‘å­¦ä¹ çš„éœ€è¦ã€‚åˆ†Aã€Bä¸¤ç§å‹å·ï¼Œå”®ä»·åˆ†åˆ«æ˜¯Aå‹25ç¾å…ƒã€Bå‹35ç¾å…ƒã€‚æ ‘è“æ´¾åŸºé‡‘ä¼šä»2012å¹´2æœˆ29æ—¥å¼€å§‹æ¥å—Bå‹çš„è®¢è´§ã€‚æ ‘è“æ´¾åŸºé‡‘ä¼šæä¾›äº†åŸºäºARMæ¶æ„çš„Debianã€Arch Linuxå’ŒFedoraç­‰çš„å‘è¡Œç‰ˆä¾›å¤§ä¼—ä¸‹è½½ï¼Œè¿˜è®¡åˆ’æä¾›æ”¯æŒPythonä½œä¸ºä¸»è¦ç¼–ç¨‹è¯­è¨€ï¼Œæ”¯æŒBBC BASIC(é€šè¿‡RISC OSæ˜ åƒæˆ–è€…Linuxçš„â€Brandy Basicâ€å…‹éš†)ã€Cè¯­è¨€å’ŒPerlç­‰ç¼–ç¨‹è¯­è¨€ã€‚æ ‘è“æ´¾åŸºé‡‘ä¼šäº2016å¹´2æœˆå‘å¸ƒäº†æ ‘è“æ´¾3,è¾ƒå‰ä¸€ä»£æ ‘è“æ´¾2ï¼Œæ ‘è“æ´¾3çš„å¤„ç†å™¨å‡çº§ä¸ºäº†64ä½çš„åšé€šBCM2837ï¼Œå¹¶é¦–æ¬¡åŠ å…¥äº†Wi-Fiæ— çº¿ç½‘ç»œåŠè“ç‰™åŠŸèƒ½ï¼Œè€Œå”®ä»·ä»ç„¶æ˜¯35ç¾å…ƒã€‚ ç®€å•æ¥è¯´ï¼Œä»–å°±æ˜¯ä¸€å°ARMæ¶æ„çš„ç”µè„‘ï¼Œä¿¡ç”¨å¡å¤§å°ï¼Œä»–æœ‰usbæ¥å£ï¼Œæœ‰hdmiæ¥å£ï¼Œæœ‰éŸ³é¢‘æ¥å£ï¼Œæœ‰ä»¥å¤ªç½‘æ¥å£ç­‰ç­‰ã€‚æˆ‘ä»¬å†æ¥çœ‹çœ‹ä»–çš„é…ç½®ï¼ˆFrom:ç»´åŸºç™¾ç§‘ï¼‰ï¼š æœ€æ–°çš„Raspberry Pi 3 Bå‹CPUæœ‰æå‡ï¼Œå¢åŠ äº†æ¿è½½WIFIå’Œè“ç‰™ã€‚ä½†æ˜¯ï¼Œè¿™æ ·çš„é…ç½®ï¼Œå’Œæˆ‘ä»¬æ™®é€šçš„PCæœºæ¯”çš„è¯è¿˜æ˜¯å·®çš„å¾ˆè¿œã€‚é‚£ä¹ˆï¼Œæˆ‘ä»¬ä¸ºä»€ä¹ˆè¿˜è¦ä½¿ç”¨æ ‘è“æ´¾å‘¢ï¼Ÿè¿™é‡Œç®€å•è¯´è¯´æˆ‘çš„çœ‹æ³•ï¼š ä½“ç§¯å°ï¼šå°åˆ°å®Œå…¨å¯ä»¥éšèº«æºå¸¦ çœç”µï¼šæˆ‘çš„æ˜¯2ä»£Bå‹ï¼Œé…ç½®çš„ç”µæº5V 2Aï¼Œæœ€å¤§åŠŸç‡ä¹Ÿæ‰10W GPIOï¼šè¿™ä¸ªæ˜¯æœ€å¸å¼•æˆ‘çš„ï¼Œé€šè¿‡å®ƒå¯ä»¥æ§åˆ¶ä¸€äº›å¼€å…³ç­‰ ä¾¿å®œï¼š200å¤šå—é’±çš„ä»·æ ¼ï¼Œå°‘åƒä¸€é¡¿é¥­å°‘çœ‹ä¸¤åœºç”µå½±å°±å‰©ä¸‹æ¥äº† â€¦ å…¶å®æ—¢ç„¶ä½ å·²ç»å†³å®šæˆ–è€…å·²ç»å…¥æ‰‹æ ‘è“æ´¾ï¼Œæˆ‘ä»¬å°±ä¸è¿‡å¤šçš„ä»‹ç»ä»–çš„ä¼˜ç¼ºç‚¹äº†ã€‚åæ­£å°±æ˜¯ä½ ä¹°äº†ç”¨èµ·æ¥ï¼Œä¸ä¼šåæ‚”çš„ã€‚æ¥ä¸‹æ¥æˆ‘ä¼šæŠŠæ›´å¤šçš„ç²¾åŠ›æ”¾åœ¨æˆ‘ä»¬è¦åšçš„äº‹æƒ…ä¸Šï¼Œè€Œä¸æ˜¯çº ç»“å…·ä½“åœ¨æŸä¸ªç‰ˆæœ¬ä¸Šï¼Œå› ä¸ºç›¸åŒçš„OSä»–ä»¬å·®åˆ«ä¸æ˜¯å¾ˆå¤§ã€‚æˆ‘ç”¨çš„æ˜¯æ ‘è“æ´¾2ä»£Bå‹ï¼Œå’Œæœ€æ–°çš„3ä»£æ¯”å°‘äº†WIFIå’ŒBluetoothï¼Œä¸è¿‡æˆ‘è‡ªå·±å‡†å¤‡äº†ä¸€ä¸ªusbæ¥å£çš„WIFIå’ŒBluetoothï¼Œæœ€åæˆ‘çš„åŸºæœ¬é…ç½®å¦‚ä¸‹ï¼š æ ‘è“æ´¾ä¸»æœºï¼š2ä»£Bå‹ ç”µæºé€‚é…å™¨ï¼š2Aï¼Œçœ‹æŒ‚çš„è´Ÿè½½é€‰æ‹© å­˜å‚¨å¡ï¼š32G Sandiskï¼Œæ¨èè¿™ä¸ªç‰Œå­ æ— çº¿ç½‘å¡ï¼šRTL8192CUï¼Œå¯é€‰ USBè“ç‰™ï¼šå¯é€‰ æ‘„åƒå¤´ï¼šç½‘ä¸Š50å¿«é’±ä¹°çš„ï¼Œå¯é€‰ å…¶ä»–ä¸€å †ç¡¬ä»¶ï¼Œå¦‚HC-SR501ã€LCD12864ã€LCD1602ã€MQ-135ã€MQ-2ã€DHT11ç­‰ç­‰ï¼Œç›®å‰å·²çŸ¥åœ¨ç”¨çš„æ˜¯DHT11ï¼Œæ£€æŸ¥æˆ¿é—´æ¸©æ¹¿åº¦ã€‚ 123456~ $ lsusbBus 001 Device 005: ID 0a12:0001 Cambridge Silicon Radio, Ltd Bluetooth Dongle (HCI mode)Bus 001 Device 004: ID 0bda:8178 Realtek Semiconductor Corp. RTL8192CU 802.11n WLAN AdapterBus 001 Device 003: ID 0424:ec00 Standard Microsystems Corp. SMSC9512/9514 Fast Ethernet AdapterBus 001 Device 002: ID 0424:9514 Standard Microsystems Corp.Bus 001 Device 001: ID 1d6b:0002 Linux Foundation 2.0 root hub 0x02 ç½‘ç»œç¯å¢ƒæˆ‘ç”¨çš„æ˜¯ä¸Šæµ·ç”µä¿¡çš„30MBå®½å¸¦ï¼Œç”µä¿¡å…‰çŒ«ä¸‹é¢æ¥ä¸€ä¸ªTP-Linkè·¯ç”±å™¨ï¼Œè·¯ç”±å™¨ä¸‹é¢æ¥ä¸Šç½‘è®¾å¤‡ã€‚å¦‚ä¸‹å›¾ï¼š èµ·åˆï¼Œå¾ˆå¤šäººä¼šé‡åˆ°å’Œæˆ‘ä¸€æ ·çš„é—®é¢˜ï¼šå…‰çŒ«åŠ ç”µåå°±å¯ä»¥ä¸Šç½‘äº†ï¼Œä½†æ˜¯æˆ‘ä»¬æ²¡åŠæ³•é€šè¿‡å…¬ç½‘è®¿é—®æˆ‘è·¯ç”±å™¨ä¸‹çš„è®¾å¤‡ã€‚è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬ä¼šå¾ˆè‡ªç„¶çš„æƒ³åˆ°å¯¹å…‰çŒ«è¿›è¡Œè®¾ç½®ã€‚ç»è¿‡å„ç§googleä¹‹åï¼Œç¡®å®šäº†ä¸€ä¸ªæœ€ç®€å•çš„æ€è·¯ï¼šç ´è§£å…‰çŒ«ï¼Œä»ä¸­è·å–æˆ‘ä»¬æ‹¨å·ç”¨çš„ç”¨æˆ·åå’Œå¯†ç ï¼Œç„¶åæŠŠå…‰çŒ«è®¾ç½®æˆä»…ä»…ä½œä¸ºçŒ«ä½¿ç”¨ï¼Œç”¨æ‹¿åˆ°çš„ç”¨æˆ·åå¯†ç åˆ°æˆ‘ä»¬çš„è·¯ç”±å™¨ä¸­è¿›è¡Œæ‹¨å·ã€‚å¬èµ·æ¥æ˜¯ä¸æ˜¯è¿˜æŒºå¤æ‚çš„ï¼Œé‚£è¿™é‡Œå‘Šè¯‰ä½ ä¸€ä¸ªç®€å•åŠæ³•ï¼šéšä¾¿æ‰¾ä¸€ä¸ªç†ç”±æŠ¥ä¿®å®½å¸¦ï¼Œæ¯”å¦‚ç½‘é€Ÿæ¯”è¾ƒæ…¢ï¼Œç­‰ç»´ä¿®çš„å¸ˆå‚…ä¸Šé—¨åå‘Šè¯‰ä»–ä½ æƒ³ç”¨è‡ªå·±çš„è·¯ç”±å™¨æ‹¨å·ä¸Šç½‘ï¼Œä»–å°±ä¼šå¸®ä½ è®¾ç½®çš„ã€‚è®¾ç½®å¥½è¿™äº›ä¹‹åæˆ‘ä»¬å°±æœ‰äº†ä¸€ä¸ªæœ‰å…¬ç½‘IPçš„è·¯ç”±å™¨ã€‚ 0x03 èŠ±ç”Ÿå£³è™½ç„¶å®Œç¾æœ‰äº†å…¬ç½‘çš„IPï¼Œä½†æ˜¯é—æ†¾çš„æ˜¯ï¼Œè¿™ä¸ªå…¬ç½‘IPåœ¨æ¯æ¬¡æ‹¨å·æ—¶éƒ½ä¼šå˜ã€‚è¿™ä¸ªé—®é¢˜æˆ‘ä»¬å¯ä»¥ç”¨èŠ±ç”Ÿå£³æ¥è§£å†³ã€‚èŠ±ç”Ÿå£³å¯ä»¥å…è´¹ç»™æˆ‘ä»¬æä¾›DDNSæœåŠ¡ï¼Œå°†æˆ‘ä»¬åŠ¨æ€çš„IPæ˜ å°„åˆ°ä¸€ä¸ªåŸŸåä¸Šã€‚è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥åœ¨å…¬ç½‘é€šè¿‡è¿™ä¸ªåŸŸåæ¥è®¿é—®å®¶é‡Œçš„æ ‘è“æ´¾ï¼Œè€Œä¸ç”¨æ‹…å¿ƒè‡ªå·±çš„å…¬ç½‘IPå˜æ¥å˜å»æ‰¾ä¸åˆ°äº†ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬éœ€è¦å…ˆæ³¨å†Œä¸€ä¸ªèŠ±ç”Ÿå£³çš„è´¦å·ï¼Œå†èŠ±5å—é’±æ³¨å†Œä¸€ä¸ªèŠ±ç”Ÿå£³åŸŸåï¼Œæ‹¿ç€è¿™ä¸ªè´¦å·åˆ°æˆ‘ä»¬çš„å®½å¸¦è·¯ç”±å™¨ä¸Šç™»å½•å³å¯: å¾ˆå¤šæ—¶å€™äº‹æƒ…å¹¶æ²¡æœ‰é‚£ä¹ˆå®Œç¾ï¼Œæ¯”å¦‚æŸå¤©ä½ ä¼šå‘ç°æˆ‘ä»¬å®½å¸¦çš„æŸäº›ç«¯å£ï¼ˆæ¯”å¦‚80ç«¯å£ï¼‰æ— æ³•ä½¿ç”¨ï¼ˆè¢«ç”µä¿¡è¿è¥å•†å°æ‰ï¼‰ï¼Œè¿™æ—¶å€™æˆ‘ä»¬å°±éœ€è¦ä½¿ç”¨èŠ±ç”Ÿå£³çš„å¦ä¸€ä¸ªæœåŠ¡ï¼šèŠ±ç”Ÿå£³å†…ç½‘ç‰ˆ æ¥è§£å†³ã€‚è¿™ä¸ªæˆ‘ä¼šåœ¨æ¥ä¸‹æ¥çš„æ–‡ç« ä¸­è®²åˆ°ã€‚ 0x04 å·¥å…·ä¿—è¯è¯´å·¥æ¬²å–„å…¶äº‹å¿…å…ˆåˆ©å…¶å™¨ï¼Œåœ¨æ­£å¼å¼€å§‹ä¹‹å‰ï¼Œç»™å¤§å®¶æ¨èå‡ ä¸ªå·¥å…·ï¼š JuiceSSH ä¸€ä¸ªandroidç³»ç»Ÿçš„SSHå®¢æˆ·ç«¯å·¥å…·ï¼Œå¯ä»¥é€šè¿‡å®ƒç›´æ¥ä¸æ ‘è“æ´¾ç›¸è¿ã€‚ GPIO tool for Raspberry Pi ä¸€ä¸ªå®¢æˆ·ç«¯å·¥å…·ï¼Œæ”¯æŒandroidç³»ç»Ÿï¼Œè¿æ¥æ ‘è“æ´¾åç›´æ¥å¯ä»¥å¯¹æ ‘è“æ´¾çš„GPIOè¿›è¡Œæ“ä½œã€‚ Fritizing è¿™ä¸ªæ˜¯ç”¨æ¥ç”»ç”µè·¯åŸç†å›¾çš„ï¼Œå¾ˆCoolï¼Œéå¸¸å¥½ç”¨ã€‚ Serverauditor iOSç³»ç»Ÿçš„SSHå®¢æˆ·ç«¯å·¥å…·ã€‚ å¦‚æœä½ æœ‰æ›´å¥½çš„å·¥å…·ï¼Œæ¬¢è¿åˆ†äº«ã€‚ è¯´äº†è¿™ä¹ˆå¤šï¼Œæ¥ä¸‹æ¥æ­£å¼è¿›å…¥æ ‘è“æ´¾çš„ä¸–ç•Œï¼Œæå‰ç¥å¤§å®¶ç©çš„å¼€å¿ƒ~~","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"https://ttdevs.github.io/categories/æŠ€æœ¯/"}],"tags":[{"name":"ç©è½¬æ ‘è“æ´¾","slug":"ç©è½¬æ ‘è“æ´¾","permalink":"https://ttdevs.github.io/tags/ç©è½¬æ ‘è“æ´¾/"}]},{"title":"ã€Œç©è½¬æ ‘è“æ´¾ã€0x01é€‰ä¸ªç³»ç»Ÿå…ˆ","slug":"[ç©è½¬æ ‘è“æ´¾]0x01é€‰ä¸ªç³»ç»Ÿå…ˆ","date":"1969-12-31T16:00:00.000Z","updated":"2017-04-27T11:07:57.000Z","comments":true,"path":"1970/01/01/[ç©è½¬æ ‘è“æ´¾]0x01é€‰ä¸ªç³»ç»Ÿå…ˆ/","link":"","permalink":"https://ttdevs.github.io/1970/01/01/[ç©è½¬æ ‘è“æ´¾]0x01é€‰ä¸ªç³»ç»Ÿå…ˆ/","excerpt":"","text":"0x00 æ ‘è“æ´¾çš„å®‰è£…é…ç½®ï¼ˆæ— æ˜¾ç¤ºå™¨ï¼‰æ ‘è“æ´¾æ²¡æœ‰ç¡¬ç›˜ï¼Œæˆ‘ä»¬æ‹¿åˆ°è®¾å¤‡ä¹‹åæ˜¯ä¸èƒ½ç›´æ¥ç”¨çš„ï¼Œå› æ­¤éœ€è¦å…ˆç»™å®ƒé…ç½®ä¸€ä¸ªè£…å¥½ç³»ç»Ÿçš„å­˜å‚¨å¡ã€‚è¿™ç¯‡æ–‡å­—ï¼Œç»™å¤§å®¶ä»‹ç»å¦‚ä½•å®‰è£…å¹¶åˆå§‹åŒ–æ ‘è“æ´¾ç³»ç»Ÿã€‚ Raspbian æ˜¯æ ‘è“æ´¾åŸºé‡‘ä¼šå®˜æ–¹æ”¯æŒçš„ç³»ç»Ÿï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥ä¸‹è½½ä»–çš„å®‰è£…æ–‡ä»¶æˆ–è€…ä½¿ç”¨å®˜ç½‘æ¨èçš„ NOOBS æ¥å®Œæˆå®‰è£…æ“ä½œã€‚é™¤äº†å®˜æ–¹æ”¯æŒçš„ç³»ç»Ÿï¼Œæ ‘è“æ´¾è¿˜æœ‰å¾ˆå¤šç¬¬ä¸‰æ–¹æ”¯æŒçš„ç³»ç»Ÿï¼Œå¦‚ï¼šUBUNTU MATEã€SN ![Uploading win32diskimager_914364.png . . .]APPY UBUNTU COREã€WINDOWS 10 IOT COREã€OSMCã€OPENELECã€PINETã€RISC OSã€WEATHER STATIONç­‰ï¼Œè¿™é‡Œæœ‰æˆ‘ä»¬æ¯”è¾ƒç†Ÿæ‚‰çš„WINDOWS 10 IOTã€UBUNTUã€OSMCç­‰ã€‚UBUNTUç³»ç»Ÿæ˜¯éå¸¸ç«çš„ä¸€ä¸ªLinuxå‘è¡Œç‰ˆæœ¬ï¼ŒWINDOWS 10 IOTæ˜¯å¾®è½¯å¼€å‘çš„ç‰©è”ç½‘ç³»ç»Ÿï¼ŒOSMCå¯ä»¥ä½œä¸ºå®¶åº­åª’ä½“ä¸­å¿ƒä½¿ç”¨ï¼Œå…¶ä»–ç³»ç»Ÿå¤§å®¶å¯ä»¥è‡ªè¡Œäº†è§£ã€‚ å‰ä¸€ç¯‡æ–‡ç« ç®€å•ä»‹ç»äº†æˆ‘çš„ç¡¬ä»¶ç¯å¢ƒï¼Œæ˜¯æ²¡æœ‰æ˜¾ç¤ºå™¨å’Œå¤–æ¥é”®ç›˜é¼ æ ‡çš„ï¼Œå› æ­¤æˆ‘ä¼šåŸºäºè¿™ä¸ªå‰æç»™å¤§å®¶ä»‹ç»å¦‚ä½•ç©è½¬æ ‘è“æ´¾ã€‚ è¿™ä¹ˆå¤šç³»ç»Ÿï¼Œåˆå­¦è€…å¯èƒ½ä¼šå¾ˆçº ç»“å¦‚ä½•é€‰æ‹©ã€‚è¿™é‡Œç»™å¤§å®¶æ¨èå®˜æ–¹æ”¯æŒçš„Raspbianï¼ˆåŸºäºDebian Jessieï¼‰ç³»ç»Ÿï¼Œä»–é¢„è£…äº†å¾ˆå¤šå¸¸ç”¨ã€ç¼–ç¨‹ã€æ•™è‚²è½¯ä»¶ï¼Œå¦‚Python(python3)ã€Scratchã€Sonic Piã€Javaã€Mathematicaç­‰ç­‰ã€‚RaspbianåŒ…å«RASPBIAN JESSIE(Full desktop image based on Debian Jessie)å’ŒRASPBIAN JESSIE LITE(Minimal image based on Debian Jessie)ä¸¤ä¸ªç‰ˆæœ¬ï¼Œç”±äºä¹‹åæˆ‘ä»¬ä¼šç”¨åˆ°æ¡Œé¢ç¯å¢ƒï¼Œå› æ­¤æˆ‘ä»¬æœ€ç»ˆé€‰æ‹©RASPBIAN JESSIEï¼Œå¸¦æ¡Œé¢ç¯å¢ƒçš„ç‰ˆæœ¬ã€‚ 0x01 ä¸‹è½½å†³å®šäº†ä½¿ç”¨RASPBIAN JESSIEï¼ˆéRASPBIAN JESSIE LITEï¼‰ï¼Œæˆ‘ä»¬åªéœ€è¦åˆ°æ ‘è“æ´¾çš„å®˜ç½‘ä¸‹è½½ç³»ç»Ÿæ–‡ä»¶å³å¯ã€‚ä»–çš„æœ€æ–°ç‰ˆæœ¬æ˜¯ March 2016ï¼š å‘å¸ƒï¼š2016-3-18 Linuxå†…æ ¸ï¼š4.1 æ–‡ä»¶åï¼š2016-02-26-raspbian-jessie.zip MD5: db41f2a8c6236c0ca9150fe4db2017c09e7871fb å¤§å°ï¼š1.3G å¯¹ä¸‹è½½çš„æ–‡ä»¶è¿›è¡ŒåŠ å‹ï¼Œå¾—åˆ°2016-02-26-raspbian-jessie.imgï¼Œå¤§å°4.03Gï¼Œè¿™ä¸ªå°±æ˜¯æˆ‘ä»¬å®‰è£…è¦ç”¨åˆ°çš„ç³»ç»Ÿé•œåƒæ–‡ä»¶ã€‚ 0x02 å®‰è£…ç³»ç»Ÿçš„å®‰è£…æ¯”è¾ƒç®€å•ï¼Œå°±æ˜¯å°†æˆ‘ä»¬åˆšä¸‹è½½çš„å®‰è£…é•œåƒæ–‡ä»¶å†™å…¥åˆ°TFå¡ä¸­ã€‚å®˜æ–¹çš„ å®‰è£…å¸®åŠ©æ–‡æ¡£ å¯¹ç³»ç»Ÿçš„å®‰è£…è¿›è¡Œäº†è¯¦ç»†çš„ä»‹ç»ã€‚æœ¬ç€ç®€åŒ–æ“ä½œçš„åŸåˆ™ï¼Œè¿™é‡Œå†åšç®€å•æ¦‚è¿°ã€‚ Windowsç³»ç»Ÿ Windowsç³»ç»Ÿå®‰è£…æ¨èä½¿ç”¨win32diskimagerï¼Œè¿™æ˜¯ä¸€ä¸ªå›¾å½¢åŒ–å·¥å…·ï¼Œæ“ä½œéå¸¸ç®€å•ï¼šä»¥ç®¡ç†å‘˜æ–¹å¼æ‰“å¼€ï¼ŒImageFileé€‰æ‹©åˆšä¸‹è½½çš„imgé•œåƒï¼ŒDeviceé€‰æ‹©æˆ‘ä»¬çš„TFå¡æ‰€åœ¨é©±åŠ¨å™¨ï¼Œç‚¹å‡»Writeå³å¯ã€‚ Macç³»ç»Ÿ è·ŸWindowsç³»ç»Ÿä¸€æ ·ï¼Œæˆ‘ä»¬æ¨èå›¾å½¢ç•Œé¢çš„ApplePi-Bakerï¼Œæ“ä½œç•Œé¢å¦‚ä¸‹ï¼š å·¦ä¾§é€‰æ‹©SDCardï¼Œå³ä¾§é€‰æ‹©æˆ‘ä»¬çš„é•œåƒæ–‡ä»¶ï¼Œç‚¹å‡»Restore BackupæŒ‰é’®å³å¯ã€‚ Macç³»ç»Ÿå‘½ä»¤è¡Œæ–¹å¼ ç”±äºæˆ‘ç”¨çš„Macç³»ç»Ÿï¼Œæ‰€ä»¥ç®€å•ä»‹ç»ä¸‹è¿™ç§ç¨å¾®å¤æ‚ç‚¹çš„æ–¹å¼ä½†ä¹Ÿå°±æ˜¯ç®€å•å‡ æ­¥æ“ä½œï¼š æ’å…¥SDCardå¡ï¼Œä½¿ç”¨ç£ç›˜ç®¡ç†å·¥å…·å¯¹å…¶è¿›è¡Œæ“¦é™¤ï¼Œæ ¼å¼é€‰æ‹©MS-DOS(FAT)ï¼Œå®Œæˆåæ¨å‡ºSDCardï¼ˆæ¨å‡ºå¹¶ä¸æ˜¯æ‹”å‡ºï¼‰ ä½¿ç”¨df -hæŸ¥çœ‹SDCardçš„è·¯å¾„ï¼Œå¦‚ä¸‹çš„ /dev/disk2s1ï¼Œæˆ‘ä»¬è®°ä¸‹ disk2ï¼š 1234567âœ ~ df -hFilesystem Size Used Avail Capacity iused ifree %iused Mounted ondevfs 185Ki 185Ki 0Bi 100% 640 0 100% /devmap -hosts 0Bi 0Bi 0Bi 100% 0 0 100% /netmap auto_home 0Bi 0Bi 0Bi 100% 0 0 100% /home/dev/disk2s1 60Mi 20Mi 40Mi 34% 512 0 100% /Volumes/raspiâœ ~ æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼Œå°†é•œåƒæ–‡ä»¶çƒ§å½•è¿›SDCardï¼Œè¿™ä¸ªè¿‡ç¨‹ä¼šå› ä¸ºä½ çš„SDCardå¡çš„é€Ÿåº¦çš„ä¸åŒè€Œä¸åŒï¼ŒæœŸé—´ä½ å¯ä»¥é€šè¿‡Ctrl+Tæ¥æŸ¥çœ‹è¿›åº¦ï¼š sudo dd bs=1m if=2016-02-26-raspbian-jessie.img of=/dev/rdisk2 å¦‚æœå‘½ä»¤è¡Œæ–¹å¼æœ‰é—®é¢˜ï¼Œè¯·å‚è€ƒå®˜æ–¹è¯´æ˜è§£å†³ã€‚ çƒ§å½•å®Œæˆä¹‹åSDCardå†…å®¹å¦‚ä¸‹ï¼š 0x03 ç™»å½•æ ‘è“æ´¾å®Œæˆä»¥ä¸Šæ“ä½œï¼Œå°†SDCardæ’å…¥æ ‘è“æ´¾åŠ ç”µå°±å¯ä»¥é¡ºåˆ©è·‘èµ·æ¥äº†ã€‚æˆ‘ä»¬å†å¼ºè°ƒä¸€éï¼Œå³ä½¿æ²¡æœ‰é”®ç›˜é¼ æ ‡æ˜¾ç¤ºå™¨ï¼Œä¹Ÿæ˜¯å¯ä»¥æ“ä½œæ ‘è“æ´¾çš„ï¼ŒåŒ…æ‹¬å®‰è£…æ—¶ã€‚ç®€å•çš„æ‹“æ‰‘å¦‚ä¸‹å›¾ï¼š å¯åŠ¨æ ‘è“æ´¾å¯ä»¥æœ‰ä¸¤ç§æ–¹å¼ï¼šæ— å¤–æ¥é”®ç›˜é¼ æ ‡æ˜¾ç¤ºå™¨å’Œæœ‰å¤–æ¥é”®ç›˜é¼ æ ‡æ˜¾ç¤ºå™¨ï¼ˆè™½ç„¶æˆ‘å‡è®¾è‡ªå·±æ²¡æœ‰å¤šä½™çš„é”®ç›˜æ˜¾ç¤ºå™¨ï¼Œä½†æ˜¯æˆ‘è¿˜æ˜¯ä¼šåœ¨æ­¤ä»‹ç»è¿™ç§æ–¹å¼~~ï¼‰ã€‚ è¿™ä¸¤ç§æ–¹å¼æ— è®ºé€‰æ‹©å“ªç§ï¼Œæˆ‘ä»¬éƒ½éœ€è¦å…ˆå°†æ ‘è“æ´¾é€šè¿‡RJ45æ¥å£ä¸æˆ‘ä»¬çš„è·¯ç”±å™¨ç›¸è¿ï¼ˆè¯´äººè¯å°±æ˜¯æ‹¿ç½‘çº¿è¿æ¥æ ‘è“æ´¾å’Œè·¯ç”±å™¨ï¼‰ã€‚åˆ«é—®æˆ‘ä¸ºä»€ä¹ˆè¿™ä¹ˆåšï¼Œå› ä¸ºè¿™æ ·æœ€ç®€å•ï¼Œè·Ÿç€åšå°±å¥½ï¼ˆå½“ç„¶ï¼Œæˆ‘çŸ¥é“ä½ ä¹Ÿå¯ä»¥ç›´æ¥æ‹¿æ ¹ç½‘çº¿ç›´æ¥è¿æ¥ç”µè„‘å’Œæ ‘è“æ´¾ï¼Œä½†æ˜¯éå¸¸ä¸å»ºè®®è¿™ä¹ˆåšï¼Œå› ä¸ºè¿™ä¹ˆå±Œçš„ä½ å·²ç»å¯ä»¥ä¸ç”¨æ¥çœ‹è¿™ç¯‡æ–‡ç« äº†ï¼‰ï¼Œæˆ–è€…ä½ ä¼šè¯´æ²¡æœ‰è·¯ç”±å™¨ï¼Œä½ çœŸçš„æ²¡è·¯ç”±å™¨ï¼Ÿé‚£èµ¶ç´§ä¹°ä¸€ä¸ªå§ã€‚ è¿™é‡Œå¼ºçƒˆå»ºè®®é€šè¿‡è·¯ç”±å™¨çš„è®¾ç½®ç»™æ ‘è“æ´¾åˆ†é…é™æ€IPï¼Œå¦åˆ™ä¼šéå¸¸éº»çƒ¦ã€‚æ›´å¤šè·å–æ ‘è“æ´¾çš„IPçš„æ–¹æ³•å¯å‚è€ƒè¿™é‡Œã€‚ æ— å¤–æ¥é”®ç›˜é¼ æ ‡æ˜¾ç¤ºå™¨ è¿™ç§æ–¹å¼æœ€ç®€å•ã€‚æ ‘è“æ´¾æ¥å…¥ç½‘ç»œï¼Œæˆ‘ä»¬åªéœ€è¦ç™»å½•è·¯ç”±å™¨ï¼Œåˆ°DHCPæœåŠ¡å™¨ä¸­çš„å®¢æˆ·ç«¯åˆ—è¡¨ä¸­æŸ¥çœ‹æˆ‘ä»¬çš„æ ‘è“æ´¾çš„IPï¼Œç„¶åé€šè¿‡sshå‘½ä»¤ç™»å½•æ ‘è“æ´¾å°±å¯ä»¥æ“ä½œäº†ã€‚[é»˜è®¤çš„ç”¨æˆ·åå¯†ç ][c2]ï¼špiï¼šraspberryï¼Œssh å‘½ä»¤å¦‚ä¸‹ï¼š 1ssh pi@&lt;you ip address&gt; å¯†ç è¾“å…¥æ— å›æ˜¾ å¤–æ¥é”®ç›˜é¼ æ ‡æ˜¾ç¤ºå™¨ å¦‚æœä½ æœ‰å¤šä½™çš„é”®ç›˜é¼ æ ‡æ˜¾ç¤ºå™¨ä¾›ç»™æ ‘è“æ´¾ä½¿ç”¨ï¼Œé‚£ä¹ˆç¬¬ä¸€æ¬¡å¯åŠ¨çš„æ—¶å€™ï¼Œæˆ‘ä»¬éœ€è¦ç®€å•é…ç½®ä¸‹æ ‘è“æ´¾ä½¿å…¶æ”¯æŒHDMIè¾“å‡ºã€‚æ‰“å¼€æˆ‘ä»¬çš„SDCardï¼Œåœ¨æ ¹ç›®å½•ä¸‹ï¼Œçœ‹åˆ°æœ‰è¿™ä¹ˆä¸€ä¸ªæ–‡ä»¶ï¼šconfig.txtã€‚æˆ‘ä»¬éœ€è¦ä¿®æ”¹ä»–æ”¯æŒHDMIçš„æ˜¾ç¤ºï¼ˆ1080Pçš„è¾“å‡ºï¼‰ï¼Œä¸‹é¢æ˜¯æˆ‘é…ç½®çš„Demoï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758pi@raspi:/boot $ cat config.txt# For more options and information see# http://www.raspberrypi.org/documentation/configuration/config-txt.md# Some settings may impact device functionality. See link above for details# uncomment if you get no picture on HDMI for a default &quot;safe&quot; mode#hdmi_safe=1# uncomment this if your display has a black border of unused pixels visible# and your display can output without overscandisable_overscan=1# uncomment the following to adjust overscan. Use positive numbers if console# goes off screen, and negative if there is too much border#overscan_left=16#overscan_right=16#overscan_top=16#overscan_bottom=16# uncomment to force a console size. By default it will be display&apos;s size minus# overscan.#framebuffer_width=1280#framebuffer_height=720# uncomment if hdmi display is not detected and composite is being outputhdmi_force_hotplug=1# uncomment to force a specific HDMI mode (this will force VGA)hdmi_group=2hdmi_mode=82# uncomment to force a HDMI mode rather than DVI. This can make audio work in# DMT (computer monitor) modes#hdmi_drive=2# uncomment to increase signal to HDMI, if you have interference, blanking, or# no displayconfig_hdmi_boost=4# uncomment for composite PAL#sdtv_mode=2#uncomment to overclock the arm. 700 MHz is the default.#arm_freq=800# Uncomment some or all of these to enable the optional hardware interfaces#dtparam=i2c_arm=on#dtparam=i2s=on#dtparam=spi=on# Uncomment this to enable the lirc-rpi module#dtoverlay=lirc-rpi# Additional overlays and parameters are documented /boot/overlays/README# Enable audio (loads snd_bcm2835)dtparam=audio=ondevice_tree= å‚è€ƒï¼š è§£å†³Raspberry Piåªèƒ½åœ¨é»˜è®¤640Ã—480æ¨¡å¼ä¸‹æ˜¾ç¤ºçš„é—®é¢˜ http://elinux.org/RPiconfig 0x04 é…ç½®WIFIå¦‚æœä½ æƒ³æ‘†è„±ç½‘çº¿çš„æŸç¼šï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨WIFIæ¥æ¥å…¥ç½‘ç»œã€‚æœ€æ–°çš„æ ‘è“æ´¾3æ¿è½½äº†WIFIï¼Œæ ‘è“æ´¾2ä»£éœ€è¦æˆ‘ä»¬è‡ªå·±é…ç½®æ— çº¿ç½‘å¡ã€‚å®˜æ–¹çš„é…ç½®å‚è€ƒè¿™é‡Œã€‚å¦‚ä½•æŸ¥çœ‹æˆ‘ä»¬çš„æ— çº¿ç½‘å¡æ˜¯å¦æ­£ç¡®è¯†åˆ«ï¼Œå¯ä»¥ä½¿ç”¨lsusbå‘½ä»¤ï¼Œå¦‚ï¼š 123456pi@raspi:~ $ lsusbBus 001 Device 005: ID 0a12:0001 Cambridge Silicon Radio, Ltd Bluetooth Dongle (HCI mode)Bus 001 Device 004: ID 0bda:8178 Realtek Semiconductor Corp. RTL8192CU 802.11n WLAN AdapterBus 001 Device 003: ID 0424:ec00 Standard Microsystems Corp. SMSC9512/9514 Fast Ethernet AdapterBus 001 Device 002: ID 0424:9514 Standard Microsystems Corp.Bus 001 Device 001: ID 1d6b:0002 Linux Foundation 2.0 root hub ç¬¬äºŒè¡Œçš„Devices 004 RTL8192CUå°±æ˜¯æˆ‘çš„æ— çº¿ç½‘å¡ã€‚RASPBIAN JESSIEç³»ç»Ÿé»˜è®¤é›†æˆäº†RTL8192CUçš„é©±åŠ¨ï¼Œæ‰€ä»¥æˆ‘æ’ä¸Šå»ä¹‹åå°±èƒ½ç”¨äº†ã€‚å¦‚æœä½ çš„æ— çº¿ç½‘å¡æ— æ³•æ£€æµ‹åˆ°ï¼Œè¯·æ£€æŸ¥é©±åŠ¨é…ç½®ï¼Œç”±äºæ— çº¿ç½‘å¡å‹å·å¤ªå¤šï¼Œé©±åŠ¨å®‰è£…å°±ä¸å±•å¼€è®²äº†ï¼Œå¯ä»¥å‚è€ƒè¿™é‡Œã€‚ ç›´æ¥ä¿®æ”¹é…ç½®æ–‡ä»¶ æ ‘è“æ´¾çš„ç½‘ç»œé…ç½®æ–‡ä»¶ä½äº /etc/network/interfaces å’Œ /etc/wpa_supplicant/wpa_supplicant.confæ–‡ä»¶ä¸­ï¼Œæˆ‘ä»¬å°†é€šè¿‡å¯¹å…¶ä¿®æ”¹æ¥ä½¿ç”¨æˆ‘ä»¬çš„WIFIã€‚ä¿®æ”¹ä¹‹å‰å»ºè®®å…ˆåšå¤‡ä»½ï¼š 12sudo cp /etc/network/interfaces /etc/network/interfaces.baksudo cp /etc/wpa_supplicant/wpa_supplicant.conf /etc/wpa_supplicant/wpa_supplicant.conf.bak ä¸‹é¢æ˜¯é»˜è®¤çš„ `interfaces` é…ç½®æ–‡ä»¶ï¼š 123456789101112131415161718192021$ cat interfaces# interfaces(5) file used by ifup(8) and ifdown(8)# Please note that this file is written to be used with dhcpcd# For static IP, consult /etc/dhcpcd.conf and &apos;man dhcpcd.conf&apos;# Include files from /etc/network/interfaces.d:source-directory /etc/network/interfaces.dauto loiface lo inet loopbackiface eth0 inet manualallow-hotplug wlan0iface wlan0 inet manual wpa-conf /etc/wpa_supplicant/wpa_supplicant.confallow-hotplug wlan1iface wlan1 inet manual wpa-conf /etc/wpa_supplicant/wpa_supplicant.conf åœ¨é»˜è®¤çš„ interfaces é…ç½®ä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥ä»…ä»…ä¿®æ”¹ /etc/wpa_supplicant/wpa_supplicant.confæ¥å®ŒæˆWIFIé…ç½®ï¼Œæ¯”å¦‚æˆ‘çš„ wpa_supplicant.confæ–‡ä»¶å¦‚ä¸‹ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243$ sudo cat /etc/wpa_supplicant/wpa_supplicant.confcountry=CNctrl_interface=DIR=/var/run/wpa_supplicant GROUP=netdevupdate_config=1network=&#123; ssid=&quot;my wifi ssid&quot; psk=&quot;my password&quot; key_mgmt=WPA-PSK&#125;``` æˆ‘çš„WIFIåŠ å¯†æ–¹å¼æ˜¯ `WPA-PSK/WPA2-PSK` å› æ­¤é…ç½® `key_mgmt=WPA-PSK` åŠ å¯†æ–¹å¼å¯ä»¥åœ¨è·¯ç”±å™¨çš„æ— çº¿å®‰å…¨è®¾ç½®ä¸­æŸ¥çœ‹ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬è¿˜éœ€è¦é‡å¯æˆ‘ä»¬çš„WIFIï¼š ``` shellsudo ifdown wlan0sudo ifup wlan0 ``` æˆ–è€…ç›´æ¥é‡å¯ç³»ç»Ÿ `sudo reboot` ã€‚é€šè¿‡ä¸Šé¢çš„è®¾ç½®ï¼Œå°±å¯ä»¥è¿æ¥æˆ‘ä»¬çš„WIFIäº†ã€‚å½“ç„¶ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ä¸ä½¿ç”¨ `/etc/wpa_supplicant/wpa_supplicant.conf` æ–‡ä»¶ï¼Œä»…ä»…ä¿®æ”¹ `interfaces` æ¥å®Œæˆé…ç½®ï¼Œå¦‚æˆ‘çš„å¦ä¸€ä¸ªé…ç½®ï¼š``` shell# interfaces(5) file used by ifup(8) and ifdown(8)# Please note that this file is written to be used with dhcpcd# For static IP, consult /etc/dhcpcd.conf and &apos;man dhcpcd.conf&apos;# Include files from /etc/network/interfaces.d:source-directory /etc/network/interfaces.dauto loiface lo inet loopbackiface eth0 inet dhcp# auto wlan0allow-hotplug wlan0iface wlan0 inet staticaddress 192.168.1.56netmask 255.255.255.0gateway 192.168.1.1wpa-ssid &lt;my ssid&gt;wpa-psk &lt;my password&gt; æ›´å¤šçš„é…ç½®å‚æ•°ï¼Œå¯ä»¥å‚è€ƒ[è¿™é‡Œ](TODO)ã€‚ &gt;è¿™é‡Œé…ç½®ä½¿ç”¨äº†é™æ€IP é€šè¿‡GUIæ¡Œé¢ç¯å¢ƒè¿›è¡Œé…ç½® è¿™ä¸ªå°±éå¸¸ç®€å•äº†ï¼Œè¿æ¥æ˜¾ç¤ºå™¨é”®ç›˜é¼ æ ‡ï¼Œç™»å½•æ¡Œé¢ç¯å¢ƒï¼Œç‚¹å‡»å³ä¸Šè§’çš„WIFIå›¾æ ‡ï¼Œé€‰æ‹©è‡ªå·±çš„WIFIï¼Œç„¶åè¾“å…¥å¯†ç å³å¯ï¼Œå¦‚ä¸‹å›¾ï¼š è·å–åˆ°IPå¹¶æ¥å…¥åˆ°ç½‘ç»œï¼Œæ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°±å¯ä»¥å¼€å¯æˆ‘ä»¬çš„æ ‘è“æ´¾ä¹‹æ—…ã€‚å„ä½ç©çš„å¼€å¿ƒ~~","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"https://ttdevs.github.io/categories/æŠ€æœ¯/"}],"tags":[{"name":"ç©è½¬æ ‘è“æ´¾","slug":"ç©è½¬æ ‘è“æ´¾","permalink":"https://ttdevs.github.io/tags/ç©è½¬æ ‘è“æ´¾/"}]},{"title":"ã€Œç©è½¬æ ‘è“æ´¾ã€0x03åˆå§‹åŒ–é…ç½®","slug":"[ç©è½¬æ ‘è“æ´¾]0x03åˆå§‹åŒ–é…ç½®","date":"1969-12-31T16:00:00.000Z","updated":"2017-04-27T11:07:57.000Z","comments":true,"path":"1970/01/01/[ç©è½¬æ ‘è“æ´¾]0x03åˆå§‹åŒ–é…ç½®/","link":"","permalink":"https://ttdevs.github.io/1970/01/01/[ç©è½¬æ ‘è“æ´¾]0x03åˆå§‹åŒ–é…ç½®/","excerpt":"","text":"0x00 ç³»ç»Ÿçš„åˆå§‹åŒ–é…ç½®Config Raspberry Pi ç³»ç»Ÿçš„é»˜è®¤é…ç½®æœ‰æ—¶å€™æ— æ³•æ»¡è¶³æˆ‘ä»¬å¤šæ ·çš„å®é™…æƒ…å†µï¼Œæ¯”å¦‚æˆ‘ä»¬çš„æ—¶åŒºã€æˆ‘ä»¬çš„è¯­è¨€ã€æˆ‘ä»¬å¤–æ¥æ˜¾ç¤ºå™¨çš„æ¥å£ç±»å‹å’Œå‚æ•°ç­‰ç­‰ï¼Œ è¿™ä¸ªæ—¶å€™å°±éœ€è¦æˆ‘ä»¬å¯¹ç³»ç»Ÿçš„é»˜è®¤é…ç½®è¿›è¡Œä¿®æ”¹ï¼Œæ¥æ»¡è¶³æˆ‘ä»¬çš„å…·ä½“çš„è¦æ±‚ã€‚ä¸‹é¢ç»™å¤§å®¶ä»‹ç»å¯èƒ½éœ€è¦ç”¨åˆ°çš„é…ç½®ã€‚ 0x01 config.txtconfig.txt è¿™æ˜¯ä¸€ä¸ªé‡è¦çš„ç³»ç»Ÿé…ç½®æ–‡ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥åˆ° Raspberry Pi çš„è¿™ä¸ª /boot/config.txt ç›®å½•ä¸‹æŸ¥çœ‹ï¼Œä¹Ÿå¯ç›´æ¥åœ¨ TF å¡çš„æ ¹ç›®å½•ä¸‹æ‰¾åˆ°ä»–ã€‚éƒ¨åˆ†é…ç½®å¯å‚è€ƒï¼šæ ‘è“æ´¾çš„å®‰è£… ã€‚æ›´å¤šçš„é…ç½®æˆ‘ä»¬ä¼šåœ¨ä»¥åç”¨åˆ°çš„æ—¶å€™è®²è§£ã€‚ 0x02 raspi-configraspi-config è¿™ä¸ªå·¥å…·å¯ä»¥å¯¹ç³»ç»Ÿè¿›è¡Œå„ç§é…ç½®ï¼Œéœ€è¦ä½¿ç”¨ç³»ç»Ÿæƒé™æ‰§è¡Œï¼šsudo raspi-configã€‚æ‰“å¼€åæˆ‘ä»¬ä¼šè§åˆ°å¦‚ä¸‹å›¾çš„é…ç½®ç•Œé¢ï¼š è¿™ä¸ªç•Œé¢æ“ä½œæ¯”è¾ƒç®€å•ï¼Œå¦‚æœä½ ç”¨è¿‡DOSç³»ç»Ÿï¼Œè‚¯å®šä¸ä¼šé™Œç”Ÿã€‚ä¸€èˆ¬æƒ…å†µåªæœ‰ä¸‹é¢å‡ ç§æŒ‰é”®ï¼šEscã€Tabã€ä¸Šã€ä¸‹ã€å·¦ã€å³ã€Spaceã€å›è½¦ã€‚ç¡®è®¤æŒ‰å›è½¦ï¼Œè¿”å›ç”¨Escï¼Œé€‰æ‹©ç”¨Spaceã€ä¸Šã€ä¸‹å’ŒTabã€‚ Expand Filesystem è¯´ä»–é‡è¦ä¸»è¦æ˜¯å› ä¸ºå¾ˆå¤šå°ä¼™ä¼´æ¯”è¾ƒå¥½å¥‡ ä¸ºä»€ä¹ˆæˆ‘çš„æ–‡ä»¶ç³»ç»Ÿå˜å°äº†ï¼Œåªæœ‰MBçº§ï¼Œè€Œä½ ç”¨çš„å´æ˜¯16æˆ–è€…32Gçš„å­˜å‚¨å¡ã€‚å¦‚æœä½ ä¹Ÿæœ‰è¿™ä¸ªç–‘é—®ï¼Œåˆ™å¯ä»¥é€šè¿‡æ‰§è¡Œè¿™ä¸ªé€‰é¡¹æ¥æ‰©å±•ä½ çš„æ–‡ä»¶ç³»ç»Ÿä½¿å…¶å¯ä»¥ä½¿ç”¨æ•´ä¸ªå­˜å‚¨å¡ã€‚ Change User Password å­—é¢æ„æ€ï¼Œä¿®æ”¹ä½  Raspbian çš„ pi ç”¨æˆ·çš„å¯†ç  Boot Options é€‰æ‹©ä½ çš„å¯åŠ¨æ–¹å¼ï¼Œå¦‚ä½¿ç”¨Console or GUIï¼Œæ˜¯å¦è‡ªåŠ¨ç™»å½• Wait for Network at Boot æ˜¯å¦åœ¨å¯åŠ¨è¿‡ç¨‹ä¸­ç­‰å¾…ç½‘ç»œè¿æ¥ï¼Œé»˜è®¤å°±å¥½ Internationalistion Options å›½é™…åŒ–æ”¯æŒï¼Œä¿®æ”¹ä½ çš„ä½ç½®ï¼Œæ—¶åŒºï¼Œé”®ç›˜å¸ƒå±€ï¼ŒWifiç­‰ã€‚ Change Localeï¼š è‹¥æœä½ å¯ä»¥æ— éšœç¢ä½¿ç”¨è‹±æ–‡ï¼Œå»ºè®®ä¸åšæ”¹åŠ¨ è‹¥æƒ³ä½¿ç”¨ä¸­æ–‡ï¼Œæ”¹ä¸ºï¼šzh_CN.UTF-8 UTF-8ã€‚æ”¹åŠ¨ä¹‹åå»ºè®®å®‰è£…ä¸­æ–‡å­—ä½“ï¼Œå¦åˆ™å¯èƒ½ä¼šå‡ºç°ä¹±ç ï¼ˆå››ä¸ªæ•°å­—çš„æ–¹å—ï¼‰ï¼Œå…·ä½“å‚è€ƒä¸‹é¢çš„ä¸­æ–‡ä¹±ç ã€‚ TimeZoneï¼šä¸œå…«åŒºï¼Œæ‰€ä»¥æˆ‘ä»¬é€‰æ‹©ï¼šAsiz &gt; Shanghai Keyboard Layoutï¼šè¿™ä¸ªæˆ‘ä»¬å¯ä»¥ä½¿ç”¨é»˜è®¤ï¼Œæˆ–è€…æ ¹æ®ä½ å®é™…ä½¿ç”¨é”®ç›˜é€‰æ‹© Wifiï¼šæˆ‘ä»¬é€‰æ‹© CN China Enable Camera Cameraï¼Œä¸ç¡®å®šæ˜¯å¯ç”¨æˆ‘ä»¬è‡ªå·±çš„USBæ‘„åƒå¤´è¿˜æ˜¯å®˜æ–¹çš„æ‘„åƒå¤´ï¼Œé€‰æ‹© Enable Add to Rastrack ä¸€å°è®¾å¤‡ï¼Œæ­¤å¤„ä¸åšæ”¹åŠ¨ Overclock è¶…é¢‘ï¼Œè¿™ä¸ªè‡ªå·±å†³å®šï¼Œä¸ªäººæ„Ÿè§‰æ²¡å¿…è¦ Advanced Options è¿™é‡Œçš„é€‰é¡¹æ¯”è¾ƒå¤šï¼Œå…±11é¡¹ï¼Œä»¥åç”¨åˆ°çš„æ—¶å€™å†è¿‡æ¥ä»‹ç» About raspi-config è¿™ä¸ªå°±ä¸è¯´äº†ï¼Œæ²¡äº‹å¯ä»¥è¯»è¯» 0x03 æ›´æ–°è½¯ä»¶æºå¦‚æœä½ ä½¿ç”¨é»˜è®¤çš„è½¯ä»¶æºï¼Œå¾ˆå¤šæ—¶å€™é€Ÿåº¦æ˜¯éå¸¸æ…¢çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬è€ƒè™‘æ¢æˆå›½å†…çš„é•œåƒã€‚æ ‘è“æ´¾çš„è½¯ä»¶æºåˆ—è¡¨è¯·å‚è€ƒè¿™é‡Œï¼Œsources.list çš„ä¿¡æ¯å¯å‚è€ƒè¿™é‡Œã€‚ å¯èƒ½ä½ ä¼šé—®æ€ä¹ˆé€‰æ‹©ï¼Œé¦–å…ˆå¤©æœçš„ç½‘ç»œè‚¯å®šé€‰å›½å†…çš„ï¼Œå›½å†…çš„ç®€å•æ¥è¯´é€‰æ‹©ç¦»è‡ªå·±è¿‘çš„ï¼Œè¿è¥å•†ç›¸åŒçš„ï¼Œå½“ç„¶ä½ ä¹Ÿå¯ä»¥é€šè¿‡ä¸“ä¸šçš„æµ‹é€Ÿå·¥å…·æ¥å†³å®šã€‚æˆ‘é€‰æ‹©äº† Open Source Software Association of Chinese Academy of Sciencesï¼ˆhttp://mirrors.opencas.cn/raspbian/raspbian/ï¼‰ï¼Œä¸‹é¢ä»‹ç»ä¿®æ”¹æ–¹æ³•ï¼š é¦–å…ˆå¤‡ä»½æºåˆ—è¡¨ pi@raspi:/etc/apt $ sudo cp sources.list sources.list.bak ç¼–è¾‘æºåˆ—è¡¨ sudo nano sources.list 12345678pi@raspi:/etc/apt $ cat sources.list#deb http://mirrordirector.raspbian.org/raspbian/ jessie main contrib non-free rpi# Uncomment line below then &apos;apt-get update&apos; to enable &apos;apt-get source&apos;#deb-src http://archive.raspbian.org/raspbian/ jessie main contrib non-free rpideb http://mirrors.opencas.cn/raspbian/raspbian/ jessie main contrib non-free rpi# Uncomment line below then &apos;apt-get update&apos; to enable &apos;apt-get source&apos;deb-src http://mirrors.opencas.cn/raspbian/raspbian/ jessie main contrib non-free rpi æ›´æ–° sudo apt-get update 0x04 ä¸­æ–‡ä¹±ç å¦‚æœä½ åœ¨Change Locale ä¸­é€‰æ‹©äº† zh_CN.UTF-8å°±å¯èƒ½å‡ºç°ä¸­æ–‡ä¹±ç çš„é—®é¢˜ï¼Œä¸‹é¢ä»‹ç»å¦‚ä½•ä¿®æ”¹ï¼š å®‰è£…å­—ä½“ï¼šsudo apt-get install ttf-wqy-zenhei é¡ºä¾¿å®‰è£…è¾“å…¥æ³•ï¼šsudo apt-get -y install scim-pinyin ä½¿ç”¨è‡ªå·±çš„å­—ä½“ï¼šå°†è‡ªå·±çš„å­—ä½“æ”¾åˆ° ~/.local/share/fonts/ or ~/.fonts æ–‡ä»¶å¤¹ä¸­ï¼ˆæ²¡æœ‰çš„è¯å°±åˆ›å»ºï¼‰ï¼Œç„¶ååˆ·æ–°å­—ä½“ fc-cache -fv æˆ–è€… é‡å¯ ç»è¿‡ä¸Šé¢çš„é…ç½®ï¼ŒåŸºæœ¬ä¸Šå°±å¯ä»¥ä½¿ç”¨æˆ‘ä»¬çš„ Raspberry Pi äº†ã€‚æ¥ä¸‹æ¥å†ç»™å¤§å®¶ä»‹ç»å¦‚æœçªç ´å¤©æœçš„ç½‘ç»œé—®é¢˜ï¼Œç„¶åæˆ‘ä»¬å°±å¯ä»¥æ­£å¼çš„ç©è½¬æ ‘è“æ´¾äº†ï½ï½","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"https://ttdevs.github.io/categories/æŠ€æœ¯/"}],"tags":[{"name":"ç©è½¬æ ‘è“æ´¾","slug":"ç©è½¬æ ‘è“æ´¾","permalink":"https://ttdevs.github.io/tags/ç©è½¬æ ‘è“æ´¾/"}]},{"title":"Hello World","slug":"hello-world","date":"1969-12-31T16:00:00.000Z","updated":"2017-01-01T04:24:36.000Z","comments":true,"path":"1970/01/01/hello-world/","link":"","permalink":"https://ttdevs.github.io/1970/01/01/hello-world/","excerpt":"","text":"Welcome to Hexo! This is your very first post. Check documentation for more info. If you get any problems when using Hexo, you can find the answer in troubleshooting or you can ask me on GitHub. Quick StartCreate a new post1$ hexo new \"My New Post\" More info: Writing Run server1$ hexo server More info: Server Generate static files1$ hexo generate More info: Generating Deploy to remote sites1$ hexo deploy More info: Deployment === My Demoè¿™æ˜¯ä¸€ç¯‡è®°å½•ä½¿ç”¨æ–¹æ³•çš„ä»‹ç»ï¼Œ å…±ä»¥åå‚è€ƒã€‚ title1title2title3æµ‹è¯•TOC åˆ›å»ºtags æ–¹æ³•ä¸€ 123tags: - hexo - yml æ–¹æ³•äºŒ 1tags: [hexo, yml] æ’å…¥å›¾ç‰‡ æ’å…¥ä»£ç  æ–¹æ³•ä¸€ 123public class Test()&#123; &#125; æ–¹æ³•äºŒ public class Test(){ } åˆ›å»ºAbouté¡µé¢123âœ blog hexo new page &quot;about&quot;INFO Created: ~/OneDrive/blog/source/about/index.mdâœ blog æ’å…¥éŸ³ä¹123&lt;iframe frameborder=\"no\" border=\"0\" marginwidth=\"0\" marginheight=\"0\" width=330 height=86 src=\"http://music.163.com/outchain/player?type=2&amp;id=25706282&amp;auto=0&amp;height=66\"&gt; &lt;/iframe&gt;","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"https://ttdevs.github.io/categories/æŠ€æœ¯/"}],"tags":[{"name":"hexo","slug":"hexo","permalink":"https://ttdevs.github.io/tags/hexo/"},{"name":"yml","slug":"yml","permalink":"https://ttdevs.github.io/tags/yml/"}]},{"title":"ã€Œç©è½¬æ ‘è“æ´¾ã€0x04è¿˜æˆ‘80ç«¯å£","slug":"[ç©è½¬æ ‘è“æ´¾]0x04è¿˜æˆ‘80ç«¯å£","date":"1969-12-31T16:00:00.000Z","updated":"2017-04-27T11:07:57.000Z","comments":true,"path":"1970/01/01/[ç©è½¬æ ‘è“æ´¾]0x04è¿˜æˆ‘80ç«¯å£/","link":"","permalink":"https://ttdevs.github.io/1970/01/01/[ç©è½¬æ ‘è“æ´¾]0x04è¿˜æˆ‘80ç«¯å£/","excerpt":"","text":"0x00 èŠ±ç”Ÿå£³ä»‹ç»Oray for Raspberry Pi èŠ±ç”Ÿå£³æœåŠ¡ç™¾åº¦ç™¾ç§‘ä¸­æœ‰è¿™æ ·ä¸€æ®µä»‹ç»ï¼š èŠ±ç”Ÿå£³æ˜¯åŠ¨æ€åŸŸåè§£ææœåŠ¡å®¢æˆ·ç«¯è½¯ä»¶ã€‚å½“æ‚¨å®‰è£…å¹¶æ³¨å†Œè¯¥é¡¹æœåŠ¡ï¼Œæ— è®ºæ‚¨åœ¨ä»»ä½•åœ°ç‚¹ã€ä»»ä½•æ—¶é—´ã€ä½¿ç”¨ä»»ä½•çº¿è·¯ï¼Œå‡å¯åˆ©ç”¨è¿™ä¸€æœåŠ¡å»ºç«‹æ‹¥æœ‰å›ºå®šåŸŸåå’Œæœ€å¤§è‡ªä¸»æƒçš„äº’è”ç½‘ä¸»æœºã€‚â€œèŠ±ç”Ÿå£³â€æ”¯æŒçš„çº¿è·¯åŒ…æ‹¬æ™®é€šç”µè¯çº¿ã€isdnã€adslã€æœ‰çº¿ç”µè§†ç½‘ç»œã€åŒç»çº¿åˆ°æˆ·çš„å®½å¸¦ç½‘å’Œå…¶å®ƒä»»ä½•èƒ½å¤Ÿæä¾›äº’è”ç½‘çœŸå®ipçš„æ¥å…¥æœåŠ¡çº¿è·¯ï¼Œè€Œæ— è®ºè¿æ¥è·å¾—çš„ipå±äºåŠ¨æ€è¿˜æ˜¯é™æ€ã€‚ ç®€å•æ¥è¯´ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡èŠ±ç”Ÿå£³çš„æœåŠ¡æŠŠæˆ‘ä»¬çš„IPå’Œä¸€ä¸ªåŸŸååšæ˜ å°„ï¼Œæ˜ å°„åå°±å¯ä»¥ä½¿ç”¨åŸŸåè®¿é—®è€Œä¸éœ€è¦è®°IPäº†ã€‚IPæ˜¯ä¸€ä¸ªä¸å¥½è®°çš„ä¸œè¥¿ï¼Œåƒæˆ‘ä»¬è¿™æ ·çš„ä¸ªäººç”¨æˆ·åˆæ˜¯æ²¡æœ‰å›ºå®šIPçš„ï¼ˆå›ºå®šIPçš„å®½å¸¦æœåŠ¡è¾ƒè´µï¼ŒåœŸè±ªå¯å¿½ç•¥ï¼‰ï¼Œå› æ­¤èŠ±ç”Ÿå£³å¯ä»¥å¸®æˆ‘ä»¬è§£å†³è¿™ä¸ªç–¼ç‚¹ã€‚ä¹‹å‰çš„èŠ±ç”Ÿå£³ç»™æ³¨å†Œç”¨æˆ·å…è´¹æä¾›äº†ä¸€ä¸ªäºŒçº§åŸŸåï¼Œç°åœ¨æ³¨å†Œéœ€è¦èŠ±5å…ƒè´­ä¹°ä¸€ä¸ªæ°¸ä¹…çš„äºŒçº§åŸŸåã€‚ä¸‹é¢ä¼šæœ‰ä»‹ç»ã€‚ 0x01 å®‰è£…èŠ±ç”Ÿå£³å†…ç½‘ç‰ˆèŠ±ç”Ÿå£³å†…ç½‘ç‰ˆ è¿™ä¸ªä¸œè¥¿æ˜¯å¹²å˜›çš„ï¼Ÿ å¦‚æœä½ æ²¡æœ‰æ¥è§¦è¿‡ï¼Œå¯èƒ½ä¼šæœ‰è¿™ä¸ªç–‘é—®ï¼Œä¸”å¬æˆ‘æ…¢æ…¢é“æ¥ã€‚ç°åœ¨æˆ–è€…æœªæ¥çš„æŸä¸€å¤©ï¼Œä½ ä¼šçŸ¥é“ï¼Œä¸­å›½ç”µä¿¡æˆ–è€…å…¶ä»–å®¶çš„å®½å¸¦ä¼šå°æ‰ä¸€äº›æˆ‘ä»¬å¸¸ç”¨çš„ç«¯å£ï¼Œæ¯”å¦‚æœ€å¸¸è§çš„80ç«¯å£ã€‚å¯èƒ½ä¸»è¦æ˜¯ä¸ºäº†åŠ å¼ºç½‘ç»œç®¡ç†ï¼Œä¸å…è®¸ç§äººåœ¨å®¶é‡Œæ­å»ºç½‘ç»œæœåŠ¡å§ã€‚é¡ºä¾¿å‘Šè¯‰ä½ ä¸€ä¸ªä¸å¹¸çš„æ¶ˆæ¯ï¼Œå¦‚æœä½ çš„sshä¸èƒ½åœ¨å¤–ç½‘è®¿é—®æˆ–è€…è®¿é—®ä¸ç¨³å®šï¼Œä¹Ÿæœ‰å¯èƒ½è¢«å°äº†ã€‚è€Œæˆ‘ä»¬å°†è¦å®‰è£…çš„ èŠ±ç”Ÿå£³å†…ç½‘ç‰ˆ å°±æ˜¯çªç ´è¿™ä¸ªé™åˆ¶çš„ã€‚å¤§å®¶ä¹Ÿå¯ä»¥å‚è€ƒè¿™é‡Œã€‚ ä¸‹è½½é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦ä¸‹è½½æ ‘è“æ´¾ç‰ˆçš„èŠ±ç”Ÿå£³å†…ç½‘ç‰ˆï¼Œåœ¨æ ‘è“æ´¾ä¸Šï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ wget è¿›è¡Œä¸‹è½½ï¼ˆè¿™é‡Œæˆ‘ä»¬ä¸‹è½½åˆ°~/Downloads/ï¼‰ï¼Œå‘½ä»¤å¦‚ä¸‹ï¼š 1pi@raspberrypi:~/Downloads $ wget http://download.oray.com/peanuthull/embed/phddns_raspberry.tgz ä¸‹è½½ä¸‹æ¥çš„æ–‡ä»¶å« phddns_raspberry.tgzï¼Œæˆ‘ä»¬å¯¹å…¶è¿›è¡Œè§£å‹ï¼š 123456pi@raspberrypi:~/Downloads $ tar zxvf phddns_raspberry.tgzphddns2/phddns2/oraynewphphddns2/oraynewph.tgzphddns2/oray_servephddns2/parse å®‰è£…æˆ‘ä»¬éœ€è¦ä½¿ç”¨rootè´¦å·æ¥å®‰è£…ï¼Œå¦åˆ™å¯èƒ½å‡ºç°æƒé™é—®é¢˜ï¼Œå¯¼è‡´å®‰è£…å¤±è´¥ã€‚sudo su åˆ‡æ¢åˆ°rootï¼Œä½¿ç”¨ ./oraynewph start æ‰§è¡Œå®‰è£…ã€‚ä¸‹é¢æ˜¯å®‰è£…è¿‡ç¨‹ï¼š 1234pi@raspberrypi:~/Downloads $ cd phddns2pi@raspberrypi:~/Downloads/phddns2 $ sudo suroot@raspberrypi:/home/pi/Downloads/phddns2# ./oraynewph start... é…ç½®åœ¨ä¸Šé¢çš„å®‰è£…æ—¥å¿—ä¸­æˆ‘ä»¬å¯ä»¥çœ‹åˆ°è¿™çš„æç¤ºä¿¡æ¯ï¼ˆä½ ä¹Ÿå¯ä»¥ä½¿ç”¨ oraynewph status å‘½ä»¤æ¥æŸ¥çœ‹æ­¤ä¿¡æ¯ï¼‰ï¼š 123SN:RAPIe*************Please visit http://b.oray.comOraynewph start success ! æŒ‰ç…§æç¤ºï¼Œæˆ‘ä»¬æ‰“å¼€ http://b.oray.com è¿™ä¸ªç½‘ç«™ï¼Œä½¿ç”¨ä¸Šé¢çš„SNç™»å½•ç³»ç»Ÿï¼ˆé»˜è®¤å¯†ç æ˜¯adminï¼Œç™»å½•åä¼šè¦æ±‚ä½ è®¾ç½®å¯†ç ï¼Œç»‘å®šèŠ±ç”Ÿå£³è´¦å·ç­‰ï¼Œå¦‚æœä½ æ²¡æœ‰ï¼Œé‚£éœ€è¦ä½ æ³¨å†Œä¸€ä¸ªï¼‰ï¼Œç™»å½•åå¦‚ä¸‹å›¾ï¼š æˆ‘ä»¬ç‚¹å‡»å†…ç½‘æ˜ å°„ï¼Œè¿›å…¥è®¾ç½®ç•Œé¢ï¼Œç‚¹å‡» æ·»åŠ é…ç½®ï¼Œå¦‚ä¸‹å›¾ï¼š ç»è¿‡å¦‚ä¸Šé…ç½®ï¼Œæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡åŸŸåæ¥è®¿é—®æˆ‘ä»¬æ”¾åœ¨å®¶é‡Œçš„æ ‘è“æ´¾ä¸Šçš„httpæœåŠ¡äº†ã€‚ç®€å•çš„ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤èµ·ä¸€ä¸ªhttpæœåŠ¡ï¼šsudo python -m SimpleHTTPServer 80 è¿›è¡Œæµ‹è¯•ã€‚ 0x02 èŠ±ç”Ÿå£³æœåŠ¡æ³¨å†ŒèŠ±ç”Ÿå£³é¦–å…ˆæˆ‘ä»¬éœ€è¦æ³¨å†Œä¸€ä¸ªèŠ±ç”Ÿå£³ï¼Œå¹¶èŠ±Â¥5è´­ä¹°ä¸€ä¸ªæ°¸ä¹…çš„äºŒçº§åŸŸåï¼Œè¿™ä¸ªå°±ä»‹ç»äº†ï¼Œç±»ä¼¼è¿™æ ·ï¼š è·¯ç”±å™¨ä¸Šç™»å½•èŠ±ç”Ÿå£³æ¥ä¸‹æ¥çš„æ“ä½œéƒ½æ˜¯åŸºäºè¿™ä¸ªå‰æçš„ã€‚å…ˆå›é¡¾ä¸‹æˆ‘çš„ç½‘ç»œæ‹“æ‰‘ï¼š æˆ‘ä½¿ç”¨çš„æ˜¯TP-Linkçš„è·¯ç”±å™¨ï¼Œå®½å¸¦ADSLæ‹¨å·æ˜¯åœ¨è¿™ä¸ªè·¯ç”±å™¨ä¸Šï¼Œè·¯ç”±å™¨æœ‰ä¸€ä¸ªå…¬ç½‘IPã€‚TP-Linkè·¯ç”±å™¨æ˜¯æ”¯æŒèŠ±ç”Ÿå£³æœåŠ¡çš„ã€‚æˆ‘ä»¬åœ¨è·¯ç”±å™¨ç™»å½•èŠ±ç”Ÿå£³è´¦å·åå³å¯é€šè¿‡ç™»å½•å¸å·ç»‘å®šçš„åŸŸåæ¥è®¿é—®è¿™ä¸ªå…¬ç½‘IPäº†ï¼ŒTP-Linkçš„è·¯ç”±å™¨ç™»å½•åçš„ä¿¡æ¯å¦‚ä¸‹ï¼š é…ç½®DMZå¯¹äºæŒ‚åœ¨è·¯ç”±å™¨ä¸‹çš„ Raspberry Pi ä»…ä»…ä¾é ä¸Šé¢çš„èŠ±ç”Ÿå£³é…ç½®è¿˜ä¸å¤Ÿçš„ã€‚æˆ‘ä»¬è¿˜éœ€è¦å¯ç”¨è·¯ç”±å™¨çš„DMZä¸»æœºåŠŸèƒ½ï¼Œä¸‹é¢æ˜¯å…³äºDMZçš„ä»‹ç»ï¼š åœ¨æŸäº›ç‰¹æ®Šæƒ…å†µä¸‹ï¼Œéœ€è¦è®©å±€åŸŸç½‘ä¸­çš„ä¸€å°è®¡ç®—æœºå®Œå…¨æš´éœ²ç»™å¹¿åŸŸç½‘ï¼Œä»¥å®ç°åŒå‘é€šä¿¡ï¼Œæ­¤æ—¶å¯ä»¥æŠŠè¯¥è®¡ç®—æœºè®¾ç½®ä¸ºDMZä¸»æœºã€‚ åªæœ‰å¯ç”¨äº†è¯¥åŠŸèƒ½åï¼Œå¯¹åº”çš„DMZä¸»æœºæ‰ä¼šç”Ÿæ•ˆã€‚ æ ¹æ®ä»‹ç»ï¼Œæˆ‘ä»¬åšä¸‹é¢çš„é…ç½®ï¼š è¿™æ ·å‘é€åˆ°æˆ‘ä»¬è·¯ç”±å™¨çš„æ‰€æœ‰è¯·æ±‚éƒ½ä¼šè¢«è½¬å‘åˆ°æˆ‘ä»¬çš„ Raspberry Piäº†ï¼Œæˆ‘ä»¬çš„ Raspberry Pi å°±æˆäº†å…¬ç½‘ä¸­çš„ä¸€å°ä¸»æœºäº†ã€‚ PSï¼šDMZä¸»æœºé…ç½®å¹¶ä¸æ˜¯ä¸€ä¸ªå®‰å…¨çš„é€‰æ‹©ï¼Œæ›´å®‰å…¨çš„é…ç½®æ˜¯åªå½±å°„æˆ‘ä»¬ä½¿ç”¨çš„ç«¯å£ï¼Œæ¯”å¦‚80ï¼Œ22ç­‰ å¥½äº†ï¼Œè¿™åŸºæœ¬ç®—æ˜¯æœ€åä¸€ç¯‡åŸºç¡€ä»‹ç»äº†ã€‚ä¸‹ä¸€ç¯‡å¼€å§‹ä»‹ç»æ ‘è“æ´¾æœ€å¸å¼•æˆ‘çš„åœ°æ–¹ GPIO æ“ä½œï¼Œæƒ³æƒ³éƒ½å…´å¥‹äº†ï½ï½","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"https://ttdevs.github.io/categories/æŠ€æœ¯/"}],"tags":[{"name":"ç©è½¬æ ‘è“æ´¾","slug":"ç©è½¬æ ‘è“æ´¾","permalink":"https://ttdevs.github.io/tags/ç©è½¬æ ‘è“æ´¾/"}]},{"title":"ã€Œç©è½¬æ ‘è“æ´¾ã€0x06DS18B20æ¸©åº¦æ£€æµ‹","slug":"[ç©è½¬æ ‘è“æ´¾]0x06DS18B20æ¸©åº¦æ£€æµ‹","date":"1969-12-31T16:00:00.000Z","updated":"2017-04-27T11:07:57.000Z","comments":true,"path":"1970/01/01/[ç©è½¬æ ‘è“æ´¾]0x06DS18B20æ¸©åº¦æ£€æµ‹/","link":"","permalink":"https://ttdevs.github.io/1970/01/01/[ç©è½¬æ ‘è“æ´¾]0x06DS18B20æ¸©åº¦æ£€æµ‹/","excerpt":"","text":"0x00 DS18B20æ¸©åº¦æ£€æµ‹Raspberry connect to DS18B20 éœ€è¦ä¸€ä¸ªèƒ½æµ‹é‡æ°´æ¸©çš„æ¸©åº¦è®¡ï¼Œæ·˜å®ä¹°äº†é«˜é€¼æ ¼çš„çº¢å¤–æ¸©æªï¼Œåˆ°æ‰‹åå‘ç°è¿™é¬¼ä¸œè¥¿ä¸èƒ½æµ‹é‡‘å±æ¯é‡Œçš„æ°´æ¸©ï¼ˆå¥½çš„å¤ªè´µï¼‰ã€‚ç„¶ååˆæ·˜å®äº†ä¸‹ï¼Œä¸€ä¸ªç”µå­æ¸©åº¦è®¡éƒ½å–ä¸‰ä½æ•°ï¼Œå¥½å§ï¼Œæˆ‘ç©·â€¦â€¦ å¿½ç„¶æƒ³èµ·æ‰‹ä¸Šæœ‰ä¸€ä¸ª DS18B20ï¼Œå—¯å—¯ï¼Œæ‹¿å‡ºæ¥è‡ªå·±åšä¸€ä¸ªæ¸©åº¦è®¡å§ï½ï½ DS18B20 è¿™ä¸ªä¼ æ„Ÿå™¨å¾ˆå¸¸è§ï¼ŒæŸå®ä¸Šä¸€æœä¸€è´­ç‰©è½¦ï¼Œä»·æ ¼5åˆ°10å…ƒä¸ç­‰ï¼Œå½“ç„¶ä¹Ÿæœ‰æ›´å¥½çš„ï¼ŒæŒ‰éœ€è´­ä¹°ï¼Œå¤§æ¦‚å‚æ•°å¦‚ä¸‹ï¼š ç‹¬ç‰¹çš„1-Wireæ€»çº¿æ¥å£ä»…éœ€è¦ä¸€ä¸ªç®¡è„šæ¥é€šä¿¡ã€‚ æ¯ä¸ªè®¾å¤‡çš„å†…éƒ¨ROMä¸Šéƒ½çƒ§å†™äº†ä¸€ä¸ªç‹¬ä¸€æ— äºŒçš„64ä½åºåˆ—å·ã€‚ å¤šè·¯é‡‡é›†èƒ½åŠ›ä½¿å¾—åˆ†å¸ƒå¼æ¸©åº¦é‡‡é›†åº”ç”¨æ›´åŠ ç®€å•ã€‚ æ— éœ€å¤–å›´å…ƒä»¶ã€‚ èƒ½å¤Ÿé‡‡ç”¨æ•°æ®çº¿ä¾›ç”µï¼›ä¾›ç”µèŒƒå›´ä¸º3.0Vè‡³5.5Vã€‚ æ¸©åº¦å¯æµ‹é‡èŒƒå›´ä¸ºï¼š-55â„ƒè‡³+125â„ƒï¼ˆ-67â„‰è‡³+257â„‰ï¼‰ã€‚ æ¸©åº¦èŒƒå›´è¶…è¿‡-10â„ƒè‡³85â„ƒä¹‹å¤–æ—¶å…·æœ‰+-0.5â„ƒçš„ç²¾åº¦ã€‚ï¼ˆæ€€ç–‘æœ‰è¯¯ï¼‰ å†…éƒ¨æ¸©åº¦é‡‡é›†ç²¾åº¦å¯ä»¥ç”±ç”¨æˆ·è‡ªå®šä¹‰ä¸º9-Bitsè‡³12-Bitsã€‚ DS18B20 åˆ†è¾¨ç‡å¯ç¼–ç¨‹ 1-Wireæ•°å­—æ¸©åº¦ä¼ æ„Ÿå™¨ æ¸©åº¦è½¬æ¢æ—¶é—´åœ¨è½¬æ¢ç²¾åº¦ä¸º12-Bitsæ—¶è¾¾åˆ°æœ€å¤§å€¼750msã€‚ ç”¨æˆ·è‡ªå®šä¹‰éæ˜“å¤±æ€§çš„çš„æ¸©åº¦æŠ¥è­¦è®¾ç½®ã€‚ Â· å®šä¹‰äº†æ¸©åº¦æŠ¥è­¦æœç´¢å‘½ä»¤å’Œå½“æ¸©åº¦è¶…è¿‡ç”¨æˆ·è‡ªå®šä¹‰çš„è®¾å®šå€¼æ—¶ã€‚ å¯é€‰æ‹©çš„8-Pin SO (150 mils), 8-PinÎ¼SOPï¼ŒåŠ3-Pin TO-92å°è£…ã€‚ Â· ä¸DS1822ç¨‹åºå…¼å®¹ã€‚ åº”ç”¨äºæ¸©åº¦æ§åˆ¶ç³»ç»Ÿï¼Œå·¥ä¸šç³»ç»Ÿï¼Œæ°‘ç”¨äº§å“ã€‚ å—¯å—¯ï¼Œå¾ˆå¤šæŠ€æœ¯å‚æ•°ï¼Œä½œä¸ºå¤–è¡Œäººçœ‹ç€å°±æ™•ã€‚è¿™é‡Œå…³æ³¨å‡ ä¸ªç»†èŠ‚å°±å¥½ï¼š ç”µå‹ï¼š3.0Vï½5.5V æ¸©åº¦èŒƒå›´ï¼š-55â„ƒè‡³+125â„ƒ æµ‹é‡ç²¾åº¦ï¼šå¯è°ƒï¼Œ0.5â„ƒå¯¹æˆ‘æ¥è¯´å¯æ¥å—ï¼Œæ‰€ä»¥æš‚æ—¶æ²¡å»ç»†ç©¶ æ¥ä¸‹æ¥ç»“åˆæˆ‘çš„æ ‘è“æ´¾çš„æ¿å­ï¼Œç»™å¤§å®¶æ¼”ç¤ºå¦‚ä½•ä½¿ç”¨ã€‚ 0x01 ä½¿ç”¨é¦–å…ˆæŒ‰ç…§ç½‘ä¸Šçš„æ–¹æ³•ï¼Œæ¯”å¦‚vvbbbbbï¼Œä¸€æ­¥æ­¥æ“ä½œï¼Œéš¾å…é‡åˆ°ä¸€äº›å‘ï¼Œæˆ‘çš„é—®é¢˜æ˜¯æ€ä¹ˆéƒ½ä¸èƒ½è¯†åˆ«è¿™ä¸ªä¼ æ„Ÿå™¨ï¼Œåæ¥æ‰¾äº†å¾ˆä¹…ï¼Œæ— æ„ä¸­è§£å†³äº†ï¼Œç»“åˆæˆ‘çš„å®é™…ï¼Œåšç®€å•è®°å½•ï¼Œå…·ä½“æ“ä½œå¦‚ä¸‹ï¼š è¿æ¥ä¼ æ„Ÿå™¨å’ŒRaspberry Pi DS18B20 æœ‰ä¸‰ä¸ªé’ˆè„šï¼Œåˆ†åˆ«æ˜¯ VCC çº¢è‰²ï¼Œè¿ Raspberry Pi çš„ VCCï¼Œæµ‹è¯•è¿æ¥ 3V3 æˆ– 5V5 éƒ½å¯ä»¥ DATA é»„è‰²ï¼Œè¿ Raspberry Pi çš„ GPIO4 GND é»‘è‰²ï¼Œè¿ Raspberry Pi çš„ GND å¦å¤–å’Œéœ€è¦åœ¨ç”¨ä¸€ä¸ª 4.7K çš„ç”µé˜»è¿æ¥ VCC å’Œ DATA ï¼ˆåˆ«é—®æˆ‘ä¸ºä»€ä¹ˆï¼Œæˆ‘ä¹Ÿä¸çŸ¥é“ï¼Œå¤§å­¦æ¨¡ç”µå­¦çš„é‚£å«ä¸€ä¸ªæ¸£ï¼‰ï¼Œå¦‚æœä½ æ²¡æœ‰ 4.7K çš„ç”µé˜»ï¼Œå¬è¯´å¤§ä¸€ç‚¹æˆ–è€…å°ä¸€ç‚¹éƒ½å¯ä»¥ï¼Œæˆ‘æ²¡è¯•ï¼Œåæ­£æˆ‘æœ‰ã€‚å¦‚æœä½ è¿ç”µé˜»éƒ½æ²¡æœ‰ï¼Œå‘Šè¯‰ä½ æŸå®ä¸Šæœ‰æ‰“åŒ…ä¸€è¢‹å‡ºå”®çš„ï¼Œå¸¸ç”¨é˜»å€¼çš„éƒ½æœ‰ï¼Œå¾ˆä¾¿å®œï¼Œå€¼å¾—ä½ å…¥æ‰‹ã€‚å¥½äº†ï¼Œæœ€ç»ˆç”µè·¯å¦‚å›¾ï¼š æ“ä½œ æ›´æ–°ç³»ç»Ÿ å¦‚æœä½ çš„ç³»ç»Ÿç‰ˆæœ¬æ¯”è¾ƒæ—§ï¼Œå»ºè®®ä½ æ›´æ–°ï¼Œå¦åˆ™è·³è¿‡è¿™ä¸€æ­¥ï¼š 12sudo apt-get updatesudo apt-get upgrade æ›´æ–°é€Ÿåº¦è§†ä½ çš„ç½‘é€Ÿå’Œæºçš„é€Ÿåº¦ï¼Œæ€ä¹ˆåˆ‡æ¢æºï¼Œå¯ä»¥å‚è€ƒæˆ‘ä¹‹å‰çš„æ–‡ç« ã€‚ 1. å¯ç”¨ `1-Wire` - ç»ˆç«¯æ‰§è¡Œ `sudo raspi-config`ï¼Œæ‰“å¼€é…ç½®ç•Œé¢ï¼Œæ‰¾åˆ° `1-Wire`ï¼ˆæˆ‘çš„ä½äº`Interfacing Option` ä¸‹ï¼Œä¸åŒç‰ˆæœ¬ä¸ä¸€æ ·ï¼Œæœ‰çš„å¯èƒ½åœ¨ `Advanced Options` ä¸‹ï¼‰å¯ç”¨å®ƒã€‚ - ä½ ä¹Ÿå¯ä»¥ç›´æ¥é…ç½®ï¼šç¼–è¾‘ `/boot/config.txt` ï¼Œåœ¨æœ€åä¸€è¡Œæ·»åŠ  `dtoverlay=w1-gpio` ä¿å­˜å³å¯ã€‚ 1. ç»ˆç«¯è¾“å…¥ï¼š`sudo nano /boot/config.txt` 2. `Ctrl+V` æ»šåˆ°æœ€ä¸‹é¢ï¼Œè¾“å…¥ `dtoverlay=w1-gpio` 3. `Ctrl+O` ä¿å­˜ï¼Œ`Ctrl+X` é€€å‡º ä¸¤ä¸ªæ–¹æ³•ç»“æœä¸€æ ·ï¼Œæ“ä½œå®Œæˆä¹‹åéœ€è¦é‡å¯æœºå™¨ï¼Œå‘½ä»¤ï¼š`sudo reboot` 2. æŸ¥çœ‹ä½ çš„ä¼ æ„Ÿå™¨ 1234567pi@raspberrypi:~ $ cd /sys/bus/w1/devicespi@raspberrypi:/sys/bus/w1/devices $ ls28-031561d43aff w1_bus_master1pi@raspberrypi:/sys/bus/w1/devices $ cat 28-031561d43aff/w1_slave48 01 01 01 1f ff 0c 10 04 : crc=04 YES48 01 01 01 1f ff 0c 10 04 t=20500pi@raspberrypi:/sys/bus/w1/devices $ å…ˆæŸ¥çœ‹ `w1` è®¾å¤‡åˆ—è¡¨ï¼Œç„¶åæŸ¥çœ‹é‡Œé¢çš„ `w1_slave` æ–‡ä»¶å†…å®¹ï¼Œå³å¯æ˜¾ç¤ºå‡ºæ¸©åº¦ä¿¡æ¯ï¼ˆè¿™ä¸ªæ¸©åº¦ä¿¡æ¯å¹¶ä¸æ˜¯æˆ‘ä»¬æœ€ç»ˆçš„æ¸©åº¦ï¼Œéœ€è¦ç»è¿‡ä¸€å®šçš„æ¢ç®—ï¼‰ã€‚ `å‰æ–¹é«˜èƒ½` `å‰æ–¹å¡«å‘` å—¯å—¯ï¼Œå‘å‡ºç°äº†ï¼Œæˆ‘çš„åœ¨æŸ¥çœ‹ä¼ æ„Ÿå™¨çš„æ—¶å€™æ˜¾ç¤ºå¦‚ä¸‹ï¼š 1234pi@raspberrypi:~$ cd /sys/bus/w1/devices/pi@raspberrypi:/sys/bus/w1/devices $ ls00-600000000000 00-a00000000000 00-e00000000000 w1_bus_master1pi@raspberrypi:/sys/bus/w1/devices $ ç½‘ä¸Šçœ‹åˆ°çš„éƒ½æ˜¯ `28-xxxxxxxxxxxxxx` è¿™æ ·çš„ä¿¡æ¯ï¼Œè€Œæˆ‘çš„å´ä¸æ˜¯ï¼›è¿™äº›ç›®å½•ä¸‹ä¹Ÿæ²¡æœ‰ `w1_slave`æ–‡ä»¶ï¼›è€Œä¸”æ¯æ¬¡è¿›è¿™ä¸ªç›®å½• `/sys/bus/w1/devices` è¿™äº›æ–‡ä»¶å¤¹çš„åå­—å’Œæ•°é‡éƒ½æœ‰å¯èƒ½ä¼šå˜ã€‚å¥½å§ï¼Œæ‡µé€¼äº†ã€‚æ‰€ä»¥å»æ‰¾ç­”æ¡ˆï¼Œæœç„¶ä¹Ÿæœ‰ä¸€äº›äººååº”è¿‡è¿™ä¸ªé—®é¢˜ï¼Œä½†å¤§éƒ¨åˆ†å¯¹æˆ‘éƒ½æ²¡ç”¨ï¼Œæ¯”å¦‚ VCC ä» 3V3 æ¢åˆ° 5V5 ï¼Œçœ‹çœ‹æ—¶é—´ï¼Œåˆå¿«12ç‚¹äº†ï¼Œæƒ³æ”¾å¼ƒäº†éƒ½ã€‚æ­¤æ—¶[ä½›å…‰ä¹ç°](https://www.raspberrypi.org/forums/viewtopic.php?f=28&amp;t=106041)ï¼šå¯èƒ½æ˜¯ `GPIO` å£çš„é—®é¢˜ï¼Œå¯ä»¥æ¢ä¸€ä¸ªè¯•è¯•ï¼Œä¸€è¯•æœç„¶å¾ˆçˆ½ï¼Œæ“ä½œå¦‚ä¸‹ï¼š ç¼–è¾‘ `/boot/config.txt`ï¼Œå°†åˆšæ‰æ·»åŠ çš„é‚£è¡Œä¿®æ”¹å¦‚ä¸‹ `dtoverlay=w1-gpio,gpiopin=5,pullup=on` è¿™é‡Œçš„ `5` æ˜¯å¯¹åº”çš„GPIOå£ï¼Œä½ ä¹Ÿå¯ä»¥ç”¨å…¶ä»–çš„ï¼Œé«˜å…´å°±å¥½ã€‚ä¿å­˜é‡å¯å³å¯ã€‚ 3. æŸ¥çœ‹æ¸©åº¦æ•°æ® 1234pi@raspberrypi:/sys/bus/w1/devices $ cat 28-031561d43aff/w1_slave48 01 01 01 1f ff 0c 10 04 : crc=04 YES48 01 01 01 1f ff 0c 10 04 t=20500pi@raspberrypi:/sys/bus/w1/devices $ è¿™é‡Œçš„ `t=20500` åº”è¯¥å°±æ˜¯æ¸©åº¦æ•°æ®ï¼Œä¸çŸ¥é“ `crc=40` æ˜¯ä¸æ˜¯æ ¡éªŒæ•°æ®ï¼Œä¸ç®¡äº†ï¼Œæˆ‘ä¹Ÿæ²¡æ—¶é—´å»è®¡ç®—ã€‚ç½‘ä¸Šè‚¯å®šæœ‰ç°æˆçš„è½®å­æ¥å±•ç¤ºï¼Œè¿™é‡Œæ¨è [w1thermsensor](https://github.com/timofurrer/w1thermsensor)ã€‚ - å®‰è£… `pip install w1thermsensor` - ä½¿ç”¨(ds18b20.py) 12345from w1thermsensor import W1ThermSensorsensor = W1ThermSensor(W1ThermSensor.THERM_SENSOR_DS18B20, \"031561d43aff\")while True: temperature_in_celsius = sensor.get_temperature() print temperature_in_celsius è¿™é‡Œçš„ä¸€ä¸ªå¸¸é‡ `031561d43aff` å°±æ˜¯ `28-031561d43aff` è¿™é‡Œçš„ååŠéƒ¨åˆ†ï¼Œä½ çš„å¯èƒ½è·Ÿæˆ‘ä¸ä¸€æ ·ï¼Œè¯·æ”¹æˆä½ è‡ªå·±çœ‹åˆ°çš„ã€‚ æ‰§è¡Œï¼š 123456789pi@raspberrypi:~/python $ cat ds18b20.pyfrom w1thermsensor import W1ThermSensorsensor = W1ThermSensor(W1ThermSensor.THERM_SENSOR_DS18B20, \"031561d43aff\")while True: temperature_in_celsius = sensor.get_temperature() print temperature_in_celsiuspi@raspberrypi:~/python $ python ds18b20.py21.021.0 å®Œç¾ï½ 0xFF å‚è€ƒ https://datasheets.maximintegrated.com/en/ds/DS18B20.pdf http://www.wendangku.net/doc/529cf93fc281e53a5802fff5.html http://blog.csdn.net/vvbbbbb/article/details/52053293 https://www.raspberrypi.org/forums/viewtopic.php?f=28&amp;t=106041","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"https://ttdevs.github.io/categories/æŠ€æœ¯/"}],"tags":[{"name":"ç©è½¬æ ‘è“æ´¾","slug":"ç©è½¬æ ‘è“æ´¾","permalink":"https://ttdevs.github.io/tags/ç©è½¬æ ‘è“æ´¾/"}]},{"title":"ã€Œç©è½¬æ ‘è“æ´¾ã€0x05GPIO","slug":"[ç©è½¬æ ‘è“æ´¾]0x05GPIO","date":"1969-12-31T16:00:00.000Z","updated":"2017-04-27T11:07:57.000Z","comments":true,"path":"1970/01/01/[ç©è½¬æ ‘è“æ´¾]0x05GPIO/","link":"","permalink":"https://ttdevs.github.io/1970/01/01/[ç©è½¬æ ‘è“æ´¾]0x05GPIO/","excerpt":"","text":"GPIOï¼šGeneral Purpose Input/Output pins on the Raspberry Pi General purpose input/output; in this specific case the pins on the Raspberry Pi and what you can do with them. So called because you can use them for all sorts of purposes; most can be used as either inputs or outputs, depending on your program. 0x00 GPIOæœ‰äº›äº‹æƒ…åšæŒäº†ï¼Œå°±åšå‡ºæ¥äº†ï¼Œä¸åšæŒï¼Œå°±æ”¾å¼ƒäº†ï¼Œå°±è¿™ä¹ˆç®€å•ã€‚ä¹‹å‰æƒ³å†™ä¸ªæ ‘è“æ´¾çš„å…¥é—¨æ–‡ç« ï¼Œä¸€ä¸‹å­å†™äº†å‡ ç¯‡ä¹‹åï¼Œå°±åœä¸‹æ¥äº†ã€‚å¯èƒ½æœ€è¿‘ç¡®æ˜¯æ¯”è¾ƒå¿™ï¼Œæˆ–è€…ï¼Œæ‰¿è®¤æ²¡æœ‰ä¸¥æ ¼è¦æ±‚è‡ªå·±ï¼Œå¥½å§ï¼Œæ‹–äº†è¿™ä¹ˆä¹…ï¼Œä»Šå¤©ï¼Œå†å†™ä¸€ç¯‡ã€‚ ä¸ç®¡ä½ ä¿¡ä¸ä¿¡ï¼Œæ ‘è“æ´¾æœ€å¸å¼•æˆ‘çš„å°±æ˜¯å®ƒçš„GPIOå£ã€‚å³ä½¿æ˜¯ç°åœ¨ï¼Œæƒ³åˆ°GPIOè¿˜æ˜¯éå¸¸çš„å…´å¥‹å‘¢ã€‚ä¸ºä»€ä¹ˆå‘¢ï¼Ÿå¯¹äºé€šç”¨è®¡ç®—æœºï¼Œæˆ‘ä»¬èƒ½æ“ä½œçš„åŸºæœ¬éƒ½æ˜¯USBã€ä¸²å£ç­‰ä¸€äº›æ¥å£ã€‚ä¸è¿™äº›æ¥å£ç›¸æ¯”ï¼ŒGPIOå£æœ‰æ˜æ˜¾çš„ä¸åŒï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥æ“ä½œä¸€ä¸ªIOå£çš„çŠ¶æ€ï¼šæ˜¯é«˜ç”µå¹³è¿˜æ˜¯ä½ç”µå¹³ã€‚æ ¹æ®è¿™ä¸ªç‰¹æ€§ï¼Œæˆ‘ä»¬å°±å¯ä»¥å®Œæˆé¦–æ¬¡æ¥è§¦å•ç‰‡æœºå®Œæˆçš„å°å®éªŒï¼šæ§åˆ¶æˆ‘ä»¬çš„LEDç¯ï¼Œåˆ¶ä½œè·‘é©¬ç¯ï¼Œæ¨¡æ‹Ÿäº¤é€šç¯ç­‰ç­‰æœ‰è¶£çš„å®éªŒã€‚å¦‚æœä½ æƒ³é€šè¿‡å…¶ä»–è®¾å¤‡æ¥å®Œæˆè¿™äº›æ“ä½œï¼Œå¯èƒ½éœ€è¦æŒæ¡å…¶ä»–å¯¹åˆå­¦è€…æ¥è¯´æ¯”è¾ƒå›°éš¾çš„æŠ€æœ¯ã€‚å¦å¤–ï¼Œå¤§å­¦æ—¶æœŸæœ‰ç©è¿‡ 89C51ï¼Œå¯¹IOå£è¿˜æ˜¯æ‹æ‹ä¸èˆï¼Œæ›¾ç»æƒ³é€šè¿‡å…¶äº§ç”ŸPWMä¿¡å·æ§åˆ¶èˆµæœºï¼Œå¾ˆé—æ†¾æ²¡å®ç°ï¼Œç°åœ¨æ­£å¥½å¯ä»¥å®Œæˆè¿™ä¸ªå¿ƒæ„¿ã€‚ 0x01 ä»ä¸€ä¸ªLEDè¯´å¼€å»è¿™æ˜¯ä¸€ç¯‡å¾ˆåŸºç¡€çš„æ–‡ç« ï¼Œæ‰€ä»¥ä¼šæ¯”è¾ƒé€šä¿—ã€‚é¦–å…ˆæˆ‘ä»¬é€šè¿‡LEDçš„Demoæ¥äº†è§£ä¸‹ä»€ä¹ˆæ˜¯GPIOã€‚å…ˆçœ‹ä¸€å¼ åŸç†å›¾ï¼š è¿™æ˜¯ä¸€ä¸ªéå¸¸ç®€å•çš„ç”µè·¯ï¼šä¸€ä¸ªå‘å…‰äºŒæç®¡ã€ä¸€ä¸ªç”µé˜»ï¼ˆ300Î©å·¦å³ï¼Œå¿˜è®°æ€ä¹ˆç®—çš„äº†ï¼‰ã€ä¸€ä¸ªRapsberry Piã€‚ç”±äºRapsberry Pi GPIOå£è¾“å‡ºç”µå‹æ˜¯3V3ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸²ä¸€ä¸ªç”µé˜»æ¥ä¿æŠ¤æˆ‘ä»¬çš„LEDã€‚å½“æˆ‘ä»¬é€šè¿‡ä»£ç æ§åˆ¶é“¾æ¥ç”µé˜»çš„é‚£ä¸ªGPIOå£çŠ¶æ€æ—¶ï¼Œå°±å¯ä»¥ä½¿LEDåœ¨äº®å’Œç­ä¹‹é—´åˆ‡æ¢ã€‚ 12345678910111213141516171819import RPi.GPIO as GPIOimport timeGPIO.setmode(GPIO.BCM)GPIO.setwarnings(False)led = 23GPIO.setup(led, GPIO.OUT)try: while(True): GPIO.output(led, 1) time.sleep(1) GPIO.output(led, 0) time.sleep(1)except Exception as e: print(e)finally: GPIO.cleanup() è¿è¡Œä¸Šé¢çš„ä»£ç ï¼Œæˆ‘ä»¬å°±å¯ä»¥çœ‹åˆ°LEDä¸¤ç§’ä¸€ä¸ªå¾ªç¯çš„äº®ç­ã€‚å“ˆå“ˆï¼Œæ˜¯ä¸æ˜¯ç‰¹æœ‰æˆå°±æ„Ÿï¼Œä¼ è¯´ä¸­çš„ç‚¹äº®å°ç¯æ³¡ç»ˆäºå®ç°äº†ï½ï½ ç„¶å¹¶åµï¼Œè¿™å¹¶æ²¡æœ‰ä»€ä¹ˆå®é™…çš„ç”¨å¤„ã€‚ä¸‹é¢å†ä»‹ç»ä¸€ä¸ªå±Œå±Œçš„demoï¼Œé€šè¿‡HC-SR501äººä½“çº¢å¤–ä¼ æ„Ÿå™¨æ£€æµ‹æ§åˆ¶LEDçš„äº®ç­ï¼Œå®é™…çš„ä¾‹å­çš„å°±æ˜¯å¾ˆå¤šè‡ªåŠ¨é—¨ï¼Œç«™åœ¨é—¨ä¸‹é¢çš„æ—¶å€™é—¨ä¼šè‡ªåŠ¨æ‰“å¼€ã€‚ HC-SR501 å®ƒæ˜¯é•¿è¿™ä¸ªæ ·å­æ»´ï¼š (PS:ä»¥ä¸Šå›¾ç‰‡æ¥è‡ªä¸¤ä¸ªæ·˜å®å–å®¶) ä¸‰ä¸ªé’ˆè„šï¼šVCCã€OUTã€GNDï¼Œå¦å¤–è¿˜æœ‰ä¸€ä¸ªæ˜¯å¦è¿ç»­ç›‘æµ‹çš„é’ˆè„šï¼Œè¿ç»­æ—¶æ˜¯Hï¼Œä¸è¿ç»­æ—¶æ˜¯Lï¼Œé»˜è®¤æ˜¯Hï¼Œçœ‹ä½ ä¹°çš„å…·ä½“è®¾è®¡äº†ã€‚å¦å¤–è¿˜æœ‰ä¸¤ä¸ªè°ƒèŠ‚æ—‹é’®ï¼Œå¦‚ä¸Šå›¾ã€‚å…¶å®è¿™ä¸ªä¼ æ„Ÿå™¨ç‰¹ç®€å•ï¼Œä¾›ç”µç”µå‹5åˆ°20Vï¼Œè¾“å‡º0æˆ–è€…3V3ä¸¤ä¸ªçŠ¶æ€ï¼Œä¸ç”¨ä¸ Raspiberry Pi è¿æ¥ï¼Œä¹Ÿå¯ä»¥ç›´æ¥å½“ä½œå¼€å…³ä½¿ç”¨ã€‚å¦å¤–æˆ‘è¿˜æ¥äº†ä¸€ä¸ªè‡ªé”å¼€å…³ï¼Œæ§åˆ¶æ•´ä¸ªç”µè·¯çš„å¼€å…³ã€‚å¦‚ä¸‹å›¾ï¼š æ¥ç€ä¸Šæºç ï¼š import RPi.GPIO as GPIO import time GPIO.setmode(GPIO.BCM) GPIO.setwarnings(False) led = 25 GPIO.setup(led, GPIO.OUT) swtich = 22 GPIO.setup(swtich, GPIO.IN, GPIO.PUD_UP) hcsr501 = 23 GPIO.setup(hcsr501, GPIO.IN, GPIO.PUD_UP) try: GPIO.output(led, 0) while(True): print(str(GPIO.input(swtich)) + '||' + str(GPIO.input(hcsr501))) if GPIO.input(swtich) == True: if GPIO.input(hcsr501) == True: GPIO.output(led, 1) else: GPIO.output(led, 0) else: GPIO.output(led, 0) time.sleep(1) except Exception as e: print(e) finally: GPIO.cleanup() å½“æˆ‘ä»¬æŠŠå¼€å…³æ‰“å¼€ï¼Œç»è¿‡äººä½“çº¢å¤–ä¼ æ„Ÿå™¨çš„æ—¶å€™LEDï¼ˆè¿™ä¸ªåœ°æ–¹æˆ‘ç”¨çš„æ˜¯3V3çš„é«˜äº®LEDï¼Œæ‰€ä»¥æ²¡æœ‰æ¥ç”µé˜»ï¼‰å°±ä¼šäº®ã€‚æŠŠè¿™ä¸ªä¸œè¥¿æ”¾åœ¨æˆ¿é—´é‡Œï¼Œæ™šä¸Šä¸‹ç­å¼€é—¨å°±å¯ä»¥è‡ªåŠ¨å¼€ç¯äº†ã€‚å¦‚æœä½ æœ‰å…´è¶£ï¼Œè¿˜å¯ä»¥æŠŠé‡Œé¢çš„å¼€å…³æ¢æˆä¸€ä¸ªå…‰çº¿ä¼ æ„Ÿå™¨ï¼Œé‚£æ ·å°±æ›´å®Œç¾äº†ï½ï½ è¿è¡Œä¸Šé¢çš„ä»£ç ï¼Œæˆ‘ä»¬éœ€è¦å®‰è£… RPi.GPIO åº“ï¼ŒRaspbian é»˜è®¤æ˜¯å®‰è£…å¥½äº†ã€‚ç®€å•çš„æµè§ˆä¸Šé¢çš„ä»£ç ï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œé¦–å…ˆè®¾ç½® GPIO modeï¼Œè¿™é‡Œè®¾ç½®ä¸ºBCMï¼›ç„¶åå®šä¹‰GPIOçš„çŠ¶æ€ï¼ŒGPIOå£æˆ‘ä»¬å¯ä»¥å®šä¹‰ä¸¤ç§çŠ¶æ€ï¼ŒGPIO.IN å’Œ GPIO.OUTï¼Œåˆ†åˆ«å¯¹åº”è¾“å…¥å’Œè¾“å‡ºï¼›æœ€åå°±æ˜¯æ“ä½œæˆ‘ä»¬çš„GPIOå£äº†ã€‚ç”±äºRPi.GPIO åº“å·²ç»ç»™æˆ‘ä»¬å°è£…å¤æ‚çš„æ“ä½œï¼Œæ‰€ä»¥æˆ‘ä»¬ç”¨èµ·æ¥ç‰¹åˆ«ç®€ä¾¿ã€‚æ›´å¤šå¯ RPi.GPIO ä¿¡æ¯å¯å‚è€ƒè¿™é‡Œã€‚ 0x02 Raspberry Piçš„GPIOé’ˆè„šæ ¹æ®ä¸Šé¢çš„demoç¨‹åºï¼Œæˆ‘ä»¬å†æ¥è¯¦ç»†çš„ä»‹ç»ä¸‹GPIOã€‚ GPIO.setmode() æŒ‡å®šé’ˆè„šçš„ç¼–å·æ–¹å¼ï¼Œè¿™é‡Œæœ‰ä¸¤ç§é€‰æ‹©ï¼š GPIO.BOARD ä½¿ç”¨é’ˆè„šçš„ç‰©ç†é¡ºåºæ¥ç¼–å· GPIO.BCM Broadcom SoC çš„ç¼–ç æ–¹å¼ å…·ä½“çš„å¯å‚è€ƒä¸‹é¢è¿™å¼ å›¾ï¼Œå…¶ä¸­ Pin åˆ—ä»£è¡¨çš„æ˜¯ GPIO.BOARD æ–¹å¼çš„ç¼–ç ï¼Œ è€Œ NAME åˆ—ä»£è¡¨çš„æ˜¯GPIO.BCM æ–¹å¼çš„ç¼–ç ã€‚ ä¸åŒç‰ˆæœ¬çš„ Raspberry Pi ä¼šæœ‰ä¸åŒçš„é’ˆè„šåˆ†å¸ƒï¼Œé™¤æŸ¥é˜…ç›¸å…³èµ„æ–™å¤–ï¼Œå¯ä»¥æ‰§è¡Œä¸‹é¢å‘½ä»¤æŸ¥çœ‹ï¼špi@raspberrypi:~ $ gpio readall GPIO.setwarnings(True or False) å½“æˆ‘ä»¬æœ‰å¤šä¸ªè„šæœ¬åœ¨æ“ä½œåŒä¸€ä¸ªGPIOå£æ—¶å¯èƒ½ä¼šå‡ºç°è­¦å‘Šï¼Œé€šè¿‡è¿™ä¸ªè®¾ç½®æ¥é€‰æ‹©æ˜¯å¦å¿½ç•¥ GPIO.setup(channel, GPIO.OUT, initial=GPIO.HIGH) è®¾ç½®GPIOå£çš„çŠ¶æ€ï¼Œå‚æ•°åˆ†åˆ«ä¸ºï¼šé’ˆè„šåºå·ã€è¾“å…¥è¿˜æ˜¯è¾“å‡ºã€åˆå§‹çŠ¶æ€é«˜ç”µå¹³è¿˜æ˜¯ä½ç”µå¹³ã€‚ GPIO.input(channel) è·å–æŒ‡å®šGPIOå£çš„çŠ¶æ€ GPIO.output(channel, GPIO.HIGH) æ“ä½œGPIOå£çš„è¾“å‡ºçŠ¶æ€ GPIO.cleanup() æ¸…é™¤å½“å‰æ“ä½œçš„æ‰€æœ‰GPIOå£çš„çŠ¶æ€ï¼Œæ¢å¤ä¸ºè¾“å…¥çŠ¶æ€ã€‚å¥½çš„åšæ³•æ˜¯æ¯æ¬¡ä½¿ç”¨å®Œéƒ½æ¸…é™¤ä¸€ä¸‹ã€‚ è¿™å°±æ˜¯ä¸€ä¸ªç®€å•å®Œæ•´çš„ä½¿ç”¨ python æ“ä½œ GPIOçš„æµç¨‹ã€‚è™½ç„¶çœ‹åˆ°çš„ç°è±¡ï¼Œçœ‹åˆ°çš„ä»£ç ï¼Œä½†æ˜¯ä½ è¿˜ä¼šé—®ï¼šGPIOåˆ°åº•æ˜¯ä¸ªå•¥æ ·çš„ä¸œè¥¿ï¼Œæˆ‘ä»¬è®¾ç½®ä¸åŒçš„çŠ¶æ€æ—¶å®ƒçš„ç”µå‹æ—¶æ€æ ·çš„ï¼Ÿå®ƒçš„é©±åŠ¨èƒ½åŠ›å¦‚ä½•ï¼Ÿä»€ä¹ˆæ ·çš„æ“ä½œå¯èƒ½å¯¼è‡´çƒ§æ¯GPIOï¼Ÿ Raspberry Pi 2 Model B ä½¿ç”¨äº† BCM2836èŠ¯ç‰‡ï¼ŒRaspberry Pi Model A, B, B+, Compute Module and Raspberry Pi Zeroä½¿ç”¨äº†BCM2835èŠ¯ç‰‡ï¼Œè¿™é‡Œæˆ‘ä»¬ä»¥BCM2835ä¸ºä¾‹ï¼ˆä½œä¸ºä¸€èˆ¬ä½¿ç”¨è€…ï¼Œå¯ä»¥ä¸å…³å¿ƒè¿™ä¸ªï¼‰ã€‚BCM2835æœ‰3ä¸ªGPIO bankï¼Œè¿™ä¸ª3ä¸ªbankéƒ½æœ‰è‡ªå·±çš„VDDï¼Œå¹¶ä¸”ç”±3V3ç”µå‹æä¾›æ”¯æŒã€‚å¦‚æœæˆ‘ä»¬çš„è¾“å…¥ç”µå‹è¶…è¿‡3V3ï¼Œå°±æœ‰å¯èƒ½çƒ§æ¯SoCä¸Šçš„GPIO bankã€‚ç”±äºæˆ‘ä¹Ÿæ˜¯ä¸šä½™çš„ï¼Œè¯´çš„å†ä¸“ä¸šæˆ‘ä¹Ÿå¬ä¸æ‡‚ï¼Œå› æ­¤ç®€å•çš„æ¥è¯´ï¼Œä½¿ç”¨å¤–éƒ¨ä¼ æ„Ÿå™¨ï¼Œå®ƒçš„è¾“å…¥ä¿¡å·ç”µå‹æ˜¯3V3çš„å°±æ²¡é—®é¢˜ã€‚å½“ç„¶ï¼Œä¼ æ„Ÿå™¨çš„é©±åŠ¨ç”µå‹å¯ä»¥ä¸æ˜¯3V3ã€‚æ¯”å¦‚ä¸Šé¢ä½¿ç”¨çš„ HC-SR501 å®ƒçš„é©±åŠ¨ç”µå‹æ˜¯5Vï¼Œè¾“å…¥ä¿¡å·ç”µå‹æ˜¯3V3ï¼Œè¿™æ ·æ¥åœ¨å¤–é¢çš„ Raspberry Pi å°±å®Œå…¨æ²¡é—®é¢˜ï¼Œè€Œä¸”ä¸éœ€è¦é¢å¤–ç”µæºä¸ºå…¶ä¾›ç”µï¼Œå› ä¸º Raspberry Pi 2 Model B æœ‰ä¸¤ä¸ª5Vçš„é’ˆè„šï¼ˆå°±æ˜¯å³ä¸Šè§’çš„ä¸¤ä¸ªï¼Œ2å’Œ4ï¼‰ã€‚ æ›´å¤šçš„å…³äºGPIOçš„ä¸Šæ‹‰ä¸‹æ‹‰æ‚¬æµ®ç­‰çŠ¶æ€ï¼Œå¯ä»¥å‚è€ƒè¿™é‡Œçš„ä»‹ç»ã€‚ 0x03 GPIOè¿›é˜¶å¯¹äºæ§åˆ¶ç®€å•çš„è®¾å¤‡ï¼Œæ¯”å¦‚LEDï¼Œä½¿ç”¨ RPi.GPIO å·²ç»å¤Ÿç”¨äº†ã€‚ä½†æ˜¯å½“æˆ‘ä»¬è¿›ä¸€æ­¥ç ”ç©¶ä¹‹åä¼šå‘ç°RPi.GPIOå¹¶ä¸æ˜¯é‚£ä¹ˆå®Œç¾ï¼Œåœ¨å®ƒçš„å®˜æ–¹æ–‡æ¡£ä¸Šæœ‰è¿™ä¹ˆä¸¤æ®µè¯ï¼š Note that this module is unsuitable for real-time or timing critical applications. This is because you can not predict when Python will be busy garbage collecting. It also runs under the Linux kernel which is not suitable for real time applications - it is multitasking O/S and another process may be given priority over the CPU, causing jitter in your program. If you are after true real-time performance and predictability, buy yourself an Arduino http://www.arduino.cc !Note that the current release does not support SPI, I2C, hardware PWM or serial functionality on the RPi yet. This is planned for the near future - watch this space! One-wire functionality is also planned. ä»ä¸Šé¢æˆ‘ä»¬å¯ä»¥äº†è§£åˆ° RPi.GPIO å¹¶ä¸é€‚åˆå®æ—¶æ€§è¦æ±‚é«˜çš„åº”ç”¨ï¼Œä¹Ÿä¸é€‚åˆå‘¨æœŸè®¡æ•°çš„åº”ç”¨ã€‚pythonæœ¬èº«æ€§èƒ½å°±ä¸æ˜¯éå¸¸ç†æƒ³ï¼Œæ¯”å¦‚å½“æˆ‘ä»¬å°è¯•ç”¨pythonå»æ“ä½œDHT11ï¼ˆæ¸©æ¹¿åº¦ä¼ æ„Ÿå™¨ï¼‰å°±éå¸¸çš„å›°éš¾ï¼Œå› ä¸ºå¾ˆéš¾å’Œå®ƒçš„æ—¶åºä¿æŒåŒæ­¥ã€‚è€Œä¸”linuxå¹¶ä¸æ˜¯å®æ—¶æ“ä½œç³»ç»Ÿï¼Œè¿è¡Œåœ¨linuxå†…æ ¸ä¹‹ä¸Šï¼Œæ— æ³•é¿å…è¢«å…¶ä»–è¿›ç¨‹æŠ¢å CPUã€‚ç›®å‰ç‰ˆæœ¬çš„ RPi.GPIO å¹¶ä¸æ”¯æŒSPIã€I2Cã€ç¡¬ä»¶PWMã€ä¸²å£ç­‰ã€‚å¦‚æœä½ å¸Œæœ›ä½¿ç”¨è¿™äº›æ¥å£ï¼Œé‚£å°±éœ€è¦è€ƒè™‘æ¢ä¸€ä¸ªåº“æˆ–è€…æ¢ä¸€ç§è¯­è¨€äº†ã€‚å…·ä½“çš„æ˜¯ç”¨ï¼Œåœ¨ä»¥åçš„æ–‡ç« ä¸­ä¼šåšä»‹ç»ã€‚ 0xFF å‚è€ƒ https://github.com/raspberrypi/documentation https://zh.scribd.com/doc/101830961/GPIO-Pads-Control2 https://pypi.python.org/pypi/RPi.GPIO http://dreamcolor.net/archives/rpi-gpio-module-pwm.html","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"https://ttdevs.github.io/categories/æŠ€æœ¯/"}],"tags":[{"name":"ç©è½¬æ ‘è“æ´¾","slug":"ç©è½¬æ ‘è“æ´¾","permalink":"https://ttdevs.github.io/tags/ç©è½¬æ ‘è“æ´¾/"}]},{"title":"ã€Œç©è½¬æ ‘è“æ´¾ã€0x02åŠç‚¸å¤©çš„è¿œç¨‹æ§åˆ¶","slug":"[ç©è½¬æ ‘è“æ´¾]0x02åŠç‚¸å¤©çš„è¿œç¨‹æ§åˆ¶","date":"1969-12-31T16:00:00.000Z","updated":"2017-04-27T11:07:57.000Z","comments":true,"path":"1970/01/01/[ç©è½¬æ ‘è“æ´¾]0x02åŠç‚¸å¤©çš„è¿œç¨‹æ§åˆ¶/","link":"","permalink":"https://ttdevs.github.io/1970/01/01/[ç©è½¬æ ‘è“æ´¾]0x02åŠç‚¸å¤©çš„è¿œç¨‹æ§åˆ¶/","excerpt":"","text":"0x00 åŠç‚¸å¤©çš„è¿œç¨‹æ§åˆ¶Connect to Raspberry Pi å®‰è£…å¥½äº†ç³»ç»Ÿï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å°±å¯ä»¥å¼€å§‹æ“ä½œ Raspberry Pi äº†ã€‚å¦‚æœä½ ä¸æ˜¯æ‹¿æ¥åšå®¶åº­åª’ä½“ä¸­å¿ƒï¼Œçœ‹è§†é¢‘ä¹‹ç±»ï¼Œæˆ‘ä»¬å®Œå…¨ä¸éœ€è¦ç»™ Raspberry Pi é…ç½®æ˜¾ç¤ºå™¨ï¼Œé€šè¿‡è¿œç¨‹è¿æ¥å·¥å…·å°±å¯ä»¥å®Œæˆæˆ‘ä»¬æ‰€æœ‰çš„æ—¥å¸¸æ“ä½œã€‚ç”±äºè¿æ¥æ˜¾ç¤ºå™¨æ“ä½œæ¯”è¾ƒç›´è§‚ï¼Œè¿™é‡Œä»…ç»™å¤§å®¶ä»‹ç»æ— æ˜¾ç¤ºå™¨çš„è¿œç¨‹æ“ä½œæ–¹æ³•ã€‚ 0x01 SSHå…ˆçœ‹ä¸€æ®µä»‹ç»ï¼Œæ¥è‡ªç»´åŸºç™¾ç§‘ï¼š Secure Shellï¼ˆç¼©å†™ä¸ºSSHï¼‰ï¼Œç”±IETFçš„ç½‘ç»œå·¥ä½œå°ç»„ï¼ˆNetwork Working Groupï¼‰æ‰€åˆ¶å®šï¼›SSHä¸ºä¸€é¡¹åˆ›å»ºåœ¨åº”ç”¨å±‚å’Œä¼ è¾“å±‚åŸºç¡€ä¸Šçš„å®‰å…¨åè®®ï¼Œä¸ºè®¡ç®—æœºä¸Šçš„Shellï¼ˆå£³å±‚ï¼‰æä¾›å®‰å…¨çš„ä¼ è¾“å’Œä½¿ç”¨ç¯å¢ƒã€‚ä¼ ç»Ÿçš„ç½‘ç»œæœåŠ¡ç¨‹åºï¼Œå¦‚rshã€FTPã€POPå’ŒTelnetå…¶æœ¬è´¨ä¸Šéƒ½æ˜¯ä¸å®‰å…¨çš„ï¼›å› ä¸ºå®ƒä»¬åœ¨ç½‘ç»œä¸Šç”¨æ˜æ–‡ä¼ é€æ•°æ®ã€ç”¨æˆ·å¸å·å’Œç”¨æˆ·å£ä»¤ï¼Œå¾ˆå®¹æ˜“å—åˆ°ä¸­é—´äººï¼ˆman-in-the-middleï¼‰æ”»å‡»æ–¹å¼çš„æ”»å‡»ã€‚å°±æ˜¯å­˜åœ¨å¦ä¸€ä¸ªäººæˆ–è€…ä¸€å°æœºå™¨å†’å……çœŸæ­£çš„æœåŠ¡å™¨æ¥æ”¶ç”¨æˆ·ä¼ ç»™æœåŠ¡å™¨çš„æ•°æ®ï¼Œç„¶åå†å†’å……ç”¨æˆ·æŠŠæ•°æ®ä¼ ç»™çœŸæ­£çš„æœåŠ¡å™¨ã€‚è€ŒSSHæ˜¯ç›®å‰è¾ƒå¯é ï¼Œä¸“ä¸ºè¿œç¨‹ç™»å½•ä¼šè¯å’Œå…¶ä»–ç½‘ç»œæœåŠ¡æä¾›å®‰å…¨æ€§çš„åè®®ã€‚åˆ©ç”¨SSHåè®®å¯ä»¥æœ‰æ•ˆé˜²æ­¢è¿œç¨‹ç®¡ç†è¿‡ç¨‹ä¸­çš„ä¿¡æ¯æ³„éœ²é—®é¢˜ã€‚é€šè¿‡SSHå¯ä»¥å¯¹æ‰€æœ‰ä¼ è¾“çš„æ•°æ®è¿›è¡ŒåŠ å¯†ï¼Œä¹Ÿèƒ½å¤Ÿé˜²æ­¢DNSæ¬ºéª—å’ŒIPæ¬ºéª—ã€‚SSHä¹‹å¦ä¸€é¡¹ä¼˜ç‚¹ä¸ºå…¶ä¼ è¾“çš„æ•°æ®å¯ä»¥æ˜¯ç»è¿‡å‹ç¼©çš„ï¼Œæ‰€ä»¥å¯ä»¥åŠ å¿«ä¼ è¾“çš„é€Ÿåº¦ã€‚SSHæœ‰å¾ˆå¤šåŠŸèƒ½ï¼Œå®ƒæ—¢å¯ä»¥ä»£æ›¿Telnetï¼Œåˆå¯ä»¥ä¸ºFTPã€POPã€ç”šè‡³ä¸ºPPPæä¾›ä¸€ä¸ªå®‰å…¨çš„â€œé€šé“â€ã€‚ ä¸Šé¢çš„ä»‹ç»æ˜¯ä¸æ˜¯å¤ªæŠ½è±¡ï½ï½è¿˜æ˜¯æˆ‘æ¥è¯´å§ã€‚æŠ˜è…¾ Raspberry Pi ï¼Œsshä½œä¸ºä¸€ä¸ªé‡è¦çš„è¿œç¨‹è¿æ¥å·¥å…·ï¼ˆæˆ–è€…ç†è§£ä¸ºæŠŠ Raspberry Pi çš„ç»ˆç«¯æ‹¿åˆ°æœ¬åœ°æ¥ï¼‰ï¼Œæ—¥å¸¸æ“ä½œä¸­æ˜¯å¿…ä¸å¯å°‘çš„ï¼åœ¨æ²¡æœ‰æ˜¾ç¤ºå™¨çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨sshå®Œæˆç»å¤§å¤šæ•°ï¼ˆç”šè‡³æ‰€æœ‰çš„ï¼‰æ“ä½œã€‚å› æ­¤ï¼Œè¿™é‡Œæˆ‘å¿…é¡»ç€é‡ä»‹ç»ã€‚æˆ‘ä»¬è£…çš„ Raspbian ç³»ç»Ÿé»˜è®¤æ˜¯æ‰“å¼€sshçš„ï¼ˆå¦åˆ™åœ¨æ²¡æœ‰æ˜¾ç¤ºå™¨çš„æƒ…å†µä¸‹æˆ‘ä»¬æ˜¯æ— æ³•æ“ä½œçš„ï¼Œå½“ç„¶ä½ éå¾—è¯´ç”¨USBè½¬TTLä¹Ÿè¡Œï¼‰ï¼Œå› æ­¤ï¼Œæˆ‘ä»¬ä¸éœ€è¦åšä»»ä½•é…ç½®å°±å¯ä»¥ç›´æ¥ä½¿ç”¨sshã€‚ å®‰è£…SSHWindowsç³»ç»Ÿæ¨èä½¿ç”¨å…è´¹ã€å°å·§ã€æ— éœ€å®‰è£…ã€å¹¶ä¸”åŠŸèƒ½å¼ºå¤§çš„sshå·¥å…·ã€‚ PuTTY æ˜¯ä¸€ä¸ªTelnetã€SSHã€rloginã€çº¯TCPä»¥åŠä¸²è¡Œæ¥å£è¿æ¥è½¯ä»¶ã€‚ å¤§å®¶å¯ä»¥åˆ°ä»–çš„å®˜ç½‘ä¸‹è½½ï¼Œæˆ–è€…åˆ°è¿™é‡Œä¸‹è½½ï¼Œéå¸¸å°ï¼Œ519KBã€‚æ‰“å¼€æ˜¯ç•Œé¢å¦‚ä¸‹ï¼š ä½¿ç”¨ä¹Ÿæ˜¯éå¸¸çš„ç®€å•ï¼Œåœ¨ Host Name(or IP address) ä¸­å¡«å…¥ä½ çš„åŸŸåæˆ–è€…IPï¼Œåœ¨ Port ä¸­å¡«å…¥ä½ çš„ç«¯å£ï¼Œé»˜è®¤æ˜¯ 22 ï¼ˆå¦‚æœä½ ä¿®æ”¹äº†é»˜è®¤ç«¯å£ï¼Œåœ¨æ­¤æ”¹æˆæ–°çš„ç«¯å£å³å¯ï¼‰ï¼Œç„¶åç‚¹å‡» Open å°±å¼€å§‹è¿æ¥ï¼Œæ‰“å¼€ä¸€ä¸ª terminal ï¼ŒæŒ‰ç…§æç¤ºæ“ä½œå³å¯ï¼š Macå’ŒLinuxç³»ç»Ÿä¸­é»˜è®¤å·²ç»å®‰è£…äº† ssh å·¥å…·ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥åœ¨å‘½ä»¤è¡Œä¸­æ“ä½œå³å¯ï¼š 123456789101112âœ ~ ssh -VOpenSSH_6.9p1, LibreSSL 2.1.8âœ ~ sshusage: ssh [-1246AaCfGgKkMNnqsTtVvXxYy] [-b bind_address] [-c cipher_spec] [-D [bind_address:]port] [-E log_file] [-e escape_char] [-F configfile] [-I pkcs11] [-i identity_file] [-L [bind_address:]port:host:hostport] [-l login_name] [-m mac_spec] [-O ctl_cmd] [-o option] [-p port] [-Q cipher | cipher-auth | mac | kex | key] [-R [bind_address:]port:host:hostport] [-S ctl_path] [-W host:port] [-w local_tun[:remote_tun]] [user@]hostname [command]âœ ~ ä½¿ç”¨SSHsshçš„ä½¿ç”¨æ¯”è¾ƒç®€å•ï¼Œç›´æ¥åœ¨æˆ‘ä»¬æœ¬åœ°çš„ç»ˆç«¯ä¸­è¾“å…¥ ssh pi@&lt;your domain or ip&gt; å‘½ä»¤ï¼ŒæŒ‰ç…§æç¤ºè¾“å…¥å¯†ç å³å¯ï¼š 1234567891011âœ ~ ssh pi@ttdevs.compi@ttdevs.com&apos;s password:The programs included with the Debian GNU/Linux system are free software;the exact distribution terms for each program are described in theindividual files in /usr/share/doc/*/copyright.Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extentpermitted by applicable law.Last login: Thu Mar 31 17:38:44 2016 from 58.11.22.33pi@raspberry:~ $ å®Œæˆsshçš„ç™»å½•ï¼Œä½ å°±å¯ä»¥åœ¨æœ¬åœ°ç›´æ¥æ“ä½œ Raspberry Pi äº†ï¼Œè€Œä¸”ä½“éªŒå’Œç›´æ¥ç™»å½• Raspberry Pi æ“ä½œä¸€æ ·ã€‚ ä¿®æ”¹ç«¯å£å·å¦‚æœä½ è·Ÿæˆ‘ä¸€æ ·æ¯”è¾ƒæ‚²å‚¬â€”â€”22ç«¯å£ ä¹Ÿ è¢«ç”µä¿¡å°äº†ï¼ˆæˆ–è€…å¾ˆä¸ç¨³å®šï¼‰ï¼Œé‚£ä½ å°±éœ€è¦ç»™sshæ¢ï¼ˆæˆ–è€…å¢åŠ ï¼‰ä¸€ä¸ªç«¯å£ã€‚å¦‚ä½•åˆ¤æ–­22ç«¯å£æ˜¯å¦è¢«å°äº†ï¼Ÿæœ€ç®€å•å°±æ˜¯å¦‚æœä½ åœ¨å†…ç½‘é€šè¿‡sshå¯ä»¥è®¿é—®Raspberry Piï¼Œå¤–ç½‘å´è®¿é—®ä¸äº†ï¼Œé‚£ä¹ˆ22ç«¯å£å°±æœ‰å¯èƒ½è¢«è¿è¥å•†æˆ–è€…ä½ çš„é˜²ç«å¢™ç»™å°äº†ã€‚æ—¢ç„¶ç«¯å£æœ‰é—®é¢˜ï¼Œé‚£æœ€ç®€å•çš„åŠæ³•æ¢ä¸ªç«¯å£ï¼Œå°±å¯ä»¥è§„é¿è¿™ä¸ªé—®é¢˜ï¼Œä¸‹é¢ä»‹ç»å¦‚ä½•æ“ä½œï¼š ç¼–è¾‘sshé…ç½®æ–‡ä»¶ /etc/ssh/sshd_config ä¿®æ”¹ç«¯å£ 123456789sudo nano /etc/ssh/sshd_config# Package generated configuration file# See the sshd_config(5) manpage for details# What ports, IPs and protocols we listen forPort 22Port 2333... æ‰¾åˆ°Port 22ï¼Œåœ¨è¿™è¡Œä¸‹é¢å¢åŠ ä¸€è¡Œ Port 2333ã€‚å½“ç„¶ä½ ä¹Ÿå¯ä»¥ç›´æ¥æŠŠ22æ”¹æˆä½ è¦è®¾ç½®çš„ç«¯å£å·ã€‚ä»–ä»¬çš„åŒºåˆ«æ˜¯ï¼šå¢åŠ ä¸€è¡Œå¯ä»¥å¢åŠ ä¸€ä¸ªsshç«¯å£å·ã€‚å¦‚ä¸Šé¢çš„å†™æ³•ï¼Œæˆ‘å¯ä»¥ä½¿ç”¨sshé€šè¿‡ 22 æˆ– 2333 ç«¯å£æ¥è®¿é—®Raspberry Piã€‚ ä½¿é…ç½®ç”Ÿæ•ˆ é‡å¯sshï¼šsudo service ssh restart æœ€ç®€å•ä½ ä¹Ÿå¯ä»¥ç›´æ¥é‡å¯è®¾å¤‡ï¼šsudo reboot or sudo init 6 ä½¿ç”¨æ–°ç«¯å£ç™»å½• ä½¿ç”¨æ–°ç«¯å£çš„ç™»å½•æ–¹å¼å¦‚ä¸‹ï¼š ssh -p &lt;your new port&gt; &lt;username&gt;@&lt;ip-address or domain&gt; å¦‚ï¼š ssh -p 2333 pi@ttdevs.com æ— å¯†ç ç™»å½•æ— å¯†ç ç™»å½•å°±æ˜¯æŠŠæˆ‘ä»¬ä»æ¯æ¬¡ç™»å½• Raspberry Pi éƒ½éœ€è¦è¾“å…¥å¯†ç çš„ç¹çä¸­è§£è„±å‡ºæ¥ã€‚é…ç½®å®Œæˆåï¼Œæˆ‘ä»¬åªéœ€è¦ ssh &lt;your domain or ip&gt; å³å¯ç™»å½•æˆ‘ä»¬çš„è®¾å¤‡è€Œä¸éœ€è¦è¾“å…¥å¯†ç ã€‚ è¿™ä¸ªé…ç½®å¾ˆç®€å•ï¼Œåªéœ€è¦å°†æˆ‘ä»¬çš„publicç§˜é’¥ä¼ åˆ°Raspberry Piçš„ ~/.ssh/authorized_keys æ–‡ä»¶ä¸­å³å¯ã€‚æ‰§è¡Œä¸‹é¢çš„å‘½ä»¤ï¼ˆå‡è®¾ä½ çš„æœ¬åœ°å·²ç»ç”Ÿæˆäº†ç›¸å…³çš„keyï¼‰ï¼š 1cat ~/.ssh/id_rsa.pub | ssh &lt;username&gt;@&lt;ip-address or domain&gt; &apos;cat &gt;&gt; .ssh/authorized_keys&apos; å…¶ä¸­id_rsa.pubä¸ºä½ çš„å…¬é’¥ã€‚å¦‚æœæ²¡æœ‰é—®é¢˜ï¼Œå½“ä½ å†æ¬¡å°è¯•ä½¿ç”¨sshç™»å½•çš„è¯å°±ä¸éœ€è¦å¯†ç äº†ã€‚å¦‚æœæœ‰é—®é¢˜ï¼Œè¯·å‚è€ƒè¿™é‡Œã€‚ 0x02 VNCè™½ç„¶sshå¯ä»¥å®Œæˆæˆ‘ä»¬çš„ç»å¤§å¤šè¯´æ“ä½œã€‚ä½†æ˜¯å¦‚æœä¹ æƒ¯äº†å›¾å½¢ç•Œé¢çš„ä½ ï¼Œä¸€æ—¶åŠä¼šå¾ˆéš¾ä¸Šæ‰‹è¿™ç§å‘½ä»¤è¡Œæ–¹å¼ï¼Œä¼šæƒ³æœ‰ä¸ªæ¡Œé¢æ“ä½œç¯å¢ƒï¼Œé‚£æ¥ä¸‹æ¥æˆ‘ä»¬ä»‹ç»ä¸‹VNCï¼Œå› ä¸ºä»–å¯ä»¥æ»¡è¶³ä½ å¯¹GUIçš„è¦æ±‚ã€‚VNCçš„é…ç½®ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨å¦‚ä¸‹ Raspberry Pi å®˜æ–¹æ–‡æ¡£ä¸­æ‰¾åˆ°ã€‚å½“ç„¶ï¼Œä½ ä¹Ÿå¯ä»¥åˆ°VNCçš„å®˜æ–¹ç½‘ç«™æŸ¥çœ‹ã€‚ å®‰è£…VNC å®‰è£…VNC æˆ‘ä»¬å¯ä»¥ä½¿ç”¨è¿™ä¸ªå‘½ä»¤æ¥å®‰è£…VNCæœåŠ¡ï¼š sudo apt-get install tightvncserver è®¾ç½®å¯†ç  åœ¨å¯åŠ¨æœåŠ¡ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦è®¾ç½®ä¸€ä¸ªè®¿é—®å¯†ç ï¼Œå‘½ä»¤ä¸ºtightvncserverï¼Œæ“ä½œå¦‚ä¸‹ï¼š 12345678910111213141516171819202122232425pi@raspberrypi:~/.vnc $ tightvncserverperl: warning: Setting locale failed.perl: warning: Please check that your locale settings: LANGUAGE = (unset), LC_ALL = (unset), LC_CTYPE = &quot;zh_CN.UTF-8&quot;, LANG = &quot;en_GB.UTF-8&quot; are supported and installed on your system.perl: warning: Falling back to a fallback locale (&quot;en_GB.UTF-8&quot;).You will require a password to access your desktops.Password:Verify:Would you like to enter a view-only password (y/n)? yPassword:Warning: password truncated to the length of 8.Verify:New &apos;X&apos; desktop is raspberrypi:5Starting applications specified in /home/pi/.vnc/xstartupLog file is /home/pi/.vnc/raspberrypi:5.logpi@raspberrypi:~/.vnc $ PSï¼šå¯†ç æ— å›æ˜¾ è¿è¡Œä¸€ä¸ªvnc display vncserver :1 -geometry 1920x1080 -depth 24 è¿™æ ·ä½ å°±å¯ä»¥é€šè¿‡VNCå®¢æˆ·ç«¯ï¼ˆå¦‚ï¼šVNC Viewerï¼‰è¿æ¥åˆ°æˆ‘ä»¬çš„æ ‘è“æ´¾äº†ï¼Œå®¢æˆ·ç«¯çš„é…ç½®ï¼Œä½ å¯ä»¥å‚è€ƒè¿™é‡Œã€‚ä¸‹é¢æ˜¯æˆ‘çš„æ•ˆæœå›¾ï¼š VNC Viewerä¸­æˆ‘ä»¬éœ€è¦æŒ‡å®šè¿æ¥å“ªä¸ªdisplayï¼Œç”±äºæˆ‘ä»¬ä¸Šé¢ç”¨çš„æ˜¯ display 1ï¼Œå› æ­¤åœ°å€å†™ï¼šttdevs.com:1 å¦å¤–ï¼Œä¸Šé¢çš„å‘½ä»¤æ˜¯åœ¨display 1ä½ç½®å¯åŠ¨ï¼Œå¦‚æœä½ è€ƒè™‘èŠ‚çœèµ„æºå¯ä»¥å…³é—­display 0ï¼Œæ‰§è¡Œå‘½ä»¤ï¼šservice lightdm stop é…ç½®VNCè‡ªå¯åŠ¨é€šè¿‡ä¸Šé¢çš„é…ç½®æˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨VNCäº†ï¼Œä½†æ˜¯å¦‚æœæˆ‘ä»¬é‡æ–°å¯åŠ¨è®¾å¤‡ï¼Œä¹‹å‰çš„é…ç½®å¤±æ•ˆï¼ŒVNCå°±è¿ä¸ä¸Šäº†ã€‚å› æ­¤æœ€å¥½èƒ½æŠŠå¯åŠ¨VNCçš„æ“ä½œæ·»åŠ åˆ°ç³»ç»Ÿçš„è‡ªå¯åŠ¨é¡¹ä¸­ã€‚å…·ä½“æ“ä½œå¦‚ä¸‹ï¼š åˆ‡æ¢åˆ°rootè´¦æˆ·ï¼šsudo su è¿›åˆ°/etc/init.d/ç›®å½•ï¼šcd /etc/init.d/ åˆ›å»ºvncbootæ–‡ä»¶ï¼štouch vncboot ç¼–è¾‘vncbootæ–‡ä»¶ï¼Œè¾“å…¥ä¸‹é¢å†…å®¹ï¼šsudo nano vncboot 12345678910111213141516171819202122232425262728293031323334353637#! /bin/sh# /etc/init.d/vncboot### BEGIN INIT INFO# Provides: vncboot# Required-Start: $remote_fs $syslog# Required-Stop: $remote_fs $syslog# Default-Start: 2 3 4 5# Default-Stop: 0 1 6# Short-Description: Start VNC Server at boot time# Description: Start VNC Server at boot time.### END INIT INFOUSER=piHOME=/home/piexport USER HOMEcase &quot;$1&quot; in start) echo &quot;Starting VNC Server&quot; #Insert your favoured settings for a VNC session su - $USER -c &quot;/usr/bin/vncserver :1 -geometry 1280x800 -depth 16 -pixelformat rgb565&quot; ;; stop) echo &quot;Stopping VNC Server&quot; /usr/bin/vncserver -kill :1 ;; *) echo &quot;Usage: /etc/init.d/vncboot &#123;start|stop&#125;&quot; exit 1 ;;esacexit 0 ä¿®æ”¹vncbootçš„æƒé™ï¼šchmod 755 vncboot è®¾ç½®VNCä¸ºé»˜è®¤å¯åŠ¨ï¼šupdate-rc.d vncboot defaults æœ€åï¼Œå®Œæ•´è„šæœ¬å¦‚ä¸‹ 123456789101112131415161718192021222324252627pi@raspberrypi:~ $ sudo suroot@raspberrypi:/home/pi# cd /etc/init.d/root@raspberrypi:/etc/init.d# touch vncbootroot@raspberrypi:/etc/init.d# sudo nano vncbootroot@raspberrypi:/etc/init.d# chmod 755 vncbootroot@raspberrypi:/etc/init.d# update-rc.d vncboot defaultsperl: warning: Setting locale failed.perl: warning: Please check that your locale settings: LANGUAGE = (unset), LC_ALL = (unset), LC_CTYPE = &quot;zh_CN.UTF-8&quot;, LANG = &quot;en_GB.UTF-8&quot; are supported and installed on your system.perl: warning: Falling back to a fallback locale (&quot;en_GB.UTF-8&quot;).root@raspberrypi:/etc/init.d# ls -altotal 308drwxr-xr-x 2 root root 4096 Mar 22 05:41 .drwxr-xr-x 109 root root 4096 Mar 21 15:01 ..-rw-r--r-- 1 root root 1745 Mar 22 05:43 .depend.boot-rw-r--r-- 1 root root 930 Mar 22 05:43 .depend.start-rw-r--r-- 1 root root 1009 Mar 22 05:43 .depend.stop-rw-r--r-- 1 root root 2427 Apr 6 2015 README...-rwxr-xr-x 1 root root 699 Mar 22 05:42 vncboot-rwxr-xr-x 1 root root 2666 Sep 25 2013 x11-commonroot@raspberrypi:/etc/init.d# reboot å¯†ç ç®¡ç†VNCçš„å¯†ç ç®¡ç†æ¯”è¾ƒç®€å•ï¼Œè¯¦ç»†æè¿°å¯ä»¥å‚è€ƒè¿™é‡Œï¼Œä¸‹é¢åšç®€å•æè¿°ï¼š ä¿®æ”¹å¯†ç  vncpasswd 123456789pi@raspberrypi:~ $ vncpasswdUsing password file /home/pi/.vnc/passwdPassword:Verify:Would you like to enter a view-only password (y/n)? yPassword:Warning: password truncated to the length of 8.Verify:pi@raspberrypi:~ $ PSï¼šè®¾ç½®æ–°çš„å¯†ç ï¼Œå¥½åƒå¹¶ä¸ä¼šéªŒè¯ä½ çš„æ—§å¯†ç  å¿˜è®°å¯†ç  VNCçš„å¯†ç æ–‡ä»¶å­˜å‚¨åœ¨ï¼š$HOME/.vnc/passwdä¸­ï¼Œå¦‚æœä½ å¿˜è®°äº†VNCçš„å¯†ç ï¼Œå¯ä»¥ç›´æ¥åˆ é™¤è¿™ä¸ªæ–‡ä»¶ï¼Œè¿è¡Œ tightvncserver å³å¯ä½¿ç”¨æ–°çš„å¯†ç ã€‚ å…¶ä»–è¯´æ˜ VNCé»˜è®¤ç«¯å£å·ï¼š5901 VNCé…ç½®æ–‡ä»¶ï¼š~/.vnc VNCå¯†ç æ–‡ä»¶ï¼š/.vnc/passwd 0x03 SCPè®²è¿‡ä¸Šé¢çš„é…ç½®ä¹‹åæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡è¿™ä¸¤ç§æ–¹å¼æ¥è¿œç¨‹æ“ä½œæˆ‘ä»¬çš„æ ‘è“æ´¾äº†ã€‚ä½†æ˜¯ï¼Œæœ‰æ—¶å€™æˆ‘ä»¬éœ€è¦åœ¨æœ¬åœ°å’Œ Raspberry Pi ä¹‹é—´è¿›è¡Œæ–‡ä»¶æ‹·è´ï¼Œè¿™é‡Œæˆ‘ä»¬å¯ä»¥æœ‰å¾ˆå¤šç§é€‰æ‹©ï¼Œæ¯”å¦‚å¸¸è§çš„FTPï¼ŒSFTPç­‰ã€‚ä½†æ˜¯ç”±äºFTPçš„é…ç½®æ¯”è¾ƒéº»çƒ¦ï¼Œè€Œä¸”å¿…é¡»ä»¥æœåŠ¡çš„æ–¹å¼åœ¨ç³»ç»Ÿå¸¸é©»ï¼Œå› æ­¤ç»™å¤§å®¶æ¨è SCPã€‚SCP æ˜¯secure copyçš„ç®€å†™ï¼Œç”¨äºåœ¨Linuxä¸‹è¿›è¡Œè¿œç¨‹æ‹·è´æ–‡ä»¶ã€‚æˆ‘ä»¬æ¯”è¾ƒå¸¸è§çš„ cp å‘½ä»¤å’Œ scp ç±»ä¼¼ï¼Œä¸è¿‡cp åªæ˜¯åœ¨æœ¬æœºè¿›è¡Œæ‹·è´ï¼Œä¸èƒ½è·¨æœåŠ¡å™¨ã€‚è€ƒè™‘ç½‘ç»œä¼ è¾“çš„å®‰å…¨æ€§ï¼Œ scp ä¼ è¾“æ˜¯åŠ å¯†çš„ã€‚é»˜è®¤æƒ…å†µï¼Œæˆ‘ä»¬çš„Raspberry Pi å·²ç»å®‰è£…äº†SCPï¼Œ å¯ä»¥é€šè¿‡ç›´æ¥åœ¨ç»ˆç«¯è¾“å…¥ scp æ¥æŸ¥çœ‹ï¼Œå¦‚ï¼š 1234$ scpusage: scp [-12346BCpqrv] [-c cipher] [-F ssh_config] [-i identity_file] [-l limit] [-o ssh_option] [-P port] [-S program] [[user@]host1:]file1 ... [[user@]host2:]file2 ç”±äºæˆ‘ç”¨çš„æ˜¯Macç³»ç»Ÿï¼Œé»˜è®¤æƒ…å†µä¹Ÿå·²ç»å®‰è£…äº†SCPå‘½ä»¤ã€‚å¦‚æœä½ ä½¿ç”¨çš„æ˜¯Windowsç³»ç»Ÿï¼Œæˆ‘ä»¬å¯ä»¥åˆ°è¿™é‡Œä¸‹è½½WinSCPã€‚ æœ¬åœ°æ–‡ä»¶æ‹·è´åˆ° Raspberry Pi æ‹·è´æœ¬åœ°æ–‡ä»¶file.txtåˆ°Raspberry Piçš„ç”¨æˆ·ç›®å½•ä¸‹ scp file.txt pi@ttdevs.com: æ‹·è´æœ¬åœ°æ–‡ä»¶file.txtåˆ°Raspberry Piçš„ç”¨æˆ·ç›®å½•ä¸‹çš„raspiæ–‡ä»¶ä¸‹ï¼Œè·¯å¾„ä¸º/home/pi/raspi/ scp file.txt pi@ttdevs.com:raspi Raspberry Piæ–‡ä»¶æ‹·è´åˆ°æœ¬åœ° scp pi@ttdevs.com:file.txt . æ‹·è´è¿œç¨‹Raspberry Piç”¨æˆ·ç›®å½•ä¸‹çš„file.txtåˆ°æœ¬åœ°çš„å½“å‰ç›®å½• å¤šæ–‡ä»¶æ‹·è´ scpæ”¯æŒå¤šæ–‡ä»¶æ‹·è´ï¼Œæˆ‘ä»¬å¯ä»¥ä¸€æ¬¡æŒ‡å®šå¤šä¸ªæ–‡ä»¶æˆ–è€…ä½¿ç”¨é€šé…ç¬¦æ¥è¿›è¡Œæ“ä½œ æŒ‡å®šå¤šä¸ªæ–‡ä»¶ scp file.txt file2.txt pi@ttdevs.com: ä½¿ç”¨é€šé…ç¬¦ scp *.txt pi@ttdevs.com: 0x04 HTTPä¸ºä»€ä¹ˆä¼šæåˆ°è¿™ä¸ªå‘¢ï¼ŸåŸå› å¾ˆç®€å•ï¼Œåœ¨æ¥ä¸‹æ¥çš„å­¦ä¹ ä¸­å¤§éƒ¨åˆ†çš„ç¼–ç æ“ä½œéƒ½ä¼šä½¿ç”¨pythonæ¥å®Œæˆã€‚æ‰€ä»¥æˆ‘ä»¬ä¼šå®‰è£…pythonè¯­è¨€ï¼Œè€Œä¸”ï¼Œé»˜è®¤æƒ…å†µæˆ‘ä»¬çš„Raspberry Piå·²ç»å®‰è£…äº†python 2.7ç‰ˆæœ¬ã€‚python2 ä¸­é»˜è®¤åŒ…å«äº†SimpleHTTPServerè¿™ä¸ªåº“ã€‚å› æ­¤æˆ‘ä»¬å¯ä»¥ç›´æ¥æ‹¿æ¥ä½¿ç”¨ã€‚è¯´äº†è¿™ä¹ˆå¤šä½ è¿˜ä¸çŸ¥é“è¿™ä¸ªä¸œä¸œæ˜¯å¹²å˜›çš„ã€‚å…¶å®ä»åå­—ä¸­æˆ‘ä»¬å°±å¯ä»¥çœ‹å‡ºæ¥ï¼Œä»–æ˜¯ä¸€ä¸ªhttp serverã€‚æ—¢ç„¶æ˜¯http serverï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥ç”¨æ¥ä½œä¸ºä¸‹è½½æ–‡ä»¶æœåŠ¡æ¥ä½¿ç”¨ï¼Œé—´æ¥å®Œæˆæ–‡ä»¶çš„æ‹·è´ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡å¦‚ä¸‹çš„å‘½ä»¤æ¥å¯åŠ¨ä¸€ä¸ªhttpæœåŠ¡ï¼š 123~ $ python -m SimpleHTTPServer 8088Serving HTTP on 0.0.0.0 port 8088 ...... å¦‚æœä½ æƒ³ä½¿ç”¨80ç«¯å£ï¼ˆè¯·ç¡®ä¿æ²¡æœ‰è¢«è¿è¥å•†å°æ‰ï¼‰ï¼Œè¯·å°†8088æ”¹æˆ80ï¼Œsudo python -m SimpleHTTPServer 80ã€‚å¯åŠ¨å¥½ä¹‹åæˆ‘ä»¬å°±å¯ä»¥åœ¨æµè§ˆå™¨ä¸­é€šè¿‡æ‰“å¼€ http://&lt;your ip or domain&gt;:8088 è¿™æ ·çš„æ–¹å¼æ¥è®¿é—®å¯åŠ¨æœåŠ¡æ—¶é‚£ä¸ªä½ç½®ä¸‹çš„æ‰€æœ‰æ–‡ä»¶ã€‚å¦‚æœä½ æƒ³ä»Raspberry Piä¸­æ‹·è´æ–‡ä»¶åˆ°æœ¬åœ°ï¼Œé‚£å°±åœ¨ Raspberry Pi ä¸­å¯åŠ¨æœåŠ¡ï¼Œå¦‚æœä½ æƒ³æŠŠæœ¬åœ°æ–‡ä»¶æ‹·è´åˆ°Raspberry Piä¸­ï¼Œåœ¨æˆ‘ä»¬æœ¬åœ°å¯åŠ¨æœåŠ¡å³å¯ã€‚ è‡³æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥çœŸæ­£å¼€å§‹Raspberry Pi æ“ä½œäº†ï½ï½","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"https://ttdevs.github.io/categories/æŠ€æœ¯/"}],"tags":[{"name":"ç©è½¬æ ‘è“æ´¾","slug":"ç©è½¬æ ‘è“æ´¾","permalink":"https://ttdevs.github.io/tags/ç©è½¬æ ‘è“æ´¾/"}]},{"title":"ã€ŒJavaã€Javaä¸­TCPå’ŒUDPæ€»ç»“","slug":"[Java]Javaä¸­TCPå’ŒUDPæ€»ç»“","date":"1969-12-31T16:00:00.000Z","updated":"2017-04-27T11:07:57.000Z","comments":true,"path":"1970/01/01/[Java]Javaä¸­TCPå’ŒUDPæ€»ç»“/","link":"","permalink":"https://ttdevs.github.io/1970/01/01/[Java]Javaä¸­TCPå’ŒUDPæ€»ç»“/","excerpt":"","text":"0x00 è¿˜æ˜¯å…ˆè¯´ç‚¹å•¥ä¹‹å‰å†™è¿‡ä¸€äº›å…³äºTCPå’ŒUDPæ•°æ®ä¼ è¾“çš„ä»£ç ï¼Œæ¯”å¦‚ä½¿ç”¨TCPä¼ è¾“éŸ³è§†é¢‘æ•°æ®åŒ…ï¼ŒP2Pæ‰“æ´ä¸­ä½¿ç”¨UDPç­‰ã€‚å†™å¥½ä¹‹åå°±ç›´æ¥ä¸¢ä¸‹äº†ï¼Œæ²¡æœ‰æ€»ç»“ä¸‹éƒ½ã€‚æœ€è¿‘å‡†å¤‡æ‰¾å·¥ä½œï¼Œå†æ‹¿æ¥æ¸©ä¹ ä¸‹ã€‚ æš‚æ—¶æŠŠè‡ªå·±çš„å®šä½å¾ˆæ˜ç¡®ï¼Œå°±æ˜¯androidåº”ç”¨å±‚çš„å¼€å‘ï¼Œæ‰€ä»¥å…³äºTCP/UDPçš„å®ç°ç»†èŠ‚ï¼Œæš‚æ—¶ä¹Ÿä¸æƒ³å»æ·±ç©¶ã€‚ä½†æ˜¯å¿ƒé‡Œæ¸…æ¥šè¿™ä¸ªå¿…é¡»å»çœ‹çš„ï¼Œæœ‰æ—¶é—´æ¨èå¤§å®¶çœ‹çœ‹ã€ŠTCP/IPè¯¦è§£ã€‹æˆ–è€…ç½‘ä¸Šæœ‰å¾ˆå¤šå¤§ç‰›çš„æ€»ç»“ã€‚ 0x01 TCPä¸çŸ¥é“ä¸ºä»€ä¹ˆï¼Œè¿™ä¸ªæ€»ç»“ä¸æƒ³å†™çš„å¤ªç»†ï¼Œä¸è´´ä»£ç å†™çš„ç»†åˆä¸çŸ¥é“èƒ½æ€»ç»“å•¥ï¼Œå¥½çº ç»“ï¼Œå¯èƒ½å°±æ˜¯è®¤è¯†æœ‰é™å§ï¼Œå…¬å¸è¦æ˜¯æœ‰ä¸ªæ¶æ„å°±å¥½äº†ã€‚ä¸è¯´äº†ï¼Œè¿˜æ˜¯å®‰å®‰ç¨³ç¨³çš„å†™æ€»ç»“å§ã€‚TCPè¿™ä¸ªå¯èƒ½æ˜¯æˆ‘ä»¬ç”¨çš„æ¯”è¾ƒå¤šçš„æˆ–è€…è¯´æˆ‘ç”¨çš„æ¯”è¾ƒå¤šçš„ï¼Œä¸»è¦çš„å·¥ä½œè¿˜æ˜¯è¿›è¡Œå¤§é‡æ•°æ®çš„ä¼ è¾“å’Œå¿ƒè·³ä¿æŒï¼ˆæƒ³æƒ³å»å¹´é¢è¯•çš„æ—¶å€™éƒ½ä¸çŸ¥é“å•¥æ˜¯å¿ƒè·³ï¼Œæ±—â€¦â€¦ï¼‰ã€‚å¯¹äºå¿ƒè·³ä¿æŒï¼Œå°±æ˜¯ä¸€ä¸ªç®€å•çš„å°å¿ƒè·³åŒ…ï¼›å¤§é‡æ•°æ®çš„ä¼ è¾“ï¼Œè¿™ä¸ªä¹Ÿæ€»ç»“ä¸äº†å•¥ä¸œè¥¿ï¼Œä»£ç å°±é‚£æ ·ï¼Œå°±æ˜¯ä¸€äº›ç»†èŠ‚è¯´ä¸€ä¸‹ã€‚ å®¢æˆ·ç«¯è¿™ä¸ªæ˜¯æˆ‘ä»¬å…³æ³¨çš„æœ€å¤šçš„ï¼Œä¹Ÿæ˜¯ä½œä¸ºä¸€ä¸ªæ‰‹æœºAPPä¸»è¦å…³æ³¨çš„ï¼Œå› ä¸ºæˆ‘ä»¬å°±æ˜¯clientã€‚ åˆ›å»ºclientnew Socket(ip, port); æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸Šé¢çš„æ–¹å¼åˆ›å»ºä¸€ä¸ªsocketï¼Œå¦‚æœå¤±è´¥ï¼Œä¼šæŠ›å‡ºIOExceptionã€‚å‚æ•°ä¸­çš„IPå’ŒPortæ˜¯ç›®æ ‡æœåŠ¡å™¨çš„IPå’Œç«¯å£å·ã€‚è‹¥ä½ æƒ³å¾—åˆ°æœ¬åœ°çš„IPå’ŒPORTä¹Ÿå¯é€šè¿‡è¿™ä¸ªsocketæ‹¿åˆ°ã€‚å½“ç„¶ï¼Œåˆ›å»ºsocketè¿˜æœ‰å¤šç§æ–¹æ³•ï¼Œæ¯”å¦‚ new Socket(proxy)ï¼Œå¦‚æœæœ‰éœ€è¦ä½ å¯ä»¥æŸ¥é˜…ç›¸å…³èµ„æ–™ã€‚ æ‹¿åˆ°socketå¯¹è±¡ä¹‹åæˆ‘ä»¬æ¥ç€è¦åšçš„äº‹æƒ…å°±æ˜¯ä»è¿™ä¸ªsocketä¸­æ‹¿åˆ°è¾“å…¥å’Œè¾“å‡ºæµï¼Œè¿™æ ·æˆ‘ä»¬æ‰å¯ä»¥è¿›è¡Œæ•°æ®çš„æ”¶å‘ï¼š 12InputStream is = mSocket.getInputStream();OutputStream out = mSocket.getOutputStream(); é€šè¿‡è¾“å‡ºæµï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ is.read(receiveBuffer) å’Œ out.write(data); æ¥è¿›è¡Œæ•°æ®çš„æ”¶å‘ã€‚è¿™é‡Œç»™ä¸¤ä¸ªç®€å•å®ä¾‹ï¼š æ¥æ”¶æ•°æ® 1234567891011121314151617@Overridepublic void execute() &#123; try &#123; int count = is.read(receiveBuffer); if (count == -1) &#123; notifyError(); &#125; byte[] data = getPacket(receiveBuffer, count, is); mReceiverQueue.put(data); &#125; catch (InterruptedException e) &#123; e.printStackTrace(); notifyError(); &#125; catch (IOException e) &#123; e.printStackTrace(); notifyError(); &#125;&#125; å‡å¦‚æˆ‘ä»¬çš„æ•°æ®åŒ…åè®®æ ¼å¼å¦‚ä¸‹ï¼š è¿™ä¸ªæ—¶å€™ï¼Œå¦‚æœè¿›è¡Œå¤§é‡æ•°æ®ä¼ è¾“çš„æ—¶å€™æˆ‘ä»¬ä»InputStreamä¸­ä¸€æ¬¡è¯»å–çš„æ•°æ®å¯èƒ½ä¸æ˜¯ä¸€ä¸ªå®Œæ•´çš„æ•°æ®åŒ…ã€‚è¿™ä¸ªæ—¶å€™æˆ‘ä»¬éœ€è¦åšä¸‹é¢çš„åˆ¤æ–­ï¼š aã€è¯»å–çš„æ•°æ®é•¿åº¦æ˜¯å¦è¾¾åˆ°åŒ…å¤´å¤§å°ï¼Œè‹¥æ²¡æœ‰åŒ…å¤´é•¿ï¼Œç»§ç»­è¯»ï¼Œç›´åˆ°è¾¾åˆ°æˆ–è€…è¶…è¿‡åŒ…å¤´å¤§å°bã€ä»åŒ…å¤´ä¸­è§£å‡ºé•¿åº¦å­—æ®µï¼Œå¾ªç¯è¯»å–ï¼Œç›´åˆ°è¯»åˆ°é•¿åº¦å­—æ®µæ ‡ç¤ºé•¿åº¦ä¸ºæ­¢cã€æ ¡éªŒæ•°æ®ï¼Œå»é™¤åŒ…å¤´ï¼Œå–å‡ºåŒ…ä½“dã€é‡å¤ä¸Šè¿°æ­¥éª¤ å‘é€æ•°æ®12345678910111213@Overridepublic void execute() &#123; try &#123; byte[] data = mSenderQueue.take(); out.write(data); &#125; catch (InterruptedException e) &#123; e.printStackTrace(); notifyError(); &#125; catch (IOException e) &#123; e.printStackTrace(); notifyError(); &#125;&#125; mSenderQueueå’ŒmReceiverQueueä¸€æ ·ï¼Œéƒ½æ˜¯é˜»å¡é˜Ÿåˆ—ã€‚å‘é€çš„æ—¶å€™ï¼Œæˆ‘ä»¬ä»é˜Ÿåˆ—ä¸­å–å‡ºè¦å‘é€çš„æ•°æ®ï¼Œç„¶åé€šè¿‡è¾“å‡ºæµå†™å…¥å³å¯ã€‚è¿™ä¸ªåœ°æ–¹æ¯”å‘é€ç®€å•äº†ä¸€äº›ã€‚å¯èƒ½ä½ å·²ç»æ³¨æ„åˆ°ï¼Œæˆ‘çš„å‘é€å’Œæ¥æ”¶éƒ½ç”¨äº†é˜»å¡é˜Ÿåˆ—ï¼Œè¿™ä¸ªåŸå› å°±æ˜¯è€ƒè™‘åˆ°å¤§é‡æ•°æ®çš„æ—¶å€™åšä¸€ä¸ªç¼“å†²ï¼Œå¦‚æœæ²¡æœ‰ç¼“å†²ï¼Œå¯èƒ½å¯¼è‡´ä»£ç çš„é˜»å¡ã€‚å¦å¤–å°±æ˜¯å½“æˆ‘ä»¬çš„é˜»å¡é˜Ÿåˆ—å……æ»¡çš„æ—¶å€™å¯ä»¥æ‰‹åŠ¨ä¸¢å¼ƒä¸€äº›æ•°æ®ï¼Œè¿™ä¸ªå°±æ˜¯å…·ä½“åº”ç”¨äº†ã€‚ æœåŠ¡ç«¯è¿™ä¸ªå¯ä»¥ç®€å•äº†è§£ä¸‹ï¼Œå¯ä»¥ä½¿ç”¨å„ç§è¯­è¨€å®ç°ï¼Œæ¯”å¦‚Javaã€C++ç­‰ã€‚è¿™é‡Œç®€å•ä»‹ç»Javaçš„å®ç°ã€‚ é¦–å…ˆï¼Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªServerSocketå¯¹è±¡å¹¶æŒ‡å®šä¸€ä¸ªç«¯å£å·ï¼Œé€šè¿‡è¿™ä¸ªå¯¹è±¡çš„accept()æ–¹æ³•ç­‰å¾…å®¢æˆ·çš„è¿æ¥ï¼Œè¿™ä¸ªæ–¹æ³•æ˜¯é˜»å¡çš„ï¼›å½“æœ‰å®¢æˆ·ç«¯è¿æ¥ä¸Šæ¥ä¹‹åï¼Œæˆ‘ä»¬å°±æ‹¿åˆ°äº†è¿æ¥çš„socketï¼Œæ‹¿åˆ°è¿™ä¸ªsocketä¹‹åçš„æ“ä½œå°±å’Œå®¢æˆ·ç«¯ä¸€æ ·äº†ï¼Œæœ€åçœ‹ä¸€ä¸‹å…³é”®ä»£ç ï¼š 123456789try &#123; ServerSocket serverSocket = new ServerSocket(9559); while (true) &#123; Socket socket = serverSocket.accept(); // new ServiceSocketThread(socket).start(); &#125;&#125; catch (Exception e) &#123; e.printStackTrace();&#125; å› ä¸ºæœåŠ¡ç«¯ä¸å¯èƒ½åªä¸ä¸€ä¸ªå®¢æˆ·ç«¯è¿æ¥ï¼Œå› æ­¤ä¸Šé¢çš„ä»£ç å†™åœ¨ä¸€ä¸ªæ­»å¾ªç¯ä¸­ã€‚æ‹¿åˆ°socketä¹‹åèµ·ä¸€ä¸ªæ–°çš„çº¿ç¨‹æ¥å¤„ç†è¿™ä¸ªsocketã€‚å½“ç„¶ï¼Œå®é™…æƒ…å†µå¯èƒ½ä¸æ˜¯è¿™æ ·ï¼Œä¸ºæ¯ä¸€ä¸ªè¿æ¥åˆ›å»ºä¸€ä¸ªæ–°çš„çº¿ç¨‹æ˜¯å¾ˆè€—è´¹èµ„æºçš„ã€‚ æœ€åï¼Œè¿˜æœ‰ä¸€ç‚¹éœ€è¦æ³¨æ„çš„æ˜¯ï¼šä»Socketä¸­æ‹¿åˆ°InputStreamå’ŒOutputStreamä¹‹åå¦‚æœå…³é—­å®ƒä»¬ï¼Œsocketä¹Ÿå°†éšä¹‹å…³é—­(æœªéªŒè¯)ã€‚ 0x02 UDPè¿™ä¸ªä¸œè¥¿ç”¨çš„å¾ˆå°‘ï¼Œå°±æ˜¯å½“åˆæµ‹è¯•P2Pçš„æ—¶å€™ç”¨è¿‡ã€‚èƒ½æƒ³åˆ°çš„é—®é¢˜å°±æ˜¯æ•°æ®å¤§å°çš„é—®é¢˜ï¼Œæ¯”å¦‚å‘é€æ•°æ®æˆ‘ä»¬çš„æ•°æ®å®šä¹‰ä¸ºå¤šå¤§åˆé€‚ã€‚ä½†æ˜¯æœ€åæ²¡æœ‰å®é™…çš„é¡¹ç›®éªŒè¯ï¼Œåœ¨æ­¤ä¹Ÿä¸å¥½å›ç­”ã€‚å…ˆè´´ä¸€æ®µä»£ç å‡ºæ¥ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253public class UDPServer extends BaseThread &#123; /** * å‘é€é˜Ÿåˆ—å¤§å° */ public static final int SENDQUEUESIZE = 10; /** * æ¥æ”¶é˜Ÿåˆ—å¤§å° */ public static final int RECEIVEQUEUESIZE = 10; /** * UDPæ¥æ”¶ç¼“å­˜å¤§å° */ public static final int RECEIVERBUFFERSIZE = 1024; /** * UDPæ¥æ”¶ç¼“å­˜å¤§å° */ public static final int RECEIVERPACKETSIZE = 1024 * 64; private int count = 0; private DatagramPacket receivePacket; private DatagramSocket mSocket; @Override public boolean prepare() &#123; receivePacket = new DatagramPacket(new byte[RECEIVERPACKETSIZE], RECEIVERPACKETSIZE); try &#123; mSocket = new DatagramSocket(9559); &#125; catch (SocketException e) &#123; System.out.println(String.format(\"udp connect init error: %s\", e.getMessage())); return false; &#125; return true; &#125; @Override public void execute() &#123; try &#123; mSocket.receive(receivePacket); byte[] data = receivePacket.getData(); int length = receivePacket.getLength(); int offset = receivePacket.getOffset(); System.out.print(++count + String.format(\"length:%d|%d, offset:%d, data: %s \\n\", length, data.length, offset, new String(data, \"gbk\"))); System.out.println(data[1024]); &#125; catch (SocketException e) &#123; System.out.println(String.format(\"udp connect init error: %s\", e.getMessage())); &#125; catch (IOException e) &#123; System.out.println(String.format(\"udp connect init error: %s\", e.getMessage())); &#125; &#125;&#125; byte[] data = receivePacket.getData(); è¿™ä¸ªåœ°æ–¹æ‹¿åˆ°çš„dataæ˜¯ç¼“å†²åŒºçš„å¤§å°ï¼Œä»–ä»¬åœ°å€æ˜¯ä¸€æ ·çš„ï¼Œè¿™ä¸ªå¤§å®¶å¯ä»¥è¯•è¯•å°±çŸ¥é“ã€‚è‡³äºè¿™ä¸ªdataä¸­æœ‰å¤šå°‘æ•°æ®ï¼Œå°±éœ€è¦æˆ‘ä»¬é€šè¿‡ receivePacket.getLength(); æ‹¿åˆ°ã€‚","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"https://ttdevs.github.io/categories/æŠ€æœ¯/"}],"tags":[{"name":"Java","slug":"Java","permalink":"https://ttdevs.github.io/tags/Java/"}]}]}