<?xml version="1.0" encoding="utf-8"?>
<search> 
  
    
    <entry>
      <title><![CDATA[[Android]ä»é€šè¿‡view.post()è·å–Viewå®½é«˜è°ˆAndroidæ¶ˆæ¯æœºåˆ¶]]></title>
      <url>/2017/07/26/Android-%E4%BB%8E%E9%80%9A%E8%BF%87view-post-%E8%8E%B7%E5%8F%96View%E5%AE%BD%E9%AB%98%E8%B0%88Android%E6%B6%88%E6%81%AF%E6%9C%BA%E5%88%B6/</url>
      <content type="html"><![CDATA[<h2 id="0x00-é€šè¿‡view-post-è·å–Viewå®½é«˜"><a href="/2017/07/26/Android-ä»é€šè¿‡view-post-è·å–Viewå®½é«˜è°ˆAndroidæ¶ˆæ¯æœºåˆ¶/#0x00-é€šè¿‡view-post-è·å–Viewå®½é«˜" class="headerlink" title="0x00 é€šè¿‡view.post()è·å–Viewå®½é«˜"></a>0x00 é€šè¿‡view.post()è·å–Viewå®½é«˜</h2><p>æœ‰æ—¶å€™æˆ‘ä»¬å¸Œæœ›åœ¨ç•Œé¢åˆå§‹è¯çš„æ—¶å€™æ ¹æ®Viewçš„å°ºå¯¸æ¥åšä¸€äº›ç›¸å…³çš„æ“ä½œï¼ˆè°ƒæ•´ï¼‰ï¼Œé‚£å¦‚ä½•è·å–Viewçš„å°ºå¯¸å‘¢ï¼Ÿ</p>
<ul>
<li><p>åœ¨Activityçš„ <code>onCreate()</code> æ–¹æ³•ä¸­ delay å‡ ç™¾æ¯«ç§’<br><br>  ç”±äºæˆ‘ä»¬çŸ¥é“åœ¨ <code>onCreate()</code> ä¸­ç›´æ¥è·å–Viewçš„å°ºå¯¸å¾—åˆ°çš„å®½é«˜éƒ½æ˜¯0ï¼Œè¿™ä¸ªä¸ç»æ€è€ƒçš„ç­”æ¡ˆç›¸ä¿¡å¾ˆå¤šäººåœ¨ç”¨ã€‚</p>
</li>
<li><p>å¦‚æœä½ Googleè¿‡ç­”æ¡ˆï¼Œä¸€èˆ¬ä¼šæœ‰ä¸‹é¢è¿™å‡ ç§æ–¹æ³•ï¼š</p>
<ul>
<li><p>onWindowFocusChanged</p>
<p>  é‡å†™Activityçš„ <code>onWindowFocusChanged()</code> æ–¹æ³•ï¼Œå½“Activityçš„ç„¦ç‚¹çŠ¶æ€å‘ç”Ÿå˜åŒ–æ—¶ä¼šå›è°ƒè¿™ä¸ªæ–¹æ³•ï¼Œå‚æ•° <code>hasFocus</code> ä¸º <code>true</code> æ—¶è¡¨ç¤ºå·²ç»è·å–åˆ°ç„¦ç‚¹ï¼Œè¿™ä¸ªæ—¶å€™Viewçš„ç»˜åˆ¶å·²ç»å®Œæˆï¼Œä¹Ÿå°±å¯ä»¥è·å–åˆ°Viewçš„å°ºå¯¸äº†ã€‚</p>
<pre><code>@Override
public void onWindowFocusChanged(boolean hasFocus) {
  super.onWindowFocusChanged(hasFocus);
  if (hasFocus) {
      System.out.println(&quot;&gt;&gt;&gt;&gt;&gt;onWindowFocusChanged&quot; + tvLog.getWidth());
      System.out.println(&quot;&gt;&gt;&gt;&gt;&gt;onWindowFocusChanged&quot; + tvLog.getHeight());
  }
}
</code></pre></li>
<li><p>ViewTreeObserver.addOnPreDrawListener or .addOnGlobalLayoutListener</p>
<p>  è¿™ä¸ªæ–¹æ³•çš„ç¼ºç‚¹æ˜¯ä¼šå¤šæ¬¡è°ƒç”¨ã€‚</p>
<pre><code>private void getViewSize(){
    tvLog.getViewTreeObserver().addOnPreDrawListener(new ViewTreeObserver.OnPreDrawListener() {
        @Override
        public boolean onPreDraw() {
            System.out.println(&quot;&gt;&gt;&gt;&gt;&gt;addOnPreDrawListener&quot; + tvLog.getWidth());
            System.out.println(&quot;&gt;&gt;&gt;&gt;&gt;addOnPreDrawListener&quot; + tvLog.getHeight());
            return true;
        }
    });
    tvLog.getViewTreeObserver().addOnGlobalLayoutListener(new ViewTreeObserver.OnGlobalLayoutListener() {
        @Override
        public void onGlobalLayout() {
            System.out.println(&quot;&gt;&gt;&gt;&gt;&gt;addOnGlobalLayoutListener&quot; + tvLog.getWidth());
            System.out.println(&quot;&gt;&gt;&gt;&gt;&gt;addOnGlobalLayoutListener&quot; + tvLog.getHeight());
        }
    });
}
</code></pre></li>
<li><p>view.post()</p>
<p>  è¿™ä¸­æ–¹æ³•æ˜¯æˆ‘ä¸ªäººæ¨èçš„æ–¹æ³•ï¼Œæ¥ä¸‹æ¥çš„å†…å®¹ä¼šç€é‡åˆ†æã€‚</p>
<pre><code>private void getViewSize() {
    tvLog.post(new Runnable() {
        @Override
        public void run() {
            System.out.println(&quot;&gt;&gt;&gt;&gt;&gt;post&quot; + tvLog.getWidth());
            System.out.println(&quot;&gt;&gt;&gt;&gt;&gt;post&quot; + tvLog.getHeight());
        }
    });
}
</code></pre></li>
<li><p>å½“ç„¶ï¼Œè¿˜ä¼šæœ‰ä¸€äº›å…¶ä»–æ–¹æ³•ï¼Œæ¯”å¦‚æ‰‹åŠ¨measureï¼Œåœ¨Viewå†…éƒ¨è·å–ç­‰ç­‰</p>
</li>
</ul>
</li>
</ul>
<p><a href="https://stackoverflow.com/questions/3591784/getwidth-and-getheight-of-view-returns-0" target="_blank" rel="external">å¯ä»¥å‚è€ƒè¿™é‡Œ</a></p>
<p>ä»¥ä¸Šçš„å‡ ç§æ–¹æ³•éƒ½å¯ä»¥ï¼Œä¸‹é¢é’ˆå¯¹View.poståšä¸€ä¸ªåˆ†æã€‚</p>
<h2 id="0x01-Androidç³»ç»Ÿçš„æ¶ˆæ¯æœºåˆ¶"><a href="/2017/07/26/Android-ä»é€šè¿‡view-post-è·å–Viewå®½é«˜è°ˆAndroidæ¶ˆæ¯æœºåˆ¶/#0x01-Androidç³»ç»Ÿçš„æ¶ˆæ¯æœºåˆ¶" class="headerlink" title="0x01 Androidç³»ç»Ÿçš„æ¶ˆæ¯æœºåˆ¶"></a>0x01 Androidç³»ç»Ÿçš„æ¶ˆæ¯æœºåˆ¶</h2><p>Androidç³»ç»Ÿçš„æ¶ˆæ¯æœºåˆ¶ï¼Œæ˜¯æ¯ä¸ªåˆå­¦è€…éƒ½å¿…é¡»æŒæ¡çš„åŸºç¡€çŸ¥è¯†ã€‚ä»¥å‰å­¦ä¹ çš„æ—¶å€™æœ‰çœ‹è¿‡ï¼Œåˆé¢è¯•çš„æ—¶å€™ä¹Ÿå»çªå‡»è¿‡ï¼Œä½†æ˜¯éƒ½æ·±å…¥çš„å»ç†è§£å»æŒæ¡ï¼Œæƒ­æ„§å‘¢ã€‚</p>
<p>å¯¹äºä¸€ä¸ªæ¶ˆæ¯ç³»ç»Ÿï¼Œå¤§å®¶å¯ä»¥ç±»æ¯”ä¸‹ç”Ÿæ´»ä¸­çš„å¿«é€’ç³»ç»Ÿï¼šæœ‰å‘ä»¶äººï¼Œæœ‰æ”¶ä»¶äººï¼Œæœ‰å¿«é€’å…¬å¸ï¼Œå½“ç„¶è¿˜æœ‰æœ€é‡è¦çš„ä¿¡ä»¶ã€‚é€šè¿‡è¿™ä¸ªç³»ç»Ÿæˆ‘ä»¬å¯ä»¥å°†ä¸åŒçš„ä¿¡ä»¶æŠ•é€åˆ°ä¸åŒçš„åœ°æ–¹ï¼Œæ¯”å¦‚ä»ä¸ªäººæŠ•é€åˆ°æ”¿åºœéƒ¨é—¨ï¼Œä»å›½å†…æŠ•é€åˆ°å›½å¤–ç­‰ã€‚ä¸‹é¢çš„è¡¨æ ¼çœ‹èµ·æ¥ä¼šæ›´ç›´è§‚ä¸€äº›ï¼š</p>
<table>
<thead>
<tr>
<th style="text-align:center">å¿«é€’ç³»ç»Ÿ</th>
<th style="text-align:center">Androidæ¶ˆæ¯ç³»ç»Ÿ</th>
<th style="text-align:center">èŒè´£</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">å‘ä»¶äºº</td>
<td style="text-align:center">Handler</td>
<td style="text-align:center">å‘é€æ¶ˆæ¯</td>
</tr>
<tr>
<td style="text-align:center">æ”¶ä»¶äºº</td>
<td style="text-align:center">Handler</td>
<td style="text-align:center">æ¥æ”¶å¤„ç†æ¶ˆæ¯</td>
</tr>
<tr>
<td style="text-align:center">å¿«ä»¶</td>
<td style="text-align:center">Message</td>
<td style="text-align:center">å‘é€çš„å†…å®¹</td>
</tr>
<tr>
<td style="text-align:center">å¿«é€’å…¬å¸</td>
<td style="text-align:center">Looper / MessageQueue</td>
<td style="text-align:center">æ¥æ”¶æ¶ˆæ¯ã€ä¼ é€’æ¶ˆæ¯ã€åˆ†å‘æ¶ˆæ¯</td>
</tr>
</tbody>
</table>
<p>ç›¸ä¿¡è¿™ä¸ªç®€å•çš„å¯¹æ¯”å¯¹ç†è§£æ¶ˆæ¯æœºåˆ¶ä¼šæœ‰å¾ˆå¤§å¸®åŠ©ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬å†æ¥çœ‹çœ‹è¿™ä¸ªç³»ç»Ÿæ˜¯å¦‚ä½•è¿è¡Œçš„ã€‚</p>
<p>å…ˆçœ‹ä¸€ä¸‹æ¶ˆæ¯ç³»ç»Ÿçš„ç®€å•ä½¿ç”¨ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MainActivity</span> <span class="keyword">extends</span> <span class="title">AppCompatActivity</span> <span class="keyword">implements</span> <span class="title">View</span>.<span class="title">OnClickListener</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Handler mHandler = <span class="keyword">new</span> Handler() &#123;</div><div class="line"></div><div class="line">        <span class="meta">@Override</span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">handleMessage</span><span class="params">(Message msg)</span> </span>&#123;</div><div class="line">            <span class="keyword">super</span>.handleMessage(msg);</div><div class="line"></div><div class="line">            printMsg(<span class="string">"handleMessage:"</span> + msg.obj);</div><div class="line">        &#125;</div><div class="line">    &#125;;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</div><div class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState);</div><div class="line">        setContentView(R.layout.activity_main);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span><span class="params">(View view)</span> </span>&#123;</div><div class="line">        <span class="keyword">switch</span> (view.getId()) &#123;</div><div class="line">            <span class="keyword">case</span> R.id.btSendMsg:</div><div class="line">                defaultSendMsg();</div><div class="line">                <span class="keyword">break</span>;</div><div class="line"></div><div class="line">            <span class="keyword">default</span>:</div><div class="line">                <span class="keyword">break</span>;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">defaultSendMsg</span><span class="params">()</span> </span>&#123;</div><div class="line">        Message msg = <span class="keyword">new</span> Message();</div><div class="line">        msg.obj = <span class="string">"è¿™æ˜¯æœ€ç®€å•çš„ä½¿ç”¨æ–¹æ³•ï¼Œä½†æ— å®é™…æ„ä¹‰"</span>;</div><div class="line">        mHandler.sendMessage(msg);</div><div class="line">        printMsg(<span class="string">"Is MainLooper: "</span> + (mHandler.getLooper() == getMainLooper()));</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">printMsg</span><span class="params">(String msg)</span> </span>&#123;</div><div class="line">        System.out.println(<span class="string">"&gt;&gt;&gt;&gt;&gt;"</span> + msg);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>è¾“å‡ºä¿¡æ¯ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">I/System.out: &gt;&gt;&gt;&gt;&gt;Is MainLooper: true</div><div class="line">I/System.out: &gt;&gt;&gt;&gt;&gt;handleMessage:è¿™æ˜¯æœ€ç®€å•çš„ä½¿ç”¨æ–¹æ³•ï¼Œä½†æ— å®é™…æ„ä¹‰</div></pre></td></tr></table></figure>
<p>ä»è¿™é‡Œå¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬éœ€è¦å…ˆåˆ›å»ºä¸€ä¸ªHandlerå¯¹è±¡ï¼Œç„¶åé€šè¿‡è¿™ä¸ªHandlerå‘é€æ¶ˆæ¯ï¼Œç„¶ååœ¨Handlerä¸­å¤„ç†æ¥æ”¶åˆ°çš„æ¶ˆæ¯ã€‚å¦å¤–æˆ‘ä»¬è¿˜çœ‹åˆ°æˆ‘ä»¬çš„Looperå¯¹è±¡æ˜¯ä¸»çº¿ç¨‹çš„Looperï¼Œè¿™æ˜¯å› ä¸ºæˆ‘ä»¬æ˜¯åœ¨Activityè·‘çš„è¿™æ®µä»£ç ã€‚ä¸‹é¢æˆ‘ä»¬æ¥è·Ÿä¸€ä¸‹ä»£ç ã€‚</p>
<p>ä»Handlerçš„æ„é€ æ–¹æ³•å¼€å§‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="title">Handler</span><span class="params">(Callback callback, <span class="keyword">boolean</span> async)</span> </span>&#123;</div><div class="line">   ...</div><div class="line"></div><div class="line">   mLooper = Looper.myLooper();</div><div class="line">   <span class="keyword">if</span> (mLooper == <span class="keyword">null</span>) &#123;</div><div class="line">       <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(</div><div class="line">           <span class="string">"Can't create handler inside thread that has not called Looper.prepare()"</span>);</div><div class="line">   &#125;</div><div class="line">   mQueue = mLooper.mQueue;</div><div class="line">   mCallback = callback; <span class="comment">// è¿™ä¸ªå¯¹è±¡æˆ‘ä»¬åœ¨åé¢çš„dispatchMessageæ—¶ä¼šç”¨åˆ°</span></div><div class="line">   mAsynchronous = async;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>è¿™é‡Œæˆ‘ä»¬çœ‹åˆ°ï¼Œé€šè¿‡ <code>Looper.myLooper()</code> è·å–åˆ°ä¸€ä¸ªLooperå¯¹è±¡ï¼Œç„¶åå†ä»è¿™ä¸ªLooperå¯¹è±¡ä¸­æ‹¿åˆ°ä¸€ä¸ªMessageQueueå¯¹è±¡ï¼ˆmQueueï¼‰ï¼Œè¿™æ ·æˆ‘ä»¬å¾ˆå®¹æ˜“å¾—åˆ°ç»“è®ºâ€”â€”æ¶ˆæ¯é˜Ÿåˆ—æ˜¯ä½äºLooperä¸­çš„ã€‚é‚£MessageQueueæ˜¯ä»€ä¹ˆæ—¶å€™åˆ›å»ºçš„ï¼Œåˆæ˜¯æ€æ ·å¤„ç†æ¶ˆæ¯çš„ï¼Ÿå¸¦ç€è¿™äº›ç–‘é—®æˆ‘ä»¬æ¥ä¸‹æ¥çœ‹ <code>Handler.sendMessage(msg)</code> (<code>sendMessage()</code> æœ€ç»ˆä¼šè°ƒåˆ° <code>sendMessageAtTime()</code>)ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">sendMessageAtTime</span><span class="params">(Message msg, <span class="keyword">long</span> uptimeMillis)</span> </span>&#123;</div><div class="line">   MessageQueue queue = mQueue;</div><div class="line">   <span class="keyword">if</span> (queue == <span class="keyword">null</span>) &#123;</div><div class="line">       RuntimeException e = <span class="keyword">new</span> RuntimeException(</div><div class="line">               <span class="keyword">this</span> + <span class="string">" sendMessageAtTime() called with no mQueue"</span>);</div><div class="line">       Log.w(<span class="string">"Looper"</span>, e.getMessage(), e);</div><div class="line">       <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">   &#125;</div><div class="line">   <span class="keyword">return</span> enqueueMessage(queue, msg, uptimeMillis);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">boolean</span> <span class="title">enqueueMessage</span><span class="params">(MessageQueue queue, Message msg, <span class="keyword">long</span> uptimeMillis)</span> </span>&#123;</div><div class="line">   msg.target = <span class="keyword">this</span>;</div><div class="line">   <span class="keyword">if</span> (mAsynchronous) &#123;</div><div class="line">       msg.setAsynchronous(<span class="keyword">true</span>);</div><div class="line">   &#125;</div><div class="line">   <span class="keyword">return</span> queue.enqueueMessage(msg, uptimeMillis);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><code>sendMessageAtTime()</code> ä¼šä¼ å…¥ä¸¤ä¸ªå‚æ•°ï¼š<code>Message</code> å’Œ <code>uptimeMillis</code>ï¼Œ<code>uptimeMillis</code> çš„æ„æ€æ˜¯æ¶ˆæ¯å°†ä¼šåœ¨è¿™ä¸ªæ—¶åˆ»æ‰§è¡Œï¼ˆä¸æ˜¯éå¸¸ç²¾ç¡®ï¼‰ï¼Œè¿™ç§æƒ…å†µæ¯”å¦‚å¸¸è§çš„ <code>postDelay</code>ã€‚åœ¨ <code>enqueueMessage()</code> æ–¹æ³•ä¸­ï¼Œä¼šæ ¹æ®è¿™ä¸ªå€¼å°†æ¶ˆæ¯åŠ å…¥æ¶ˆæ¯é˜Ÿåˆ—ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥çœ‹åˆ°ï¼Œåœ¨æ”¾å…¥é˜Ÿåˆ—ä¹‹å‰Messageçš„ <code>target</code> è¢«è®¾ç½®ä¸ºå½“å‰çš„Handlerå¯¹è±¡â€”â€”é€éœ²ä¸‹è¿™ä¸ªæ˜¯ä¿è¯ä¹‹åæ¶ˆæ¯æŠ•é€’çš„æ—¶å€™ä»åˆ†å‘ç»™å½“å‰Handlerï¼Œè¿™ä¸ªå¾ˆé‡è¦ï¼</p>
<p>å†æ¥çœ‹ä¸‹ä¸Šé¢æåˆ°çš„ Looper å’Œ MessageQueueï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">Looper</span> </span>&#123;</div><div class="line">    ...</div><div class="line">    <span class="comment">// sThreadLocal.get() will return null unless you've called prepare().</span></div><div class="line">    <span class="keyword">static</span> <span class="keyword">final</span> ThreadLocal&lt;Looper&gt; sThreadLocal = <span class="keyword">new</span> ThreadLocal&lt;Looper&gt;();</div><div class="line">    ...</div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">prepare</span><span class="params">(<span class="keyword">boolean</span> quitAllowed)</span> </span>&#123;</div><div class="line">       <span class="keyword">if</span> (sThreadLocal.get() != <span class="keyword">null</span>) &#123;</div><div class="line">           <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(<span class="string">"Only one Looper may be created per thread"</span>);</div><div class="line">       &#125;</div><div class="line">       sThreadLocal.set(<span class="keyword">new</span> Looper(quitAllowed));</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="comment">/**</span></div><div class="line">    * Initialize the current thread as a looper, marking it as an</div><div class="line">    * application's main looper. The main looper for your application</div><div class="line">    * is created by the Android environment, so you should never need</div><div class="line">    * to call this function yourself.  See also: &#123;<span class="doctag">@link</span> #prepare()&#125;</div><div class="line">    */</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">prepareMainLooper</span><span class="params">()</span> </span>&#123;</div><div class="line">       prepare(<span class="keyword">false</span>);</div><div class="line">       <span class="keyword">synchronized</span> (Looper.class) &#123;</div><div class="line">           <span class="keyword">if</span> (sMainLooper != <span class="keyword">null</span>) &#123;</div><div class="line">               <span class="keyword">throw</span> <span class="keyword">new</span> IllegalStateException(<span class="string">"The main Looper has already been prepared."</span>);</div><div class="line">           &#125;</div><div class="line">           sMainLooper = myLooper();</div><div class="line">       &#125;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="comment">/**</span></div><div class="line">    * Returns the application's main looper, which lives in the main thread of the application.</div><div class="line">    */</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Looper <span class="title">getMainLooper</span><span class="params">()</span> </span>&#123;</div><div class="line">       <span class="keyword">synchronized</span> (Looper.class) &#123;</div><div class="line">           <span class="keyword">return</span> sMainLooper;</div><div class="line">       &#125;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="comment">/**</span></div><div class="line">    * Run the message queue in this thread. Be sure to call</div><div class="line">    * &#123;<span class="doctag">@link</span> #quit()&#125; to end the loop.</div><div class="line">    */</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">loop</span><span class="params">()</span> </span>&#123;</div><div class="line">       <span class="keyword">final</span> Looper me = myLooper();</div><div class="line">       <span class="keyword">if</span> (me == <span class="keyword">null</span>) &#123;</div><div class="line">           <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(<span class="string">"No Looper; Looper.prepare() wasn't called on this thread."</span>);</div><div class="line">       &#125;</div><div class="line">       <span class="keyword">final</span> MessageQueue queue = me.mQueue;</div><div class="line">       ...</div><div class="line">       <span class="keyword">for</span> (;;) &#123;</div><div class="line">           Message msg = queue.next(); <span class="comment">// might block</span></div><div class="line">           <span class="keyword">if</span> (msg == <span class="keyword">null</span>) &#123;</div><div class="line">               <span class="comment">// No message indicates that the message queue is quitting.</span></div><div class="line">               <span class="keyword">return</span>;</div><div class="line">           &#125;</div><div class="line">    </div><div class="line">           ...</div><div class="line">    </div><div class="line">           msg.target.dispatchMessage(msg);</div><div class="line">    </div><div class="line">           <span class="keyword">if</span> (logging != <span class="keyword">null</span>) &#123;</div><div class="line">               logging.println(<span class="string">"&lt;&lt;&lt;&lt;&lt; Finished to "</span> + msg.target + <span class="string">" "</span> + msg.callback);</div><div class="line">           &#125;</div><div class="line">    </div><div class="line">           ...</div><div class="line">    </div><div class="line">           msg.recycleUnchecked();</div><div class="line">       &#125;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="title">Looper</span><span class="params">(<span class="keyword">boolean</span> quitAllowed)</span> </span>&#123;</div><div class="line">        mQueue = <span class="keyword">new</span> MessageQueue(quitAllowed);</div><div class="line">        mThread = Thread.currentThread();</div><div class="line">    &#125;</div><div class="line">      </div><div class="line">    <span class="comment">/**</span></div><div class="line">    * Return the Looper object associated with the current thread.  Returns</div><div class="line">    * null if the calling thread is not associated with a Looper.</div><div class="line">    */</div><div class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="meta">@Nullable</span> <span class="function">Looper <span class="title">myLooper</span><span class="params">()</span> </span>&#123;</div><div class="line">       <span class="keyword">return</span> sThreadLocal.get();</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="comment">/**</span></div><div class="line">    * Return the &#123;<span class="doctag">@link</span> MessageQueue&#125; object associated with the current</div><div class="line">    * thread.  This must be called from a thread running a Looper, or a</div><div class="line">    * NullPointerException will be thrown.</div><div class="line">    */</div><div class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="meta">@NonNull</span> <span class="function">MessageQueue <span class="title">myQueue</span><span class="params">()</span> </span>&#123;</div><div class="line">       <span class="keyword">return</span> myLooper().mQueue;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="title">Looper</span><span class="params">(<span class="keyword">boolean</span> quitAllowed)</span> </span>&#123;</div><div class="line">       mQueue = <span class="keyword">new</span> MessageQueue(quitAllowed);</div><div class="line">       mThread = Thread.currentThread();</div><div class="line">    &#125;</div><div class="line">    ...</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>Looperçš„æ„é€ æ–¹æ³•ä¸­åªæ˜¯åˆ›å»ºäº†ä¸€ä¸ª MessageQueue å¯¹è±¡ï¼ŒåŒæ—¶è¿™ä¸ªæ–¹æ³•æ˜¯ç§æœ‰çš„ï¼Œå› æ­¤è¿™ä¸ªç±»æ— æ³•åœ¨å¤–éƒ¨é€šè¿‡newæ¥åˆ›å»ºï¼Œã€‚æˆ‘ä»¬çœ‹åˆ°å”¯ä¸€åˆ›å»ºçš„åœ°æ–¹å°±æ˜¯ <code>Looper.prepare()</code> æ–¹æ³•ä¸­ï¼Œåˆ›å»ºå¥½ä¹‹åç›´æ¥è¢«åŠ å…¥åˆ°ThreadLocalä¸­ã€‚å†æ¥çœ‹æˆ‘ä»¬åˆšæ‰ç”¨åˆ°çš„ <code>Looper.myLooper()</code> æ–¹æ³•ï¼Œè¿™å…¶ä¸­åªæœ‰ä¸€è¡Œå¾ˆå°´å°¬çš„ä»£ç ï¼Œ<code>sThreadLocal.get()</code> ï¼Œå®ƒå°±æ˜¯ä»ThreadLocalä¸­è·å– <code>å±äºå½“å‰çº¿ç¨‹çš„ Looper å¯¹è±¡</code>ã€‚å…³äº ThreadLocalï¼Œè¿™ä¸ªåœ¨æˆ‘çš„<a href="http://blog.csdn.net/ttdevs/article/details/71375416" target="_blank" rel="external">å¦ä¸€ç¯‡æ–‡ç« ä¸­æœ‰ä»‹ç»</a>â€”â€”æˆ‘ä»¬åœ¨çº¿ç¨‹ä¸­åˆ›å»ºçš„å˜é‡ï¼Œä»»ä½•ä¸€ä¸ªçº¿ç¨‹éƒ½å¯ä»¥è®¿é—®å¹¶å¯¹å…¶ä¿®æ”¹ï¼Œä½†æ˜¯æˆ‘ä»¬é€šè¿‡LocalThreadåˆ›å»ºçš„å˜é‡ï¼Œå°±åªæœ‰å½“å‰çº¿ç¨‹å¯ä»¥è®¿é—®äº†ã€‚</p>
<p>ä¹‹å‰æˆ‘ä»¬çŸ¥é“é€šè¿‡ Handler.sendMessage(msg) å°† Message å­˜å…¥ MessageQueue ä¸­ï¼Œåœ¨ä¸Šé¢çš„ä»£ç ä¸­æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼ŒLooper.loop()ä¸­å¼€äº†ä¸€ä¸ªæ­»å¾ªç¯ï¼Œå°†æ¶ˆæ¯ä» MessageQueue ä¸­å–å‡ºç„¶åè¿›è¡Œåˆ†å‘ã€‚çœ‹åˆ° MessageQueue åæˆ‘ç¬¬ä¸€ä¸ªæƒ³åˆ°å°±æ˜¯é˜»å¡é˜Ÿåˆ—ï¼Œç»“æœçœ‹äº†æºç ä¹‹åå¹¶ä¸æ˜¯è¿™ä¹ˆç®€å•ã€‚å¦‚æœæƒ³çœ‹è¿™ä¸ªç±»çš„åˆ†æï¼Œå¯ä»¥å‚è€ƒ<a href="http://blog.csdn.net/luoshengyang/article/details/6817933/" target="_blank" rel="external">è¿™é‡Œ</a>ï¼Œè¿™æ˜¯æœ€æ ¸å¿ƒçš„éƒ¨åˆ†ï¼Œæ¶‰åŠåˆ°æ“ä½œç³»ç»Ÿçš„çŸ¥è¯†ï¼Œæˆ‘å°±ä¸å–å¼„äº†ã€‚ä½†æ˜¯è¿™ä¸å½±å“æˆ‘ä»¬å°† MessageQueue æŒ‰ç…§ä¸€ä¸ªé˜»å¡é˜Ÿåˆ—æ¥ç†è§£ã€‚</p>
<p>å†çœ‹ä¸‹Looperæ˜¯å¦‚ä½•ä½¿ç”¨çš„ã€‚æˆ‘ä»¬åœ¨Looperçš„ç±»æ³¨é‡Šä¸­å¯ä»¥çœ‹åˆ°è¿™æ®µä¿¡æ¯ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line">  * Class used to run a message loop for a thread.  Threads by default do</div><div class="line">  * not have a message loop associated with them; to create one, call</div><div class="line">  * &#123;<span class="doctag">@link</span> #prepare&#125; in the thread that is to run the loop, and then</div><div class="line">  * &#123;<span class="doctag">@link</span> #loop&#125; to have it process messages until the loop is stopped.</div><div class="line">  *</div><div class="line">  * &lt;p&gt;Most interaction with a message loop is through the</div><div class="line">  * &#123;<span class="doctag">@link</span> Handler&#125; class.</div><div class="line">  *</div><div class="line">  * &lt;p&gt;This is a typical example of the implementation of a Looper thread,</div><div class="line">  * using the separation of &#123;<span class="doctag">@link</span> #prepare&#125; and &#123;<span class="doctag">@link</span> #loop&#125; to create an</div><div class="line">  * initial Handler to communicate with the Looper.</div><div class="line">  *</div><div class="line">  * &lt;pre&gt;</div><div class="line">  *  class LooperThread extends Thread &#123;</div><div class="line">  *      public Handler mHandler;</div><div class="line">  *</div><div class="line">  *      public void run() &#123;</div><div class="line">  *          Looper.prepare();</div><div class="line">  *</div><div class="line">  *          mHandler = new Handler() &#123;</div><div class="line">  *              public void handleMessage(Message msg) &#123;</div><div class="line">  *                  // process incoming messages here</div><div class="line">  *              &#125;</div><div class="line">  *          &#125;;</div><div class="line">  *</div><div class="line">  *          Looper.loop();</div><div class="line">  *      &#125;</div><div class="line">  *  &#125;&lt;/pre&gt;</div><div class="line">  */</div><div class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">Looper</span> </span>&#123;...&#125;</div></pre></td></tr></table></figure>
<p>å¦‚æœæˆ‘ä»¬éœ€è¦åœ¨è‡ªå·±çš„çº¿ç¨‹ä¸­å®ç°æ¶ˆæ¯æœºåˆ¶ï¼Œæˆ‘ä»¬éœ€è¦å…ˆæ‰§è¡Œ <code>Looper.prepare();</code>ï¼› ç„¶ååˆ›å»º Handlerå¯¹è±¡ï¼›æœ€åå†æ‰§è¡Œ <code>Looper.loop()</code>ï¼›è¿™ä¸ªé¡ºåºä¸èƒ½é¢ å€’ï¼æœ€åæˆ‘ä»¬å†æ¥å°†è¿™ä¸ªæµç¨‹æ¢³ç†ä¸€ä¸‹ï¼š</p>
<ol>
<li><p>Looper.prepare()ï¼›</p>
<p> åˆå§‹åŒ–å±äºå½“å‰çº¿ç¨‹çš„ Looper å¯¹è±¡ï¼Œç„¶åæ”¾å…¥ ThreadLocal ä¸­ã€‚</p>
</li>
<li><p>new Handler()ï¼›</p>
<p> ä¸ºä»€ä¹ˆä¸€å®šè¦åœ¨ <code>Looper.prepare()</code> ä¹‹å <code>Looper.loop()</code> ä¹‹å‰åˆ›å»ºHandlerå¯¹è±¡å‘¢ï¼Ÿ </p>
<p> ç­”ï¼šåœ¨ <code>Looper.prepare()</code> ä¹‹åæ˜¯å› ä¸º Handler çš„æ„é€ å‡½æ•°ä¸­éœ€è¦æä¾›å½“å‰çº¿ç¨‹çš„ Looper å¯¹ è±¡ï¼Œè¿™ä¸ª Looper å¯¹è±¡åªèƒ½é€šè¿‡ <code>Looper.prepare()</code> æ¥åˆ›å»ºã€‚åœ¨ <code>Looper.loop()</code> ä¹‹å‰æ˜¯å› ä¸ºLooper.loop()æ˜¯ä¸ªæ­»å¾ªç¯ï¼Œå†™åœ¨å…¶åä»£ç æ˜¯æ‰§è¡Œä¸åˆ°çš„ï¼ˆçœ‹çœ‹æœ€åç•™çš„é‚£ä¸ªé—®é¢˜ï½ï¼‰ã€‚</p>
</li>
<li><p>Looper.loop();</p>
<p> è¿™ä¸ªæ“ä½œå°±æ˜¯å¼€å§‹æ‰§è¡Œæ¶ˆæ¯å¾ªç¯ï¼Œå¤„ç†æ¶ˆæ¯ã€‚</p>
</li>
</ol>
<p>å°ç»“ï¼š</p>
<p>æ¶ˆæ¯æœºåˆ¶æ˜¯Androidç³»ç»Ÿä¸­çº¿ç¨‹é€šä¿¡éå¸¸é‡è¦çš„ä¸€ç§æ–¹æ³•ã€‚å¦‚æœå‘å¦ä¸€ä¸ªçº¿ç¨‹ä¼ é€’æ•°æ®ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ç›®æ ‡çº¿ç¨‹ä¸­å¯åŠ¨æ¶ˆæ¯æœºåˆ¶ï¼Œæ‹¿åˆ°è¿™ä¸ªçº¿ç¨‹Looperå¯¹è±¡åˆ›å»ºä¸€ä¸ªHandlerï¼Œé€šè¿‡è¿™ä¸ªHandlerå°±å¯ä»¥å‘ç›®æ ‡çº¿ç¨‹å‘é€æ¶ˆæ¯äº†ï¼Œåä¹‹äº¦ç„¶ã€‚</p>
<h2 id="0x03-HandlerThreadã€AsyncTask-å’Œ-UI-Thread"><a href="/2017/07/26/Android-ä»é€šè¿‡view-post-è·å–Viewå®½é«˜è°ˆAndroidæ¶ˆæ¯æœºåˆ¶/#0x03-HandlerThreadã€AsyncTask-å’Œ-UI-Thread" class="headerlink" title="0x03 HandlerThreadã€AsyncTask å’Œ UI Thread"></a>0x03 HandlerThreadã€AsyncTask å’Œ UI Thread</h2><ul>
<li><p>HandlerThread</p>
<p>  ä»æºç å¯ä»¥çœ‹åˆ°ï¼Œè¿™ä¸ªç±»æ˜¯å¯¹æˆ‘ä»¬Androidæ¶ˆæ¯æœºåˆ¶çš„ä¸€ä¸ªå°è£…ã€‚å½“æˆ‘ä»¬éœ€è¦è‡ªå·±å»å†™ä¸€ä¸ªåœ¨å­çº¿ç¨‹å·¥ä½œç„¶åå°†ç»“æœä¼ åˆ°ä¸»çº¿ç¨‹çš„åŠŸèƒ½æ—¶å¯ä»¥è€ƒè™‘ç”¨è¿™ä¸ªç±»ã€‚ä¸‹é¢æä¾›ä¸€ä¸ªç®€å•çš„Demoï¼š</p>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HandlerThreadActivity</span> <span class="keyword">extends</span> <span class="title">AppCompatActivity</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="keyword">private</span> Handler mHandler = <span class="keyword">new</span> Handler()&#123;</div><div class="line">        <span class="meta">@Override</span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">handleMessage</span><span class="params">(Message msg)</span> </span>&#123;</div><div class="line">            <span class="keyword">super</span>.handleMessage(msg);</div><div class="line"></div><div class="line">            String threadName = Thread.currentThread().getName();</div><div class="line">            tvLog.setText(String.format(<span class="string">"å½“å‰çº¿ç¨‹ï¼š%s Msgï¼š%s"</span>, threadName, msg.obj));</div><div class="line">        &#125;</div><div class="line">    &#125;;</div><div class="line"></div><div class="line">    <span class="keyword">private</span> TextView tvLog;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</div><div class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState);</div><div class="line">        setContentView(R.layout.activity_handler_thread);</div><div class="line">        Toolbar toolbar = (Toolbar) findViewById(R.id.toolbar);</div><div class="line">        setSupportActionBar(toolbar);</div><div class="line"></div><div class="line">        tvLog = (TextView)findViewById(R.id.tvLog);</div><div class="line"></div><div class="line">        FloatingActionButton fab = (FloatingActionButton) findViewById(R.id.fab);</div><div class="line">        fab.setOnClickListener(<span class="keyword">new</span> View.OnClickListener() &#123;</div><div class="line">            <span class="meta">@Override</span></div><div class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span><span class="params">(View view)</span> </span>&#123;</div><div class="line">                sendMessage();</div><div class="line">            &#125;</div><div class="line">        &#125;);</div><div class="line"></div><div class="line">        initData();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">private</span> Handler mWorker;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">initData</span><span class="params">()</span> </span>&#123;</div><div class="line">        HandlerThread worker = <span class="keyword">new</span> HandlerThread(<span class="string">"worker"</span>);</div><div class="line">        worker.start();</div><div class="line">        mWorker = <span class="keyword">new</span> Handler(worker.getLooper());</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">sendMessage</span><span class="params">()</span> </span>&#123;</div><div class="line">        mWorker.post(<span class="keyword">new</span> Runnable() &#123;</div><div class="line">            <span class="meta">@Override</span></div><div class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</div><div class="line">                print(<span class="string">"æˆ‘å·¥ä½œåœ¨çº¿ç¨‹ï¼š"</span> + Thread.currentThread().getName());</div><div class="line">                <span class="keyword">try</span> &#123;</div><div class="line">                    Thread.sleep(<span class="number">6</span> * <span class="number">1000</span>);</div><div class="line">                &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</div><div class="line">                    e.printStackTrace();</div><div class="line">                &#125;</div><div class="line">                sendMsgToUI();</div><div class="line">            &#125;</div><div class="line"></div><div class="line">            <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">sendMsgToUI</span><span class="params">()</span></span>&#123;</div><div class="line">                Message msg = <span class="keyword">new</span> Message();</div><div class="line">                msg.obj = Thread.currentThread().getName() + <span class="string">"å·¥ä½œå®Œæˆï¼Œè¿™æ˜¯ç»“æœ"</span>;</div><div class="line">                    mHandler.sendMessage(msg);</div><div class="line">            &#125;</div><div class="line">        &#125;);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">print</span><span class="params">(String msg)</span> </span>&#123;</div><div class="line">        System.out.println(<span class="string">"&gt;&gt;&gt;&gt;&gt;"</span> + msg);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>æ€è·¯å¦‚ä¸‹ï¼š</p>
<ol>
<li>åˆ›å»ºHandlerThreadå¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡æ˜¯ä¸€ä¸ªçº¿ç¨‹</li>
<li>å¯åŠ¨ç¬¬ä¸€æ­¥åˆ›å»ºçš„çº¿ç¨‹</li>
<li>åˆ›å»ºä¸€ä¸ªHandlerï¼Œå¹¶ä½¿ç”¨ç¬¬ä¸€æ­¥åˆ›å»ºçš„çº¿ç¨‹ä¸­çš„Looper</li>
<li>ç„¶ååœ¨ä¸»çº¿ç¨‹é€šè¿‡è¿™ä¸ªHandlerå‘å·¥ä½œçº¿ç¨‹å‘ä»»åŠ¡</li>
<li>ä»»åŠ¡æ‰§è¡Œå®Œæ¯•åï¼Œä½¿ç”¨åœ¨Activityï¼ˆä¸»çº¿ç¨‹ï¼‰ä¸­çš„Handlerå‘é€æ¶ˆæ¯ï¼Œå°†ç»“æœä»å·¥ä½œçº¿ç¨‹ä¼ å›ä¸»çº¿ç¨‹</li>
</ol>
<ul>
<li><p>AsyncTask</p>
<p>  è¿™æ˜¯ä¸ªéå¸¸å¼ºå¤§çš„å·¥å…·ç±»ï¼Œç”¨åˆ°çš„çŸ¥è¯†ç‚¹ä¹Ÿéå¸¸å¤šï¼Œæ›¾ç»ç»Ÿæ²»è¿‡ç½‘ç»œåº“çš„ç¼–å†™ã€‚è¿™é‡Œåªè®²è·Ÿæˆ‘ä»¬æ¶ˆæ¯ç³»ç»Ÿç›¸å…³çš„çŸ¥è¯†ï¼Œå…ˆçœ‹ä¸€æ®µæºç ï¼š</p>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">AsyncTask</span>&lt;<span class="title">Params</span>, <span class="title">Progress</span>, <span class="title">Result</span>&gt; </span>&#123;</div><div class="line">...</div><div class="line">    <span class="keyword">private</span> <span class="keyword">static</span> InternalHandler sHandler; </div><div class="line">...</div><div class="line">    <span class="comment">// è·å–åˆ°Handler</span></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> Handler <span class="title">getHandler</span><span class="params">()</span> </span>&#123; </div><div class="line">        <span class="keyword">synchronized</span> (AsyncTask.class) &#123;</div><div class="line">            <span class="keyword">if</span> (sHandler == <span class="keyword">null</span>) &#123;</div><div class="line">                sHandler = <span class="keyword">new</span> InternalHandler();</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">return</span> sHandler;</div><div class="line">        &#125;</div><div class="line">...</div><div class="line">    <span class="comment">// åœ¨å·¥ä½œçº¿ç¨‹å‘é€ç»“æœåˆ°ä¸»çº¿ç¨‹ï¼Œè¿™é‡Œè·å–åˆ°Message.targetéƒ½æ˜¯sHandlerå¯¹è±¡</span></div><div class="line">    <span class="function"><span class="keyword">private</span> Result <span class="title">postResult</span><span class="params">(Result result)</span> </span>&#123;</div><div class="line">        <span class="meta">@SuppressWarnings</span>(<span class="string">"unchecked"</span>)</div><div class="line">        Message message = getHandler().obtainMessage(MESSAGE_POST_RESULT,</div><div class="line">                <span class="keyword">new</span> AsyncTaskResult&lt;Result&gt;(<span class="keyword">this</span>, result));</div><div class="line">        message.sendToTarget();</div><div class="line">        <span class="keyword">return</span> result;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">...</div><div class="line">    <span class="comment">/**</span></div><div class="line">     * &lt;p&gt;Runs on the UI thread after &#123;<span class="doctag">@link</span> #doInBackground&#125;. The</div><div class="line">     * specified result is the value returned by &#123;<span class="doctag">@link</span> #doInBackground&#125;.&lt;/p&gt;</div><div class="line">     * </div><div class="line">     * &lt;p&gt;This method won't be invoked if the task was cancelled.&lt;/p&gt;</div><div class="line">     *</div><div class="line">     * <span class="doctag">@param</span> result The result of the operation computed by &#123;<span class="doctag">@link</span> #doInBackground&#125;.</div><div class="line">     *</div><div class="line">     * <span class="doctag">@see</span> #onPreExecute</div><div class="line">     * <span class="doctag">@see</span> #doInBackground</div><div class="line">     * <span class="doctag">@see</span> #onCancelled(Object) </div><div class="line">     */</div><div class="line">    <span class="meta">@SuppressWarnings</span>(&#123;<span class="string">"UnusedDeclaration"</span>&#125;)</div><div class="line">    <span class="meta">@MainThread</span> <span class="comment">// è¿™ä¸ªæ–¹æ³•é‡Œçš„ä»£ç éƒ½æ˜¯åœ¨ä¸»çº¿ç¨‹æ‰§è¡Œäº†</span></div><div class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onPostExecute</span><span class="params">(Result result)</span> </span>&#123;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * Runs on the UI thread after &#123;<span class="doctag">@link</span> #publishProgress&#125; is invoked.</div><div class="line">     * The specified values are the values passed to &#123;<span class="doctag">@link</span> #publishProgress&#125;.</div><div class="line">     *</div><div class="line">     * <span class="doctag">@param</span> values The values indicating progress.</div><div class="line">     *</div><div class="line">     * <span class="doctag">@see</span> #publishProgress</div><div class="line">     * <span class="doctag">@see</span> #doInBackground</div><div class="line">     */</div><div class="line">    <span class="meta">@SuppressWarnings</span>(&#123;<span class="string">"UnusedDeclaration"</span>&#125;)</div><div class="line">    <span class="meta">@MainThread</span> <span class="comment">// è¿™ä¸ªæ–¹æ³•é‡Œçš„ä»£ç éƒ½æ˜¯åœ¨ä¸»çº¿ç¨‹æ‰§è¡Œäº†</span></div><div class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onProgressUpdate</span><span class="params">(Progress... values)</span> </span>&#123;</div><div class="line">    &#125;</div><div class="line">...</div><div class="line">    <span class="comment">/**</span></div><div class="line">     * This method can be invoked from &#123;<span class="doctag">@link</span> #doInBackground&#125; to</div><div class="line">     * publish updates on the UI thread while the background computation is</div><div class="line">     * still running. Each call to this method will trigger the execution of</div><div class="line">     * &#123;<span class="doctag">@link</span> #onProgressUpdate&#125; on the UI thread.</div><div class="line">     *</div><div class="line">     * &#123;<span class="doctag">@link</span> #onProgressUpdate&#125; will not be called if the task has been</div><div class="line">     * canceled.</div><div class="line">     *</div><div class="line">     * <span class="doctag">@param</span> values The progress values to update the UI with.</div><div class="line">     *</div><div class="line">     * <span class="doctag">@see</span> #onProgressUpdate</div><div class="line">     * <span class="doctag">@see</span> #doInBackground</div><div class="line">     */</div><div class="line">    <span class="meta">@WorkerThread</span> <span class="comment">// ä»å·¥ä½œçº¿ç¨‹å‘æ¶ˆæ¯åˆ°ä¸»çº¿ç¨‹</span></div><div class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">final</span> <span class="keyword">void</span> <span class="title">publishProgress</span><span class="params">(Progress... values)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (!isCancelled()) &#123;</div><div class="line">            getHandler().obtainMessage(MESSAGE_POST_PROGRESS,</div><div class="line">                    <span class="keyword">new</span> AsyncTaskResult&lt;Progress&gt;(<span class="keyword">this</span>, values)).sendToTarget();</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">finish</span><span class="params">(Result result)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (isCancelled()) &#123;</div><div class="line">            onCancelled(result);</div><div class="line">        &#125; <span class="keyword">else</span> &#123;</div><div class="line">            onPostExecute(result);</div><div class="line">        &#125;</div><div class="line">        mStatus = Status.FINISHED;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">InternalHandler</span> <span class="keyword">extends</span> <span class="title">Handler</span> </span>&#123;</div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="title">InternalHandler</span><span class="params">()</span> </span>&#123;</div><div class="line">            <span class="keyword">super</span>(Looper.getMainLooper()); <span class="comment">// åˆ›å»ºä¸€ä¸ªHandlerå¯¹è±¡ï¼Œä½¿ç”¨çš„Looperæ˜¯ä¸»çº¿ç¨‹çš„Looperï¼Œé‚£ä¹ˆå®ƒå¤„ç†çš„æ¶ˆæ¯éƒ½å°†åœ¨ä¸»çº¿ç¨‹ï¼Œè¿™ä¸ªå¾ˆå…³é”®</span></div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="meta">@SuppressWarnings</span>(&#123;<span class="string">"unchecked"</span>, <span class="string">"RawUseOfParameterizedType"</span>&#125;)</div><div class="line">        <span class="meta">@Override</span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">handleMessage</span><span class="params">(Message msg)</span> </span>&#123;</div><div class="line">            AsyncTaskResult&lt;?&gt; result = (AsyncTaskResult&lt;?&gt;) msg.obj;</div><div class="line">            <span class="keyword">switch</span> (msg.what) &#123;</div><div class="line">                <span class="keyword">case</span> MESSAGE_POST_RESULT:</div><div class="line">                    <span class="comment">// There is only one result</span></div><div class="line">                    result.mTask.finish(result.mData[<span class="number">0</span>]);</div><div class="line">                    <span class="keyword">break</span>;</div><div class="line">                <span class="keyword">case</span> MESSAGE_POST_PROGRESS:</div><div class="line">                    result.mTask.onProgressUpdate(result.mData);</div><div class="line">                    <span class="keyword">break</span>;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">...</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>çœ‹äº†ä¸Šé¢çš„æºç å†å›æƒ³ä¸‹AsyncTaskç”¨æ³•æˆ‘ä»¬å¯ä»¥å¾—åˆ°å¦‚ä¸‹ç»“è®ºï¼š</p>
<ol>
<li>ä¸»çº¿ç¨‹æ— éœ€åŠ¨æ€å‘å·¥ä½œçº¿ç¨‹å‘æ¶ˆæ¯ï¼Œåªæ˜¯åˆå§‹åŒ–çš„æ—¶å€™ä¼ é€’ä¸€äº›å‚æ•°</li>
<li>å·¥ä½œçº¿ç¨‹å®Œæˆåï¼Œé€šè¿‡è·å–ä¸»çº¿ç¨‹çš„Looperï¼Œæ„å»ºHandlerå°†ç»“æœå‘é€ç»™ä¸»çº¿ç¨‹</li>
</ol>
<ul>
<li><p>UI Thread</p>
<p>  çœ‹äº†ä¸Šé¢çš„ä¸¤ä¸ªæ¡ˆä¾‹ï¼Œæˆ‘ä»¬åœ¨æ¥çœ‹çœ‹ä¸ºä»€ä¹ˆæˆ‘ä»¬ä½¿ç”¨çš„ä¸»çº¿ç¨‹å¯ä»¥ç›´æ¥ä½¿ç”¨æ¶ˆæ¯ç³»ç»Ÿè€Œæ²¡æœ‰æ‰§è¡Œ<code>Looper.prepare()</code>ï¼Œ<code>Looper.loop()</code> ä¹‹ç±»çš„åˆå§‹åŒ–å·¥ä½œå‘¢ã€‚</p>
<p>  å…¶å®ç»“è®ºå¾ˆç®€å•ï¼Œä¸å¯èƒ½ä¸åˆå§‹åŒ–ï¼Œåªæ˜¯ç³»ç»Ÿæå‰å·²ç»å¸®æˆ‘ä»¬åˆå§‹åŒ–å¥½äº†ï¼Œè¿™éƒ¨åˆ†çš„æºç ä½äº <code>sdk/sources/android-xx/android/app/ActivityThread.java</code> ä¸­ï¼š</p>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">ActivityThread</span> </span>&#123;</div><div class="line">...</div><div class="line">    <span class="keyword">final</span> H mH = <span class="keyword">new</span> H();</div><div class="line">...</div><div class="line"><span class="keyword">private</span> <span class="class"><span class="keyword">class</span> <span class="title">H</span> <span class="keyword">extends</span> <span class="title">Handler</span> </span>&#123;</div><div class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> LAUNCH_ACTIVITY         = <span class="number">100</span>;</div><div class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> PAUSE_ACTIVITY          = <span class="number">101</span>;</div><div class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> PAUSE_ACTIVITY_FINISHING= <span class="number">102</span>;</div><div class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> STOP_ACTIVITY_SHOW      = <span class="number">103</span>;</div><div class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> STOP_ACTIVITY_HIDE      = <span class="number">104</span>;</div><div class="line">    ...</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">handleMessage</span><span class="params">(Message msg)</span> </span>&#123;</div><div class="line">      ...</div><div class="line">      <span class="keyword">switch</span> (msg.what) &#123;</div><div class="line">          <span class="keyword">case</span> LAUNCH_ACTIVITY: &#123;</div><div class="line">              Trace.traceBegin(Trace.TRACE_TAG_ACTIVITY_MANAGER, <span class="string">"activityStart"</span>);</div><div class="line">              <span class="keyword">final</span> ActivityClientRecord r = (ActivityClientRecord) msg.obj;</div><div class="line">              r.packageInfo = getPackageInfoNoCheck(</div><div class="line">                      r.activityInfo.applicationInfo, r.compatInfo);</div><div class="line">              handleLaunchActivity(r, <span class="keyword">null</span>, <span class="string">"LAUNCH_ACTIVITY"</span>);</div><div class="line">              Trace.traceEnd(Trace.TRACE_TAG_ACTIVITY_MANAGER);</div><div class="line">          &#125; <span class="keyword">break</span>;</div><div class="line">          <span class="keyword">case</span> RELAUNCH_ACTIVITY: &#123;</div><div class="line">              Trace.traceBegin(Trace.TRACE_TAG_ACTIVITY_MANAGER, <span class="string">"activityRestart"</span>);</div><div class="line">              ActivityClientRecord r = (ActivityClientRecord)msg.obj;</div><div class="line">              handleRelaunchActivity(r);</div><div class="line">              Trace.traceEnd(Trace.TRACE_TAG_ACTIVITY_MANAGER);</div><div class="line">          &#125; <span class="keyword">break</span>;</div><div class="line">          <span class="keyword">case</span> PAUSE_ACTIVITY: &#123;</div><div class="line">              Trace.traceBegin(Trace.TRACE_TAG_ACTIVITY_MANAGER, <span class="string">"activityPause"</span>);</div><div class="line">              SomeArgs args = (SomeArgs) msg.obj;</div><div class="line">              handlePauseActivity((IBinder) args.arg1, <span class="keyword">false</span>,</div><div class="line">                      (args.argi1 &amp; USER_LEAVING) != <span class="number">0</span>, args.argi2,</div><div class="line">                      (args.argi1 &amp; DONT_REPORT) != <span class="number">0</span>, args.argi3);</div><div class="line">              maybeSnapshot();</div><div class="line">              Trace.traceEnd(Trace.TRACE_TAG_ACTIVITY_MANAGER);</div><div class="line">          &#125; <span class="keyword">break</span>;</div><div class="line">          ...</div><div class="line">       &#125;</div><div class="line">       ...</div><div class="line">    &#125;</div><div class="line">    ...</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">        Trace.traceBegin(Trace.TRACE_TAG_ACTIVITY_MANAGER, <span class="string">"ActivityThreadMain"</span>);</div><div class="line">        SamplingProfilerIntegration.start();</div><div class="line"></div><div class="line">        <span class="comment">// CloseGuard defaults to true and can be quite spammy.  We</span></div><div class="line">        <span class="comment">// disable it here, but selectively enable it later (via</span></div><div class="line">        <span class="comment">// StrictMode) on debug builds, but using DropBox, not logs.</span></div><div class="line">        CloseGuard.setEnabled(<span class="keyword">false</span>);</div><div class="line"></div><div class="line">        Environment.initForCurrentUser();</div><div class="line"></div><div class="line">        <span class="comment">// Set the reporter for event logging in libcore</span></div><div class="line">        EventLogger.setReporter(<span class="keyword">new</span> EventLoggingReporter());</div><div class="line"></div><div class="line">        <span class="comment">// Make sure TrustedCertificateStore looks in the right place for CA certificates</span></div><div class="line">        <span class="keyword">final</span> File configDir = Environment.getUserConfigDirectory(UserHandle.myUserId());</div><div class="line">        TrustedCertificateStore.setDefaultUserDirectory(configDir);</div><div class="line"></div><div class="line">        Process.setArgV0(<span class="string">"&lt;pre-initialized&gt;"</span>);</div><div class="line"></div><div class="line">        Looper.prepareMainLooper(); <span class="comment">// å‡†å¤‡MainLooper</span></div><div class="line"></div><div class="line">        ActivityThread thread = <span class="keyword">new</span> ActivityThread();</div><div class="line">        thread.attach(<span class="keyword">false</span>);</div><div class="line"></div><div class="line">        <span class="keyword">if</span> (sMainThreadHandler == <span class="keyword">null</span>) &#123;</div><div class="line">            sMainThreadHandler = thread.getHandler();</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="keyword">if</span> (<span class="keyword">false</span>) &#123;</div><div class="line">            Looper.myLooper().setMessageLogging(<span class="keyword">new</span></div><div class="line">                    LogPrinter(Log.DEBUG, <span class="string">"ActivityThread"</span>));</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="comment">// End of event ActivityThreadMain.</span></div><div class="line">        Trace.traceEnd(Trace.TRACE_TAG_ACTIVITY_MANAGER);</div><div class="line">        Looper.loop(); <span class="comment">// å¯åŠ¨è¿™ä¸ªæ¶ˆæ¯å¾ªç¯</span></div><div class="line"></div><div class="line">        <span class="comment">// å½“ä¸Šé¢çš„Looperæ‰§è¡Œquit()çš„æ—¶å€™æ‰§è¡Œåˆ°è¿™é‡Œï¼Œå½“ç„¶ï¼Œè¿™ä¸ªæ—¶å€™appå°±è¦é€€å‡ºäº†</span></div><div class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(<span class="string">"Main thread loop unexpectedly exited"</span>);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>å†å›åˆ°æˆ‘ä»¬æ–‡ç« å¼€å§‹çš„æ—¶å€™æåˆ°çš„é—®é¢˜ï¼šä¸ºä»€ä¹ˆé€šè¿‡ <code>view.post()</code> å¯ä»¥è·å–åˆ°Viewçš„å°ºå¯¸å‘¢ï¼Ÿ</p>
<p>ç­”ï¼šé¦–å…ˆå¤§å®¶éœ€è¦çŸ¥é“ï¼Œæˆ‘ä»¬Activityçš„å¯åŠ¨ï¼Œä¹Ÿæ˜¯é€šè¿‡ç³»ç»Ÿæ¶ˆæ¯çš„æ–¹å¼è§¦å‘çš„ã€‚ä»ä¸Šé¢çš„ä»£ç ä¸­å¯ä»¥çœ‹åˆ°ï¼Œå½“ <code>Looper.loop()</code> æ‰§è¡Œä¹‹åï¼Œå³å¯æ¥æ”¶ç³»ç»Ÿæ¶ˆæ¯äº†ï¼Œæ¯”å¦‚å¯åŠ¨Activityä¹‹ç±»çš„æ¶ˆæ¯ã€‚å½“ç³»ç»Ÿå‘å‡ºäº†ä¸€ä¸ªå¯åŠ¨Activityçš„æ¶ˆæ¯ï¼Œç„¶åæ‰§è¡Œè¿™ä¸ªæ¶ˆæ¯æ‰ä¼šå»å¯åŠ¨Actvityï¼Œå¯åŠ¨Activiyä¼šè°ƒç”¨å®ƒçš„ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ï¼Œæ¯”å¦‚ <code>onCreate()</code> ç­‰ï¼Œåœ¨ <code>Activity.onCreate()</code> ä¸­ç”¨view.postå‘ä¸€ä¸ªä»»åŠ¡åˆ°ä¸»çº¿ç¨‹çš„æ¶ˆæ¯é˜Ÿåˆ—ï¼Œé‚£è¿™ä¸ªæ¶ˆæ¯è‚¯å®šè¦ç­‰ä¹‹å‰çš„æ¶ˆæ¯ä»»åŠ¡æ‰§è¡Œå®Œï¼Œä¹Ÿå°±æ˜¯å½“å‰åˆ›å»ºActivityçš„æ¶ˆæ¯æ‰§è¡Œå®Œæˆä¹‹åæ‰èƒ½æ‰§è¡Œã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬å°±å¯ä»¥è·å–åˆ°Viewçš„å°ºå¯¸äº†ã€‚</p>
<p>é‚£ä¹ˆæˆ‘ä»¬æ¥éªŒè¯ä¸€ä¸‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ViewPostActivity</span> <span class="keyword">extends</span> <span class="title">AppCompatActivity</span> </span>&#123;</div><div class="line">    <span class="keyword">private</span> TextView tvInfo;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</div><div class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState);</div><div class="line">        setContentView(R.layout.activity_view_post);</div><div class="line"></div><div class="line">        printMsg(<span class="string">"onCreate"</span>);</div><div class="line"></div><div class="line">        tvInfo = (TextView) findViewById(R.id.tvInfo);</div><div class="line">        tvInfo.post(<span class="keyword">new</span> Runnable() &#123;</div><div class="line">            <span class="meta">@Override</span></div><div class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</div><div class="line">                printMsg(<span class="string">"Width:"</span> + tvInfo.getWidth());</div><div class="line">                printMsg(<span class="string">"Height:"</span> + tvInfo.getHeight());</div><div class="line">            &#125;</div><div class="line">        &#125;);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onStart</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">super</span>.onStart();</div><div class="line"></div><div class="line">        printMsg(<span class="string">"onStart"</span>);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onResume</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">super</span>.onResume();</div><div class="line"></div><div class="line">        printMsg(<span class="string">"onResume"</span>);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">printMsg</span><span class="params">(String msg)</span> </span>&#123;</div><div class="line">        System.out.println(<span class="string">"&gt;&gt;&gt;&gt;&gt;"</span> + msg);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>è¾“å‡ºçš„Logï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="number">07</span>-<span class="number">27</span> <span class="number">13</span>:<span class="number">06</span>:<span class="number">36.373</span> <span class="number">17506</span>-<span class="number">17506</span>/com.ttdevs.message I/System.out: &gt;&gt;&gt;&gt;&gt;onCreate</div><div class="line"><span class="number">07</span>-<span class="number">27</span> <span class="number">13</span>:<span class="number">06</span>:<span class="number">36.378</span> <span class="number">17506</span>-<span class="number">17506</span>/com.ttdevs.message I/System.out: &gt;&gt;&gt;&gt;&gt;onStart</div><div class="line"><span class="number">07</span>-<span class="number">27</span> <span class="number">13</span>:<span class="number">06</span>:<span class="number">36.378</span> <span class="number">17506</span>-<span class="number">17506</span>/com.ttdevs.message I/System.out: &gt;&gt;&gt;&gt;&gt;onResume</div><div class="line"><span class="number">07</span>-<span class="number">27</span> <span class="number">13</span>:<span class="number">06</span>:<span class="number">36.433</span> <span class="number">17506</span>-<span class="number">17506</span>/com.ttdevs.message I/System.out: &gt;&gt;&gt;&gt;&gt;Width:<span class="number">248</span></div><div class="line"><span class="number">07</span>-<span class="number">27</span> <span class="number">13</span>:<span class="number">06</span>:<span class="number">36.433</span> <span class="number">17506</span>-<span class="number">17506</span>/com.ttdevs.message I/System.out: &gt;&gt;&gt;&gt;&gt;Height:<span class="number">76</span></div></pre></td></tr></table></figure>
<p>å’Œæ¨æµ‹çš„ä¸€è‡´ï¼ŒCooooolï½ï½</p>
<p>æœ€åï¼Œç•™ä¸ªå¥½ç©çš„é—®é¢˜ï¼Œæ‰§è¡Œ <code>getMainLooper().quit()</code> ä¼šæ€æ ·å‘¢ï¼Ÿ</p>
<p><a href="https://github.com/ttdevs/android/tree/master/apps/message" target="_blank" rel="external">æºç å‚è€ƒè¿™é‡Œ</a></p>
<hr>
<p><img src="https://raw.githubusercontent.com/ttdevs/ttdevs.github.io/common/images/logo.png" alt="Create by ttdevs"></p>
]]></content>
      
        <categories>
            
            <category> æŠ€æœ¯ </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Android </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title></title>
      <url>/2017/06/20/2017-06-20/</url>
      <content type="html"><![CDATA[<h1 id="è¥¿å®‰æ¸¸-â€”â€”-å¤§å”ç››ä¸–"><a href="/2017/06/20/2017-06-20/#è¥¿å®‰æ¸¸-â€”â€”-å¤§å”ç››ä¸–" class="headerlink" title="# è¥¿å®‰æ¸¸ â€”â€” å¤§å”ç››ä¸–"></a># è¥¿å®‰æ¸¸ â€”â€” å¤§å”ç››ä¸–</h1><p><img src="http://upload-images.jianshu.io/upload_images/1801981-ec7c4ff20dfd2d9e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="è¥¿å®‰"></p>
<p>ç»å†äº†æ¼«é•¿çš„çŠ¹è±«çº ç»“ä¹‹åå†³å®šè£¸è¾ã€‚ä¸€åœºè¯´èµ°å°±èµ°çš„æ—…ç¨‹å°±è¿™ä¹ˆå¼€å§‹äº†ã€‚</p>
<p>ç¦»èŒæ—¶æ— æ„ä¸­è·Ÿä¸€ä¸ªå°ä¼™ä¼´èŠå¤©ï¼Œå¾—çŸ¥å¥¹ä¹Ÿæ˜¯ç¦»èŒçŠ¶æ€ï¼Œé‚ç»“ä¼´ä¸€èµ·å»å¾€è¥¿å®‰ã€‚è™½ç„¶æ˜¯ä¸€ä¸ªæ¾æ•£ç»„åˆï¼Œä½†ä¹Ÿä¸ç”¨ä¸€ç›´ä¸€ä¸ªäººäº†ï½ï¼ˆå…¶å®å•èº«ç‹—æœ‰æ—¶å€™ä¹Ÿéœ€è¦æ‰¾åˆ«äººå¸®æ‹æ—…æ¸¸ç…§ï¼‰</p>
<p>å‡ºå‘ä¹‹å‰å¹¶æ²¡æœ‰åšè¯¦ç»†çš„æ”»ç•¥ï¼Œåªæœ‰ä¸€ä¸ªç›®çš„åœ°è¥¿å®‰ã€‚æƒ³åˆ°å“ªé‡Œå»å“ªé‡Œï¼Œæ¯”å¦‚è‘—åçš„ç§¦å§‹çš‡é™µå…µé©¬ä¿‘ï¼Œåå±±ï¼Œå¤åŸå¢™ï¼Œå¤§é›å¡”ï¼Œè¥¿å®‰å°åƒç­‰ç­‰ï¼Œå½“ç„¶è¿˜æœ‰äº›ä¹‹å‰ä¸çŸ¥é“çš„æ™¯ç‚¹ã€‚æœ€åçœ‹æ¥ï¼Œé™¤äº†åå±±å’Œå¤§é›å¡”æ²¡æœ‰å»æœ‰ç‚¹å°é—æ†¾ä¹‹å¤–ï¼Œå¤§éƒ¨åˆ†æœŸå¾…çš„éƒ½å»äº†ï¼Œè€Œä¸”å¤šæ•°éƒ½æ˜¯è¶…è¿‡ä¹‹å‰çš„æœŸå¾…ï½</p>
<h2 id="ç¬¬ä¸€å¤©-ä»å‡ºå‘åˆ°å›æ°‘è¡—"><a href="/2017/06/20/2017-06-20/#ç¬¬ä¸€å¤©-ä»å‡ºå‘åˆ°å›æ°‘è¡—" class="headerlink" title="ç¬¬ä¸€å¤© ä»å‡ºå‘åˆ°å›æ°‘è¡—"></a>ç¬¬ä¸€å¤© ä»å‡ºå‘åˆ°å›æ°‘è¡—</h2><p>æå‰ä¸¤å¤©ä¹°çš„æœºç¥¨ï¼Œå—èˆª<code>CZ6616</code>ä¸Šåˆ<code>11:25</code> ä¸Šæµ·é£è¥¿å®‰ã€‚ç¦»æœºåœºå¾ˆè¿‘ï¼Œæ‰€ä»¥ä¸ç”¨æ—©èµ·èµ¶ç°æœºï¼Œå‡†ç‚¹èµ·é£ï¼Œé¢„ç¤ºä¸€ä¸ªç¾å¥½çš„æ—…ç¨‹å³å°†å¼€å§‹ï½</p>
<p>å‡ºå‘ä¹‹å‰å°ä¼™ä¼´åœ¨ç½‘ä¸ŠæŠ¥äº†ä¸€ä¸ª<a href="http://www.mafengwo.cn/sales/2201895.html" target="_blank" rel="external">ä¸€å¤©çš„æ—…è¡Œå›¢</a>ï¼ŒåŒ…å«æ¥æœºçš„æœåŠ¡ï¼Œæ—…æ¸¸å·´å£«ï¼Œä»æœºåœºé€åˆ°ä½åœ°ã€‚æ‰€ä»¥æ•´ä¸ªåˆ°è¾¾è¿‡ç¨‹è¿˜æ˜¯ç›¸å½“é¡ºåˆ©æ»´ã€‚</p>
<p>åŒè¡Œå°ä¼™ä¼´è¦ä½é’æ—…ï¼Œè¯´å¯ä»¥ç©ç‹¼äººæ€ç­‰æ¸¸æˆã€‚ç”±äºæ²¡æœ‰ä½è¿‡é’æ—…ï¼Œæƒ³ä½“éªŒä¸‹ï¼Œæ‰€ä»¥ä¹Ÿè®¢äº†ä¸€ä¸ªåºŠé“ºï¼Œå››äººé—´ï¼Œ45å…ƒï¼æ™šã€‚åˆ°äº†é’æ—…åŠäº†å…¥ä½ï¼Œçœ‹äº†æˆ¿é—´ï¼Œç¬é—´ä¸æƒ³ä½äº†ï¼ˆé‡Œé¢å·²ä½ä¸¤äººï¼Œæœ‰ç‚¹ä¹±ï¼Œå¸¦äº†ä¸ªå¯ä»¥ç™»æœºçš„è¡Œæç®±æˆ¿é—´çš„æŸœå­ç«Ÿç„¶æ”¾ä¸ä¸‹ï¼Œä¹Ÿæ²¡å…¶ä»–åœ°æ–¹å¯æ”¾ï¼‰ï¼Œé‚é€€æˆ¿ï¼ˆåæ¥æƒ³äº†ä¸‹ï¼Œå¯èƒ½å·²ç»è¿‡äº†ä½é’æ—…çš„å¹´é¾„äº†å§ï¼‰ï¼Œå»æ‰¾äº†å®¶<a href="/2017/06/20/2017-06-20/ä¸ƒå¤©è¥¿å®‰é’Ÿæ¥¼åº—ï¼Œè¥¿ä¸€è·¯49å·">å¿«æ·é…’åº—</a>ï¼Œç¦»å›æ°‘è¡—å¾ˆè¿‘ï¼Œå¤§åºŠæˆ¿æ¯æ™šä¸åˆ°100ï¼Œä¹‹åå‡ å¤©ä¸€ç›´ä½è¿™é‡Œï¼ˆå“ˆå“ˆï¼Œæ·˜å®ä¹°äº†å‡ å¼ 20çš„ä¼˜æƒ åˆ¸ï¼Œè¿˜æ˜¯èƒ½çœä¸€ç‚¹æ˜¯ä¸€ç‚¹ï¼‰ã€‚</p>
<p>å®‰å®šå¥½ä¹‹åå¼€å§‹é€›å›æ°‘è¡—ã€é’Ÿæ¥¼å’Œé¼“æ¥¼ã€‚ä¸‹é¢å¼€å§‹ä¸Šå›¾ï½</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1801981-d7cdca0b55cfc589.JPG?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="å›æ°‘è¡—"><br>äººè¶…å¤šæœ‰æ²¡æœ‰ï½ï½</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1801981-39ac7b3a83e11b1a.JPG?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="è‰²å½©ä¸°å¯Œçš„ç¾é£Ÿ"><br>è‰²å½©è¶…çº§ä¸°å¯Œå•Š</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1801981-c917909cde1b791d.JPG?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="æŸ¿å­é¥¼"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/1801981-fe79d6fdc93ed9f9.JPG?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="biangbiangé¢"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/1801981-b8d04e14cb572d26.JPG?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="é¦•"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/1801981-115ef2973ed7e09d.JPG?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="æ‰‹è‰ºäºº"><br><img src="http://upload-images.jianshu.io/upload_images/1801981-b9d4cb4a8d81705a.JPG?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="æ‰‹è‰ºäºº"><br><img src="http://upload-images.jianshu.io/upload_images/1801981-468a2b6e70670696.JPG?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="æ‰‹è‰ºäºº"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/1801981-0c3d51681a1fc6db.JPG?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="é’Ÿæ¥¼"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/1801981-4724bd384967678f.JPG?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="é¼“æ¥¼"></p>
<h2 id="ç¬¬äºŒå¤©-ç§¦å§‹çš‡é™µå…µé©¬ä¿‘"><a href="/2017/06/20/2017-06-20/#ç¬¬äºŒå¤©-ç§¦å§‹çš‡é™µå…µé©¬ä¿‘" class="headerlink" title="ç¬¬äºŒå¤© ç§¦å§‹çš‡é™µå…µé©¬ä¿‘"></a>ç¬¬äºŒå¤© ç§¦å§‹çš‡é™µå…µé©¬ä¿‘</h2><h3 id="è¥¿å®‰ä¸€æ—¥æ¸¸"><a href="/2017/06/20/2017-06-20/#è¥¿å®‰ä¸€æ—¥æ¸¸" class="headerlink" title="è¥¿å®‰ä¸€æ—¥æ¸¸"></a>è¥¿å®‰ä¸€æ—¥æ¸¸</h3><p>å‰é¢æåˆ°æŠ¥äº†ä¸€ä¸ªæ—…æ¸¸å›¢ï¼š<a href="http://www.mafengwo.cn/sales/2201895.html" target="_blank" rel="external">å…µé©¬ä¿‘+åæ¸…å®«+éªŠå±±ç´¢é“ä¸€æ—¥æ¸¸ï¼ˆèµ æ¥æœº/é«˜é“/åŒè€³éº¦/èµ è‡ªåŠ©é¤ï¼‰ä»·æ ¼390ï¼Œä¸åç´¢é“330</a>ï¼Œé©¬èœ‚çªä¸Šæœ‰å”®ã€‚ç¾å¥³å¯¼æ¸¸ï¼Œå¤§å·´æ¥é€ï¼Œæ— è´­ç‰©ï¼Œè‡ªåŠ©é¤ç­‰ç­‰ï¼Œå»ä¹‹å‰è¿˜æ‹…å¿ƒè¢«å¸¦åˆ°å‡å…µé©¬ä¿‘ç­‰å„ç§å‘ï¼Œæœ€åæ€»ç»“ä¸‹æ¥å¾ˆæ»¡æ„çš„ä¸€æ¬¡è·Ÿå›¢ã€‚å…·ä½“çš„è¡Œç¨‹å¤§å®¶å¯ä»¥çœ‹ä»‹ç»ã€‚</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1801981-35507f861e6f142b.JPG?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="å…µé©¬ä¿‘"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/1801981-e31046ae3c969d4c.JPG?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="å…µé©¬ä¿‘"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/1801981-3cf285c2026feb2d.JPG?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="å…µé©¬ä¿‘"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/1801981-9e11adcfccd4ad48.JPG?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="å…µé©¬ä¿‘"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/1801981-d7a0bd055a32f819.JPG?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="å…µé©¬ä¿‘"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/1801981-5db4d6a737f9a5a7.JPG?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="å…µé©¬ä¿‘"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/1801981-1b87890b254e2e6b.JPG?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="å…µé©¬ä¿‘"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/1801981-25e411403ffbb5fe.JPG?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="å…µé©¬ä¿‘"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/1801981-a06df8b4385d3154.JPG?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="åæ¸…å®«"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/1801981-a9fda7b212bc48fd.JPG?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="åæ¸…å®«"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/1801981-2c63547ceca7f151.JPG?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="åæ¸…å®«"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/1801981-d472ea14ec698863.JPG?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="éªŠå±±ä¿¯ç°"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/1801981-18d999e9295d0d43.JPG?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="ç¾å¥³å¯¼æ¸¸"><br>æˆ‘ä»¬çš„ç¾å¥³å¯¼æ¸¸ï½</p>
<h3 id="è¥¿å®‰å¤åŸå¢™"><a href="/2017/06/20/2017-06-20/#è¥¿å®‰å¤åŸå¢™" class="headerlink" title="è¥¿å®‰å¤åŸå¢™"></a>è¥¿å®‰å¤åŸå¢™</h3><p>æ—…æ¸¸å›¢ç»“æŸä¹‹åé€å›é’Ÿæ¥¼ï¼Œè·¯ä¸Šå¯¼æ¸¸æ¨èäº†å‡ å®¶ï¼Œä½†æ˜¯éƒ½æ²¡è®°ä½ã€‚ä¸è¿‡è¿˜æ˜¯è¦å»æ‰¾åƒçš„ï¼Œå‡‰çš®è‚‰å¤¹é¦è‡ªç„¶æ˜¯é¦–é€‰ï¼ˆå›æ°‘è¡—å–çš„è‚‰å¤¹é¦éƒ½æ˜¯ç‰›ç¾Šè‚‰çš„ï¼Œæˆ‘è¿˜æ˜¯å–œæ¬¢çŒªè‚‰çš„ï¼Œæ‰€ä»¥è¿™ä¸ªè‚‰å¤¹é¦ä¸æ˜¯å›æ°‘è¡—ä¹°çš„ï½ï¼‰ã€‚</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1801981-122a846d19df3695.JPG?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="è‚‰å¤¹é¦"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/1801981-d9cd4f0c12c4c33f.JPG?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="å‡‰çš®"></p>
<p>åƒé¥­åƒå®Œæ—¶é—´è¿˜æ—©ï¼Œé‚å†³å®šå»å¤åŸå¢™ã€‚å°±è¿™æ ·ä¸€ä¸ªäººéª‘ç€å°é»„è½¦å±é¢ å±é¢ çš„èµ¶åˆ°åŸå¢™ï¼Œä¹°ç¥¨è¿›å…¥ï¼Œé—¨ç¥¨54ã€‚</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1801981-a35904c1bcf2a45e.JPG?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="å¤åŸå¢™"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/1801981-12bfc6a16b7633ea.JPG?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="å¤åŸå¢™"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/1801981-e6d33f5bfbd1bb88.JPG?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="å¤åŸå¢™"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/1801981-d74154a343104713.JPG?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="å¤åŸå¢™"></p>
<p>ç”±äºå»çš„æ—¶å€™å¤©å·²ç»å¿«æ™šä¸Š8ç‚¹äº†ï¼Œæ‰€ä»¥è¿˜æ˜¯æœ‰ç‚¹æ™šçš„ã€‚åŠ ä¹‹å¤©æ°”ä¸å¥½é˜´çš„å¾ˆé‡ï¼Œä¸­é—´è¿˜æœ‰å°é›¨ï¼Œåˆä¸æƒ³éª‘è‡ªè¡Œè½¦ä¸€ä¸ªäººèµ°äº†å››åˆ†ä¹‹ä¸€å°±æ’¤äº†ï¼ˆä»å—é—¨èµ°åˆ°è¥¿é—¨ï¼‰ã€‚å¯èƒ½éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæ™šä¸Šä¸æ˜¯æ¯ä¸ªé—¨éƒ½å¼€çš„ï¼Œæƒ³å‡ºæ¥ä¹Ÿå¾—èµ°åˆ°æŸä¸ªå¤§ä¸€ç‚¹çš„é—¨ã€‚</p>
<h2 id="ç¬¬ä¸‰å¤©-å¤§å”èŠ™è“‰å›­"><a href="/2017/06/20/2017-06-20/#ç¬¬ä¸‰å¤©-å¤§å”èŠ™è“‰å›­" class="headerlink" title="ç¬¬ä¸‰å¤© å¤§å”èŠ™è“‰å›­"></a>ç¬¬ä¸‰å¤© å¤§å”èŠ™è“‰å›­</h2><p>å‰ä¸€å¤©é€›çš„å¤ªæ™šï¼Œæ¯”è¾ƒç´¯ï¼Œæ‰€ä»¥ç¡äº†ä¸ªæ‡’è§‰ï¼Œèµ·åºŠå·²ç»ä¸‹åˆã€‚æ—¶é—´ä¸å¤ŸèŠ™è“‰å›­å’Œå¤§é›å¡”ä¸èƒ½åŒæ—¶å»äº†ï¼ˆå¤§é›å¡”éŸ³ä¹å–·æ³‰ä¹Ÿæ²¡å»æˆï¼‰ï¼Œå¤§é›å¡”ä¸æ˜¯ç‰¹åˆ«æœŸå¾…ï¼Œæœ€åé€‰æ‹©äº†èŠ™è“‰å›­ã€‚å»ä¹‹å‰ç®€å•äº†è§£äº†ä¸‹ï¼šæ–°å»ºçš„æ™¯ç‚¹ï¼Œä¸æ˜¯å†å²å¤è¿¹ï¼Œæ‰€ä»¥ä¹Ÿä¸æŠ±å¤ªå¤§å¸Œæœ›ã€‚ä¹°äº†å¸¦æ¼”å‡ºçš„198å—çš„é—¨ç¥¨ï¼Œå…¶ä¸­å¸¦äº†<code>å¤§å”ç››ä¸–</code>çš„æ¼”å‡ºã€‚</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1801981-4a7a70f01f30a447.JPG?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="å¤§å”èŠ™è“‰å›­"></p>
<h3 id="å¤§å”ç››ä¸–"><a href="/2017/06/20/2017-06-20/#å¤§å”ç››ä¸–" class="headerlink" title="å¤§å”ç››ä¸–"></a>å¤§å”ç››ä¸–</h3><p>è¿™æ˜¯ä¸€ä¸ªå•†ä¸šæ¼”å‡ºï¼Œå¦‚æœä¸å–œæ¬¢å¯ä»¥ä¹°120çš„ç¥¨ï¼Œå°±æ²¡æœ‰è¿™ä¸€é¡¹äº†ã€‚æ‚„æ‚„çš„å‘Šè¯‰ä½ ä»¬ï¼Œæˆ‘æ˜¯ç¬¬ä¸€æ¬¡çœ‹æ¼”å‡ºï¼Œç¬¬ä¸€æ’ï¼Œè¿™ä¸ªä½ç½®æœ‰ç‚¹ä½ï¼Œå¾€åä¸¤æ’åº”è¯¥ä¼šæ›´å¥½ï¼Œä½†æ˜¯ä¹Ÿæœ‰ä¸€ä¸ªå¥½å¤„æ˜¯ç¦»æ¼”å‘˜å¾ˆè¿‘ï¼Œå¯ä»¥çœ‹ç¾å¥³ï½ï½</p>
<p>å››ç‚¹åŠå°±å¯ä»¥å…¥åœºäº†ï¼Œæœ¬ä»¥ä¸ºçœ‹çš„äººä¼šå¾ˆå°‘ï¼Œä½†æ˜¯æœ€åå‘ç°å‡ ä¹åº§æ— è™šå¸­ï¼Œè¶…ä¹æˆ‘çš„æƒ³è±¡ã€‚</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1801981-54f46e83857f8c96.JPG?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="å¤§å”èŠ™è“‰å›­"><br>ï¼ˆä¸å¥½æ„æ€ï¼ŒåŸè°…æˆ‘å·æ‹ç…§äº†ï¼‰</p>
<p>å¯¹æˆ‘æ¥è¯´ç™½å¤©è¿™ä¸ªå›­å­å¯çœ‹çš„ä¸æ˜¯å¾ˆå¤šã€‚æœ‰ä¸€äº›é›•å¡‘ï¼Œçœ‹ä¸æ‡‚çš„æˆ‘ï¼ŒçœŸæ˜¯èœœæ±å°´å°¬ï¼Œæ¯”å¦‚ä¸‹é¢è¿™åº§ï¼š</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1801981-da441ed3975e44e6.JPG?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="å¤§å”èŠ™è“‰å›­"></p>
<p>å”¯ä¸€æœ‰å¥½ä¸€ç‚¹å°è±¡çš„æ˜¯ç´«äº‘æ¥¼ä¸­ä¼šæœ‰å®šæ—¶çš„è¡¨æ¼”ï¼Œæ„Ÿå…´è¶£å¯ä»¥çœ‹çœ‹ã€‚</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1801981-ce756ea59f975995.JPG?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="å¤§å”èŠ™è“‰å›­"></p>
<h3 id="ç¯å…‰è¡¨æ¼”"><a href="/2017/06/20/2017-06-20/#ç¯å…‰è¡¨æ¼”" class="headerlink" title="ç¯å…‰è¡¨æ¼”"></a>ç¯å…‰è¡¨æ¼”</h3><p>ä»ä¸¤ä¸ªæ ‡é¢˜å¯ä»¥çœ‹å‡ºï¼Œå¯¹äºè¿™é‡Œçš„å»ºç­‘çœŸæ˜¯æœŸå¾…ä¸å¤§ï¼Œå¥½åœ¨æœ‰æ™šä¸Šçš„ç¯å…‰æ°´å¹•ç­‰è¡¨æ¼”ï¼Œå“ˆå“ˆï½ï½</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1801981-22c5068ab3f6928e.JPG?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="å¤§å”èŠ™è“‰å›­"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/1801981-536510e747a4b55a.JPG?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="å¤§å”èŠ™è“‰å›­"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/1801981-aa4b70b446946d05.JPG?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="å¤§å”èŠ™è“‰å›­"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/1801981-ae20add28b0258b7.JPG?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="å¤§å”èŠ™è“‰å›­"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/1801981-c729164e0b1f6862.JPG?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="å¤§å”èŠ™è“‰å›­"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/1801981-35737d9af2e773ac.JPG?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="å¤§å”èŠ™è“‰å›­"></p>
<p>ä¸€ä¸ªäººåœ¨ä¸€ä¸ªååƒ»çš„è§’è½çœ‹å®Œæ•´ä¸ªè¡¨æ¼”ï¼ˆå…¶å®å°±æ˜¯ä¸ºäº†æ‹ç…§ï½ï½ï¼‰æ™šä¸Šçš„ç¯å…‰è¿˜æ˜¯å¾ˆæ¼‚äº®çš„ã€‚å¬è¯´æ˜¯å…¨å›½æœ€å¤§çš„æ°´å¹•ç”µå½±ã€‚</p>
<h2 id="ç¬¬å››å¤©-é™•è¥¿å†å²åšç‰©é¦†"><a href="/2017/06/20/2017-06-20/#ç¬¬å››å¤©-é™•è¥¿å†å²åšç‰©é¦†" class="headerlink" title="ç¬¬å››å¤© é™•è¥¿å†å²åšç‰©é¦†"></a>ç¬¬å››å¤© é™•è¥¿å†å²åšç‰©é¦†</h2><p>åƒè´§ä»¬å¯èƒ½å·²ç»å‘ç°ä¸€ä¸ªé—®é¢˜â€”â€”åŸºæœ¬ä¸Šæ²¡æœ‰ä»‹ç»åƒã€‚çœ‹æˆ‘çš„å°´å°¬è„¸ğŸ˜…</p>
<p>å› ä¸ºä»æ¥ç¬¬äºŒå¤©å°±å¼€å§‹æ‹‰è‚šå­ï¼Œæ¶å¿ƒæƒ³åï¼Œå•¥ä¹Ÿä¸æƒ³åƒã€‚æœ‹å‹è¯´è‚ èƒƒæ„Ÿå†’ï¼Œåƒç‚¹è¯å°±å¥½ã€‚ä½†æ˜¯ä»Šå¤©æ„Ÿè§‰å¿«è¦æ­»äº†ï¼ˆæ¥ä¸‹æ¥è¿˜æœ‰ä¸€å‘¨å¤šçš„è¡Œç¨‹ï¼Œé’±å·²äº¤ï¼‰ï¼Œé‚å»äº†åŒ»é™¢ã€‚ä¸€å¤§æ—©èµ¶åˆ°è¥¿å®‰äº¤é€šå¤§å­¦ç¬¬ä¸€é™„å±åŒ»é™¢çœ‹äº†ä¸ªæ¶ˆåŒ–å†…ç§‘ï¼ŒåŒ»ç”Ÿä¸åˆ†é’çº¢çš‚ç™½çš„ç»™å¼€äº†ä¸€å †è¯ï¼ˆè¿˜æœ‰è¿›å£çš„é…µæ¯èŒï¼Œå–è¯æ—¶æ‰å‘ç°ï¼Œæˆ‘ä»¬ä¹‹å‰ä¹Ÿå–è¿‡ï¼Œå‘å•Šï¼‰ï¼Œè¾“æ¶²ä¸¤ç“¶ï¼Œè¯è´¹480+ï¼Œç®€ç›´æ˜¯æŠ¢åŠ«å•Šï¼Œæœ‰æ²¡æœ‰ã€‚æœ€åéƒ½ä¸çŸ¥é“æ˜¯åƒäº†è¿™äº›è¯å¥½çš„è¿˜æ˜¯æˆ‘è‡ªå·±å»è¯åº—ä¹°çš„è—¿é¦™æ­£æ°”æ°´åƒå¥½çš„ã€‚ã€‚ã€‚</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1801981-5a1ace90943c66c3.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="è¾“æ¶²"></p>
<p>è¾“å®Œæ¶²ï¼Œèµ¶åˆ°è¥¿å®‰å†å²åšç‰©é¦†ï¼Œå·²ç»ä¸‹åˆä¸¤ç‚¹å¤šã€‚åœ¨å¯¹é¢å–äº†ç‚¹ç²¥ï¼Œåƒäº†ç‚¹ä¸œè¥¿â€”â€”çƒ¤é¦â€”â€”ä¸€å—é’±ä¸€ä¸ªâ€”â€”è¶…çº§å¥½åƒï¼Œé‚£ä¸ªçŠ¶æ€æˆ‘ç«Ÿç„¶åƒäº†ä¿©ï½</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1801981-0681f0ba38c8ce14.JPG?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="çƒ¤é¦"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/1801981-b55ab1477dfda13b.JPG?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="çƒ¤é¦"></p>
<p>è¯´æ­£é¢˜ï¼Œä¸ºä»€ä¹ˆæƒ³æ¥è¿™é‡Œå‘¢ï¼Ÿéš¾é“æˆ‘å¾ˆçˆ±å†å²å˜›ï½ å…¶å®ä¸æ˜¯ï¼Œå°±æ˜¯æƒ³å¤šäº†è§£ä¸€ä¸‹å†å²è€Œå·²ã€‚ä¹‹å‰å»è¿‡å—äº¬åšç‰©é™¢ï¼Œä¸€ä¸ªäººé€›äº†åŠå¤©ï¼Œè¿˜æ˜¯æŒºéœ‡æ’¼çš„ã€‚æ‰€ä»¥å¯¹äºè¥¿å®‰è¿™åº§å¤åŸï¼Œå¯¹ä»–çš„åšç‰©é¦†è¿˜æ˜¯æŒºæœŸå¾…çš„ã€‚</p>
<p>ç®€å•æé†’ä¸€ä¸‹ï¼Œè¿™é‡Œçš„ç¥¨å…è´¹ï¼Œå¯ä»¥å®˜ç½‘é¢„çº¦ï¼Œé¢„çº¦å¥½äº†é‚£å¤©å•¥æ—¶å€™å»éƒ½å¯ä»¥ï¼Œå¦åˆ™çš„è¯å°±åˆ°ç°åœºæ’é˜Ÿã€‚äººå¤šçš„æ—¶å€™é˜Ÿä¼å¯èƒ½ä¼šæ¯”è¾ƒé•¿ã€‚</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1801981-08fe18bce59d0359.JPG?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="é™•è¥¿å†å²åšç‰©é¦†"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/1801981-aea8bc3f1721d33e.JPG?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="é™•è¥¿å†å²åšç‰©é¦†"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/1801981-331cfb93c26d5e98.JPG?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="é™•è¥¿å†å²åšç‰©é¦†"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/1801981-15b8b10151f199bc.JPG?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="é™•è¥¿å†å²åšç‰©é¦†"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/1801981-7556f2292ba025ce.JPG?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="é™•è¥¿å†å²åšç‰©é¦†"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/1801981-36e2cd79a7dfed95.JPG?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="é™•è¥¿å†å²åšç‰©é¦†"></p>
<p>ç”±äºå®åœ¨éš¾å—ï¼Œä¹Ÿæ²¡é€›å¤šä¹…å°±æ—©æ—©çš„å›å»ä¼‘æ¯äº†ã€‚</p>
<h2 id="ç¬¬äº”å¤©-ä»è¥¿å®‰åˆ°è¥¿å®"><a href="/2017/06/20/2017-06-20/#ç¬¬äº”å¤©-ä»è¥¿å®‰åˆ°è¥¿å®" class="headerlink" title="ç¬¬äº”å¤© ä»è¥¿å®‰åˆ°è¥¿å®"></a>ç¬¬äº”å¤© ä»è¥¿å®‰åˆ°è¥¿å®</h2><p>æœ€åä¸€å¤©çš„è¡Œç¨‹ï¼Œè¥¿å®‰åˆ°è¥¿å®ã€‚æœ¬æ‰“ç®—åšæœºåœºå¤§å·´ï¼Œä½†æ˜¯æœ‰ä¸ªè¡Œæç®±æ¯”è¾ƒé‡ï¼ŒåŒè¡Œçš„å°ä¼™ä¼´å†³å®šä¸€èµ·æ‰“è½¦ã€‚å«äº†ä¸“è½¦ï¼Œä»è¥¿å®‰å¸‚åŒºé€åˆ°å’¸é˜³æœºåœºã€‚ä¼˜æƒ äº†50ï¼Œæ¯ä¸ªäºº50å¿«ï¼Œè¿˜æ˜¯æŒºåˆ’ç®—çš„ã€‚</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1801981-b7d9245cd8aed746.JPG?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="è¥¿å®‰åˆ°è¥¿å®"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/1801981-428f915f9fe1af9c.JPG?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="è¥¿å®‰åˆ°è¥¿å®"></p>
<p>æ„Ÿè§‰ä¸€è·¯ä¸Šç°æœºç»è¿‡äº†é™•ç”˜ä¸åŒçš„åœ°è²Œç¯å¢ƒï¼Œå·å·ç”¨æ‰‹æœºæ‹äº†å‡ ç«™ï¼Œè¶…çº§åæ‚”ç°æœºä¸Šæ²¡æœ‰æŠŠç›¸æœºæ‹¿å‡ºæ¥ã€‚ç»™å¤§å®¶åˆ†äº«å‡ å¼ ï¼Œè¥¿å®‰è¡Œç¨‹ç»“æŸï½</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1801981-93732e0aae772f4c.JPG?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="è¥¿å®‰åˆ°è¥¿å®"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/1801981-3940547d7d552c56.JPG?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="è¥¿å®‰åˆ°è¥¿å®"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/1801981-895f96537f902aa3.JPG?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="è¥¿å®‰åˆ°è¥¿å®"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/1801981-90b4c485dec7470d.JPG?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="è¥¿å®‰åˆ°è¥¿å®"></p>
<p>è¥¿å®‰ä¹‹è¡Œå°±è¿™ä¹ˆç»“æŸäº†ã€‚å¦‚æœæœ‰äººä¸€èµ·çš„è¯ï¼Œå¯èƒ½ä¼šå»çˆ¬åå±±ï¼Œä¸è¿‡ç•™ç€ä»¥åæœ‰æœºä¼šå»ä¹Ÿå¥½ã€‚</p>
]]></content>
      
        
    </entry>
    
    <entry>
      <title></title>
      <url>/2017/06/02/2017-06-02/</url>
      <content type="html"><![CDATA[<p># </p>
]]></content>
      
        
    </entry>
    
    <entry>
      <title><![CDATA[[Android]å‡çº§Support Library]]></title>
      <url>/2017/05/26/Android-%E5%8D%87%E7%BA%A7SupportLibrary/</url>
      <content type="html"><![CDATA[<h2 id="0x00-Support-Library"><a href="/2017/05/26/Android-å‡çº§SupportLibrary/#0x00-Support-Library" class="headerlink" title="0x00 Support Library"></a>0x00 Support Library</h2><h2 id="0x01-æ³¨æ„äº‹é¡¹"><a href="/2017/05/26/Android-å‡çº§SupportLibrary/#0x01-æ³¨æ„äº‹é¡¹" class="headerlink" title="0x01 æ³¨æ„äº‹é¡¹"></a>0x01 æ³¨æ„äº‹é¡¹</h2><ul>
<li><p><code>compileSdkVersion</code>ä¸<code>buildToolsVersion</code>ç‰ˆæœ¬ä¸ä¸€è‡´</p>
  <figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">    /Users/ttdevs/Android/app/build/intermediates/res/merged/debug/values-v24/values-v24.xml</div><div class="line">Error:(<span class="number">3</span>) Error retrieving parent <span class="keyword">for</span> item: No resource found that matches the given name <span class="string">'android:TextAppearance.Material.Widget.Button.Borderless.Colored'</span>.</div><div class="line">Error:(<span class="number">4</span>) Error retrieving parent <span class="keyword">for</span> item: No resource found that matches the given name <span class="string">'android:TextAppearance.Material.Widget.Button.Colored'</span>.</div><div class="line">Error:(<span class="number">3</span>) Error retrieving parent <span class="keyword">for</span> item: No resource found that matches the given name <span class="string">'android:TextAppearance.Material.Widget.Button.Borderless.Colored'</span>.</div><div class="line">Error:(<span class="number">4</span>) Error retrieving parent <span class="keyword">for</span> item: No resource found that matches the given name <span class="string">'android:TextAppearance.Material.Widget.Button.Colored'</span>.</div><div class="line">Error:Execution failed <span class="keyword">for</span> task <span class="string">':app:processDebugResources'</span>.</div><div class="line">&gt; com.android.ide.common.process.ProcessException: Failed to execute aapt</div><div class="line">Information:BUILD FAILED</div></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="0xFF-å‚è€ƒ"><a href="/2017/05/26/Android-å‡çº§SupportLibrary/#0xFF-å‚è€ƒ" class="headerlink" title="0xFF å‚è€ƒ"></a>0xFF å‚è€ƒ</h2><ul>
<li><a href="https://developer.android.com/topic/libraries/support-library/index.html" target="_blank" rel="external">https://developer.android.com/topic/libraries/support-library/index.html</a></li>
<li><a href="https://developer.android.com/topic/libraries/support-library/revisions.html" target="_blank" rel="external">https://developer.android.com/topic/libraries/support-library/revisions.html</a></li>
<li><a href="https://stackoverflow.com/questions/41365401/how-to-fix-eror-app-build-intermediates-res-merged-debug-values-v24-values-v24-x" target="_blank" rel="external">https://stackoverflow.com/questions/41365401/how-to-fix-eror-app-build-intermediates-res-merged-debug-values-v24-values-v24-x</a></li>
</ul>
<p><img src="https://raw.githubusercontent.com/ttdevs/ttdevs.github.io/common/images/logo.png" alt="Create by ttdevs"></p>
]]></content>
      
        <categories>
            
            <category> æŠ€æœ¯ </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Android </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[ã€ŒAndroid-Bluetoothã€0x02æ“ä½œ]]></title>
      <url>/2017/05/19/%5BAndroid-Bluetooth%5D0x02%E6%93%8D%E4%BD%9C/</url>
      <content type="html"><![CDATA[<h2 id="0x00-ä½åŠŸè€—è“ç‰™ï¼ˆBLEï¼‰"><a href="/2017/05/19/[Android-Bluetooth]0x02æ“ä½œ/#0x00-ä½åŠŸè€—è“ç‰™ï¼ˆBLEï¼‰" class="headerlink" title="0x00 ä½åŠŸè€—è“ç‰™ï¼ˆBLEï¼‰"></a>0x00 ä½åŠŸè€—è“ç‰™ï¼ˆBLEï¼‰</h2><p>ä¸Šä¸€ç¯‡ç®€å•ä»‹ç»äº†ä¼ ç»Ÿè“ç‰™è®¾å¤‡çš„ä½¿ç”¨ï¼Œå½“ä½ æ²¿ç€ä¸Šä¸€ç¯‡çš„æ€è·¯å»è¿æ¥æŸäº›è“ç‰™è®¾å¤‡çš„æ—¶å€™ï¼Œä½ ä¼šå‘ç°æ€»æ˜¯ä¸æˆåŠŸã€‚æ²¡é”™ï¼Œæˆ‘ä»¬è¿˜æœ‰å¦å¤–ä¸€ç§è“ç‰™æ²¡æœ‰è®²ï¼šä½åŠŸè€—è“ç‰™(BLE: Bluetooth Low Energy)ã€‚</p>
<p>è¿™å¹¶ä¸æ˜¯ä¸€ç§æ–°çš„ä¸œè¥¿ï¼Œå®ƒåªæ˜¯è“ç‰™åè®®ä¸­çš„ä¸€ä¸ªæ–°çš„ç‰ˆæœ¬ã€‚ä¹‹å‰æåˆ°çš„å¤šæ˜¯è“ç‰™2.0/2.1ï¼Œè¿™é‡Œçš„ä½åŠŸè€—è“ç‰™ï¼ˆBLEï¼‰ä¸»è¦æ˜¯æŒ‡è“ç‰™4.0/4.1/4.2ã€‚åœ¨æˆ‘ä»¬çš„æ—¥å¸¸ç”Ÿæ´»ä¸­è¿™ç§è“ç‰™è¶Šæ¥è¶Šå¸¸è§ï¼Œæ¯”å¦‚å„ç§æ‰‹ç¯ã€ä½“è„‚ç§¤ã€æ™ºèƒ½è®¾å¤‡ã€ä¾¿æºè“ç‰™è®¾å¤‡ç­‰ç­‰ã€‚</p>
<p>æ›´å¤šå…³äºè“ç‰™çš„ä»‹ç»å¯ä»¥å‚è€ƒ<a href="https://zh.wikipedia.org/wiki/è“ç‰™" target="_blank" rel="external">è¿™é‡Œ</a></p>
<h2 id="0x01-è“ç‰™åè®®æ ˆ"><a href="/2017/05/19/[Android-Bluetooth]0x02æ“ä½œ/#0x01-è“ç‰™åè®®æ ˆ" class="headerlink" title="0x01 è“ç‰™åè®®æ ˆ"></a>0x01 è“ç‰™åè®®æ ˆ</h2><p>å’Œå­¦ä¹  TCP/IP ä¸€æ ·ï¼Œå¦‚æœäº†è§£BLEçš„è®®æ ˆå¯¹æˆ‘ä»¬æŒæ¡è“ç‰™ä¼šæœ‰å¾ˆå¤§çš„å¸®åŠ©ã€‚</p>
<p><img src="https://www.bluetooth.com/~/media/images/page-content/bluetooth%20stack.ashx?h=501&amp;w=388&amp;la=zh-cn&amp;hash=9756388D40595EB444E4B110F3587A323604714A" alt="è“ç‰™åè®®æ ˆ"></p>
<ul>
<li><p>ç‰©ç† (PHY) å±‚</p>
<p>  é€šè¿‡è“ç‰™é€šä¿¡ä¿¡é“æ§åˆ¶ 2.4Ghz å°„é¢‘çš„ä¼ è¾“/æ¥æ”¶ã€‚BR/EDR æä¾›çš„ä¿¡é“è¾ƒå¤šä½†å¸¦å®½è¾ƒçª„ï¼Œè€Œ LE ä½¿ç”¨çš„ä¿¡é“è¾ƒå°‘ä½†å¸¦å®½è¾ƒå®½ã€‚</p>
</li>
<li><p>é“¾è·¯å±‚</p>
<p>  å®šä¹‰æ•°æ®åŒ…ç»“æ„/ä¿¡é“ã€å‘ç°/è¿æ¥ç¨‹åºä»¥åŠå‘é€/æ¥æ”¶æ•°æ®ã€‚</p>
</li>
<li><p>ç›´æ¥æµ‹è¯•æ¨¡å¼</p>
<p>  å…è®¸æµ‹è¯•äººå‘˜å‘ PHY å±‚å‘å‡ºæŒ‡ä»¤ä»¥ä¼ è¾“æˆ–æ¥æ”¶ç»™å®šæ•°æ®åŒ…åºåˆ—ï¼Œé€šè¿‡ HCI æˆ– 2 çº¿ UART æ¥å£æäº¤å‘½ä»¤ã€‚</p>
</li>
<li><p>ä¸»æœºæ§åˆ¶å™¨æ¥å£ (HCI)</p>
<p>  è“ç‰™æ§åˆ¶å™¨å­ç³»ç»Ÿï¼ˆåº•éƒ¨ä¸‰å±‚ï¼‰å’Œè“ç‰™ä¸»æœºä¹‹é—´çš„å¯é€‰æ ‡å‡†æ¥å£ã€‚</p>
</li>
<li><p>é€»è¾‘é“¾è·¯æ§åˆ¶å’Œé€‚é…åè®® (L2CAP) å±‚</p>
<p>  åŸºäºæ•°æ®åŒ…çš„åè®®ï¼Œå¯å°†æ•°æ®åŒ…ä¼ è¾“è‡³ HCI æˆ–ç›´æ¥ä¼ è¾“åˆ°æ— ä¸»æœºç³»ç»Ÿä¸­çš„é“¾è·¯ç®¡ç†å™¨ã€‚æ”¯æŒæ›´é«˜çº§åˆ«çš„åè®®å¤šè·¯å¤ç”¨ã€æ•°æ®åŒ…åˆ†å‰²å’Œé‡ç»„ï¼Œä»¥åŠå°†æœåŠ¡è´¨é‡ä¿¡æ¯ä¼ è¾“åˆ°æ›´é«˜å±‚ã€‚</p>
</li>
<li><p>å±æ€§åè®® (ATT)</p>
<p>  åœ¨å»ºç«‹è¿æ¥ä¹‹åå®šä¹‰æ•°æ®äº¤æ¢å®¢æˆ·ç«¯/æœåŠ¡å™¨åè®®ã€‚ä½¿ç”¨é€šç”¨å±æ€§é…ç½®æ–‡ä»¶ (GATT) å°†å±æ€§åˆ†ç±»ä¸ºæœ‰æ„ä¹‰çš„æœåŠ¡ã€‚ATT ä¸»è¦ç”¨äº LE éƒ¨ç½²ï¼Œå¶å°”ä¹Ÿä¼šç”¨äº BR/EDR éƒ¨ç½²ã€‚</p>
</li>
<li><p>å®‰å…¨ç®¡ç†å™¨</p>
<p>  å®šä¹‰ç®¡ç†è“ç‰™è®¾å¤‡ä¹‹é—´é…å¯¹å®Œæ•´æ€§ã€èº«ä»½éªŒè¯ä»¥åŠåŠ å¯†çš„åè®®å’Œæ“ä½œï¼Œæä¾›å®‰å…¨åŠŸèƒ½å·¥å…·ç®±ï¼Œå…¶ä»–ç»„ä»¶å¯åˆ©ç”¨è¯¥å·¥å…·ç®±æ”¯æŒä¸åŒåº”ç”¨æ‰€éœ€çš„å„ç§å®‰å…¨çº§åˆ«ã€‚</p>
</li>
<li><p>é€šç”¨å±æ€§é…ç½®æ–‡ä»¶ (GATT)</p>
<p>  ä½¿ç”¨å±æ€§åè®®ï¼ŒGATT å¯¹å°è£…è®¾å¤‡ç»„ä»¶æ€§èƒ½çš„æœåŠ¡è¿›è¡Œåˆ†ç»„ï¼Œå¹¶æè¿°åŸºäº GATT åŠŸèƒ½çš„ç”¨ä¾‹ã€è§’è‰²å’Œä¸€èˆ¬æ€§èƒ½ã€‚å…¶æœåŠ¡æ¡†æ¶å®šä¹‰æœåŠ¡è§„ç¨‹å’Œæ ¼å¼åŠå…¶ç‰¹æ€§ï¼Œå…¶ä¸­åŒ…æ‹¬å‘ç°ã€è¯»å–ã€å†™å…¥ã€é€šçŸ¥ä»¥åŠæŒ‡ç¤ºç‰¹æ€§ä»¥åŠé…ç½®ç‰¹æ€§å¹¿æ’­ã€‚GATT ä»…ç”¨äºè“ç‰™ LE éƒ¨ç½²ã€‚ è¯¦ç»†äº†è§£ <a href="https://www.bluetooth.com/zh-cn/specifications/generic-attributes-overview" target="_blank" rel="external">GATT</a> ä¿¡æ¯ã€‚ </p>
</li>
<li><p>é€šç”¨è®¿é—®é…ç½®æ–‡ä»¶(GAP)</p>
</li>
</ul>
<p>å¯ä¸è“ç‰™ LE éƒ¨ç½²ä¸­çš„ GATT é…åˆä½¿ç”¨ï¼Œä»¥å®šä¹‰ä¸å‘ç°è“ç‰™è®¾å¤‡å’Œå…±äº«ä¿¡æ¯ç›¸å…³çš„è§„ç¨‹å’Œè§’è‰²ï¼Œä»¥åŠè¿æ¥è“ç‰™è®¾å¤‡çš„é“¾è·¯ç®¡ç†å†…å®¹ã€‚ </p>
<p><a href="https://www.bluetooth.com/zh-cn/specifications/bluetooth-core-specification" target="_blank" rel="external">ä»¥ä¸Šä¿¡æ¯æ¥è‡ªè¿™é‡Œ</a></p>
<h2 id="0x02-Androidç³»ç»Ÿä¸­çš„BLE"><a href="/2017/05/19/[Android-Bluetooth]0x02æ“ä½œ/#0x02-Androidç³»ç»Ÿä¸­çš„BLE" class="headerlink" title="0x02 Androidç³»ç»Ÿä¸­çš„BLE"></a>0x02 Androidç³»ç»Ÿä¸­çš„BLE</h2><p>Androidç³»ç»Ÿä¸­å¯¹äºä½åŠŸè€—è“ç‰™æˆ‘ä»¬éœ€è¦å…³å¿ƒä»¥ä¸‹å‡ ç‚¹ï¼š</p>
<ul>
<li>Android 4.3ï¼ˆ18ï¼‰å¼€å§‹æ”¯æŒBLE</li>
<li>Android 5.0ï¼ˆ21ï¼‰ä¹‹å‰æ‰‹æœºåªå¯ä»¥ä½œä¸ºä¸­å¿ƒè®¾å¤‡ï¼ˆCentral modeï¼‰ä½¿ç”¨ï¼Œ5.0ä¹‹åå¯ä»¥ä½œä¸ºå¤–è®¾ï¼ˆPeripheral modeï¼‰ä½¿ç”¨</li>
</ul>
<p>é™¤äº†ä»¥ä¸Šä¿¡æ¯ï¼Œæˆ‘ä»¬åœ¨å¯¹åè®®ä¸­çš„å‡ ä¸ªæ¦‚å¿µåšä¸ªä»‹ç»ï¼Œè¿™æ¶‰åŠåˆ°ä¹‹åçš„å¼€å‘ï¼š</p>
<ul>
<li><p>Attribute Protocol (ATT)</p>
<p>  å±æ€§åè®®ï¼Œå¯¹åº” <code>BluetoothGattService</code></p>
</li>
<li><p>Generic Attribute Profile (GATT)</p>
<p>  é€šç”¨å±æ€§é…ç½®æ–‡ä»¶ï¼Œå¯¹åº”Androidä¸­çš„ <code>BluetoothGatt</code></p>
</li>
<li><p>Characteristic</p>
<p>  <code>BluetoothGattCharacteristic</code></p>
</li>
<li><p>Descriptor</p>
<p>  <code>BluetoothGattDescriptor</code></p>
</li>
<li><p>Service</p>
<p>  <code>BluetoothGattService</code></p>
</li>
</ul>
<p><img src="https://www.bluetooth.com/~/media/images/page-content/gatt%20profile%20hierarchy.ashx?la=zh-cn&amp;hash=9323C669A731EA445651072296730FB343BA6BB5" alt=""></p>
<h2 id="0x03-Androidç³»ç»Ÿä¸­çš„BLEæ“ä½œæµç¨‹"><a href="/2017/05/19/[Android-Bluetooth]0x02æ“ä½œ/#0x03-Androidç³»ç»Ÿä¸­çš„BLEæ“ä½œæµç¨‹" class="headerlink" title="0x03 Androidç³»ç»Ÿä¸­çš„BLEæ“ä½œæµç¨‹"></a>0x03 Androidç³»ç»Ÿä¸­çš„BLEæ“ä½œæµç¨‹</h2><p>å’Œä¹‹å‰çš„æ™®é€šè“ç‰™ç›¸åŒï¼Œæˆ‘ä»¬éœ€è¦å…ˆæ£€æµ‹è®¾å¤‡çš„è“ç‰™æ˜¯å¦å¯ç”¨ï¼Œç„¶åæ‰«æå‘¨å›´çš„è“ç‰™è®¾å¤‡ï¼Œç„¶åè¿æ¥ã€‚è¿™é‡Œå¯ä»¥çœ‹åˆ°ï¼ŒBLEçš„æ“ä½œå¹¶ä¸éœ€è¦é…å¯¹ã€‚å¦‚éœ€è¦åœ¨è®¾å¤‡å¿…é¡»æ”¯æŒä½åŠŸè€—è“ç‰™ï¼Œåˆ™è¿˜éœ€è¦åŠ ä¸Šè¿™å¥ï¼š</p>
<p><code>&lt;uses-feature android:name=&quot;android.hardware.bluetooth_le&quot; android:required=&quot;true&quot;/&gt;</code></p>
<ul>
<li><p>è“ç‰™æ‰«æ</p>
  <figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">private</span> <span class="keyword">boolean</span> mScanning;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">scanLeDevice</span><span class="params">(<span class="keyword">final</span> <span class="keyword">boolean</span> enable)</span> </span>&#123;</div><div class="line">    <span class="keyword">if</span> (enable) &#123;</div><div class="line">        mHandler.postDelayed(<span class="keyword">new</span> Runnable() &#123;</div><div class="line">            <span class="meta">@Override</span></div><div class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</div><div class="line">                mScanning = <span class="keyword">false</span>;</div><div class="line">                mBluetoothAdapter.stopLeScan(mLeScanCallback);</div><div class="line">            &#125;</div><div class="line">        &#125;, SCAN_PERIOD);</div><div class="line"></div><div class="line">        mScanning = <span class="keyword">true</span>;</div><div class="line">        mBluetoothAdapter.startLeScan(mLeScanCallback);</div><div class="line">    &#125; <span class="keyword">else</span> &#123;</div><div class="line">        mScanning = <span class="keyword">false</span>;</div><div class="line">        mBluetoothAdapter.stopLeScan(mLeScanCallback);</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// Device scan callback.</span></div><div class="line"><span class="keyword">private</span> BluetoothAdapter.LeScanCallback mLeScanCallback = <span class="keyword">new</span> BluetoothAdapter.LeScanCallback() &#123;</div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onLeScan</span><span class="params">(<span class="keyword">final</span> BluetoothDevice device, <span class="keyword">int</span> rssi, <span class="keyword">byte</span>[] scanRecord)</span> </span>&#123;</div><div class="line">        String format = <span class="string">"Name:%s, Mac:%s, Type:%s"</span>;</div><div class="line">        String msg = String.format(format, device.getName(), device.getAddress(), device.getType());</div><div class="line">        print(msg);</div><div class="line">    &#125;</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
</li>
</ul>
<pre><code>æ‰«æå®Œæˆä¹‹åï¼Œæˆ‘ä»¬ä¼šæ‹¿åˆ°è“ç‰™çš„è®¾å¤‡ä¿¡æ¯ï¼Œç„¶åå°±å¯ä»¥è¿›è¡Œè¿æ¥äº†ã€‚ 
</code></pre><ul>
<li><p>è¿æ¥è“ç‰™</p>
  <figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@Override</span></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">onStartCommand</span><span class="params">(Intent intent, <span class="keyword">int</span> flags, <span class="keyword">int</span> startId)</span> </span>&#123;</div><div class="line">    <span class="keyword">if</span> (<span class="keyword">null</span> != intent) &#123;</div><div class="line">        mMAC = intent.getStringExtra(KEY_MAC);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span> (TextUtils.isEmpty(mMAC)) &#123;</div><div class="line">        mMAC = MAC_BIKE;</div><div class="line">    &#125;</div><div class="line">    mBluetoothManager = (BluetoothManager) getSystemService(Context.BLUETOOTH_SERVICE);</div><div class="line">    mBluetoothAdapter = mBluetoothManager.getAdapter();</div><div class="line">    <span class="keyword">if</span> (<span class="keyword">null</span> == mBluetoothAdapter) &#123;</div><div class="line">        stopSelf();</div><div class="line">        <span class="keyword">return</span> START_NOT_STICKY;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    BluetoothDevice device = mBluetoothAdapter.getRemoteDevice(mMAC);</div><div class="line">    <span class="keyword">if</span> (<span class="keyword">null</span> == device) &#123;</div><div class="line">        stopSelf();</div><div class="line">        <span class="keyword">return</span> START_NOT_STICKY;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    closeConnect();</div><div class="line"></div><div class="line">    mBluetoothGatt = device.connectGatt(<span class="keyword">this</span>, <span class="keyword">false</span>, mCallBack);</div><div class="line">    <span class="keyword">if</span> (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.LOLLIPOP) &#123; <span class="comment">//5.0è®¾ç½®çš„ä¼ è¾“æœ€å¤§ç©ºé—´</span></div><div class="line">        mBluetoothGatt.requestConnectionPriority(BluetoothGatt.CONNECTION_PRIORITY_HIGH);</div><div class="line">        mBluetoothGatt.requestMtu(<span class="number">84</span>);</div><div class="line">    &#125;</div><div class="line">    print(<span class="string">"Gatt connect"</span>);</div><div class="line">    <span class="keyword">return</span> START_STICKY;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>è¿æ¥è“ç‰™</p>
<p>  åœ¨è¿æ¥çš„CallBackä¸­å¦‚æœæˆ‘ä»¬æ£€æµ‹åˆ°è¿æ¥æˆåŠŸï¼Œæ‰å¯ä»¥è¯·æ±‚è“ç‰™æä¾›çš„æœåŠ¡ï¼Œè¿™é‡Œå…ˆæ£€æµ‹è¿æ¥çš„çŠ¶æ€ï¼š</p>
  <figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line">    <span class="keyword">private</span> <span class="keyword">final</span> BluetoothGattCallback mCallBack = <span class="keyword">new</span> BluetoothGattCallback() &#123;</div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onConnectionStateChange</span><span class="params">(BluetoothGatt gatt, <span class="keyword">int</span> status, <span class="keyword">int</span> newState)</span> </span>&#123;</div><div class="line">        <span class="keyword">super</span>.onConnectionStateChange(gatt, status, newState);</div><div class="line"></div><div class="line">        print(String.format(<span class="string">"status:%d, newState:%d"</span>, status, newState));</div><div class="line"></div><div class="line">        <span class="keyword">if</span> (status != BluetoothGatt.GATT_SUCCESS) &#123;</div><div class="line">            closeConnect();</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="keyword">switch</span> (newState) &#123;</div><div class="line">            <span class="keyword">case</span> BluetoothProfile.STATE_CONNECTED:</div><div class="line">                print(<span class="string">"è¿æ¥GATTæœåŠ¡æˆåŠŸï¼Œå¼€å§‹å‘ç°æœåŠ¡..."</span>);</div><div class="line">                gatt.discoverServices();</div><div class="line">                <span class="keyword">break</span>;</div><div class="line">            <span class="keyword">case</span> BluetoothProfile.STATE_DISCONNECTED:</div><div class="line">                print(<span class="string">"æ–­å¼€GATTæœåŠ¡ï¼ŒBye"</span>);</div><div class="line">                closeConnect();</div><div class="line">                <span class="keyword">break</span>;</div><div class="line"></div><div class="line">            <span class="keyword">default</span>:</div><div class="line">                <span class="keyword">break</span>;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    ...</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
</li>
</ul>
<ul>
<li><p>å‘ç°æœåŠ¡</p>
  <figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">private</span> <span class="keyword">final</span> BluetoothGattCallback mCallBack = <span class="keyword">new</span> BluetoothGattCallback() &#123;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onServicesDiscovered</span><span class="params">(BluetoothGatt gatt, <span class="keyword">int</span> status)</span> </span>&#123;</div><div class="line">        <span class="keyword">super</span>.onServicesDiscovered(gatt, status);</div><div class="line"></div><div class="line">        print(<span class="string">"å‘ç°æœåŠ¡ï¼š"</span> + status);</div><div class="line"></div><div class="line">        <span class="keyword">if</span> (BluetoothGatt.GATT_SUCCESS == status) &#123;</div><div class="line">            List&lt;BluetoothGattService&gt; gattServices = gatt.getServices();</div><div class="line">            <span class="keyword">if</span> (<span class="keyword">null</span> == gattServices || gattServices.size() == <span class="number">0</span>) &#123;</div><div class="line">                <span class="keyword">return</span>;</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">for</span> (BluetoothGattService gattService : gattServices) &#123;</div><div class="line">                String serviceUUID = gattService.getUuid().toString();</div><div class="line">                print(<span class="string">"UUID GATT:"</span> + serviceUUID);</div><div class="line">                List&lt;BluetoothGattCharacteristic&gt; characteristics = gattService.getCharacteristics();</div><div class="line">                <span class="keyword">for</span> (BluetoothGattCharacteristic characteristic : characteristics) &#123;</div><div class="line">                    String uuid = characteristic.getUuid().toString();</div><div class="line">                    print(<span class="string">"UUID     Cha:"</span> + uuid);</div><div class="line">                    print(<span class="string">"UUID     Status:"</span> + getProperties(characteristic));</div><div class="line">                    <span class="keyword">if</span> (UUID_RECEIVE.toString().equalsIgnoreCase(uuid)) &#123;</div><div class="line">                        mBluetoothGatt.setCharacteristicNotification(characteristic, <span class="keyword">true</span>);</div><div class="line">                        print(<span class="string">"å¼€å§‹ç›‘å¬ï¼š"</span> + uuid);</div><div class="line">                    &#125;</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    ...</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ul>
<ul>
<li><p>ä½¿ç”¨æœåŠ¡</p>
<p>  â€¦</p>
</li>
</ul>
<h2 id="0x04-è¿˜éœ€è¦äº†è§£çš„ä¸€äº›ç»†èŠ‚"><a href="/2017/05/19/[Android-Bluetooth]0x02æ“ä½œ/#0x04-è¿˜éœ€è¦äº†è§£çš„ä¸€äº›ç»†èŠ‚" class="headerlink" title="0x04 è¿˜éœ€è¦äº†è§£çš„ä¸€äº›ç»†èŠ‚"></a>0x04 è¿˜éœ€è¦äº†è§£çš„ä¸€äº›ç»†èŠ‚</h2><ul>
<li>UUID</li>
</ul>
<ul>
<li>åˆ¤æ–­æœåŠ¡çš„å±æ€§</li>
</ul>
<h2 id="0x05-å¯èƒ½ä¼šé‡åˆ°çš„å‘"><a href="/2017/05/19/[Android-Bluetooth]0x02æ“ä½œ/#0x05-å¯èƒ½ä¼šé‡åˆ°çš„å‘" class="headerlink" title="0x05 å¯èƒ½ä¼šé‡åˆ°çš„å‘"></a>0x05 å¯èƒ½ä¼šé‡åˆ°çš„å‘</h2><p>æ‰‹ä¸Šçš„ä¸¤å°é­…æ—è®¾å¤‡ï¼Œè¿æ¥ä¸€ä¸ªå®¢æˆ·æä¾›çš„è“ç‰™æ¨¡å—ï¼Œæ­»æ´»è¿ä¸ä¸Šï¼Œå…¶ä»–æ‰‹æœºè¿æ¥æ­£å¸¸ã€‚è¿™ä¸¤éƒ¨è®¾å¤‡è¿æ¥æ·˜å®ä¸Šä¹°çš„ä¸€ä¸ªè“ç‰™æ¨¡å—æ­£å¸¸ã€‚</p>
<h2 id="0xFF-å‚è€ƒ"><a href="/2017/05/19/[Android-Bluetooth]0x02æ“ä½œ/#0xFF-å‚è€ƒ" class="headerlink" title="0xFF å‚è€ƒ"></a>0xFF å‚è€ƒ</h2><ul>
<li><a href="https://developer.android.com/guide/topics/connectivity/bluetooth-le.html" target="_blank" rel="external">https://developer.android.com/guide/topics/connectivity/bluetooth-le.html</a></li>
<li><a href="https://www.bluetooth.com/zh-cn/specifications/bluetooth-core-specification" target="_blank" rel="external">https://www.bluetooth.com/zh-cn/specifications/bluetooth-core-specification</a></li>
<li><a href="https://zh.wikipedia.org/wiki/%E8%97%8D%E7%89%99#.E8.97.8D.E7.89.994.0" target="_blank" rel="external">https://zh.wikipedia.org/wiki/%E8%97%8D%E7%89%99#.E8.97.8D.E7.89.994.0</a></li>
<li><a href="https://race604.com/android-ble-in-action/" target="_blank" rel="external">https://race604.com/android-ble-in-action/</a></li>
<li><a href="http://blog.csdn.net/qinxiandiqi/article/details/40741269" target="_blank" rel="external">http://blog.csdn.net/qinxiandiqi/article/details/40741269</a></li>
<li><a href="http://www.jianshu.com/p/8690dbafe849" target="_blank" rel="external">http://www.jianshu.com/p/8690dbafe849</a></li>
<li><a href="https://www.bluetooth.com/zh-cn/specifications/adopted-specifications" target="_blank" rel="external">https://www.bluetooth.com/zh-cn/specifications/adopted-specifications</a></li>
<li><a href="https://www.bluetooth.org/DocMan/handlers/DownloadDoc.ashx?doc_id=286439" target="_blank" rel="external">https://www.bluetooth.org/DocMan/handlers/DownloadDoc.ashx?doc_id=286439</a></li>
</ul>
<p><img src="https://raw.githubusercontent.com/ttdevs/ttdevs.github.io/common/images/logo.png" alt="Create by ttdevs"></p>
]]></content>
      
        <categories>
            
            <category> æŠ€æœ¯ </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Android </tag>
            
            <tag> Bluetooth </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[ã€ŒAndroid-Bluetoothã€0x01æ“ä½œ]]></title>
      <url>/1970/01/01/%5BAndroid-Bluetooth%5D0x01%E6%93%8D%E4%BD%9C/</url>
      <content type="html"><![CDATA[<h2 id="0x00-è“ç‰™ï¼ˆBluetoothï¼‰"><a href="/1970/01/01/[Android-Bluetooth]0x01æ“ä½œ/#0x00-è“ç‰™ï¼ˆBluetoothï¼‰" class="headerlink" title="0x00 è“ç‰™ï¼ˆBluetoothï¼‰"></a>0x00 è“ç‰™ï¼ˆBluetoothï¼‰</h2><p>è¿™ä¸ªå°ç¡¬ä»¶å·²ç»æ˜¯Androidæœºå™¨çš„æ ‡é…äº†ï¼Œç”±äºå¹³æ—¶ä¸æ€ä¹ˆç”¨ï¼Œå› æ­¤åˆ°ç°åœ¨éƒ½æ²¡æœ‰å»ç ”ç©¶è¿‡ã€‚ç°åœ¨æœ‰ä¸€ä¸ªç®€å•çš„å°éœ€æ±‚ï¼šé€šè¿‡è“ç‰™è¿æ¥ä¸€ä¸ªä¸²å£è®¾å¤‡è¯»å–å…¶ä¸Šé¢çš„æ•°æ®ï¼Œå³ä»å·²é…å¯¹çš„è®¾å¤‡åˆ—è¡¨ä¸­é€‰æ‹©æˆ‘ä»¬çš„ä¸²å£è“ç‰™è®¾å¤‡ï¼ˆä»ï¼‰ï¼Œè¿æ¥ï¼Œç„¶åè¯»å–æ•°æ®ã€‚é‚å†™æ­¤æ–‡ã€‚</p>
<h2 id="0x01-ç®€å•ä½¿ç”¨"><a href="/1970/01/01/[Android-Bluetooth]0x01æ“ä½œ/#0x01-ç®€å•ä½¿ç”¨" class="headerlink" title="0x01 ç®€å•ä½¿ç”¨"></a>0x01 ç®€å•ä½¿ç”¨</h2><p>è“ç‰™è®¾å¤‡çš„è¯¦ç»†ä½¿ç”¨ï¼Œå¯ä»¥å‚è€ƒ<a href="https://developer.android.google.cn/guide/topics/connectivity/bluetooth.html" target="_blank" rel="external">Androidå…³äºè“ç‰™çš„å®˜æ–¹æ–‡æ¡£</a>ã€‚å¦‚æœä½ å’Œæˆ‘ä¸€æ ·ï¼Œä¹‹å‰æ²¡æœ‰ç ”ç©¶è¿‡è“ç‰™ï¼Œä¼°è®¡çœ‹çœ‹å®Œåä¹Ÿä¼šæœ‰ä¸€å †é—®é¢˜å­˜åœ¨ï¼šä»€ä¹ˆä¸»è®¾å¤‡ã€ä»è®¾å¤‡ã€UUIDæ˜¯å¹²å˜›çš„ï¼Œå¦‚ä½•å…å¯†é’¥é…å¯¹ç­‰ç­‰ã€‚ä¸ç€æ€¥ï¼Œæˆ‘ä»¬æ…¢æ…¢æ¥ã€‚</p>
<p>ä¸Šé¢å·²ç»è¯´åˆ°ï¼Œæˆ‘ä»¬çš„è®¾å¤‡å·²ç»æå‰é…å¯¹å®Œæˆï¼ˆæ€ä¹ˆé…å¯¹ï¼šç½‘ç»œè®¾ç½®ä¸­ä¸­æ‰¾åˆ°è“ç‰™ï¼Œç„¶åæœç´¢ï¼Œæ‰¾åˆ°ä½ çš„è®¾å¤‡ï¼Œç„¶åé…å¯¹ã€‚è¿™ä¸ªæ—¶å€™å¯èƒ½ä¼šæç¤ºè¾“å…¥å¯†ç ï¼Œé»˜è®¤å¯†ç æ¯”0000ï¼Œ1234ç­‰ï¼‰ã€‚æˆ‘ä»¬åªéœ€è¦è¿æ¥å³å¯ã€‚ä¸‹é¢ç®€è¿°æ“ä½œæ­¥éª¤ï¼š</p>
<ol>
<li><p>æ·»åŠ è“ç‰™æƒé™</p>
 <figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">uses-permission</span> <span class="attr">android:name</span>=<span class="string">"android.permission.BLUETOOTH"</span> /&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">uses-permission</span> <span class="attr">android:name</span>=<span class="string">"android.permission.BLUETOOTH_ADMIN"</span> /&gt;</span></div></pre></td></tr></table></figure>
</li>
</ol>
<ol>
<li><p>åˆ¤æ–­æ˜¯å¦æ”¯æŒè“ç‰™</p>
 <figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">initBluetooth</span><span class="params">()</span> </span>&#123;</div><div class="line">    mBluetoothAdapter = BluetoothAdapter.getDefaultAdapter();</div><div class="line">    <span class="keyword">if</span> (<span class="keyword">null</span> == mBluetoothAdapter) &#123;</div><div class="line">        tvContent.setText(<span class="string">"BluetoothAdapter is null"</span>);</div><div class="line">        <span class="keyword">return</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span> (!mBluetoothAdapter.isEnabled()) &#123;</div><div class="line">        tvContent.setText(<span class="string">"BluetoothAdapter is disable, please open it"</span>);</div><div class="line"></div><div class="line">        Intent intent = <span class="keyword">new</span> Intent(BluetoothAdapter.ACTION_REQUEST_ENABLE);</div><div class="line">        startActivityForResult(intent, REQUEST_ENABLE_BT);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    tvContent.setText(<span class="string">"Bluetooth init success"</span>);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ol>
<pre><code>é¦–å…ˆæ˜¯åˆ¤æ–­æ˜¯å¦æœ‰è“ç‰™é€‚é…å™¨ï¼Œå¦‚æœæ²¡æœ‰ï¼Œ`BluetoothAdapter.getDefaultAdapter()` è¿”å› `null`ã€‚ç„¶ååˆ¤æ–­è“ç‰™è®¾å¤‡æ˜¯å¦å¯ç”¨ `mBluetoothAdapter.isEnabled()` ï¼Œå¦‚æœæœªå¯ç”¨ï¼Œåˆ™å‘é€ä¸€ä¸ª `Intent` æ¥è®©ç”¨æˆ·å¯ç”¨è“ç‰™ï¼Œè¿™ä¸ª `Intent` æ˜¯ç³»ç»Ÿçš„ï¼Œæˆ‘ä»¬åœ¨ `onActivityResult` ä¸­å¤„ç†ç”¨æˆ·æ“ä½œç»“æœï¼Œå¦‚æœç”¨æˆ·é¡ºåˆ©å¼€å¯è“ç‰™ï¼Œåˆ™ä¼šè¿”å› `RESULT_OK`ã€‚
</code></pre><ol>
<li><p>è·å–è®¾å¤‡åˆ—è¡¨</p>
 <figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">Set&lt;BluetoothDevice&gt; pairedDevices = mBluetoothAdapter.getBondedDevices();</div><div class="line"><span class="keyword">if</span> (<span class="keyword">null</span> != pairedDevices &amp;&amp; pairedDevices.size() &gt; <span class="number">0</span>) &#123;</div><div class="line">  <span class="keyword">for</span> (BluetoothDevice device : pairedDevices) &#123;</div><div class="line">      ......</div><div class="line">      String msg = String.format(<span class="string">"%s %s\n"</span>, device.getName(), device.getAddress());</div><div class="line">      ......</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ol>
<pre><code>è¿™ä¸ªæ—¶å€™æˆ‘ä»¬å¯ä»¥æ‹¿åˆ° `BluetoothDevice` ï¼Œè¿™ä¸ªå¯¹è±¡ä¸­ä¿å­˜äº†å·²é…å¯¹è“ç‰™è®¾å¤‡çš„ä¿¡æ¯ï¼Œæ¯”å¦‚åç§°ï¼ŒMACåœ°å€ï¼ŒçŠ¶æ€ï¼ŒUUIDç­‰ä¿¡æ¯ï¼ˆä½†è¿™äº›ä¿¡æ¯ä¸ä¸€å®šéƒ½éƒ½ï¼‰ï¼Œæˆ‘ä»¬éœ€è¦ä¿å­˜ä¸‹æ¥ï¼Œåœ¨æ¥ä¸‹æ¥è¿æ¥çš„æ—¶å€™ä¼šä½¿ç”¨ã€‚
</code></pre><ol>
<li><p>è¿æ¥è®¾å¤‡</p>
<p> æœ‰äº† <code>BluetoothDevice</code> ä¿¡æ¯ï¼Œæˆ‘ä»¬å°±å¯ä»¥è¿æ¥è¿™ä¸ªå·²ç»é…å¯¹çš„è“ç‰™è®¾å¤‡äº†ã€‚</p>
 <figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"> <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> UUID DEFAULT_UUID = UUID.fromString(<span class="string">"00001101-0000-1000-8000-00805f9b34fb"</span>);</div><div class="line"></div><div class="line"> <span class="keyword">try</span> &#123;</div><div class="line">    <span class="keyword">if</span>(<span class="keyword">null</span> == mSocket)&#123;</div><div class="line">        mSocket = mDevice.createRfcommSocketToServiceRecord(DEFAULT_UUID);</div><div class="line">    &#125;</div><div class="line">    mSocket.connect(); <span class="comment">// é˜»å¡çš„</span></div><div class="line"></div><div class="line">    mIn = mSocket.getInputStream();</div><div class="line">&#125; <span class="keyword">catch</span> (IOException e) &#123;</div><div class="line">    e.printStackTrace();</div><div class="line">    <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ol>
<pre><code>è¿æ¥æˆåŠŸåï¼Œæˆ‘ä»¬ä¼šå¾—åˆ°ä¸€ä¸ª `BluetoothSocket` å¯¹è±¡ï¼Œç„¶åè°ƒç”¨å…¶é˜»å¡çš„ `connect()` æ–¹æ³•ï¼Œç­‰å¾…ä¸¤å°è®¾å¤‡è¿æ¥æˆåŠŸï¼ˆæ‰€ä»¥è¿™ä¸ªæ—¶å€™å¿…é¡»åœ¨å¦å¤–ä¸€ä¸ªçº¿ç¨‹ä¸­è¿›è¡Œï¼‰ã€‚å½“ä¸¤å°è®¾å¤‡è¿æ¥æˆåŠŸä¹‹åä¼šç»§ç»­å‘ä¸‹æ‰§è¡Œã€‚
</code></pre><ol>
<li><p>è¯»å–æ•°æ®</p>
<p> è¿æ¥æˆåŠŸä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ <code>mSocket.getInputStream()</code> è·å¾—ä¸€ä¸ªè¾“å…¥æµï¼Œç»“ä¸‹æ¥çš„æ“ä½œå°±æ˜¯æµçš„æ“ä½œäº†ï¼Œè¿™ä¸ªå’Œæ™®é€š <code>socket</code> ä¸­è¾“å…¥è¾“å‡ºæµçš„æ“ä½œä¸€æ ·äº†ã€‚</p>
 <figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"> <span class="keyword">try</span> &#123;</div><div class="line">    mBytes = mIn.read(readBuffer);</div><div class="line">    System.arraycopy(readBuffer, <span class="number">0</span>, tempBuffer, mCount, mBytes);</div><div class="line">    mCount += mBytes;</div><div class="line">    <span class="keyword">if</span> (mCount &gt;= SIZE) &#123;</div><div class="line">        parseData(tempBuffer);</div><div class="line">        mCount = <span class="number">0</span>;</div><div class="line">    &#125;</div><div class="line">&#125; <span class="keyword">catch</span> (IOException e) &#123;</div><div class="line">    e.printStackTrace();</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ol>
<h2 id="0x02-æ€»ç»“"><a href="/1970/01/01/[Android-Bluetooth]0x01æ“ä½œ/#0x02-æ€»ç»“" class="headerlink" title="0x02 æ€»ç»“"></a>0x02 æ€»ç»“</h2><p>Androidè“ç‰™ï¼ˆä¸»ä»ï¼‰çš„æ“ä½œï¼š</p>
<ul>
<li>æ£€æŸ¥æ˜¯å¦æ”¯æŒï¼Œæ˜¯å¦å¯ç”¨ï¼ˆåŒ…æ‹¬æ˜¯å¦å¯è§ç­‰ï¼‰</li>
<li>æ‰«æè®¾å¤‡</li>
<li>é…å¯¹</li>
<li>è¿æ¥</li>
<li>æ•°æ®äº¤æ¢</li>
<li>ç­‰ç­‰</li>
</ul>
<p>è¿™é‡Œåªè®²äº†æ£€æŸ¥éƒ¨åˆ†æ“ä½œï¼Œæ¶‰åŠçš„æ‰«æä¸é…å¯¹å¯èƒ½æ˜¯æ›´å¤æ‚ä¸€äº›çš„ï¼Œåœ¨æ¥ä¸‹æ¥è®²è¿°ã€‚</p>
<p>æœ€åï¼Œé¡¹ç›®ä»£ç å¯å‚è€ƒè¿™é‡Œ<a href="https://github.com/ttdevs/android/tree/master/apps/air" target="_blank" rel="external">github/ttdevs/air</a>ã€‚</p>
<h2 id="0x03-Javaçº¿ç¨‹çš„å°è£…"><a href="/1970/01/01/[Android-Bluetooth]0x01æ“ä½œ/#0x03-Javaçº¿ç¨‹çš„å°è£…" class="headerlink" title="0x03 Javaçº¿ç¨‹çš„å°è£…"></a>0x03 Javaçº¿ç¨‹çš„å°è£…</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"> * Created by ttdevs</div><div class="line"> * 2017-01-22 (android)</div><div class="line"> * https://github.com/ttdevs</div><div class="line"> */</div><div class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">BaseWorkerThread</span> <span class="keyword">extends</span> <span class="title">Thread</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="keyword">private</span> <span class="keyword">boolean</span> isRunning = <span class="keyword">true</span>;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">super</span>.run();</div><div class="line">        isRunning = workerBefore();</div><div class="line"></div><div class="line">        <span class="keyword">while</span> (isRunning) &#123;</div><div class="line">            workerCycle();</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        workerAfter();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * æå‰æ‰§è¡Œ true: ç»§ç»­ false: ç»“æŸ</div><div class="line">     *</div><div class="line">     * <span class="doctag">@return</span></div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">workerBefore</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * å·¥ä½œæ–¹æ³•ï¼Œè¢«å¾ªç¯è°ƒç”¨</div><div class="line">     *</div><div class="line">     * <span class="doctag">@return</span> true: ç»§ç»­ false: ç»“æŸ</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">workerCycle</span><span class="params">()</span></span>;</div><div class="line"></div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * ç»“æŸæ‰§è¡Œ</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">workerAfter</span><span class="params">()</span> </span>&#123;</div><div class="line"></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * å¼€å§‹çº¿ç¨‹</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">startThread</span><span class="params">()</span> </span>&#123;</div><div class="line">        isRunning = <span class="keyword">true</span>;</div><div class="line">        <span class="keyword">try</span> &#123;</div><div class="line">            start();</div><div class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</div><div class="line">            e.printStackTrace();</div><div class="line">            isRunning = <span class="keyword">false</span>;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * ç»“æŸçº¿ç¨‹</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">stopThread</span><span class="params">()</span> </span>&#123;</div><div class="line">        isRunning = <span class="keyword">false</span>;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="0x04-å‚è€ƒ"><a href="/1970/01/01/[Android-Bluetooth]0x01æ“ä½œ/#0x04-å‚è€ƒ" class="headerlink" title="0x04 å‚è€ƒ"></a>0x04 å‚è€ƒ</h2><ul>
<li><a href="https://developer.android.google.cn/guide/topics/connectivity/bluetooth.html" target="_blank" rel="external">https://developer.android.google.cn/guide/topics/connectivity/bluetooth.html</a></li>
</ul>
<p><img src="https://raw.githubusercontent.com/ttdevs/ttdevs.github.io/common/images/logo.png" alt="Create by ttdevs"></p>
]]></content>
      
        <categories>
            
            <category> æŠ€æœ¯ </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Android </tag>
            
            <tag> Bluetooth </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[ã€ŒAndroid-SQLiteã€0x02ä»åŠ è½½æœ¬åœ°æ•°æ®åº“å¼€å§‹]]></title>
      <url>/1970/01/01/%5BAndroid-SQLite%5D0x02%E4%BB%8E%E5%8A%A0%E8%BD%BD%E6%9C%AC%E5%9C%B0%E6%95%B0%E6%8D%AE%E5%BA%93%E5%BC%80%E5%A7%8B/</url>
      <content type="html"><![CDATA[<h2 id="0x00-å¼•è¨€"><a href="/1970/01/01/[Android-SQLite]0x02ä»åŠ è½½æœ¬åœ°æ•°æ®åº“å¼€å§‹/#0x00-å¼•è¨€" class="headerlink" title="0x00 å¼•è¨€"></a>0x00 å¼•è¨€</h2><blockquote>
<p>å¥½ä¹…ä»¥å‰å°±å†™äº†ï¼Œä½†æ˜¯ä¸€ç›´æ‹–æ‹–æ‹‰æ‹‰çš„ï¼Œåœ¨è‰ç¨¿ç®±é‡Œæ”¾äº†ä¸¤ä¸ªæ˜ŸæœŸè¿˜æ²¡å†™å®Œï¼Œæƒ³æƒ³è¿™æ ·æ‰˜ä¸‹å»åˆè¦åºŸæ‰äº†ï¼Œè¿˜æ˜¯åˆ†å¼€æ¥å§ï¼Œå†™å¤šå°‘æ˜¯å¤šå°‘ã€‚</p>
</blockquote>
<p>Androidçš„SQLiteæ•°æ®åº“ç®€å•ä½¿ç”¨ä¸€æ®µæ—¶é—´äº†ï¼Œç°åœ¨æƒ³æŠ½äº›æ—¶é—´æ€»ç»“ä¸‹ï¼Œä¸ç„¶æ€»æ„Ÿè§‰å¾ˆä¹±ã€‚</p>
<h2 id="0x01-SQLiteExpert"><a href="/1970/01/01/[Android-SQLite]0x02ä»åŠ è½½æœ¬åœ°æ•°æ®åº“å¼€å§‹/#0x01-SQLiteExpert" class="headerlink" title="0x01 SQLiteExpert"></a>0x01 SQLiteExpert</h2><p>å…ˆè¯´ä¸€ä¸ªå·¥å…·ï¼Œ<code>SQLite Expert</code>ï¼Œä¸€æ¬¾SQLiteæ•°æ®åº“ç®¡ç†å·¥å…·ï¼Œä¸‹è½½åœ°å€ï¼š <a href="http://www.sqliteexpert.com/" target="_blank" rel="external">http://www.sqliteexpert.com/</a>ï¼ŒPersonal Editionæ˜¯å…è´¹çš„ï¼Œæ—¥å¸¸ä½¿ç”¨åŸºæœ¬è¶³å¤Ÿï¼Œéœ€è¦ä¸“ä¸šç‰ˆçš„å¯ä»¥è‡ªè¡Œç½‘ä¸Šæ‰¾å¯»ã€‚å½“ç„¶ï¼Œå…¶ä»–å…è´¹çš„å·¥å…·è¿˜æœ‰å¾ˆå¤šï¼Œå¦‚ï¼š<code>SQLite Database Browser</code>ã€ <code>SQLiteManager</code> ç­‰ã€‚<br><img src="http://img.blog.csdn.net/20130916222611000?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvdHRkZXZz/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt=""></p>
<h2 id="0x02-åŠ è½½æœ¬åœ°æ•°æ®åº“"><a href="/1970/01/01/[Android-SQLite]0x02ä»åŠ è½½æœ¬åœ°æ•°æ®åº“å¼€å§‹/#0x02-åŠ è½½æœ¬åœ°æ•°æ®åº“" class="headerlink" title="0x02 åŠ è½½æœ¬åœ°æ•°æ®åº“"></a>0x02 åŠ è½½æœ¬åœ°æ•°æ®åº“</h2><p>å‡è®¾æˆ‘ä»¬SDCardçš„æ ¹ç›®å½•ä¸Šå·²ç»å­˜åœ¨ä¸€ä¸ªæ•°æ®åº“ï¼Œåç§°ä¸ºï¼šChinaCity.dbã€‚è¿™æ—¶å€™æˆ‘ä»¬å¯ä»¥è¿™æ ·æ“ä½œï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">readDataBaseFromSDCard</span><span class="params">()</span> </span>&#123;</div><div class="line">    String dbPath = Environment.getExternalStorageDirectory() + <span class="string">"/ChinaCity.db"</span>;</div><div class="line"></div><div class="line">    File dbFile = <span class="keyword">new</span> File(dbPath);</div><div class="line">    <span class="keyword">if</span> (!dbFile.exists()) &#123;</div><div class="line">        Toast.makeText(getApplicationContext(), <span class="string">"è¯·å…ˆç‚¹å‡»æ‹·è´åˆ°SDCard"</span>, Toast.LENGTH_LONG).show();</div><div class="line">        <span class="keyword">return</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    openOrCreateDatabase(dbPath, SQLiteDatabase.CREATE_IF_NECESSARY, <span class="keyword">null</span>);</div><div class="line"></div><div class="line">    SQLiteDatabase db = SQLiteDatabase.openDatabase(dbPath, <span class="keyword">null</span>, SQLiteDatabase.OPEN_READWRITE);</div><div class="line">    <span class="comment">// db = openOrCreateDatabase(dbPath, SQLiteDatabase.OPEN_READWRITE, null);</span></div><div class="line"></div><div class="line">    StringBuffer sb = <span class="keyword">new</span> StringBuffer();</div><div class="line">    Cursor cursor = db.rawQuery(<span class="string">"select * from china_provinces_code"</span>, <span class="keyword">null</span>);</div><div class="line">    <span class="keyword">while</span> (cursor.moveToNext()) &#123;</div><div class="line">        <span class="keyword">int</span> id = cursor.getInt(cursor.getColumnIndex(<span class="string">"_id"</span>));</div><div class="line">        String name = cursor.getString(cursor.getColumnIndex(<span class="string">"name"</span>));</div><div class="line">        sb.append(id + <span class="string">":"</span> + name + <span class="string">" \n"</span>);</div><div class="line">    &#125;</div><div class="line">    System.out.println(sb.toString());</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>å…ˆç”¨SQLiteDatabaseçš„ä¸€ä¸ªé™æ€æ–¹æ³•openDatabaseæ‰“å¼€ä¸€ä¸ªæ•°æ®åº“ï¼Œç¬¬ä¸€ä¸ªå‚æ•°ä¸ºæ•°æ®åº“æ–‡ä»¶è·¯å¾„ï¼Œç¬¬äºŒä¸ªå‚æ•°ä¸€èˆ¬ä¸ºnullï¼Œç¬¬ä¸‰ä¸ªå‚æ•°ä¸ºæ‰“å¼€æ•°æ®åº“çš„æ–¹å¼ï¼Œç”±äºåªéœ€è¦è¯»å–æ•°æ®ï¼Œæ‰€ä»¥æˆ‘ä»¬é€‰æ‹© <code>SQLiteDatabase.OPEN_READONLY</code>ï¼Œæ­¤ç§æ–¹å¼çš„å¥½å¤„æ˜¯æ•°æ®åº“å­˜åœ¨çš„è¯å°±ä¸ä¼šå‡ºé”™ï¼›å¦å¤–ä¸€ç§ä¸º <code>SQLiteDatabase.OPEN_READWRITE</code>ï¼Œä»¥è¯»å†™çš„æ–¹å¼æ‰“å¼€ã€‚æ‰§è¡Œä¸Šé¢ä»£ç ï¼Œæˆ‘ä»¬ä¼šçœ‹ä¸ä¸Šå›¾ä¿¡æ¯ç›¸åŒçš„ï¼š</p>
<p><img src="http://img.blog.csdn.net/20130916225300890?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvdHRkZXZz/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="">  </p>
<p>å¼€å‘çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šéœ€è¦ä¸€äº›åˆå§‹åŒ–æ•°æ®ï¼Œæ¯”å¦‚åŸå¸‚ä»£ç ä¿¡æ¯ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥äº‹å…ˆåˆ›å»ºå¥½ä¸€ä¸ªæ•°æ®åº“ï¼Œå†™å…¥åˆå§‹æ•°æ®ï¼Œå°†å…¶æ”¾å…¥è‡ªå·±çš„apkä¸­ä¸€èµ·åˆ†å‘ã€‚è¿™ä¸ªæ—¶å€™æˆ‘ä»¬å°±å¯ä»¥ç›´æ¥ä»èµ„æºæ–‡ä»¶ä¸­è¯»å–è¿™ä¸ªæ•°æ®åº“æ–‡ä»¶å†™å…¥åˆ°åº”ç”¨çš„æ•°æ®åº“ç›®å½•æˆ–è€…SDCardä¸­ï¼Œç„¶åå°±å¯ä»¥å¯¹å…¶æ“ä½œï¼Œæ‹·è´å¯ä»¥è¿™æ ·æ“ä½œï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"> * æ‹·è´èµ„æºä¸­æ•°æ®åº“</div><div class="line"> *</div><div class="line"> * <span class="doctag">@param</span> where 1SDCARD,2LOCAL</div><div class="line"> */</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">copyDataBase</span><span class="params">(<span class="keyword">int</span> where)</span> </span>&#123;</div><div class="line">    <span class="comment">// æ¯ä¸ªåº”ç”¨éƒ½æœ‰ä¸€ä¸ªæ•°æ®åº“ç›®å½•ï¼Œä»–ä½äº /data/data/packagename/databases/ç›®å½•ä¸‹</span></div><div class="line">    String packageName = <span class="string">"com.ttdevs.citydata"</span>; <span class="comment">// xmlä¸­é…ç½®çš„</span></div><div class="line">    String dbName = <span class="string">"ChinaCity.db"</span>;</div><div class="line">    String dbPath = <span class="keyword">null</span>;</div><div class="line">    <span class="keyword">if</span> (where == <span class="number">1</span>) &#123; <span class="comment">// sdcard</span></div><div class="line">        dbPath = Environment.getExternalStorageDirectory() + File.separator + dbName;</div><div class="line">    &#125; <span class="keyword">else</span> &#123; <span class="comment">// local, TODO Environment.getDataDirectory()</span></div><div class="line">        dbPath = <span class="string">"/data/data/"</span> + packageName + <span class="string">"/databases/"</span> + dbName;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">if</span> (where == <span class="number">2</span>) &#123;</div><div class="line">        <span class="keyword">new</span> File(<span class="string">"/data/data/"</span> + packageName + <span class="string">"/databases/"</span>).mkdirs();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">if</span> (where == <span class="number">1</span> &amp;&amp; !Environment.MEDIA_MOUNTED.equals(Environment.getExternalStorageState())) &#123;</div><div class="line">        <span class="keyword">return</span>; <span class="comment">// æœªæŒ‚è½½å¤–éƒ¨å­˜å‚¨ï¼Œæ‹·è´åˆ°å†…éƒ¨ä¸ç”¨åˆ¤æ–­</span></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    File dbFile = <span class="keyword">new</span> File(dbPath);</div><div class="line">    <span class="keyword">if</span> (dbFile.exists()) &#123;</div><div class="line">        dbFile.delete();</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">try</span> &#123;</div><div class="line">        dbFile.createNewFile();</div><div class="line">    &#125; <span class="keyword">catch</span> (IOException e1) &#123;</div><div class="line">        e1.printStackTrace();</div><div class="line">        <span class="keyword">return</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">try</span> &#123;</div><div class="line">        InputStream is = getResources().getAssets().open(dbName);</div><div class="line">        OutputStream os = <span class="keyword">new</span> FileOutputStream(dbPath);</div><div class="line"></div><div class="line">        <span class="keyword">byte</span>[] buffer = <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">1024</span>];</div><div class="line">        <span class="keyword">int</span> length = <span class="number">0</span>;</div><div class="line">        <span class="keyword">while</span> ((length = is.read(buffer)) &gt; <span class="number">0</span>) &#123;</div><div class="line">            os.write(buffer, <span class="number">0</span>, length);</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        os.flush();</div><div class="line">        os.close();</div><div class="line">        is.close();</div><div class="line">    &#125; <span class="keyword">catch</span> (IOException e) &#123;</div><div class="line">        e.printStackTrace();</div><div class="line">    &#125;</div><div class="line">    Toast.makeText(getApplicationContext(), <span class="string">"æ‹·è´æˆåŠŸ"</span>, Toast.LENGTH_LONG).show();</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä»£ç ä¸æ˜¯å¾ˆä¸¥è°¨ï¼Œå‡‘æ´»ç€çœ‹å“ˆã€‚ç»è¿‡ä»¥ä¸Šæ­¥éª¤ï¼Œæˆ‘ä»¬å°±å¯ä»¥å¼€å§‹ä½¿ç”¨æ•°æ®åº“ï¼Œæ•°æ®åº“çš„å¸¸ç”¨æ“ä½œï¼Œåœ¨æ¥ä¸‹æ¥çš„ä»‹ç»ä¸­ç»§ç»­ã€‚</p>
<h2 id="0x03-ä¸‹è½½"><a href="/1970/01/01/[Android-SQLite]0x02ä»åŠ è½½æœ¬åœ°æ•°æ®åº“å¼€å§‹/#0x03-ä¸‹è½½" class="headerlink" title="0x03 ä¸‹è½½"></a>0x03 ä¸‹è½½</h2><p>ChinaCity.dbæ•°æ®åº“ï¼š <a href="http://download.csdn.net/detail/ttdevs/6332431" target="_blank" rel="external">ä¸‹è½½</a></p>
<p><img src="https://raw.githubusercontent.com/ttdevs/ttdevs.github.io/common/images/logo.png" alt="Create by ttdevs"></p>
]]></content>
      
        <categories>
            
            <category> æŠ€æœ¯ </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Android </tag>
            
            <tag> SQLite </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[ã€ŒAndroid-SQLiteã€0x01åˆ›å»ºè‡ªå·±çš„æ•°æ®åº“]]></title>
      <url>/1970/01/01/%5BAndroid-SQLite%5D0x01%E5%88%9B%E5%BB%BA%E8%87%AA%E5%B7%B1%E7%9A%84%E6%95%B0%E6%8D%AE%E5%BA%93/</url>
      <content type="html"><![CDATA[<h2 id="0x01-åˆ›å»ºè‡ªå·±çš„æ•°æ®åº“"><a href="/1970/01/01/[Android-SQLite]0x01åˆ›å»ºè‡ªå·±çš„æ•°æ®åº“/#0x01-åˆ›å»ºè‡ªå·±çš„æ•°æ®åº“" class="headerlink" title="0x01 åˆ›å»ºè‡ªå·±çš„æ•°æ®åº“"></a>0x01 åˆ›å»ºè‡ªå·±çš„æ•°æ®åº“</h2><p>å¤§å¤šæ•°æƒ…å†µï¼Œæˆ‘ä»¬è¿˜æ˜¯éœ€è¦è‡ªå·±å»ç»´æŠ¤ä¸€ä¸ªæ•°æ®åº“ï¼Œå¸¸è§çš„åŒ…æ‹¬æ•°æ®åº“çš„åˆ›å»ºï¼Œå‡çº§ï¼Œé”€æ¯ç­‰æ“ä½œã€‚ androidæä¾›äº†SQLiteOpenHelperæŠ½è±¡ç±»ï¼Œæˆ‘ä»¬åˆ›å»ºSQLiteOpenHelperçš„å®ç°ç±»ï¼Œé‡å†™ä»–çš„onCreate(), onUpgrade() æˆ–è€… onOpen()æ–¹æ³•ï¼Œå¯¹æ•°æ®åº“è¿›è¡Œç®¡ç†ã€‚å¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DataBaseOpenHelper</span> <span class="keyword">extends</span> <span class="title">SQLiteOpenHelper</span> </span>&#123;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String DATABASE_NAME = <span class="string">"ChinaCity.db"</span>;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> DATABASE_VERSION = <span class="number">1</span>; <span class="comment">// Version must be &gt;= 1</span></div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">DataBaseOpenHelper</span><span class="params">(Context context)</span> </span>&#123;</div><div class="line">        <span class="keyword">super</span>(context, DATABASE_NAME, <span class="keyword">null</span>, DATABASE_VERSION);</div><div class="line">        System.out.println(<span class="string">"DataBaseOpenHelper"</span>);</div><div class="line"></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">DataBaseOpenHelper</span><span class="params">(Context context, <span class="keyword">int</span> version)</span> </span>&#123;</div><div class="line">        <span class="keyword">super</span>(context, DATABASE_NAME, <span class="keyword">null</span>, version);</div><div class="line">        System.out.println(<span class="string">"DataBaseOpenHelper version"</span>);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onOpen</span><span class="params">(SQLiteDatabase db)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (!db.isReadOnly()) &#123;</div><div class="line">            db.execSQL(<span class="string">"PRAGMA foreign_keys = ON;"</span>); <span class="comment">// Enable foreign key constraints </span></div><div class="line">        &#125;</div><div class="line">        <span class="comment">// create table test(id integer references students(id),score integer check (score&lt;=100 and score&lt;=0),primary key(id,score))</span></div><div class="line">        <span class="keyword">super</span>.onOpen(db);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(SQLiteDatabase db)</span> </span>&#123;</div><div class="line">        CityData.createTable(db);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onUpgrade</span><span class="params">(SQLiteDatabase db, <span class="keyword">int</span> oldVersion, <span class="keyword">int</span> newVersion)</span> </span>&#123;</div><div class="line">        CityData.dropTable(db);</div><div class="line">        CityData.createTable(db);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">CityData</span> <span class="keyword">implements</span> <span class="title">BaseColumns</span> </span>&#123;</div><div class="line">        <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String TYPE_TEXT = <span class="string">" text "</span>;</div><div class="line">        <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String TYPE_INTEGER = <span class="string">" integer "</span>;</div><div class="line">        <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String COMMA_SEP = <span class="string">","</span>;</div><div class="line"></div><div class="line">        <span class="comment">// *******************************china_city_code***********************************</span></div><div class="line">        <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String TABLE_NAME_CITY = <span class="string">"china_city_code"</span>;</div><div class="line">        <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String COLUMN_NAME_PROVINCE = <span class="string">"province"</span>;</div><div class="line">        <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String COLUMN_NAME_CITY = <span class="string">"city"</span>;</div><div class="line">        <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String COLUMN_NAME_COUNTY = <span class="string">"county"</span>;</div><div class="line">        <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String COLUMN_NAME_CODE = <span class="string">"code"</span>;</div><div class="line">        <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String SQL_CREATE_CITY = <span class="string">"CREATE TABLE IF NOT EXISTS "</span> + TABLE_NAME_CITY + <span class="string">" ("</span> +</div><div class="line">                _ID + TYPE_INTEGER + <span class="string">" PRIMARY KEY AUTOINCREMENT, "</span> +</div><div class="line">                COLUMN_NAME_PROVINCE + TYPE_TEXT + COMMA_SEP +</div><div class="line">                COLUMN_NAME_CITY + TYPE_TEXT + COMMA_SEP +</div><div class="line">                COLUMN_NAME_COUNTY + TYPE_TEXT + COMMA_SEP +</div><div class="line">                COLUMN_NAME_CODE + TYPE_INTEGER</div><div class="line">                + <span class="string">" )"</span>;</div><div class="line">        <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String SQL_CREATE_CITY_INDEX = <span class="string">"CREATE UNIQUE INDEX IF NOT EXISTS "</span> + COLUMN_NAME_CODE + <span class="string">" ON "</span> + TABLE_NAME_CITY + <span class="string">"("</span> + COLUMN_NAME_CODE + <span class="string">")"</span>;</div><div class="line">        <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String SQL_DELETE_CITY = <span class="string">"DROP TABLE IF EXISTS "</span> + TABLE_NAME_CITY;</div><div class="line"></div><div class="line">        <span class="comment">// *******************************china_provinces_code*******************************</span></div><div class="line">        <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String TABLE_NAME_PROVINCE = <span class="string">"china_provinces_code"</span>;</div><div class="line">        <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String COLUMN_NAME_ID = <span class="string">"id"</span>;</div><div class="line">        <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String COLUMN_NAME_NAME = <span class="string">"name"</span>;</div><div class="line">        <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String SQL_CREATE_PROVINCE = <span class="string">"CREATE TABLE IF NOT EXISTS "</span> + TABLE_NAME_PROVINCE + <span class="string">" ("</span> +</div><div class="line">                _ID + TYPE_INTEGER + <span class="string">" PRIMARY KEY AUTOINCREMENT, "</span> +</div><div class="line">                COLUMN_NAME_ID + TYPE_INTEGER + COMMA_SEP +</div><div class="line">                COLUMN_NAME_NAME + TYPE_TEXT</div><div class="line">                + <span class="string">" )"</span>;</div><div class="line">        <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String SQL_DELETE_PROVINCE = <span class="string">"DROP TABLE IF EXISTS "</span> + TABLE_NAME_PROVINCE;</div><div class="line"></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">createTable</span><span class="params">(SQLiteDatabase db)</span> </span>&#123;</div><div class="line">            db.execSQL(SQL_CREATE_PROVINCE);</div><div class="line">            db.execSQL(SQL_CREATE_CITY);</div><div class="line">            db.execSQL(SQL_CREATE_CITY_INDEX);</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">dropTable</span><span class="params">(SQLiteDatabase db)</span> </span>&#123;</div><div class="line">            db.execSQL(SQL_DELETE_PROVINCE);</div><div class="line">            db.execSQL(SQL_DELETE_CITY);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>æ„é€ å‡½æ•°ä¸­æˆ‘ä»¬éœ€è¦ä¼ å…¥å››ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°ä¸ºä¸Šä¸‹æ–‡ï¼Œç¬¬äºŒä¸ªä¸ºæ•°æ®åº“åç§°ï¼Œç¬¬ä¸‰ä¸ªå‚æ•°ä¸€èˆ¬ä¸ºnullï¼Œç¬¬å››ä¸ªä¸ºæ•°æ®åº“çš„ç‰ˆæœ¬ã€‚onCreate()æ–¹æ³•ä¸­ä¸»è¦æ‰§è¡Œæ•°æ®åº“çš„åˆ›å»ºæ“ä½œã€‚onUpgrade()æ–¹æ³•ä¸»è¦åœ¨æ•°æ®åº“å‡çº§æ—¶è°ƒç”¨ï¼Œæºç  <code>android.database.sqlite.SQLiteOpenHelper.getDatabaseLocked(boolean writable)</code> ä¸­è¿™æ ·æè¿°ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">private</span> SQLiteDatabase <span class="title">getDatabaseLocked</span><span class="params">(<span class="keyword">boolean</span> writable)</span> </span>&#123;</div><div class="line">   <span class="keyword">if</span> (mDatabase != <span class="keyword">null</span>) &#123;</div><div class="line">       <span class="keyword">if</span> (!mDatabase.isOpen()) &#123;</div><div class="line">           <span class="comment">// Darn!  The user closed the database by calling mDatabase.close().</span></div><div class="line">           mDatabase = <span class="keyword">null</span>;</div><div class="line">       &#125; <span class="keyword">else</span> <span class="keyword">if</span> (!writable || !mDatabase.isReadOnly()) &#123;</div><div class="line">           <span class="comment">// The database is already open for business.</span></div><div class="line">           <span class="keyword">return</span> mDatabase;</div><div class="line">       &#125;</div><div class="line">   &#125;</div><div class="line"></div><div class="line">   <span class="keyword">if</span> (mIsInitializing) &#123;</div><div class="line">       <span class="keyword">throw</span> <span class="keyword">new</span> IllegalStateException(<span class="string">"getDatabase called recursively"</span>);</div><div class="line">   &#125;</div><div class="line"></div><div class="line">   SQLiteDatabase db = mDatabase;</div><div class="line">   <span class="keyword">try</span> &#123;</div><div class="line">       mIsInitializing = <span class="keyword">true</span>;</div><div class="line"></div><div class="line">       <span class="keyword">if</span> (db != <span class="keyword">null</span>) &#123;</div><div class="line">           <span class="keyword">if</span> (writable &amp;&amp; db.isReadOnly()) &#123;</div><div class="line">               db.reopenReadWrite();</div><div class="line">           &#125;</div><div class="line">       &#125; <span class="keyword">else</span> <span class="keyword">if</span> (mName == <span class="keyword">null</span>) &#123;</div><div class="line">           db = SQLiteDatabase.create(<span class="keyword">null</span>);</div><div class="line">       &#125; <span class="keyword">else</span> &#123;</div><div class="line">           <span class="keyword">try</span> &#123;</div><div class="line">               <span class="keyword">if</span> (DEBUG_STRICT_READONLY &amp;&amp; !writable) &#123;</div><div class="line">                   <span class="keyword">final</span> String path = mContext.getDatabasePath(mName).getPath();</div><div class="line">                   db = SQLiteDatabase.openDatabase(path, mFactory,</div><div class="line">                           SQLiteDatabase.OPEN_READONLY, mErrorHandler);</div><div class="line">               &#125; <span class="keyword">else</span> &#123;</div><div class="line">                   db = mContext.openOrCreateDatabase(mName, mEnableWriteAheadLogging ?</div><div class="line">                           Context.MODE_ENABLE_WRITE_AHEAD_LOGGING : <span class="number">0</span>,</div><div class="line">                           mFactory, mErrorHandler);</div><div class="line">               &#125;</div><div class="line">           &#125; <span class="keyword">catch</span> (SQLiteException ex) &#123;</div><div class="line">               <span class="keyword">if</span> (writable) &#123;</div><div class="line">                   <span class="keyword">throw</span> ex;</div><div class="line">               &#125;</div><div class="line">               Log.e(TAG, <span class="string">"Couldn't open "</span> + mName</div><div class="line">                       + <span class="string">" for writing (will try read-only):"</span>, ex);</div><div class="line">               <span class="keyword">final</span> String path = mContext.getDatabasePath(mName).getPath();</div><div class="line">               db = SQLiteDatabase.openDatabase(path, mFactory,</div><div class="line">                       SQLiteDatabase.OPEN_READONLY, mErrorHandler);</div><div class="line">           &#125;</div><div class="line">       &#125;</div><div class="line"></div><div class="line">       onConfigure(db);</div><div class="line"></div><div class="line">       <span class="keyword">final</span> <span class="keyword">int</span> version = db.getVersion();</div><div class="line">       <span class="keyword">if</span> (version != mNewVersion) &#123;</div><div class="line">           <span class="keyword">if</span> (db.isReadOnly()) &#123;</div><div class="line">               <span class="keyword">throw</span> <span class="keyword">new</span> SQLiteException(<span class="string">"Can't upgrade read-only database from version "</span> +</div><div class="line">                       db.getVersion() + <span class="string">" to "</span> + mNewVersion + <span class="string">": "</span> + mName);</div><div class="line">           &#125;</div><div class="line"></div><div class="line">           db.beginTransaction();</div><div class="line">           <span class="keyword">try</span> &#123;</div><div class="line">               <span class="keyword">if</span> (version == <span class="number">0</span>) &#123;</div><div class="line">                   onCreate(db);</div><div class="line">               &#125; <span class="keyword">else</span> &#123;</div><div class="line">                   <span class="keyword">if</span> (version &gt; mNewVersion) &#123;</div><div class="line">                       onDowngrade(db, version, mNewVersion);</div><div class="line">                   &#125; <span class="keyword">else</span> &#123;</div><div class="line">                       onUpgrade(db, version, mNewVersion);</div><div class="line">                   &#125;</div><div class="line">               &#125;</div><div class="line">               db.setVersion(mNewVersion);</div><div class="line">               db.setTransactionSuccessful();</div><div class="line">           &#125; <span class="keyword">finally</span> &#123;</div><div class="line">               db.endTransaction();</div><div class="line">           &#125;</div><div class="line">       &#125;</div><div class="line"></div><div class="line">       onOpen(db);</div><div class="line"></div><div class="line">       <span class="keyword">if</span> (db.isReadOnly()) &#123;</div><div class="line">           Log.w(TAG, <span class="string">"Opened "</span> + mName + <span class="string">" in read-only mode"</span>);</div><div class="line">       &#125;</div><div class="line"></div><div class="line">       mDatabase = db;</div><div class="line">       <span class="keyword">return</span> db;</div><div class="line">   &#125; <span class="keyword">finally</span> &#123;</div><div class="line">       mIsInitializing = <span class="keyword">false</span>;</div><div class="line">       <span class="keyword">if</span> (db != <span class="keyword">null</span> &amp;&amp; db != mDatabase) &#123;</div><div class="line">           db.close();</div><div class="line">       &#125;</div><div class="line">   &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>å½“å½“å‰ç‰ˆæœ¬å°äºæ–°ç‰ˆæœ¬æ—¶ï¼Œä¼šè°ƒç”¨onUpgrade()æ–¹æ³•ã€‚æ‰€ä»¥ä¸Šé¢SQLiteOpenHelperçš„å®ç°æ€è·¯ä¸ºï¼šæ„é€ æ–¹æ³•ä¸­åˆå§‹åŒ–ä¸€ä¸‹æ•°æ®åº“çš„å¿…è¦å‚æ•°ï¼Œå¦‚æ•°æ®åº“ç‰ˆæœ¬ï¼Œæ•°æ®åº“åç­‰ï¼›åœ¨onCreate()æ–¹æ³•ä¸­åˆ›å»ºæ•°æ®åº“çš„è¡¨ï¼›å½“æˆ‘ä»¬éœ€è¦å¯¹æ•°æ®åº“è¿›è¡Œå‡çº§çš„æ—¶å€™ï¼Œä¿®æ”¹æ•°æ®åº“çš„ç‰ˆæœ¬å·ï¼Œè¿™æ ·å°±å¯ä»¥è§¦å‘onUpgrade()æ–¹æ³•ï¼Œè¿™é‡Œæˆ‘ä»¬åšæœ€ç®€å•çš„å¤„ç†ï¼šdropæ‰æ‰€æœ‰è¡¨ç„¶åé‡æ–°åˆ›å»ºã€‚å½“ç„¶æˆ‘ä»¬è¿˜å¯ä»¥åœ¨onOpen()æ–¹æ³•ä¸­åšä¸€ä¸‹æ•°æ®åº“çš„è®¾ç½®æ“ä½œï¼Œå¦‚è®¾ç½®å¤–é”®ç”Ÿæ•ˆã€‚è¿™æ ·æˆ‘ä»¬çš„æ•°æ®åº“ç®¡ç†ç±»å°±å®ç°äº†ã€‚</p>
<h2 id="0x02-æ‹¿åˆ°æ•°æ®åº“å¯¹è±¡"><a href="/1970/01/01/[Android-SQLite]0x01åˆ›å»ºè‡ªå·±çš„æ•°æ®åº“/#0x02-æ‹¿åˆ°æ•°æ®åº“å¯¹è±¡" class="headerlink" title="0x02 æ‹¿åˆ°æ•°æ®åº“å¯¹è±¡"></a>0x02 æ‹¿åˆ°æ•°æ®åº“å¯¹è±¡</h2><p>æœ‰äº†æ•°æ®åº“ç®¡ç†ç±»ï¼Œå¯¹æ•°æ®åº“è¿›è¡Œæ“ä½œæˆ‘ä»¬æœ€å¥½å°è£…ä¸€ä¸ªæ“ä½œç±»ï¼Œåœ¨è¿™ä¸ªç±»ä¸­å¯¹æ•°æ®åº“ä¸­çš„è¡¨è¿›è¡Œæ“ä½œã€‚ä¸‹é¢çš„ä»£ç ä¹Ÿæ˜¯ç½‘ä¸Šæ¯”è¾ƒå¸¸è§çš„ï¼ˆå¯¹äºæ•°æ®åº“å¯¹è±¡ï¼Œä¹Ÿæœ‰å¤„ç†æˆå•ä¾‹ï¼‰ã€‚å…ˆçœ‹ä»£ç ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DataBaseManager</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="keyword">private</span> DataBaseOpenHelper dbHelper;</div><div class="line">    <span class="keyword">private</span> SQLiteDatabase db;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">DataBaseManager</span><span class="params">(Context context)</span> <span class="keyword">throws</span> SQLException </span>&#123;</div><div class="line">        <span class="keyword">this</span>.dbHelper = <span class="keyword">new</span> DataBaseOpenHelper(context);</div><div class="line">        <span class="keyword">this</span>.db = dbHelper.getWritableDatabase();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">CopyOfDataBaseManager</span><span class="params">(Context context, <span class="keyword">int</span> version)</span> <span class="keyword">throws</span> SQLException </span>&#123;</div><div class="line">        <span class="keyword">this</span>.dbHelper = <span class="keyword">new</span> DataBaseOpenHelper(context, version);</div><div class="line">        <span class="keyword">this</span>.db = dbHelper.getWritableDatabase();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">closeDataBase</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (db != <span class="keyword">null</span> &amp;&amp; db.isOpen()) &#123;</div><div class="line">            db.close();</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isInitData</span><span class="params">(String tableName)</span> </span>&#123;</div><div class="line">        <span class="keyword">int</span> count = <span class="number">0</span>;</div><div class="line">        String sql = <span class="string">"select count(*) from "</span> + tableName;</div><div class="line">        Cursor cursor = db.rawQuery(sql, <span class="keyword">null</span>);</div><div class="line">        <span class="keyword">if</span> (cursor.moveToFirst()) &#123;</div><div class="line">            count = cursor.getInt(<span class="number">0</span>);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> count &gt; <span class="number">0</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">clearTable</span><span class="params">(String tableName)</span> </span>&#123;</div><div class="line">        String sql = <span class="string">"delete from "</span> + tableName + <span class="string">";"</span>;</div><div class="line">        sql += <span class="string">"update sqlite_sequence set seq = 0 where name = "</span> + tableName + <span class="string">";"</span>;</div><div class="line">        db.execSQL(sql);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">insertProvinceData</span><span class="params">(<span class="keyword">int</span> id, String name)</span> </span>&#123;</div><div class="line">        String sql = <span class="string">"insert into "</span> + CityData.TABLE_NAME_PROVINCE + <span class="string">" ("</span> + CityData.COLUMN_NAME_ID + <span class="string">","</span></div><div class="line">                + CityData.COLUMN_NAME_NAME + <span class="string">") VALUES("</span> + id + <span class="string">",'"</span> + name + <span class="string">"');"</span>;</div><div class="line">        db.execSQL(sql);</div><div class="line">        System.out.println(sql);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">// TODOå…¶ä»–ä¸€ä¸‹å¯¹è¡¨è¿›è¡Œçš„æ“ä½œ</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>é¦–å…ˆæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªDataBaseOpenHelperçš„å®ä¾‹ï¼Œç„¶åé€šè¿‡å®ƒæ‹¿åˆ°SQLiteDatabaseå¯¹è±¡ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥å¯¹æ•°æ®åº“è¿›è¡Œæ“ä½œäº†ã€‚DataBaseOpenHelperæœ‰ä¸¤ç§getæ–¹æ³•ï¼š<code>getWritableDatabase()</code> å’Œ <code>getReadableDatabase()</code>ï¼Œå¤§å®¶éƒ½åº”è¯¥çŸ¥é“ç€ä¸¤ç§æ–¹æ³•çš„å«ä¹‰ï¼Œ<code>getReadableDatabase()</code> æ‹¿åˆ°çš„æ•°æ®åº“å¯¹è±¡ä¸å¯ä»¥è¿›è¡Œæ’å…¥ä¿®æ”¹ç­‰å†™æ“ä½œã€‚åœ¨è¿™ä¸¤ç§æ–¹æ³•çš„è¯´æ˜åœ¨æˆ‘ä»¬å¯èƒ½éœ€è¦æ³¨æ„å‡ ç‚¹ï¼š</p>
<ul>
<li>å½“æˆ‘ä»¬æ²¡æœ‰ç”³è¯·æ•°æ®åº“æ“ä½œçš„æƒé™æˆ–è€…ç£ç›˜å·²æ»¡ï¼Œä¼šæŠ¥é”™</li>
<li>æ•°æ®åº“çš„æ›´æ–°å¯èƒ½éœ€è¦å¾ˆé•¿æ—¶é—´ï¼Œå› æ­¤æˆ‘ä»¬ä¸èƒ½åœ¨ä¸»çº¿ç¨‹ä¸­è°ƒç”¨</li>
<li>å½“æˆ‘ä»¬ä¸å†å¯¹æ•°æ®åº“è¿›è¡Œæ“ä½œæ—¶ï¼Œåˆ«å¿˜è®°å…³é—­æ•°æ®åº“</li>
</ul>
<p>æ¥ä¸‹æ¥å°±æ˜¯æ•°æ®åº“çš„å¸¸ç”¨æ“ä½œäº†</p>
<p><img src="https://raw.githubusercontent.com/ttdevs/ttdevs.github.io/common/images/logo.png" alt="Create by ttdevs"></p>
]]></content>
      
        <categories>
            
            <category> æŠ€æœ¯ </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Android </tag>
            
            <tag> SQLite </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[ã€ŒAndroidã€0x01æœ¬åœ°æ•°æ®å®‰å…¨å°è¯•SQLCipher]]></title>
      <url>/1970/01/01/%5BAndroid%5D0x01%E6%9C%AC%E5%9C%B0%E6%95%B0%E6%8D%AE%E5%AE%89%E5%85%A8%E5%B0%9D%E8%AF%95SQLCipher/</url>
      <content type="html"><![CDATA[<h2 id="0x00"><a href="/1970/01/01/[Android]0x01æœ¬åœ°æ•°æ®å®‰å…¨å°è¯•SQLCipher/#0x00" class="headerlink" title="0x00"></a>0x00</h2><p>å…ˆçºªå¿µä¸‹ï¼Œä»ä»Šå¤©å¼€å§‹ï¼Œåˆå¼€å§‹å†™åšå®¢å•¦å•¦å•¦å•¦ã€‚è¯è¯´åŸºæœ¬ä¸Šä¸€å¹´å¤šæ²¡å¥½å¥½å†™åšå®¢äº†ã€‚å›æƒ³èµ·æ¥ï¼Œå’Œä¹‹å‰å†™åšå®¢æ—¶ç›¸æ¯”ï¼Œè¿˜æ˜¯å·®è·å¥½å¤§ã€‚å¥½å§ï¼ŒåºŸè¯ä¸è¯´äº†ï¼Œè¿›å…¥æ­£é¢˜ã€‚</p>
<p>é¦–å…ˆï¼Œå¼€ç¯‡æ‰“ç®—è·Ÿå¤§å®¶åˆ†äº«ä¸‹ä½ é‡åˆ°çš„æˆ–è€…å°†æ¥å¯èƒ½é‡åˆ°çš„é—®é¢˜ï¼šæœ¬åœ°æ•°æ®çš„å®‰å…¨é—®é¢˜ã€‚å¤šæ•°æƒ…å†µï¼Œæˆ‘ä»¬å¯èƒ½æ²¡æœ‰å»è€ƒè™‘appçš„æœ¬åœ°æ•°æ®å®‰å…¨é—®é¢˜ï¼Œä¸€æ¥å…¬å¸æ²¡è¿™æ ·çš„è¦æ±‚ï¼ŒäºŒæ¥æˆ‘ä»¬å¯èƒ½ä¹Ÿæ²¡æœ‰éå¸¸éœ€è¦ä¿å¯†çš„æ•°æ®ã€‚é‚£ç°åœ¨æ€è€ƒä¸€ä¸‹ä¸ºå°†æ¥åšå‚¨å¤‡ã€‚</p>
<p>é¢è¯•çš„æ—¶å€™ï¼Œå¯èƒ½å¸¸å¸¸ä¼šè¢«é—®åˆ°è¿™æ ·ä¸€ä¸ªé—®é¢˜ï¼šAndroidçš„æ•°æ®å­˜å‚¨æœ‰å“ªå‡ ç§æ–¹å¼ï¼Ÿ å¯¹äºè¿™ä¸ªé—®é¢˜ï¼Œ<a href="http://developer.android.com/guide/topics/data/data-storage.html" target="_blank" rel="external">Androidçš„å®˜æ–¹æ–‡æ¡£</a> æœ‰å›ç­”ï¼š</p>
<ul>
<li>Shared Preferences</li>
<li>Internal Storage</li>
<li>External Storage</li>
<li>SQLite Databases</li>
<li>Network Connection</li>
</ul>
<p>è¿™å‡ ç§æ–¹å¼å°±ä¸ç”¨å¤šè¯´äº†ã€‚ç¬¬ä¸€ç§ä»¥key-valueçš„æ–¹å¼å­˜å‚¨åœ¨æˆ‘ä»¬çš„è®¾å¤‡å†…éƒ¨ï¼›ç¬¬äºŒç§ç¬¬ä¸‰ç§ç®€å•ç†è§£ä¸ºæ–‡ä»¶å­˜å‚¨ï¼›ç¬¬å››ç§æœ¬åœ°æ•°æ®åº“å­˜å‚¨ï¼ˆè¿™å››ç§éƒ½å±æœ¬åœ°å­˜å‚¨ï¼‰ã€‚æœ€åä¸€ç§æ–¹å¼ï¼ˆæš‚ä¸”ç®—æ˜¯ä¸€ç§æ–¹å¼å§ï¼‰ä¸åœ¨æˆ‘ä»¬è€ƒè™‘èŒƒå›´ä¹‹å†…ã€‚ç°åœ¨å‡è®¾ä¸€ä¸ªæœ€åçš„ç¯å¢ƒï¼šè®¾å¤‡å·²ç»rootï¼Œä»»ä½•æœ¬åœ°æ•°æ®éƒ½å¯ä»¥è¢«ç›´æ¥æˆ–è€…é—´æ¥æ‹¿åˆ°ã€‚è¿™æ—¶å€™æˆ‘ä»¬è‡ªç„¶æƒ³åˆ°çš„å°±æ˜¯å¯¹æˆ‘ä»¬çš„æ•°æ®è¿›è¡ŒåŠ å¯†ã€‚</p>
<h2 id="0x01"><a href="/1970/01/01/[Android]0x01æœ¬åœ°æ•°æ®å®‰å…¨å°è¯•SQLCipher/#0x01" class="headerlink" title="0x01"></a>0x01</h2><p>ä»¥ä¸Šæ˜¯å¼€åœºï¼Œä¸‹é¢è¿›å…¥ç¬¬ä¸€éƒ¨åˆ†ï¼šæœ¬åœ°æ•°æ®åº“åŠ å¯†ã€‚<br>å…ˆå›é¡¾ä¸‹æœ¬åœ°æ•°æ®åº“ï¼Œrootä»¥åï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ä¸‹é¢çš„ä½ç½®æ‰¾åˆ°å®ƒï¼š<code>/data/data/you.package/databases</code>ï¼Œä¾‹å¦‚æˆ‘ä»¬demoçš„æ•°æ®åº“ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">root@t03g:/data/data/com.ttdevs.demo/databases # ls</div><div class="line">normal_user.db</div><div class="line">normal_user.db-journal</div><div class="line">user.db</div><div class="line">root@t03g:/data/data/com.ttdevs.demo/databases #</div><div class="line">``` </div><div class="line"></div><div class="line">çŸ¥é“äº†å®ƒçš„ä½ç½®ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å°±å¯ä»¥ç›´æ¥å°†è¿™äº›æ•°æ®åº“æ–‡ä»¶æ‹·è´å‡ºæ¥ï¼Œç„¶åä½¿ç”¨SQLiteæµè§ˆå™¨æµè§ˆã€‚</div><div class="line">æˆ‘ä»¬é€‰ç”¨ç½‘ä¸Šä¸€ä¸ªå¼€æºçš„æ–¹æ¡ˆï¼š[SQLCipher][2]ï¼ˆ[GitHubåœ°å€][3]ï¼‰ã€‚SQLCipheræ˜¯åœ¨SQLiteçš„åŸºç¡€ä¸Šå°è£…äº†åŠ å¯†åŠŸèƒ½ï¼Œä½¿ç”¨ä¸Šå’Œç›´æ¥ä½¿ç”¨SQLiteåŸºæœ¬ç›¸åŒã€‚</div><div class="line"></div><div class="line"></div><div class="line">## 0x02</div><div class="line"></div><div class="line">é¦–å…ˆï¼ŒæŒ‰ç…§è¯´æ˜ï¼Œæˆ‘ä»¬å¼•å…¥SQLCipherï¼š</div><div class="line"></div><div class="line">``` gradle</div><div class="line">compile &apos;net.zetetic:android-database-sqlcipher:3.3.1-2@aar&apos;</div></pre></td></tr></table></figure>
<p>æ¥ä¸‹æ¥å°±æ˜¯ç¼–å†™æˆ‘ä»¬çš„æ•°æ®åº“ä»£ç äº†ã€‚å…ˆåˆ›å»ºä¸€ä¸ªDatabaseHelperï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> net.sqlcipher.database.SQLiteDatabase;</div><div class="line"><span class="keyword">import</span> net.sqlcipher.database.SQLiteOpenHelper;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DatabaseOpenHelper</span> <span class="keyword">extends</span> <span class="title">SQLiteOpenHelper</span> </span>&#123;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String DATABASE_NAME = <span class="string">"user.db"</span>;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> DATABASE_VERSION = <span class="number">1</span>;</div><div class="line"></div><div class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String TABLE = <span class="string">"user_info"</span>;</div><div class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String NAME = <span class="string">"name"</span>;</div><div class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String AGE = <span class="string">"age"</span>;</div><div class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String ICON = <span class="string">"icon"</span>;</div><div class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String TOKEN = <span class="string">"token"</span>;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">DatabaseOpenHelper</span><span class="params">(Context context)</span> </span>&#123;</div><div class="line">        <span class="keyword">super</span>(context, DATABASE_NAME, <span class="keyword">null</span>, DATABASE_VERSION);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(SQLiteDatabase db)</span> </span>&#123;</div><div class="line">        String sql = <span class="string">"create table "</span> + TABLE +</div><div class="line">                <span class="string">" (_id integer primary key autoincrement, "</span> +</div><div class="line">                NAME + <span class="string">" text, "</span> +</div><div class="line">                AGE + <span class="string">" integer, "</span> +</div><div class="line">                ICON + <span class="string">" blob, "</span> +</div><div class="line">                TOKEN + <span class="string">" text not null);"</span>;</div><div class="line">        Log.d(<span class="string">"EventsData"</span>, <span class="string">"onCreate: "</span> + sql);</div><div class="line">        db.execSQL(sql);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onUpgrade</span><span class="params">(SQLiteDatabase db, <span class="keyword">int</span> oldVersion, <span class="keyword">int</span> newVersion)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (oldVersion &lt; newVersion) &#123;</div><div class="line">            <span class="comment">// TODO</span></div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><code>æ³¨æ„ï¼Œæ­¤å¤„çš„SQLiteOpenHelperå’ŒSQLiteDatabaseéƒ½æ¥è‡ªnet.sqlcipher.databaseåŒ…ã€‚</code></p>
<p>ä¸ºäº†ä¾¿äºå¯¹æ¯”ï¼Œæˆ‘åˆå†™äº†ä¸€ä¸ªç›¸åŒé€»è¾‘ä½¿ç”¨<code>android.database.sqlite.SQLiteOpenHelper</code>çš„Helperä½œå¯¹æ¯”ã€‚æ¥ä¸‹æ¥ä½¿ç”¨ç¼–å†™æ•°æ®åº“æ“ä½œé€»è¾‘ã€‚ä½¿ç”¨ä¸­SQLiteCipheråŒºåˆ«æ˜¯æ‰“å¼€æ•°æ®åº“çš„æ—¶å€™éœ€è¦ä¼ å…¥ç”¨äºåŠ å¯†çš„KEYã€‚ä¸‹é¢æ˜¯æµ‹è¯•ä»£ç ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SqlcipherActivity</span> <span class="keyword">extends</span> <span class="title">AppCompatActivity</span> <span class="keyword">implements</span> <span class="title">View</span>.<span class="title">OnClickListener</span> </span>&#123;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String TAG = <span class="string">"&gt;&gt;&gt;&gt;&gt;"</span>;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String CIPHER_KEY = <span class="string">"123abc_!@#$%^&amp;*"</span>;</div><div class="line">    <span class="keyword">private</span> DatabaseOpenHelper mOpenHelper;</div><div class="line">    <span class="keyword">private</span> NormalDatabaseOpenHelper mNormalHelper;</div><div class="line">...</div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">writeData</span><span class="params">(<span class="keyword">boolean</span> isCipher)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (isCipher) &#123;</div><div class="line">            log(<span class="string">"Cipher:101:"</span> + System.currentTimeMillis());</div><div class="line">            SQLiteDatabase db = mOpenHelper.getWritableDatabase(PASSWORD_KEY);</div><div class="line">            log(<span class="string">"Cipher:102:"</span> + System.currentTimeMillis());</div><div class="line">            String name = <span class="string">"Cipher"</span> + (++mIndex);</div><div class="line">            ContentValues values = <span class="keyword">new</span> ContentValues();</div><div class="line">            values.put(DatabaseOpenHelper.NAME, name);</div><div class="line">            values.put(DatabaseOpenHelper.AGE, mIndex);</div><div class="line">            values.put(DatabaseOpenHelper.TOKEN, PASSWORD_KEY);</div><div class="line">            values.put(DatabaseOpenHelper.ICON, name.getBytes());</div><div class="line">            log(<span class="string">"Cipher:11:"</span> + System.currentTimeMillis());</div><div class="line">            <span class="keyword">try</span> &#123;</div><div class="line">                db.beginTransaction();</div><div class="line">                db.insert(DatabaseOpenHelper.TABLE, <span class="keyword">null</span>, values);</div><div class="line">                db.setTransactionSuccessful();</div><div class="line">            &#125; <span class="keyword">catch</span> (Exception e) &#123;</div><div class="line">                e.printStackTrace();</div><div class="line">            &#125; <span class="keyword">finally</span> &#123;</div><div class="line">                db.endTransaction();</div><div class="line">            &#125;</div><div class="line">            log(<span class="string">"Cipher:12:"</span> + System.currentTimeMillis());</div><div class="line">            db.close();</div><div class="line">        &#125; <span class="keyword">else</span> &#123;</div><div class="line">            ...</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">readData</span><span class="params">(<span class="keyword">boolean</span> isCipher)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (isCipher) &#123;</div><div class="line">            SQLiteDatabase db = mOpenHelper.getReadableDatabase(PASSWORD_KEY);</div><div class="line">            Cursor cursor = db.query(DatabaseOpenHelper.TABLE, <span class="keyword">null</span>, <span class="keyword">null</span>, <span class="keyword">null</span>, <span class="keyword">null</span>, <span class="keyword">null</span>, <span class="keyword">null</span>);</div><div class="line">            <span class="keyword">while</span> (cursor.moveToNext()) &#123;</div><div class="line">                String name = cursor.getString(cursor.getColumnIndex(DatabaseOpenHelper.NAME));</div><div class="line">                <span class="keyword">int</span> age = cursor.getInt(cursor.getColumnIndex(DatabaseOpenHelper.AGE));</div><div class="line">                String token = cursor.getString(cursor.getColumnIndex(DatabaseOpenHelper.TOKEN));</div><div class="line">                String result = String.format(<span class="string">"Cipher&gt;&gt;&gt;&gt; name:%s, age:%d, token:%s"</span>, name, age, token);</div><div class="line">                log(result);</div><div class="line">            &#125;</div><div class="line">            db.close();</div><div class="line">        &#125; <span class="keyword">else</span> &#123;</div><div class="line">            android.database.sqlite.SQLiteDatabase ndb = mNormalHelper.getReadableDatabase();</div><div class="line">            android.database.Cursor cursor = ndb.query(NormalDatabaseOpenHelper.TABLE, <span class="keyword">null</span>, <span class="keyword">null</span>, <span class="keyword">null</span>, <span class="keyword">null</span>, <span class="keyword">null</span>, <span class="keyword">null</span>);</div><div class="line">            <span class="keyword">while</span> (cursor.moveToNext()) &#123;</div><div class="line">                String name = cursor.getString(cursor.getColumnIndex(DatabaseOpenHelper.NAME));</div><div class="line">                <span class="keyword">int</span> age = cursor.getInt(cursor.getColumnIndex(DatabaseOpenHelper.AGE));</div><div class="line">                String token = cursor.getString(cursor.getColumnIndex(DatabaseOpenHelper.TOKEN));</div><div class="line">                String result = String.format(<span class="string">"Normal&gt;&gt;&gt;&gt; name:%s, age:%d, token:%s"</span>, name, age, token);</div><div class="line">                log(result);</div><div class="line">            &#125;</div><div class="line">            ndb.close();</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    ...</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>å¥½äº†ï¼Œè·‘ä¸€ä¸‹æˆ‘ä»¬çš„æµ‹è¯•ä»£ç ï¼Œå¾—åˆ°ä¸‹é¢çš„ç»“æœï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">02-19 13:49:41.596 24884-24884/com.ttdevs.demo E/&gt;&gt;&gt;&gt;&gt;: &gt;&gt;&gt;&gt;&gt; Cipher &gt;&gt;&gt;&gt;&gt;</div><div class="line">02-19 13:49:41.596 24884-24884/com.ttdevs.demo E/&gt;&gt;&gt;&gt;&gt;: Cipher:101:1455860981597</div><div class="line">02-19 13:49:41.971 24884-24884/com.ttdevs.demo E/&gt;&gt;&gt;&gt;&gt;: Cipher:102:1455860981974</div><div class="line">02-19 13:49:41.971 24884-24884/com.ttdevs.demo E/&gt;&gt;&gt;&gt;&gt;: Cipher:11:1455860981974</div><div class="line">02-19 13:49:41.981 24884-24884/com.ttdevs.demo E/&gt;&gt;&gt;&gt;&gt;: Cipher:12:1455860981983</div><div class="line">02-19 13:49:42.201 24884-24884/com.ttdevs.demo E/&gt;&gt;&gt;&gt;&gt;: Cipher&gt;&gt;&gt;&gt; name:Cipher1, age:1, token:123abc_!@#$%^&amp;*</div><div class="line">02-19 13:49:42.201 24884-24884/com.ttdevs.demo I/Choreographer: Skipped 35 frames!  The application may be doing too much work on its main thread.</div><div class="line">02-19 13:49:49.471 24884-24884/com.ttdevs.demo E/&gt;&gt;&gt;&gt;&gt;: &gt;&gt;&gt;&gt;&gt; Noremal &gt;&gt;&gt;&gt;&gt;</div><div class="line">02-19 13:49:49.476 24884-24884/com.ttdevs.demo E/&gt;&gt;&gt;&gt;&gt;: Normal:101:1455860989477</div><div class="line">02-19 13:49:49.521 24884-24884/com.ttdevs.demo E/&gt;&gt;&gt;&gt;&gt;: Normal:102:1455860989525</div><div class="line">02-19 13:49:49.521 24884-24884/com.ttdevs.demo E/&gt;&gt;&gt;&gt;&gt;: Normal:11:1455860989525</div><div class="line">02-19 13:49:49.531 24884-24884/com.ttdevs.demo E/&gt;&gt;&gt;&gt;&gt;: Normal:12:1455860989535</div><div class="line">02-19 13:49:49.541 24884-24884/com.ttdevs.demo E/&gt;&gt;&gt;&gt;&gt;: Normal&gt;&gt;&gt;&gt; name:Normal2, age:2, token:123abc_!@#$%^&amp;*</div></pre></td></tr></table></figure>
<p>é€šè¿‡ç®€å•çš„å¯¹æ¯”ï¼Œæˆ‘ä»¬å‘ç°ï¼ŒSQLCipheråœ¨æ‰“å¼€å†™æ•°æ®åº“çš„æ—¶å€™èŠ±è´¹äº†375msï¼Œæ—¶é—´å¤§æ¦‚æ˜¯SQLite 45msçš„8~9å€ï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨logä¸­çœ‹åˆ°ä¸¢å¸§çš„æç¤ºã€‚è¿™å°±æç¤ºæˆ‘ä»¬ï¼Œç®€å•çš„æ•°æ®åº“æ“ä½œï¼Œä½¿ç”¨SQLiteæˆ‘ä»¬ä¹Ÿå¯èƒ½éœ€è¦è€ƒè™‘å°†å…¶æ”¾åœ¨æ–°çš„çº¿ç¨‹ä¸­ã€‚å½“ç„¶ï¼Œè¿™ä¸ªæµ‹è¯•å¯¹æ¯”ä¸å¤Ÿå®Œå–„ï¼Œæ¯”å¦‚å¤§æ–‡ä»¶å†™å…¥ï¼Œå¤§é‡æ•°æ®æ’å…¥ï¼Œäº‹åŠ¡ç­‰ç­‰ï¼Œå› æ­¤è¿˜éœ€è¦æ›´å¤šã€æ›´è¯¦ç»†çš„æµ‹è¯•æ¥æ£€æµ‹SQLCipherçš„æ€§èƒ½ç­‰ï¼Œè¿™é‡Œå°±æš‚ä¸è®¨è®ºäº†ã€‚</p>
<p>è·‘å®Œä¸Šé¢çš„ä»£ç ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹æˆ‘ä»¬æœ¬åœ°æ•°æ®åº“ä¸­éƒ½åˆ›å»ºäº†å“ªäº›ä¸œè¥¿ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">root@t03g:/data/data/com.ttdevs.demo/databases # ls</div><div class="line">normal_user.db</div><div class="line">normal_user.db-journal</div><div class="line">user.db</div><div class="line">root@t03g:/data/data/com.ttdevs.demo/databases #</div></pre></td></tr></table></figure>
<p>æˆ‘ä»¬æŠŠè¿™ä¸¤ä¸ªdbæ–‡ä»¶æ‹·è´åˆ°æˆ‘ä»¬çš„ç”µè„‘ï¼Œçœ‹çœ‹é‡Œé¢æœ‰å“ªäº›ä¸œè¥¿ã€‚è¿™é‡Œæ¨èä¸€ä¸ªå·¥å…·ï¼š<a href="http://sqlitebrowser.org/" target="_blank" rel="external">sqlitebrowser</a>ã€‚æ‰“å¼€ä»–ä»¬çš„ç½‘ç«™ä½ ä¼šå‘ç°å®ƒæœ‰ä¸¤ä¸ªç‰ˆæœ¬çš„ï¼šStandardå’ŒSQLCipherçš„ã€‚æ˜¯çš„ï¼Œä½ æ²¡çœ‹é”™ï¼Œå°±æ˜¯é’ˆå¯¹SQLCipherçš„ã€‚å¦‚æœä½ ä½¿ç”¨Standardç‰ˆæœ¬ï¼Œä½ ä¼šå‘ç°æ— æ³•æ‰“å¼€æˆ‘ä»¬åŠ å¯†åçš„user.dbï¼ˆå½“ç„¶ä½ ä¹Ÿå¯æ˜¯è¯•è¯•å…¶ä»–æ–¹æ³•ï¼‰ã€‚ä½¿ç”¨SQLCipherç‰ˆçš„ï¼Œæ‰“å¼€ä¹‹å‰ä¼šè¦æ±‚è¾“å…¥æˆ‘ä»¬åŠ å¯†çš„KEYï¼Œå°±æ˜¯æˆ‘ä»¬ä¸Šé¢çš„<code>123abc_!@#$%^&amp;*</code>ã€‚è¿™æ—¶å€™æˆ‘ä»¬å°±å¯ä»¥çœ‹åˆ°åŸå§‹çš„æ•°æ®äº†ï¼Œå¦‚ä¸‹å›¾ï¼š</p>
<p><img src="http://img.blog.csdn.net/20160219151008300" alt="Browser SQLCipher Data"></p>
<h2 id="0x03"><a href="/1970/01/01/[Android]0x01æœ¬åœ°æ•°æ®å®‰å…¨å°è¯•SQLCipher/#0x03" class="headerlink" title="0x03"></a>0x03</h2><p>åˆ°è¿™é‡Œï¼Œæˆ‘ä»¬åŸºæœ¬ä¸Šå·²ç»è§åˆ°äº†SQLCipherçš„ä½¿ç”¨ã€‚è¿˜æ²¡æœ‰ç»“æŸï¼Œå†æ¥çœ‹ä¸€ä¸ªé—®é¢˜ï¼šåœ¨åˆ›å»ºé¡¹ç›®å¼€å§‹ï¼Œæˆ‘å°è¯•è·‘äº†ä¸‹é¡¹ç›®ï¼Œapkçš„å¤§å°æ˜¯1.4MBï¼Œåœ¨Gradleä¸­å¼•å…¥SQLCipherä¹‹åï¼Œä½“ç§¯ä¸€ä¸‹å­é£™åˆ°äº†8.7MBã€‚å‘µå‘µå‘µ~~ è¿™ä¸ªä½“ç§¯çš„å¢åŠ è¿˜æ˜¯å€¼å¾—æˆ‘ä»¬æ…é‡çš„æ€è€ƒä¸€ä¸‹ä¸‹çš„ã€‚</p>
<h2 id="0x04"><a href="/1970/01/01/[Android]0x01æœ¬åœ°æ•°æ®å®‰å…¨å°è¯•SQLCipher/#0x04" class="headerlink" title="0x04"></a>0x04</h2><p>è¯´äº†è¿™ä¹ˆå¤šï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°è¿™æ ·ä¸€ä¸ªç»“è®ºï¼Œä½¿ç”¨SQLiteCipherå¯ä»¥å¯¹æˆ‘ä»¬å®¢æˆ·ç«¯çš„æœ¬åœ°æ•°æ®åº“è¿›è¡ŒåŠ å¯†ï¼Œä½†æ˜¯æˆ‘ä»¬éœ€è¦è‡ªå·±å­˜ä¸€ä¸ªåŠ å¯†KEYï¼Œå¦‚æœæˆ‘ä»¬èƒ½ä¿å­˜å¥½è¿™ä¸ªKEYï¼Œé‚£æˆ‘ä»¬çš„æ•°æ®åŸºæœ¬æ˜¯å®‰å…¨çš„ã€‚ä½†æ˜¯åŒæ—¶ï¼Œæˆ‘ä»¬å¯èƒ½éœ€è¦è€ƒè™‘æ•°æ®åº“åŠ å¯†è¿‡ç¨‹ä¸­å¼•å…¥çš„æ–°çš„é—®é¢˜ï¼Œæ¯”å¦‚ï¼šapkä½“ç§¯çš„æš´å¢ï¼ŒåŠ å¯†å¯¹æ€§èƒ½çš„å½±å“ï¼ŒåŠ å¯†KEYçš„ä¿å­˜ç­‰ç­‰ã€‚è¿™äº›é—®é¢˜è€ƒè™‘å¥½ä¹‹åï¼Œæˆ‘ä»¬å°±å¯ä»¥å†³å®šæ˜¯å¦å¼•å…¥SQLCipherã€‚</p>
<p>å¦‚æœä½ å¯¹å¼•å…¥SQLiteCiperå¼•èµ·çš„æ–°é—®é¢˜å¿ƒå­˜èŠ¥è’‚ï¼Œé‚£æ¥ä¸‹æ¥ç»™å¤§å®¶æ¨èä¸‹ä¸€ç§æ–¹æ³•ã€‚æ•¬è¯·æœŸå¾…ï¼š<a href="http://blog.csdn.net/ttdevs/" target="_blank" rel="external">Androidæœ¬åœ°æ•°æ®å®‰å…¨å°è¯•(ä¸­)</a></p>
<p>PSï¼š<a href="https://github.com/ttdevs/Demo" target="_blank" rel="external">Github Demo</a></p>
<hr>
<p><img src="https://raw.githubusercontent.com/ttdevs/ttdevs.github.io/common/images/logo.png" alt="Create by ttdevs"></p>
]]></content>
      
        <categories>
            
            <category> æŠ€æœ¯ </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Android </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[ã€ŒAndroidã€0x02æœ¬åœ°æ•°æ®å®‰å…¨å°è¯•Conceal]]></title>
      <url>/1970/01/01/%5BAndroid%5D0x02%E6%9C%AC%E5%9C%B0%E6%95%B0%E6%8D%AE%E5%AE%89%E5%85%A8%E5%B0%9D%E8%AF%95Conceal/</url>
      <content type="html"><![CDATA[<h2 id="0x00"><a href="/1970/01/01/[Android]0x02æœ¬åœ°æ•°æ®å®‰å…¨å°è¯•Conceal/#0x00" class="headerlink" title="0x00"></a>0x00</h2><p>ä¸Šä¸€ç¯‡æˆ‘ä»¬æåˆ°ä½¿ç”¨SQLCipherå¯¹æœ¬åœ°çš„æ•°æ®è¿›è¡ŒåŠ å¯†ã€‚åœ¨ä¿è¯æ•°æ®å®‰å…¨çš„åŒæ—¶ï¼Œæˆ‘ä»¬åˆå¼•å…¥äº†ä¸€äº›æ–°çš„é—®é¢˜ï¼Œæ¯”å¦‚å®‰è£…åŒ…ä½“ç§¯çš„å¢åŠ ï¼Œæ•°æ®å­˜å‚¨è¿‡ç¨‹ä¸­è€—æ—¶å¢åŠ ï¼Œæ•°æ®åŠ å¯†çš„ç²’åº¦ä¸å¯æ§ç­‰ç­‰ã€‚å¦‚æœä½ æ¥å—ä¸äº†è¿™äº›é—®é¢˜ï¼Œé‚£æˆ‘ä»¬è¿˜éœ€å¯»æ‰¾å…¶ä»–çš„åŠ å¯†æ–¹æ³•ã€‚è¿™é‡Œç»™å¤§å®¶æ¨è<a href="https://github.com/facebook/conceal" target="_blank" rel="external">Conceal</a></p>
<h2 id="0x01"><a href="/1970/01/01/[Android]0x02æœ¬åœ°æ•°æ®å®‰å…¨å°è¯•Conceal/#0x01" class="headerlink" title="0x01"></a>0x01</h2><p><a href="https://github.com/facebook/conceal" target="_blank" rel="external">Conceal</a>æ˜¯Facebookçš„ä¸€ä¸ªå¼€æºé¡¹ç›®ï¼Œå®ƒå¯ä»¥é«˜æ•ˆçš„å¯¹å¤§æ–‡ä»¶è¿›è¡ŒåŠ å¯†ï¼ˆå½“ç„¶å¯¹å°æ•°æ®åŠ å¯†ä¹Ÿä¸æ˜¯é—®é¢˜ï¼‰ï¼ŒåŒæ—¶å¯¹è®¾å¤‡çš„æ€§èƒ½å’Œç³»ç»Ÿç‰ˆæœ¬è¦æ±‚æ¯”è¾ƒä½ã€‚æ›´å…·ä½“çš„ä¿¡æ¯å¯å‚è€ƒ<a href="https://facebook.github.io/conceal/" target="_blank" rel="external">è¿™é‡Œ</a>ã€‚</p>
<blockquote>
<p>Conceal doesnâ€™t implement any crypto, but instead, it uses specific cryptographics algorithms from OpenSSL. Conceal attempts to manage memory efficiently between the native and Java heap. Conceal also uses fast modes like AES-GCM and HMAC-SHA1 by default.<br>OpenSSL is a very large library, and would increase the size of apps. Conceal ships with only a select number of encryption algorithms from OpenSSL which make it much smaller (85KB). </p>
</blockquote>
<h2 id="0x02"><a href="/1970/01/01/[Android]0x02æœ¬åœ°æ•°æ®å®‰å…¨å°è¯•Conceal/#0x02" class="headerlink" title="0x02"></a>0x02</h2><h3 id="å¼•ç”¨"><a href="/1970/01/01/[Android]0x02æœ¬åœ°æ•°æ®å®‰å…¨å°è¯•Conceal/#å¼•ç”¨" class="headerlink" title="å¼•ç”¨"></a>å¼•ç”¨</h3><p><code>compile &#39;com.facebook.conceal:conceal:1.0.1@aar&#39;</code></p>
<h3 id="å…³é”®ä»£ç "><a href="/1970/01/01/[Android]0x02æœ¬åœ°æ•°æ®å®‰å…¨å°è¯•Conceal/#å…³é”®ä»£ç " class="headerlink" title="å…³é”®ä»£ç "></a>å…³é”®ä»£ç </h3><p>æˆ‘ä»¬å¯ä»¥ç”¨å…¶åŠ å¯†å¸¸è§çš„æ•°æ®ç±»å‹ï¼Œæ¯”å¦‚å­—ç¬¦ä¸²ï¼Œå›¾ç‰‡ç­‰ã€‚</p>
<ul>
<li>å­—ç¬¦ä¸²</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// åŠ å¯†</span></div><div class="line"><span class="keyword">byte</span>[] cipherText = mCrypto.encrypt(plainText, mEntity);</div><div class="line"><span class="comment">// è§£å¯†</span></div><div class="line"><span class="keyword">byte</span>[] plainText = mCrypto.decrypt(cipherText, mEntity);</div></pre></td></tr></table></figure>
<ul>
<li>å¤§æ–‡ä»¶</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">OutputStream out = mCrypto.getCipherOutputStream(fileOS, mEntity);</div><div class="line"><span class="keyword">int</span> read = <span class="number">0</span>;</div><div class="line"><span class="keyword">byte</span>[] buffer = <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">1024</span>];</div><div class="line"><span class="keyword">while</span> ((read = sourceFile.read(buffer)) != -<span class="number">1</span>) &#123;</div><div class="line">    out.write(buffer, <span class="number">0</span>, read);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>åˆå§‹åŒ–</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String ENTITY = <span class="string">"ttdevs"</span>;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">(Context context)</span> </span>&#123;</div><div class="line">    <span class="keyword">if</span> (<span class="keyword">null</span> == mCrypto) &#123;</div><div class="line">        mCrypto = <span class="keyword">new</span> Crypto(<span class="keyword">new</span> SharedPrefsBackedKeyChain(context), <span class="keyword">new</span> SystemNativeCryptoLibrary());</div><div class="line">        mEntity = <span class="keyword">new</span> Entity(ENTITY);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä»¥ä¸Šä¸‰éƒ¨åˆ†æ˜¯æˆ‘ä»¬ä½¿ç”¨Concealçš„å…³é”®ä»£ç ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦æ„é€ ä¸€ä¸ªCryptoå¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡éœ€è¦ä¼ å…¥ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªæ˜¯KeyChainï¼Œç¬¬äºŒä¸ªæ˜¯NativeCryptoLibraryã€‚NativeCryptoLibraryæˆ‘ä»¬ä½¿ç”¨ç³»ç»Ÿé»˜è®¤çš„ã€‚KeyChainé¡¾åæ€ä¹‰ï¼Œå°±æ˜¯æˆ‘ä»¬çš„åŠ å¯†keyã€‚ä¾‹å­ä¸­æˆ‘ä»¬ä½¿ç”¨äº†SharedPrefsBackedKeyChainï¼Œé€šè¿‡æŸ¥çœ‹æºç ï¼Œæˆ‘ä»¬å‘ç°ï¼Œå®ƒæ˜¯å°†åŠ å¯†çš„keyä¿å­˜åˆ°SharedPreferencesä¸­çš„ä¸€ä¸ªKeyChainçš„å®ç°ã€‚</p>
<h3 id="æµ‹è¯•"><a href="/1970/01/01/[Android]0x02æœ¬åœ°æ•°æ®å®‰å…¨å°è¯•Conceal/#æµ‹è¯•" class="headerlink" title="æµ‹è¯•"></a>æµ‹è¯•</h3><p>æ¥ä¸‹æ¥æˆ‘ä»¬æ¥çœ‹çœ‹Concealçš„è¡¨ç°å¦‚ä½•ã€‚æˆ‘å†™äº†ä¸€ä¸ªç®€å•çš„æµ‹è¯•ä»£ç ï¼Œç”±äºæ¯”è¾ƒé•¿ï¼Œå°±ä¸è´´äº†ï¼Œå…·ä½“å¯ä»¥å‚è€ƒ<a href="https://github.com/ttdevs/Demo" target="_blank" rel="external">è¿™é‡Œ</a>ï¼Œä¸»è¦æœ‰ä¸‰ä¸ªéƒ¨åˆ†ï¼š</p>
<ul>
<li>æµ‹è¯•å­—ç¬¦ä¸²åŠ è§£å¯†</li>
<li>æµ‹è¯•åŠ å¯†æ•°æ®çš„æ•°æ®åº“è¯»å†™</li>
<li>æµ‹è¯•æœ¬åœ°æ–‡ä»¶åŠ è§£å¯†</li>
</ul>
<p>ç•Œé¢å¦‚ä¸‹ï¼š</p>
<p><img src="https://raw.githubusercontent.com/ttdevs/Demo/master/app/image-conceal-string.png" alt="æµ‹è¯•ç•Œé¢"></p>
<ul>
<li>å­—ç¬¦ä¸²åŠ è§£å¯†</li>
</ul>
<p>å­—ç¬¦ä¸²çš„è¯»å†™å¦‚ä¸Šå›¾ï¼ŒåŠ è§£å¯†å­—ç¬¦ä¸²<code>Hello world!</code>è€—æ—¶éƒ½åœ¨3mså·¦å³ï¼Œè¿™ä¸ªæ—¶é—´åº”è¯¥æ˜¯æˆ‘ä»¬å¯ä»¥æ¥å—çš„ã€‚</p>
<p><code>PS:å¼ºåŠ¿æ’å…¥ä¸€ä¸ª2Bé—®é¢˜</code></p>
<blockquote>
<p>ç»†å¿ƒçš„ä½ å¯èƒ½ä¼šæƒ³å¦‚æœæˆ‘ä»¬ä¸ç”¨æ•°æ®åº“ï¼Œåªæ˜¯åŠ å¯†å‡ ä¸ªç®€å•çš„æ•°æ®ï¼Œèƒ½ä¸èƒ½å°†å¯†æ–‡ç›´æ¥å†™å…¥SharedPreferencesä¸­å‘¢ï¼Ÿå‘Šè¯‰ä½ æˆ‘ä¹Ÿæ˜¯è¿™ä¹ˆæƒ³çš„ï¼Œè€Œä¸”å»æµ‹è¯•äº†ï¼Œä½†æ˜¯æ­»æ´»ä¸æˆåŠŸï¼Œä¸æˆåŠŸï¼Œä¸æˆåŠŸâ€¦â€¦<br>æˆ‘çš„æ€è·¯æ˜¯è¿™æ ·çš„ï¼šç”±äºåŠ å¯†ã€åŠ å¯†ç»“æœã€è§£å¯† ä¸‰ä¸ªæ“ä½œå‚æ•°éƒ½æ˜¯byteï¼Œè€ŒSharedPreferencesæ¥å—çš„å‚æ•°æ˜¯Stringç±»å‹ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦è¿›è¡Œè½¬æ¢ï¼Œ<code>new String(bytes, &quot;utf-8&quot;)</code> å’Œ <code>string.getBytes(&quot;utf-8&quot;)</code> ï¼Œ å½“ä½ è¿™ä¹ˆåšçš„æ—¶å€™ï¼Œä½ ä¼šå‘ç°è§£å¯†æ­»æ´»ä¸æˆåŠŸã€‚ç»å†è¿‡æ— æ•°ä¸ªä¸çœ ä¹‹å¤œåï¼Œç»ˆäºæç„¶å¤§æ‚Ÿï¼ŒåŸæ¥è¿™ä¹ˆè½¬æ¢æ˜¯é”™è¯¯çš„ï¼åŸå› å¾ˆç®€å•ï¼Œä¸€ä¸ªutf-8ç¼–ç æ±‰å­—æ˜¯2bytesï¼Œå¦‚æœæˆ‘ä»¬çš„åŠ å¯†ç»“æœä¸è¶³2byteï¼Œæˆ‘ä»¬å¼ºè½¬æ—¶ä¸è¶³éƒ¨åˆ†å°±ä¼šè¢«è¡¥é½ï¼Œå½“å†è½¬æ¢å›æ¥çš„æ—¶å€™å°±å’ŒåŸæ¥çš„ä¸ä¸€ä¸€æ ·äº†ã€‚æœ€åæ€ä¹ˆè§£å†³å‘¢ï¼Ÿä¹Ÿå¾ˆç®€å•ï¼Œç”¨Base64å¯¹byteæ•°ç»„è¿›è¡Œç¼–ç ï¼Œå…·ä½“æ€ä¹ˆåšå¯ä»¥å‚è€ƒConcealæºç ä¸­çš„SharedPrefsBackedKeyChainã€‚</p>
</blockquote>
<ul>
<li>æ•°æ®åº“è¯»å†™</li>
</ul>
<p>è¿™ä¸ªæ—¶é—´å°±ä¸åšè¿‡å¤šè§£è¯»ï¼Œæ•°æ®åº“æ“ä½œæ—¶é—´åŠ åŠ è§£å¯†æ—¶é—´ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">1456500607857: Begin transaction </div><div class="line">1456500607861: Insert: Hello world! </div><div class="line">1456500607865: Read: name:Hello world! token:Hello world! </div><div class="line">1456500607868: Read: name:Hello world! token:Hello world! </div><div class="line">1456500607871: Read: name:Hello world! token:Hello world! </div><div class="line">1456500607885: End transaction</div></pre></td></tr></table></figure>
<ul>
<li>æ–‡ä»¶åŠ è§£å¯†</li>
</ul>
<p>è¿™ä¸ªæ¯”è¾ƒé‡è¦ï¼Œå¦‚æœæˆ‘ä»¬æœ‰å¤§æ–‡ä»¶åŠ å¯†çš„éœ€æ±‚ï¼ˆæ¯”å¦‚å‰æ®µæ—¶é—´å¾®ä¿¡çš„çº¢åŒ…å›¾ç‰‡ï¼‰ï¼Œå¯¹æ€§èƒ½å’Œæ•ˆç‡è¦æ±‚å°±æ¯”è¾ƒé«˜äº†ã€‚</p>
<p>æŸä¸€æ¬¡åŠ å¯†æ•°æ®ï¼š</p>
<p><img src="https://raw.githubusercontent.com/ttdevs/Demo/master/app/image-conceal-file.png" alt="æµ‹è¯•ç•Œé¢"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">Encrpyt 1.png 1014KB 163ms</div><div class="line">Encrpyt 2.jpg 2078KB 336ms</div><div class="line">Encrpyt 3.jpg 3043KB 477ms</div><div class="line">Encrpyt 4.JPG 3811KB 560ms</div><div class="line">Encrpyt 5.JPG 4772KB 699ms</div><div class="line">Encrpyt 10.apk 10268KB 1281ms</div><div class="line">Encrpyt 10.gif 10421KB 671ms</div><div class="line">Encrpyt 21.apk 20962KB 1323ms</div></pre></td></tr></table></figure>
<p>æŸä¸€æ¬¡è§£å¯†æ•°æ®ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">Decrpyt encrypt_1.png 1014KB 108ms</div><div class="line">Decrpyt encrypt_2.jpg 2078KB 177ms</div><div class="line">Decrpyt encrypt_3.jpg 3043KB 221ms</div><div class="line">Decrpyt encrypt_4.JPG 3811KB 270ms</div><div class="line">Decrpyt encrypt_5.JPG 4772KB 340ms</div><div class="line">Decrpyt encrypt_10.apk 10268KB 732ms</div><div class="line">Decrpyt encrypt_10.gif 10421KB 764ms</div><div class="line">Decrpyt encrypt_21.apk 20962KB 1468ms</div></pre></td></tr></table></figure>
<p>ä»ä¸Šé¢çš„æ•°æ®æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼ŒåŠ å¯†å¤šå¼ å¤§å›¾å¹¶æ²¡æœ‰å¯¼è‡´å†…å­˜çš„å¢åŠ ï¼Œåªæ˜¯CPUä½¿ç”¨ç‡æœ‰æ‰€å˜åŒ–ã€‚åŠ å¯†1MBå›¾ç‰‡è€—æ—¶160msï¼ŒåŠ å¯†20MBæ–‡ä»¶è€—æ—¶1300mså¤šã€‚è§£å¯†æ•°æ®çš„æ€§èƒ½æ¶ˆè€—ç±»ä¼¼ã€‚</p>
<h2 id="0x03"><a href="/1970/01/01/[Android]0x02æœ¬åœ°æ•°æ®å®‰å…¨å°è¯•Conceal/#0x03" class="headerlink" title="0x03"></a>0x03</h2><h3 id="åˆ†æ"><a href="/1970/01/01/[Android]0x02æœ¬åœ°æ•°æ®å®‰å…¨å°è¯•Conceal/#åˆ†æ" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h3><p>äº†è§£äº†Concealçš„åŸºæœ¬æƒ…å†µï¼Œæˆ‘ä»¬æ¥å¯¹æ¯”ä¸‹ä¸Šé¢æåˆ°çš„ä½¿ç”¨SQLCipheré‡åˆ°çš„é—®é¢˜ã€‚é¦–å…ˆï¼ŒConcealåªæœ‰85KBï¼Œè¿™ä¸ªå¤§å°æ˜¯æˆ‘ä»¬å®Œå…¨å¯ä»¥æ¥å—çš„ï¼Œç„¶åå°±æ˜¯åŠ å¯†ç²’åº¦ï¼Œæ— è®ºæ˜¯æ•°æ®åº“è¿˜æ˜¯æ–‡ä»¶ï¼Œæˆ‘ä»¬éƒ½å¯ä»¥åªçœŸå¯¹éœ€è¦çš„é‚£éƒ¨åˆ†åŠ å¯†ï¼Œæœ€åå³ä½¿ä½ é€‰æ‹©å°†æ–‡ä»¶å­˜å…¥æ•°æ®åº“ï¼Œå®ƒçš„æ—¶é—´ä¹Ÿåªæœ‰æ­£å¸¸æ•°æ®åº“æ“ä½œæ—¶é—´åŠ Concealçš„åŠ è§£å¯†æ—¶é—´ã€‚ç»¼ä¸Šæ‰€è¿°ï¼ŒConcealåº”è¯¥æ˜¯ä¸€ä¸ªä¸é”™çš„é€‰æ‹©ã€‚</p>
<h3 id="æ€»ç»“"><a href="/1970/01/01/[Android]0x02æœ¬åœ°æ•°æ®å®‰å…¨å°è¯•Conceal/#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><p>æˆ‘ä»¬å†æ¥æƒ³æƒ³è¿™ä¸¤ç¯‡æ–‡ç« ä¸­æåˆ°çš„åŠ å¯†æ–¹æ³•ï¼šæ— è®ºä½ é€‰æ‹©å“ªä¸€ç§ï¼Œç”±äºä»–ä»¬éƒ½é‡‡ç”¨äº†å¯¹ç§°åŠ å¯†ç®—æ³•ï¼Œè™½ç„¶æ•°æ®éƒ¨åˆ†åŠ å¯†äº†ï¼Œä½†æ˜¯æˆ‘ä»¬å´éœ€è¦ç»´æŠ¤ä¸€ä¸ªç§˜é’¥ï¼Œè¿™ä¸ªç§˜é’¥æ”¾åœ¨é‚£é‡Œï¼ŸSharedPreferencesï¼Ÿæ•°æ®åº“ï¼Ÿæœ¬åœ°æ–‡ä»¶ï¼Ÿè²Œä¼¼è¿›å…¥äº†ä¸€ä¸ªæ­»å¾ªç¯ï¼Œé—®é¢˜åˆå›åˆ°äº†èµ·ç‚¹ã€‚åˆ†æäº†è¿™ä¹ˆå¤šï¼Œå¦‚æœæ²¡æœ‰åŠæ³•è§£å†³ç§˜é’¥çš„é—®é¢˜ï¼Œä¹Ÿéƒ½æ˜¯ç™½æ­ã€‚æ€ä¹ˆåŠï¼Ÿä¸‹ä¸€ç¯‡åœ¨è¿›ä¸€æ­¥åˆ†æã€‚æ•¬è¯·æœŸå¾…ã€‚</p>
<p><code>PS: æ‰€æœ‰æµ‹è¯•æœºå™¨ é­…æ— MX4PRO æ€§èƒ½å‡è¡¡æ¨¡å¼</code></p>
<hr>
<p><img src="https://raw.githubusercontent.com/ttdevs/ttdevs.github.io/common/images/logo.png" alt="Create by ttdevs"></p>
]]></content>
      
        <categories>
            
            <category> æŠ€æœ¯ </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Android </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[ã€ŒAndroidã€0x03æœ¬åœ°æ•°æ®å®‰å…¨å°è¯•JNI]]></title>
      <url>/1970/01/01/%5BAndroid%5D0x03%E6%9C%AC%E5%9C%B0%E6%95%B0%E6%8D%AE%E5%AE%89%E5%85%A8%E5%B0%9D%E8%AF%95JNI/</url>
      <content type="html"><![CDATA[<p>å‰ä¸¤ç¯‡ï¼Œæˆ‘ä»¬è°ˆåˆ°äº†ä½¿ç”¨SQLCipherå’ŒConcealå¯¹æœ¬åœ°æ•°æ®è¿›è¡ŒåŠ å¯†ã€‚ç”±äºéƒ½ä¸¤ç§æ–¹æ³•éƒ½é‡‡ç”¨äº†å¯¹ç§°åŠ å¯†ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦è‡ªå·±ç®¡ç†åŠ å¯†çš„ç§˜é’¥ã€‚è¿™æ—¶ä½ ä¼šå‘ç°ï¼Œè™½ç„¶å¯¹æˆ‘ä»¬çš„æ•°æ®è¿›è¡Œäº†åŠ å¯†ï¼Œä½†æ˜¯æˆ‘ä»¬å´å¼•å…¥äº†æ–°çš„é—®é¢˜ã€‚æˆ‘ä»¬çš„åŠ å¯†æ–¹æ³•å¾ˆå®¹æ˜“é€šè¿‡åç¼–è¯‘apkè·å–åˆ°ï¼Œé‚£ä¹ˆï¼Œæˆ‘ä»¬å°±éœ€è¦å®‰å…¨çš„ç»´æŠ¤è¿™ä¸ªç§˜é’¥äº†ã€‚ä½†é—æ†¾çš„æ˜¯ï¼Œæœ¬åœ°æ•°æ®å­˜å‚¨æ–¹å¼æˆ‘ä»¬éƒ½å·²ç»è®²è¿°ï¼Œå¹¶æ²¡æœ‰ä¸€ç§ä¸€åŠ³æ°¸é€¸çš„å®‰å…¨ä¿å­˜æ–¹æ³•ï¼Œé‚£ä¹ˆï¼Œæˆ‘ä»¬çš„ç§˜é’¥å­˜åœ¨å“ªé‡Œåˆé€‚å‘¢ï¼Ÿè¿™ä¸ªæ—¶å€™ä½ å¯èƒ½ä¼šæƒ³åˆ°æœ¬åœ°ä¸è¡Œé‚£æˆ‘ä»¬å­˜åˆ°æœåŠ¡å™¨ä¸Šå§ï¼Œé€šè¿‡httpsè¿›è¡Œä¼ è¾“ã€‚è¿™æ ·å½“ç„¶å¯ä»¥ï¼Œé€šè¿‡ä¸€å®šçš„ç®—æ³•ä¸ºæ¯ä¸ªäººé…ç½®ä¸€ä¸ªç§˜é’¥ï¼Œéœ€è¦çš„æ—¶å€™è¯·æ±‚ç½‘ç»œè·å–ï¼Œç„¶åå¯¹æœ¬åœ°æ•°æ®è¿›è¡Œè§£å¯†ã€‚ä½†æ˜¯è¿™æ ·ä¹Ÿå­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼šæœ¬åœ°ä¿å­˜çš„æ•°æ®å¦‚æœä¸è”ç½‘å°±æ— æ³•æ‰“å¼€ã€‚é‚£ä¹ˆï¼Œè¿˜æœ‰æ›´å¥½çš„æ–¹æ¡ˆå—ï¼Ÿä»Šå¤©ç»™å¤§å®¶ä»‹ç»JNIã€‚</p>
<h2 id="0x01"><a href="/1970/01/01/[Android]0x03æœ¬åœ°æ•°æ®å®‰å…¨å°è¯•JNI/#0x01" class="headerlink" title="0x01"></a>0x01</h2><p>NDKï¼ŒJNIå¯¹äºåˆšæ¥è§¦androidå¼€å‘çš„æ”»åŸç‹®æ¥è¯´æ˜¯æœ‰è¾ƒå¤§çš„é—¨æ§›çš„ï¼Œä½†æ˜¯ä¸ºäº†å®ç°æˆ‘ä»¬æ›´å®‰å…¨çš„ä¿å­˜æ•°æ®ï¼Œä»–å¯èƒ½æ˜¯ä¸é”™çš„é€‰æ‹©ã€‚åç¼–è¯‘è¿‡åˆ«äººå®¶appçš„ä½ å¯èƒ½éƒ½é‡åˆ°è¿‡è¿™æ ·çš„æƒ…å†µï¼šä¸€ä¸ªä¸ªæ²¡æ— æ³•æŸ¥çœ‹ä»£ç é€»è¾‘çš„soæ–‡ä»¶ã€‚è¿™äº›æ–‡ä»¶æˆ‘ä»¬å¯ä»¥ä½¿ç”¨javaä»£ç è°ƒç”¨ï¼Œå®ç°ä¸€äº›æˆ‘ä»¬ä¸çŸ¥é“å†…éƒ¨é€»è¾‘ä½†æ˜¯ä¼šç»™æˆ‘ä»¬ä¸€ä¸ªç»“æœåŠŸèƒ½ã€‚é‚£ä¹ˆï¼Œæˆ‘ä»¬æŠŠå¯†ç æ”¾åˆ°è¿™äº›soä¸­å°±å¯ä»¥æ›´è¿›ä¸€æ­¥æé«˜æˆ‘ä»¬æœ¬åœ°æ•°æ®çš„å®‰å…¨çº§åˆ«ã€‚</p>
<p>ä¸‹é¢é€šè¿‡ä¸€ä¸ªåŠ å•çš„demoæ¥çœ‹çœ‹JNIçš„å®ç°ã€‚</p>
<p>é¦–å…ˆåˆ›å»ºä¸€ä¸ªå·¥å…·ç±»ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CipherUtil</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="keyword">static</span> &#123;</div><div class="line">        System.loadLibrary(<span class="string">"Cipher"</span>);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">native</span> String <span class="title">getCipherKey</span><span class="params">()</span></span>;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>åœ¨è¿™ä¸ªç±»æ–‡ä»¶ä¸Šç‚¹å‡»å³é”®ï¼Œä½¿ç”¨æˆ‘ä»¬ä¹‹å‰é…ç½®çš„javahå·¥å…·ç”Ÿæˆå¤´æ–‡ä»¶ã€‚ä¹‹åæˆ‘ä»¬ä¼šåœ¨å’Œjavaç›®å½•åŒçº§çš„jniæ–‡ä»¶ä¸‹çœ‹åˆ°ä¸€ä¸ª.hæ–‡ä»¶ï¼Œå¦‚ä¸‹ï¼š</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/* DO NOT EDIT THIS FILE - it is machine generated */</span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;jni.h&gt;</span></span></div><div class="line"><span class="comment">/* Header for class com_ttdevs_ndk_CipherUtil */</span></div><div class="line"></div><div class="line"><span class="meta">#<span class="meta-keyword">ifndef</span> _Included_com_ttdevs_ndk_CipherUtil</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> _Included_com_ttdevs_ndk_CipherUtil</span></div><div class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> __cplusplus</span></div><div class="line"><span class="keyword">extern</span> <span class="string">"C"</span> &#123;</div><div class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></div><div class="line"><span class="comment">/*</span></div><div class="line"> * Class:     com_ttdevs_ndk_CipherUtil</div><div class="line"> * Method:    getCipherKey</div><div class="line"> * Signature: ()Ljava/lang/String;</div><div class="line"> */</div><div class="line"><span class="function">JNIEXPORT jstring JNICALL <span class="title">Java_com_ttdevs_ndk_CipherUtil_getCipherKey</span></span></div><div class="line">  <span class="params">(JNIEnv *, jclass)</span>;</div><div class="line"></div><div class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> __cplusplus</span></div><div class="line">&#125;</div><div class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></div></pre></td></tr></table></figure>
<p>ç„¶ååœ¨hæ–‡ä»¶çš„åŒçº§æ–°å»ºä¸€ä¸ªC++æ–‡ä»¶ï¼ˆå³é”®&gt;New&gt;C/C++ Source fileï¼‰,å†…å®¹å¦‚ä¸‹ï¼š</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"QiniuConfig.h"</span></span></div><div class="line"></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;android/log.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> LOG_TAG <span class="meta-string">"System.out"</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> LOGD(...) __android_log_print(ANDROID_LOG_DEBUG, LOG_TAG, __VA_ARGS__)</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> LOGI(...) __android_log_print(ANDROID_LOG_INFO, LOG_TAG, __VA_ARGS__)</span></div><div class="line"></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"com_ttdevs_ndk_CipherUtil.h"</span></span></div><div class="line"></div><div class="line"><span class="function">JNIEXPORT jstring JNICALL <span class="title">Java_com_ttdevs_ndk_CipherUtil_getCipherKey</span><span class="params">(JNIEnv *env, jclass)</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">return</span> (*env).NewStringUTF(<span class="string">"Hello World! getCipherKey"</span>);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>æˆ‘ä»¬è¿˜éœ€è¦åˆ›å»ºä¸¤ä¸ªæ–‡ä»¶ï¼Œä¸€ä¸ªå«Android.mkï¼Œå¦ä¸€ä¸ªå«Application.mkï¼Œä»–ä»¬éƒ½åœ¨jniç›®å½•ä¸‹ã€‚</p>
<ul>
<li>Android.mk:</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"># http://developer.android.com/intl/zh-tw/ndk/guides/android_mk.html</div><div class="line"></div><div class="line">LOCAL_PATH := $(call my-dir)</div><div class="line"></div><div class="line">include $(CLEAR_VARS)</div><div class="line"></div><div class="line">LOCAL_MODULE := Cipher</div><div class="line">LOCAL_SRC_FILES := Cipher.cpp</div><div class="line">LOCAL_LDLIBS += -llog</div><div class="line"></div><div class="line">include $(BUILD_SHARED_LIBRARY)</div></pre></td></tr></table></figure>
<ul>
<li>Application.mk</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"># http://developer.android.com/intl/zh-tw/ndk/guides/application_mk.html</div><div class="line"></div><div class="line"># APP_STL := stlport_static</div><div class="line">APP_STL := gnustl_static</div><div class="line">APP_CPPFLAGS := -frtti -std=c++11</div><div class="line">APP_CFLAGS += -Wno-error=format-security</div><div class="line"></div><div class="line">APP_ABI := all</div></pre></td></tr></table></figure>
<p>è¿˜æ²¡æœ‰å®Œï¼Œæˆ‘ä»¬è¿˜éœ€è¦ä¿®æ”¹å½“å‰Projectæˆ–è€…Moduleçš„gradle.buildæ–‡ä»¶:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">android &#123;</div><div class="line">    compileSdkVersion 23</div><div class="line">    buildToolsVersion &quot;23.0.2&quot;</div><div class="line"></div><div class="line">    defaultConfig &#123;</div><div class="line">        minSdkVersion 16</div><div class="line">        targetSdkVersion 23</div><div class="line">        versionCode 1</div><div class="line">        versionName &quot;1.0&quot;</div><div class="line"></div><div class="line">        ndk &#123;</div><div class="line">            moduleName &quot;ndkutil&quot;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    sourceSets.main &#123;</div><div class="line">        jni.srcDirs = []</div><div class="line">        jniLibs.srcDir &quot;libs&quot;</div><div class="line">    &#125;</div><div class="line">...</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>å®Œæˆè¿™äº›ï¼Œæˆ‘ä»¬å°±å¯ä»¥è¿›è¡Œç¼–è¯‘äº†ã€‚åœ¨å½“å‰Projectï¼ˆModuleï¼‰ä¸Šç‚¹å‡»å³é”®ï¼Œä½¿ç”¨ä¹‹å‰é…ç½®çš„ndk-buildå·¥å…·è¿›è¡Œç¼–è¯‘ï¼Œå¦‚æœæ²¡æœ‰é—®é¢˜ï¼Œæˆ‘ä»¬ä¼šåœ¨libsç›®å½•ä¸‹çœ‹åˆ°ç”Ÿäº§çš„soæ–‡ä»¶ã€‚å¥½äº†ï¼Œæœ€åæˆ‘ä»¬å¯ä»¥ç¼–å†™æµ‹è¯•ä»£ç äº†ï¼šåœ¨javaç›´æ¥è°ƒç”¨åˆšæ‰åˆ›å»ºçš„CipherUtilå³å¯ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Log.d(<span class="string">"&gt;&gt;&gt;&gt;&gt;"</span>, CipherUtil.getCipherKey());</div></pre></td></tr></table></figure>
<p>è¿è¡Œä¸Šé¢ä»£ç ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨logä¸­çœ‹åˆ°è¾“å‡ºçš„å­—ç¬¦ä¸²ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Hello World! getCipherKey</div></pre></td></tr></table></figure>
<h2 id="0x02"><a href="/1970/01/01/[Android]0x03æœ¬åœ°æ•°æ®å®‰å…¨å°è¯•JNI/#0x02" class="headerlink" title="0x02"></a>0x02</h2><p>ä¸Šè¿°demoä¸­ï¼Œæˆ‘ä»¬åªæ˜¯ç®€å•çš„è¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè¦å®ç°æ›´å®‰å…¨ï¼Œæˆ‘ä»¬å¯ä»¥å°†æ­¤æ–¹æ³•å†™çš„æ›´å¤æ‚ï¼Œæ¯”å¦‚è·å–appçš„ç­¾åï¼Œè·å–è®¾å¤‡çš„ç¡¬ä»¶ä¿¡æ¯è¿›è¡Œå¤æ‚çš„ç»„åˆï¼Œä»¥ä¿éšœæœ€ç»ˆç”Ÿæˆçš„ç§˜é’¥çš„å”¯ä¸€æ€§å’Œå®‰å…¨æ€§ï¼ˆæ›´éš¾ä¼ªé€ ï¼‰ï¼Œè¿™é‡Œæœ‰ä¸€ä¸ª<a href="https://github.com/MasonLiuChn/AndroidUltimateEncrypt" target="_blank" rel="external">demo</a>å¯ä»¥å‚è€ƒã€‚</p>
<p>å†™åˆ°è¿™é‡Œï¼Œå¯èƒ½åˆæœ‰äººä¼šé—®åˆ°ï¼šå…¶å®soæ–‡ä»¶ä¹Ÿä¸æ˜¯å¾ˆå…¨ï¼Œå¯ä»¥é€šè¿‡å¯¹æ±‡ç¼–çš„åˆ†æå¾—åˆ°é‡Œé¢çš„ä»£ç é€»è¾‘ã€‚å½“ç„¶ï¼Œé«˜æ‰‹æ˜¯å¯ä»¥åšåˆ°å¯¹soæ–‡ä»¶è¿›è¡Œåˆ†æçš„ï¼Œä½†æ˜¯soè¿˜æ˜¯å¯ä»¥é˜»éš”å¤§éƒ¨åˆ†çš„åç¼–è¯‘äººå‘˜ã€‚å¦‚æœæˆ‘ä»¬èƒ½æŠŠgetCipherKeyå®ç°çš„æ›´å¥½ï¼Œä¹Ÿä¼šå¢åŠ ç ´è§£çš„æˆæœ¬ã€‚å¦å¤–ï¼Œsoè¿˜æœ‰ä¸€ä¸ªè¢«ç›—ç”¨çš„é—®é¢˜ï¼Œå°±æ˜¯åˆ«äººç›´æ¥è°ƒç”¨æˆ‘ä»¬çš„soï¼Œè¿™ä¸ªé—®é¢˜ä¹Ÿå¯ä»¥é€šè¿‡ä¸€å®šçš„ä»£ç é€»è¾‘æ¥é¿å…ã€‚ä¹‹åä¼šç»§ç»­è®²è§£ã€‚</p>
<p>æœ€åå†è¯´ä¸€ç‚¹ï¼Œå¯¹äºç§˜é’¥ï¼Œæˆ‘ä»¬æœ€ç»ˆè¿˜ä¼šè¢«è½½å…¥æˆ‘ä»¬çš„å†…å­˜ï¼Œå¦‚æœç›´æ¥dumpæˆ‘ä»¬çš„å†…å­˜ï¼Œä¼šæ˜¯ä¸€ä¸ªäººä»€ä¹ˆæ ·çš„ç»“æœå‘¢ï¼Ÿ</p>
<hr>
<p><img src="https://raw.githubusercontent.com/ttdevs/ttdevs.github.io/common/images/logo.png" alt="Create by ttdevs"></p>
]]></content>
      
        <categories>
            
            <category> æŠ€æœ¯ </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Android </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[ã€ŒAndroidã€Androidé—¹é’Ÿé‡åˆ°çš„é‚£äº›å‘]]></title>
      <url>/1970/01/01/%5BAndroid%5DAndroid%E9%97%B9%E9%92%9F%E9%81%87%E5%88%B0%E7%9A%84%E9%82%A3%E4%BA%9B%E5%9D%91/</url>
      <content type="html"><![CDATA[<h2 id="0x00-åšè¿‡é—¹é’Ÿçš„è¯ä½ æ‰ä¼šç†è§£çš„å‘"><a href="/1970/01/01/[Android]Androidé—¹é’Ÿé‡åˆ°çš„é‚£äº›å‘/#0x00-åšè¿‡é—¹é’Ÿçš„è¯ä½ æ‰ä¼šç†è§£çš„å‘" class="headerlink" title="0x00 åšè¿‡é—¹é’Ÿçš„è¯ä½ æ‰ä¼šç†è§£çš„å‘"></a>0x00 åšè¿‡é—¹é’Ÿçš„è¯ä½ æ‰ä¼šç†è§£çš„å‘</h2><p>ç¬¬ä¸€æ¬¡åšé—¹é’Ÿç¨‹åºæ˜¯åœ¨2012å¹´ï¼Œé‚£æ—¶å€™androidæœ€æ–°ç‰ˆæœ¬æ˜¯2.2ï¼Œ2.3å‘å¸ƒåœ¨å³ï¼Œåšäº†ä¸€ä¸ªæ•´ç‚¹æé†’çš„å°å·¥å…·ï¼Œè®°å¾—å¾ˆæ¸…æ¥šï¼Œä¸»è¦çš„é—®é¢˜æ˜¯é”å±ä¹‹åé—¹é’Ÿä¸èƒ½å‡†æ—¶è¢«å”¤é†’ï¼Œæ€»ä¼šæ™šé‚£ä¹ˆå‡ ç§’é’Ÿï¼Œåæ¥æ²¡åŠæ³•æŠŠé—¹é’Ÿæå‰è®¾ç½®å‡ ç§’é’Ÿã€‚ä¸è¿‡é‚£æ—¶å€™ç¯å¢ƒè¿˜å¥½ï¼Œæ²¡æœ‰é‡åˆ°æ”»å…‹ä¸äº†çš„é—®é¢˜ï¼Œé‡å¯ä¹Ÿå¯ä»¥å”¤èµ·é—¹é’Ÿçš„ã€‚</p>
<p>ä½†æ˜¯éšç€androidç‰ˆæœ¬çš„è¿›åŒ–ï¼Œå¼€å‘è€…èŠ‚æ“çš„ä¸¢å¤±ï¼Œé—®é¢˜å°±è¶Šæ¥è¶Šéš¾åšäº†ã€‚é—¹é’Ÿæ˜æ˜è®¾ç½®äº†å´ä¸èƒ½åˆ°æ¥ï¼›ä¸å†è®¾ç½®çš„æ—¶é—´åˆ°æ¥ï¼Œæ™šäº†å¥½ä¹…æ‰åˆ°ï¼›é‡å¯ä¹‹åé—¹é’Ÿå°±æ²¡äº†ç­‰ç­‰ã€‚å½“ç„¶ï¼Œè¿˜æœ‰å¥½å¤šå¥½å¤šï¼Œæ€»ä¹‹å¾ˆå¤šä¸œè¥¿ä¸æŒ‰ç…§è‡ªå·±æœŸå¾…çš„æ¥ã€‚</p>
<p>é¡¹ç›®ä¸Šçº¿ï¼Œè¸©è¿‡ä¹‹åæŒ‘ä¸€äº›åšæ€»ç»“ã€‚</p>
<p>ç”±äºæ—¶é—´å…³ç³»ï¼Œé¡¹ç›®æ¯”è¾ƒèµ¶ï¼Œæ‰€ä»¥æ²¡æœ‰å»è€ƒè™‘é—¹é’Ÿæ— æ³•åŠæ—¶è§¦å‘çš„é—®é¢˜ï¼Œå‡è®¾äº†ä¸€ä¸ªæœ€ç†æƒ³çš„ç¯å¢ƒã€‚ï¼ˆæ›´å¤šçš„ä¿¡æ¯å¯ä»¥å‚è€ƒä¸‹é¢çš„æ–‡ç« ï¼‰</p>
<h2 id="0x01-é—¹é’Ÿçš„åˆ›å»º"><a href="/1970/01/01/[Android]Androidé—¹é’Ÿé‡åˆ°çš„é‚£äº›å‘/#0x01-é—¹é’Ÿçš„åˆ›å»º" class="headerlink" title="0x01 é—¹é’Ÿçš„åˆ›å»º"></a>0x01 é—¹é’Ÿçš„åˆ›å»º</h2><p>è¿™é‡Œæ¶‰åŠåˆ°ä¸åŒç‰ˆæœ¬è®¾ç½®é—¹é’Ÿçš„æ–¹æ³•ï¼Œä¸‹é¢çš„å‚è€ƒæ–‡ç« ä¸­å·²ç»æåˆ°ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">startAlarm</span><span class="params">(Calendar calendar, PendingIntent pendingIntent)</span> </span>&#123;</div><div class="line">   <span class="keyword">if</span> (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.KITKAT) &#123;</div><div class="line">       <span class="comment">// mManager.setWindow(AlarmManager.RTC_WAKEUP, calendar.getTimeInMillis(), 1000* 5, mFirstPIntent);</span></div><div class="line">       mManager.setExact(AlarmManager.RTC_WAKEUP, calendar.getTimeInMillis(), pendingIntent);</div><div class="line">       <span class="comment">// mManager.set(AlarmManager.RTC_WAKEUP, calendar.getTimeInMillis(), mSecondPIntent);</span></div><div class="line">   &#125; <span class="keyword">else</span> &#123;</div><div class="line">       mManager.set(AlarmManager.RTC_WAKEUP, calendar.getTimeInMillis(), pendingIntent);</div><div class="line">   &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="0x02-é—¹é’Ÿçš„å–æ¶ˆ"><a href="/1970/01/01/[Android]Androidé—¹é’Ÿé‡åˆ°çš„é‚£äº›å‘/#0x02-é—¹é’Ÿçš„å–æ¶ˆ" class="headerlink" title="0x02 é—¹é’Ÿçš„å–æ¶ˆ"></a>0x02 é—¹é’Ÿçš„å–æ¶ˆ</h2><p>æœ‰çš„æ—¶å€™å¯èƒ½éœ€è¦å»å–æ¶ˆä¸€ä¸ªé—¹é’Ÿã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸¤ç§æ–¹å¼æ¥å–æ¶ˆï¼š</p>
<ul>
<li><p>é€šè¿‡ <code>PendingIntent.cancel();</code> æ¥å–æ¶ˆ</p>
  <figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"> * Cancel a currently active PendingIntent.  Only the original application</div><div class="line"> * owning a PendingIntent can cancel it.</div><div class="line"> */</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">cancel</span><span class="params">()</span> </span>&#123;</div><div class="line">    <span class="keyword">try</span> &#123;</div><div class="line">        ActivityManagerNative.getDefault().cancelIntentSender(mTarget);</div><div class="line">    &#125; <span class="keyword">catch</span> (RemoteException e) &#123;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ul>
<pre><code>è¿™ç§æ–¹å¼åªæœ‰èƒ½æ‹¿åˆ° `PendingIntent` æ‰å¯ä»¥ã€‚
</code></pre><ul>
<li><p>é€šè¿‡ <code>AlarmManager.cancel(PendingIntent);</code> æ¥å–æ¶ˆ</p>
  <figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"> * Remove any alarms with a matching &#123;<span class="doctag">@link</span> Intent&#125;.</div><div class="line"> * Any alarm, of any type, whose Intent matches this one (as defined by</div><div class="line"> * &#123;<span class="doctag">@link</span> Intent#filterEquals&#125;), will be canceled.</div><div class="line"> *</div><div class="line"> * <span class="doctag">@param</span> operation IntentSender which matches a previously added</div><div class="line"> * IntentSender.</div><div class="line"> *</div><div class="line"> * <span class="doctag">@see</span> #set</div><div class="line"> */</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">cancel</span><span class="params">(PendingIntent operation)</span> </span>&#123;</div><div class="line">    <span class="keyword">try</span> &#123;</div><div class="line">        mService.remove(operation);</div><div class="line">    &#125; <span class="keyword">catch</span> (RemoteException ex) &#123;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="0x03-é—¹é’Ÿçš„æŸ¥çœ‹"><a href="/1970/01/01/[Android]Androidé—¹é’Ÿé‡åˆ°çš„é‚£äº›å‘/#0x03-é—¹é’Ÿçš„æŸ¥çœ‹" class="headerlink" title="0x03 é—¹é’Ÿçš„æŸ¥çœ‹"></a>0x03 é—¹é’Ÿçš„æŸ¥çœ‹</h2><p>åˆä¸ªadbå‘½ä»¤å¯ä»¥ç”¨æ¥æŸ¥çœ‹å½“å‰ç³»ç»Ÿä¸­å­˜åœ¨çš„é—¹é’Ÿï¼š</p>
<p><code>adb shell dumpsys alarm</code></p>
<p><img src="http://img.blog.csdn.net/20170224183136089?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvdHRkZXZz/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="è¿™é‡Œå†™å›¾ç‰‡æè¿°"></p>
<p>ä¸æ˜¯åœ¨æ‰€æœ‰çš„è®¾å¤‡ä¸Šéƒ½å¥½ä½¿ï¼Œæ¯”å¦‚åœ¨æˆ‘çš„é­…æ—è®¾å¤‡ä¸Šå¯ä»¥æ­£å¸¸ä½¿ç”¨ï¼Œè€Œåœ¨å¦ä¸€å° OPPO R7Cä¸Šå°±ä¸å¯ä»¥ã€‚</p>
<h2 id="0xFF-å‚è€ƒ"><a href="/1970/01/01/[Android]Androidé—¹é’Ÿé‡åˆ°çš„é‚£äº›å‘/#0xFF-å‚è€ƒ" class="headerlink" title="0xFF å‚è€ƒ"></a>0xFF å‚è€ƒ</h2><ul>
<li><a href="http://www.jianshu.com/p/1f919c6eeff6" target="_blank" rel="external">http://www.jianshu.com/p/1f919c6eeff6</a></li>
</ul>
<p><img src="https://raw.githubusercontent.com/ttdevs/ttdevs.github.io/common/images/logo.png" alt="Create by ttdevs"></p>
]]></content>
      
        <categories>
            
            <category> æŠ€æœ¯ </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Android </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[ã€ŒAndroidã€Android Studio 1.x NDKç¯å¢ƒæ­å»º]]></title>
      <url>/1970/01/01/%5BAndroid%5DAndroid%20Studio%201.x%20NDK%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/</url>
      <content type="html"><![CDATA[<h2 id="ä¸‹è½½NDK"><a href="/1970/01/01/[Android]Android Studio 1.x NDKç¯å¢ƒæ­å»º/#ä¸‹è½½NDK" class="headerlink" title="ä¸‹è½½NDK"></a>ä¸‹è½½NDK</h2><h3 id="ä¸‹è½½"><a href="/1970/01/01/[Android]Android Studio 1.x NDKç¯å¢ƒæ­å»º/#ä¸‹è½½" class="headerlink" title="ä¸‹è½½"></a>ä¸‹è½½</h3><p><a href="http://developer.android.com/ndk/downloads/index.html" target="_blank" rel="external">NDK Download</a></p>
<p><a href="http://dl.google.com/android/ndk/android-ndk-r10e-linux-x86.bin" target="_blank" rel="external">mac: android-ndk-r10e-linux-x86.bin</a></p>
<h3 id="å®‰è£…"><a href="/1970/01/01/[Android]Android Studio 1.x NDKç¯å¢ƒæ­å»º/#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">âœ  ndk ls</div><div class="line">android-ndk-r10e-darwin-x86_64.bin</div><div class="line">âœ  ndk chmod a+x android-ndk-r10e-darwin-x86_64.bin</div><div class="line">âœ  ndk ./android-ndk-r10e-darwin-x86_64.bin</div></pre></td></tr></table></figure>
<h2 id="é…ç½®ç¯å¢ƒ"><a href="/1970/01/01/[Android]Android Studio 1.x NDKç¯å¢ƒæ­å»º/#é…ç½®ç¯å¢ƒ" class="headerlink" title="é…ç½®ç¯å¢ƒ"></a>é…ç½®ç¯å¢ƒ</h2><h3 id="gradle-properties"><a href="/1970/01/01/[Android]Android Studio 1.x NDKç¯å¢ƒæ­å»º/#gradle-properties" class="headerlink" title="gradle.properties"></a>gradle.properties</h3><p>åœ¨æœ«å°¾æ·»åŠ ä¸€è¡Œï¼š <code>android.useDeprecatedNdk=true</code></p>
<h3 id="æ·»åŠ buildå·¥å…·"><a href="/1970/01/01/[Android]Android Studio 1.x NDKç¯å¢ƒæ­å»º/#æ·»åŠ buildå·¥å…·" class="headerlink" title="æ·»åŠ buildå·¥å…·"></a>æ·»åŠ buildå·¥å…·</h3><p>AS &gt; Preferences &gt; Tools &gt; External Tools</p>
<h4 id="add-javah"><a href="/1970/01/01/[Android]Android Studio 1.x NDKç¯å¢ƒæ­å»º/#add-javah" class="headerlink" title="add javah"></a>add javah</h4><ul>
<li>Name: javah</li>
<li>Group: default(External Tools)</li>
<li>Description: generate C header</li>
<li>Options: select all</li>
<li>Show in: select all</li>
<li>Tools Settings:<ul>
<li>Program:  <code>$JDKPath$/bin/javah</code></li>
<li>Parameters:  <code>-v -d $ModuleFileDir$/src/main/jni -jni $FileClass$</code></li>
<li>Parameters:  <code>-bootclasspath $ModuleSdkPath$/platforms/android-23/android.jar -v -d $ModuleFileDir$/src/main/jni -jni $FileClass$</code> (if you need android object)</li>
<li>Working directory:  <code>$SourcepathEntry$</code></li>
</ul>
</li>
</ul>
<p>(PS: Right click on the class)</p>
<p><img src="https://raw.githubusercontent.com/ttdevs/Demo/master/ndkutil/image-javah.png" alt="é¡¹ç›®ç»“æ„"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">âœ  ~ javah</div><div class="line">ç”¨æ³•:</div><div class="line">  javah [options] &lt;classes&gt;</div><div class="line">å…¶ä¸­, [options] åŒ…æ‹¬:</div><div class="line">  -o &lt;file&gt;                è¾“å‡ºæ–‡ä»¶ (åªèƒ½ä½¿ç”¨ -d æˆ– -o ä¹‹ä¸€)</div><div class="line">  -d &lt;dir&gt;                 è¾“å‡ºç›®å½•</div><div class="line">  -v  -verbose             å¯ç”¨è¯¦ç»†è¾“å‡º</div><div class="line">  -h  --help  -?           è¾“å‡ºæ­¤æ¶ˆæ¯</div><div class="line">  -version                 è¾“å‡ºç‰ˆæœ¬ä¿¡æ¯</div><div class="line">  -jni                     ç”Ÿæˆ JNI æ ·å¼çš„æ ‡å¤´æ–‡ä»¶ (é»˜è®¤å€¼)</div><div class="line">  -force                   å§‹ç»ˆå†™å…¥è¾“å‡ºæ–‡ä»¶</div><div class="line">  -classpath &lt;path&gt;        ä»ä¸­åŠ è½½ç±»çš„è·¯å¾„</div><div class="line">  -bootclasspath &lt;path&gt;    ä»ä¸­åŠ è½½å¼•å¯¼ç±»çš„è·¯å¾„</div><div class="line">&lt;classes&gt; æ˜¯ä½¿ç”¨å…¶å…¨é™å®šåç§°æŒ‡å®šçš„</div><div class="line">(ä¾‹å¦‚, java.lang.Object)ã€‚</div></pre></td></tr></table></figure>
<h4 id="add-ndkBuild"><a href="/1970/01/01/[Android]Android Studio 1.x NDKç¯å¢ƒæ­å»º/#add-ndkBuild" class="headerlink" title="add ndkBuild"></a>add ndkBuild</h4><ul>
<li>Name: ndkBuild</li>
<li>Group: default(External Tools)</li>
<li>Description: ndk build</li>
<li>Options: select all</li>
<li>Show in: select all</li>
<li>Tools Settings:<ul>
<li>Program:  <code>/Users/ttdevs/android/android-ndk-r10e/ndk-build</code></li>
<li>Parameters:  <code>NDK_LIBS_OUT=$ModuleFileDir$/libs</code></li>
<li>Working directory:  <code>$ModuleFileDir$/src/main</code></li>
</ul>
</li>
</ul>
<p>(PS: Right click on the module name)</p>
<p><img src="https://raw.githubusercontent.com/ttdevs/Demo/master/ndkutil/image-ndkbuild.png" alt="é¡¹ç›®ç»“æ„"></p>
<h2 id="ç¼–å†™ä»£ç "><a href="/1970/01/01/[Android]Android Studio 1.x NDKç¯å¢ƒæ­å»º/#ç¼–å†™ä»£ç " class="headerlink" title="ç¼–å†™ä»£ç "></a>ç¼–å†™ä»£ç </h2><h3 id="æ–°å»ºä¸€ä¸ªModuleï¼šndkutil"><a href="/1970/01/01/[Android]Android Studio 1.x NDKç¯å¢ƒæ­å»º/#æ–°å»ºä¸€ä¸ªModuleï¼šndkutil" class="headerlink" title="æ–°å»ºä¸€ä¸ªModuleï¼šndkutil"></a>æ–°å»ºä¸€ä¸ªModuleï¼šndkutil</h3><h3 id="ä¿®æ”¹ndkutilçš„build-gradle"><a href="/1970/01/01/[Android]Android Studio 1.x NDKç¯å¢ƒæ­å»º/#ä¿®æ”¹ndkutilçš„build-gradle" class="headerlink" title="ä¿®æ”¹ndkutilçš„build.gradle"></a>ä¿®æ”¹ndkutilçš„build.gradle</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">android &#123;</div><div class="line">    ...</div><div class="line">    defaultConfig &#123;</div><div class="line">        ...</div><div class="line">        ndk &#123;</div><div class="line">            moduleName <span class="string">"ndkutil"</span></div><div class="line">//            abiFilters <span class="string">"armeabi-v7a"</span>, <span class="string">"x86"</span></div><div class="line">//            stl <span class="string">"gnustl_static"</span></div><div class="line">//            cFlags <span class="string">"-std=c++11 -Wall"</span></div><div class="line">//            ldLibs <span class="string">"log"</span>, <span class="string">"jnigraphics"</span>, <span class="string">"EGL"</span>, <span class="string">"GLESv3"</span></div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    sourceSets.main &#123;</div><div class="line">        jni.srcDirs = []</div><div class="line">        jniLibs.srcDir <span class="string">"libs"</span></div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="åˆ›å»ºå·¥å…·ç±»CipherUtil"><a href="/1970/01/01/[Android]Android Studio 1.x NDKç¯å¢ƒæ­å»º/#åˆ›å»ºå·¥å…·ç±»CipherUtil" class="headerlink" title="åˆ›å»ºå·¥å…·ç±»CipherUtil"></a>åˆ›å»ºå·¥å…·ç±»CipherUtil</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> com.ttdevs.ndk;</div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CipherUtil</span> </span>&#123;</div><div class="line">    <span class="keyword">static</span> &#123;</div><div class="line">        System.loadLibrary(<span class="string">"Cipher"</span>);</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">native</span> String <span class="title">getCipherKey</span><span class="params">()</span></span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="ç”Ÿæˆå¤´æ–‡ä»¶com-ttdevs-ndk-CipherUtil-h"><a href="/1970/01/01/[Android]Android Studio 1.x NDKç¯å¢ƒæ­å»º/#ç”Ÿæˆå¤´æ–‡ä»¶com-ttdevs-ndk-CipherUtil-h" class="headerlink" title="ç”Ÿæˆå¤´æ–‡ä»¶com_ttdevs_ndk_CipherUtil.h"></a>ç”Ÿæˆå¤´æ–‡ä»¶com_ttdevs_ndk_CipherUtil.h</h3><p>åœ¨åˆšæ‰åˆ›å»ºçš„CipherUtil.javaä¸Šç‚¹å‡»å³é”® &gt; External Tools &gt; javah<br>æ­¤æ—¶ä¼šåœ¨mainç›®å½•ä¸‹ç”Ÿæˆ: jni/com_ttdevs_ndk_CipherUtil.h</p>
<h3 id="ç¼–å†™ä»£ç -1"><a href="/1970/01/01/[Android]Android Studio 1.x NDKç¯å¢ƒæ­å»º/#ç¼–å†™ä»£ç -1" class="headerlink" title="ç¼–å†™ä»£ç "></a>ç¼–å†™ä»£ç </h3><p>éƒ½æ˜¯åœ¨ndkutil/src/main/jniç›®å½•ä¸‹</p>
<ul>
<li>åˆ›å»ºCæºç :Cipher.cpp</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"com_ttdevs_ndk_CipherUtil.h"</span></span></div><div class="line"></div><div class="line"><span class="function">JNIEXPORT jstring JNICALL <span class="title">Java_com_ttdevs_ndk_CipherUtil_getCipherKey</span><span class="params">(JNIEnv *env, jclass)</span></span>&#123;</div><div class="line">    <span class="keyword">return</span> (*env).NewStringUTF(<span class="string">"Hello World!"</span>);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>åˆ›å»ºAndroid.mk</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">LOCAL_PATH := $(call my-dir)</div><div class="line"></div><div class="line">include $(CLEAR_VARS)</div><div class="line"></div><div class="line">LOCAL_MODULE := Cipher</div><div class="line">LOCAL_SRC_FILES := Cipher.cpp</div><div class="line"></div><div class="line">include $(BUILD_SHARED_LIBRARY)</div></pre></td></tr></table></figure>
<ul>
<li>åˆ›å»ºApplication.mk</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">APP_MODULE := Cipher</div><div class="line">APP_ABI := all</div></pre></td></tr></table></figure>
<h3 id="ç¼–è¯‘ç”Ÿæˆsoæ–‡ä»¶"><a href="/1970/01/01/[Android]Android Studio 1.x NDKç¯å¢ƒæ­å»º/#ç¼–è¯‘ç”Ÿæˆsoæ–‡ä»¶" class="headerlink" title="ç¼–è¯‘ç”Ÿæˆsoæ–‡ä»¶"></a>ç¼–è¯‘ç”Ÿæˆsoæ–‡ä»¶</h3><p>åœ¨moduleï¼ˆndkutilï¼‰ä¸Šç‚¹å‡»å³é”® &gt; External Tools &gt; ndkBuild ï¼Œå¯ä»¥çœ‹åˆ°å¦‚ä¸‹logï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line">/Users/ttdevs/android/android-ndk-r10d/ndk-build NDK_LIBS_OUT=/Users/ttdevs/android/workspace/Demo/ndkutil/libs</div><div class="line">[arm64-v8a] Compile++      : Cipher &lt;= Cipher.cpp</div><div class="line">[arm64-v8a] SharedLibrary  : libCipher.so</div><div class="line">[arm64-v8a] Install        : libCipher.so =&gt; /Users/ttdevs/android/workspace/Demo/ndkutil/libs/arm64-v8a/libCipher.so</div><div class="line">[x86_64] Compile++      : Cipher &lt;= Cipher.cpp</div><div class="line">[x86_64] SharedLibrary  : libCipher.so</div><div class="line">[x86_64] Install        : libCipher.so =&gt; /Users/ttdevs/android/workspace/Demo/ndkutil/libs/x86_64/libCipher.so</div><div class="line">[mips64] Compile++      : Cipher &lt;= Cipher.cpp</div><div class="line">[mips64] SharedLibrary  : libCipher.so</div><div class="line">[mips64] Install        : libCipher.so =&gt; /Users/ttdevs/android/workspace/Demo/ndkutil/libs/mips64/libCipher.so</div><div class="line">[armeabi-v7a] Compile++ thumb: Cipher &lt;= Cipher.cpp</div><div class="line">[armeabi-v7a] SharedLibrary  : libCipher.so</div><div class="line">[armeabi-v7a] Install        : libCipher.so =&gt; /Users/ttdevs/android/workspace/Demo/ndkutil/libs/armeabi-v7a/libCipher.so</div><div class="line">[armeabi] Compile++ thumb: Cipher &lt;= Cipher.cpp</div><div class="line">[armeabi] SharedLibrary  : libCipher.so</div><div class="line">[armeabi] Install        : libCipher.so =&gt; /Users/ttdevs/android/workspace/Demo/ndkutil/libs/armeabi/libCipher.so</div><div class="line">[x86] Compile++      : Cipher &lt;= Cipher.cpp</div><div class="line">[x86] SharedLibrary  : libCipher.so</div><div class="line">[x86] Install        : libCipher.so =&gt; /Users/ttdevs/android/workspace/Demo/ndkutil/libs/x86/libCipher.so</div><div class="line">[mips] Compile++      : Cipher &lt;= Cipher.cpp</div><div class="line">[mips] SharedLibrary  : libCipher.so</div><div class="line">[mips] Install        : libCipher.so =&gt; /Users/ttdevs/android/workspace/Demo/ndkutil/libs/mips/libCipher.so</div><div class="line"></div><div class="line">Process finished with exit code 0</div></pre></td></tr></table></figure>
<p>æ­¤æ—¶æˆ‘ä»¬å¯ä»¥å‘ç°åœ¨ndkutil/libs/ç›®å½•ä¸‹ç”Ÿæˆçš„soæ–‡ä»¶ã€‚</p>
<h3 id="æµ‹è¯•ä»£ç "><a href="/1970/01/01/[Android]Android Studio 1.x NDKç¯å¢ƒæ­å»º/#æµ‹è¯•ä»£ç " class="headerlink" title="æµ‹è¯•ä»£ç "></a>æµ‹è¯•ä»£ç </h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">String cipher = CipherUtil.getCipherKey();</div></pre></td></tr></table></figure>
<h2 id="é¡¹ç›®ç»“æ„"><a href="/1970/01/01/[Android]Android Studio 1.x NDKç¯å¢ƒæ­å»º/#é¡¹ç›®ç»“æ„" class="headerlink" title="é¡¹ç›®ç»“æ„"></a>é¡¹ç›®ç»“æ„</h2><p><img src="https://raw.githubusercontent.com/ttdevs/Demo/master/ndkutil/image-dir.png" alt="é¡¹ç›®ç»“æ„"></p>
]]></content>
      
        <categories>
            
            <category> æŠ€æœ¯ </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Android </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[ã€ŒAndroidã€DataBindingç»™Buttonè®¾ç½®èƒŒæ™¯æ— æ•ˆ]]></title>
      <url>/1970/01/01/%5BAndroid%5DDataBinding%E7%BB%99Button%E8%AE%BE%E7%BD%AE%E8%83%8C%E6%99%AF%E6%97%A0%E6%95%88/</url>
      <content type="html"><![CDATA[<h2 id="0x00-é—®é¢˜"><a href="/1970/01/01/[Android]DataBindingç»™Buttonè®¾ç½®èƒŒæ™¯æ— æ•ˆ/#0x00-é—®é¢˜" class="headerlink" title="0x00 é—®é¢˜"></a>0x00 é—®é¢˜</h2><p>é€šè¿‡Data Bindingç»™Buttonè®¾ç½®èƒŒæ™¯æ— æ•ˆã€‚<br>å…·ä½“è¡¨ç°ä¸ºç»™Buttonè®¾ç½®ä¸åŒçš„èƒŒæ™¯å›¾ç‰‡ï¼Œä½†æ˜¯æ— è®ºæ€æ ·èƒŒæ™¯åªä¼šæ˜¾ç¤ºä¸åŒçš„é¢œè‰²ï¼Œè€Œä¸æ˜¯æ˜¾ç¤ºæœŸæœ›çš„å›¾ç‰‡ã€‚</p>
<h2 id="0x01-åˆ†æ"><a href="/1970/01/01/[Android]DataBindingç»™Buttonè®¾ç½®èƒŒæ™¯æ— æ•ˆ/#0x01-åˆ†æ" class="headerlink" title="0x01 åˆ†æ"></a>0x01 åˆ†æ</h2><p>ç”±äºå¯¹Data Bindingä¸æ˜¯å¾ˆç†Ÿæ‚‰ï¼Œæ‰€ä»¥å¾ˆå¥‡æ€ªä¸ºä»€ä¹ˆã€‚ä¸ç®¡æ€æ ·å…ˆæ‰“å°ä¸‹è¿™ä¸ªèµ„æºçš„å€¼ï¼Œå‘ç°åœ¨å¸ƒå±€æ–‡ä»¶ä¸­æ‰“å°èµ„æºå€¼æ˜¯æœ‰çš„ã€‚æ ¹æ®ç»éªŒï¼Œè®¾ç½®ä¸åŒçš„èƒŒæ™¯å›¾ç‰‡ï¼ŒèƒŒæ™¯ä¼šæ˜¾ç¤ºä¸åŒçš„é¢œè‰²ï¼Œé‚£è¿™ä¸ªå€¼å¯èƒ½è¢«è§£ææˆäº†é¢œè‰²å€¼ã€‚</p>
<h2 id="0x02-è§£å†³"><a href="/1970/01/01/[Android]DataBindingç»™Buttonè®¾ç½®èƒŒæ™¯æ— æ•ˆ/#0x02-è§£å†³" class="headerlink" title="0x02 è§£å†³"></a>0x02 è§£å†³</h2><p>åœ¨ç½‘ä¸Šæœäº†ä¸€ä¸‹ï¼ˆå®¹æˆ‘å¿˜è®°äº†å…·ä½“ç½‘å€ï¼‰ï¼Œéœ€è¦é€šè¿‡ä¸åŒçš„æ–¹å¼æ¥è®¾ç½®èƒŒæ™¯ï¼š<br>ä¹‹å‰çš„ï¼š</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">Button</span></span></div><div class="line">      <span class="attr">android:layout_width</span>=<span class="string">"200dp"</span></div><div class="line">      <span class="attr">android:layout_height</span>=<span class="string">"200dp"</span></div><div class="line">      <span class="attr">android:gravity</span>=<span class="string">"center"</span></div><div class="line">      <span class="attr">android:onClick</span>=<span class="string">"@&#123;(view) -&gt; handler.onStartClick(view)&#125;"</span></div><div class="line">      <span class="attr">android:text</span>=<span class="string">"@string/button_start"</span></div><div class="line">      <span class="attr">android:textColor</span>=<span class="string">"@color/blueColor"</span></div><div class="line">      <span class="attr">android:textSize</span>=<span class="string">"@dimen/global_font_large"</span></div><div class="line">      <span class="attr">android:background</span>=<span class="string">"@&#123;handler.startButtonBg&#125;"</span></div><div class="line">      <span class="attr">tools:background</span>=<span class="string">"@drawable/btn_main_circle_start"</span> /&gt;</div></pre></td></tr></table></figure>
<p>ä¿®æ”¹ä¹‹åï¼š</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">Button</span></span></div><div class="line">      <span class="attr">android:layout_width</span>=<span class="string">"200dp"</span></div><div class="line">      <span class="attr">android:layout_height</span>=<span class="string">"200dp"</span></div><div class="line">      <span class="attr">android:gravity</span>=<span class="string">"center"</span></div><div class="line">      <span class="attr">android:onClick</span>=<span class="string">"@&#123;(view) -&gt; handler.onStartClick(view)&#125;"</span></div><div class="line">      <span class="attr">android:text</span>=<span class="string">"@string/button_start"</span></div><div class="line">      <span class="attr">android:textColor</span>=<span class="string">"@color/blueColor"</span></div><div class="line">      <span class="attr">android:textSize</span>=<span class="string">"@dimen/global_font_large"</span></div><div class="line">      <span class="attr">app:backgroundResource</span>=<span class="string">"@&#123;handler.startButtonBg&#125;"</span></div><div class="line">      <span class="attr">tools:background</span>=<span class="string">"@drawable/btn_main_circle_start"</span> /&gt;</div></pre></td></tr></table></figure>
<p>ä¹Ÿå°±æ˜¯å°†ä¹‹å‰çš„ <code>android:background</code> æ¢æˆ <code>app:backgroundResource</code></p>
<h2 id="0x03-æ€»ç»“"><a href="/1970/01/01/[Android]DataBindingç»™Buttonè®¾ç½®èƒŒæ™¯æ— æ•ˆ/#0x03-æ€»ç»“" class="headerlink" title="0x03 æ€»ç»“"></a>0x03 æ€»ç»“</h2><p>æ²¡å•¥æ€»ç»“çš„ï¼ŒData Binding è¿˜æœ‰å¾ˆå¤šç­‰å¾…æ¢ç©¶ã€‚</p>
<p><img src="https://raw.githubusercontent.com/ttdevs/ttdevs.github.io/common/images/logo.png" alt="Create by ttdevs"></p>
]]></content>
      
        <categories>
            
            <category> æŠ€æœ¯ </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Android </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[ã€ŒAndroidã€Android Studio 2.0 NDKå¼€å‘ç¯å¢ƒæ­å»º]]></title>
      <url>/1970/01/01/%5BAndroid%5DAndroid%20Studio%202.0%20NDK%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/</url>
      <content type="html"><![CDATA[<h2 id="0x00-å‰æƒ…å›é¡¾"><a href="/1970/01/01/[Android]Android Studio 2.0 NDKå¼€å‘ç¯å¢ƒæ­å»º/#0x00-å‰æƒ…å›é¡¾" class="headerlink" title="0x00 å‰æƒ…å›é¡¾"></a>0x00 å‰æƒ…å›é¡¾</h2><p>å‰ä¸ä¹…å†™äº†ä¸€ç¯‡ç¯å¢ƒæ­å»ºï¼Œè™½ç„¶å¯ä»¥è·‘ä¸€ä¸ªdemoï¼Œä½†æ˜¯å¦‚æœä½ è·Ÿç€åšçš„è¯å°±ä¼šå‘ç°ï¼Œä»…ä»…æ˜¯å¯ä»¥è·‘ä¸€ä¸ªDemoï¼ŒçœŸåšèµ·æ¥å¾ˆæ˜¯è›‹ç–¼ã€‚ç¼–å†™æºç ï¼Œç”Ÿæˆsoï¼Œè·‘Appï¼Œæ”¹ä¸€ç‚¹ä»£ç ï¼Œå†ç”Ÿæˆsoï¼Œè·‘appã€‚è€Œä¸”ç¼–å†™ä»£ç æ²¡æœ‰æç¤ºï¼Œä¸èƒ½æ ¼å¼åŒ–ï¼Œå„ç§ä¸èƒ½ï¼Œå°±æ˜¯æœ€åŸºæœ¬çš„æ–‡æœ¬å¼€å‘ã€‚ç»è¿‡ä¸€æ®µæ—¶é—´æŠ˜è…¾å’ŒAndroid Studio 2.0çš„ releaseï¼Œå‘ç°æœ‰æ›´å®Œç¾çš„æ–¹å¼ï¼Œè€Œä¸”ä¸ç”¨ç¼–å†™Android.mkå’ŒApplication.mkã€‚çœ‹åœ¨æˆ‘åˆšå¼€å§‹å­¦çš„ä»½ä¸Šï¼Œå®¹æˆ‘å†æ¥å†™ä¸€éã€‚çœ‹å®Œè¿™ç¯‡ï¼Œä½ ä¼šå‘ç°JNIçš„å¼€å‘ä¹Ÿæ˜¯å¦‚æ­¤çš„so easyã€‚</p>
<h2 id="0x01-ç¯å¢ƒæ­å»º"><a href="/1970/01/01/[Android]Android Studio 2.0 NDKå¼€å‘ç¯å¢ƒæ­å»º/#0x01-ç¯å¢ƒæ­å»º" class="headerlink" title="0x01 ç¯å¢ƒæ­å»º"></a>0x01 ç¯å¢ƒæ­å»º</h2><p>æ‰€éœ€ç¯å¢ƒï¼š</p>
<ol>
<li>Android Studio 2.0</li>
<li>Gradle 2.10ï¼ˆæœ€ä½è¦æ±‚ï¼‰</li>
<li>NDKï¼šndk-r11cï¼ˆç›®å‰æœ€æ–°ç‰ˆï¼š2016-04-16ï¼‰</li>
<li>LLDBï¼š2.1ï¼ˆç›®å‰æœ€æ–°ç‰ˆï¼š2016-04-16ï¼‰</li>
</ol>
<p>ä¸‹é¢å¼€å§‹æ­£å¼æ“ä½œï¼š</p>
<ul>
<li><p>å®‰è£…Android Studio 2.0</p>
<p>  è¿™ä¸ªå°±ä¸ç»†è¯´äº†ã€‚</p>
</li>
<li><p>é…ç½®Gradle</p>
<p>  æœ€ä½è¦æ±‚Gradleç‰ˆæœ¬ä¸º2.10ï¼Œç›®å‰æœ€æ–°ç‰ˆæœ¬ä¸º2.12ã€‚ä¿®æ”¹æ–¹æ³•ï¼š</p>
<p>  <code>é¡¹ç›®æ ¹ç›®å½•/gradle/wrapper/gradle-wrapper.properties</code></p>
<p>  å°†æœ€ä¸‹é¢çš„ä¸€è¡Œæ”¹æˆä½ è¦çš„ç‰ˆæœ¬ï¼Œå¦‚ï¼š</p>
<p>  <code>distributionUrl=https\://services.gradle.org/distributions/gradle-2.10-all.zip</code></p>
</li>
<li><p>å®‰è£…NDK</p>
<p>  å®‰è£…NDKæœ‰ä¸¤ç§æ–¹å¼ï¼Œä¸€ç§æ˜¯ç›´æ¥ä¸‹è½½æœ€æ–°çš„NDKå®‰è£…æ–‡ä»¶è¿›è¡Œå®‰è£…ï¼Œå¦ä¸€ç§æ˜¯é€šè¿‡SDKå®‰è£…ï¼š</p>
<ol>
<li><p>NDKå®‰è£…æ–‡ä»¶</p>
<p> ä¸‹è½½å‚è€ƒ<a href="http://developer.android.com/ndk/downloads/index.html" target="_blank" rel="external">è¿™é‡Œ</a>ã€‚æ ¹æ®ä½ çš„æ“ä½œç³»ç»Ÿä¸‹è½½ä¸åŒç‰ˆæœ¬ã€‚</p>
</li>
<li><p>é€šè¿‡SDKå®‰è£…</p>
<p> <code>Android Studio &gt; Preferences &gt; Appearance &amp; Behavior &gt; Syetem Settings &gt; Android SDK &gt; SDK Tools</code></p>
<p> åœ¨è¿™ä¸ªTabä¸­æ‰¾åˆ° <code>Android NDK</code>ï¼Œé€‰ä¸­å®‰è£…å³å¯ã€‚å®‰è£…ä¹‹åæˆ‘ä»¬å¯ä»¥åœ¨ Android SDK çš„ç›®å½•ä¸‹çœ‹åˆ°ä¸€ä¸ª <code>ndk-bundle</code> ç›®å½•ï¼Œè¿™ä¸ªå°±æ˜¯æˆ‘ä»¬çš„NDKç›®å½•ã€‚</p>
<p><img src="/1970/01/01/[Android]Android Studio 2.0 NDKå¼€å‘ç¯å¢ƒæ­å»º/image.png" alt="ndk_lldb"></p>
</li>
</ol>
</li>
<li><p>LLDB</p>
<p>  å’Œ GDB ç±»ä¼¼ï¼Œ<a href="http://lldb.llvm.org/" target="_blank" rel="external">LLDB</a>  æ˜¯ä¸€æ¬¾è°ƒè¯•å™¨ï¼Œå¯ä»¥è°ƒè¯•æˆ‘ä»¬çš„JNIä»£ç ã€‚åŒä¸Šæ‰“å¼€SDKè®¾ç½®ç•Œé¢ï¼š</p>
<p>  <code>Android Studio &gt; Preferences &gt; Appearance &amp; Behavior &gt; Syetem Settings &gt; Android SDK &gt; SDK Tools</code></p>
<p>  åœ¨è¿™ä¸ªTabä¸­æ‰¾åˆ° <code>LLDB</code>ï¼Œé€‰ä¸­å®‰è£…å³å¯ã€‚å®‰è£…ä¹‹åæˆ‘ä»¬å¯ä»¥åœ¨ Android SDK çš„ç›®å½•ä¸‹çœ‹åˆ°ä¸€ä¸ª <code>lldb</code> ç›®å½•ï¼Œè¿™ä¸ªå°±æ˜¯æˆ‘ä»¬çš„ LLDB ç›®å½•ã€‚LLDBçš„æ›´å¤šä¿¡æ¯å¯å‚è€ƒ<a href="http://lldb.llvm.org/" target="_blank" rel="external">è¿™é‡Œ</a>ã€‚</p>
</li>
</ul>
<p>é€šè¿‡ä¸Šé¢çš„é…ç½®ï¼Œæ¥ä¸‹æ¥å°±å¯ä»¥å¼€å§‹æˆ‘ä»¬çš„JNIçš„å¼€å‘äº†ã€‚ å¯èƒ½ä½ ä¼šé—®ä¹‹å‰æˆ‘æœ‰ä»‹ç»è¿‡ä¸€ç¯‡å¼€å‘ç¯å¢ƒçš„æ­å»ºï¼Œè¿™ä¸ªæœ‰ä»€ä¹ˆä¸åŒå‘¢ï¼Ÿå¦‚æœä½ ä½¿ç”¨ä¹‹å‰çš„æ–¹æ³•ï¼Œä½ éœ€è¦é…ç½® Android.mkã€Application.mkï¼Œæ— ä»£ç è‡ªåŠ¨å®Œæˆï¼Œä¸èƒ½ä»£ç ä¸ªæ—¶å€™ï¼Œè¿è¡Œè°ƒè¯•éº»çƒ¦ï¼Œç­‰ç­‰ã€‚è¿™äº›é—®é¢˜åœ¨è¿™é‡Œéƒ½ä¸å­˜åœ¨äº†ï¼Œè®©æˆ‘ä»¬æŠŠæ›´å¤šçš„ç²¾åŠ›æ”¾åˆ°ä»£ç ç¼–å†™ä¸­ã€‚</p>
<h2 id="0x02-æµ‹è¯•Demo"><a href="/1970/01/01/[Android]Android Studio 2.0 NDKå¼€å‘ç¯å¢ƒæ­å»º/#0x02-æµ‹è¯•Demo" class="headerlink" title="0x02 æµ‹è¯•Demo"></a>0x02 æµ‹è¯•Demo</h2><p>æ–°å»ºjavaä»£ç ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CipherUtils</span> </span>&#123;</div><div class="line">    <span class="keyword">static</span> &#123;</div><div class="line">        System.loadLibrary(<span class="string">"CipherUtils"</span>);</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">native</span> <span class="keyword">int</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ç”Ÿæˆå¯¹åº”çš„C++ä»£ç ï¼š</p>
<p>ä»¤äººå…´å¥‹çš„æ˜¯ï¼ŒAndroid Studioå¯ä»¥å¸®æˆ‘ä»¬è‡ªåŠ¨ç”Ÿæˆ C ä»£ç ã€‚ç‚¹å‡» <code>add</code> æ–¹æ³•ï¼ŒOption ï¼‹ Return å³å¯ç”Ÿæˆä¸€ä¸ª <code>CipherUtils.c</code>æ–‡ä»¶ï¼Œç”±äºæˆ‘æ‰“ç®—ä½¿ç”¨C++ï¼Œå› æ­¤å°†æ‰©å±•åæ”¹ä¸º <code>cpp</code> ï¼ŒåŒæ—¶æ·»åŠ å¤´æ–‡ä»¶ï¼Œæœ€ç»ˆå¦‚ä¸‹ï¼š</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;jni.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></div><div class="line"></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"utils/log.h"</span></span></div><div class="line"></div><div class="line"><span class="function">JNIEXPORT jint JNICALL <span class="title">Java_com_ttdevs_jniutils_CipherUtils_add</span><span class="params">(JNIEnv *env, jclass type, jint x, jint y)</span> </span>&#123;</div><div class="line">    <span class="built_in">std</span>::<span class="function"><span class="built_in">string</span> <span class="title">input_str</span><span class="params">(<span class="string">"Test add two number!"</span>)</span></span>;</div><div class="line">    LOGE(<span class="string">"%s"</span>, input_str.c_str());</div><div class="line">    <span class="keyword">return</span> x + y;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><code>PSï¼šå¦‚æœæŠ¥é”™ï¼Œå¯æ˜¯å°†é”™è¯¯çš„ cppæ–‡ä»¶æ‹·è´å‡ºæ¥å†è€ƒå§å›å»ã€‚</code></p>
<p>build.gradle é…ç½®</p>
<figure class="highlight gradle"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">android &#123;</div><div class="line">    ......</div><div class="line">        defaultConfig &#123;</div><div class="line">        ......</div><div class="line">        ndk &#123;</div><div class="line">            moduleName <span class="string">"CipherUtils"</span></div><div class="line">            stl <span class="string">"gnustl_static"</span> <span class="comment">// stlport_static</span></div><div class="line">            abiFilters <span class="string">"armeabi"</span>, <span class="string">"armeabi-v7a"</span></div><div class="line">            ldLibs <span class="string">"log"</span>, <span class="string">"android"</span></div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">sourceSets</span>.main &#123;</div><div class="line">        <span class="comment">// å¦‚æœä¸å†™(jni.srcDirs = ['src/main/jni/'])</span></div><div class="line">        <span class="comment">// Androidå±•ç¤ºæ¨¡å¼æ²¡æœ‰jniç›®å½•</span></div><div class="line">        <span class="comment">// this file has been added after the last project sync with gradle</span></div><div class="line">        <span class="comment">// å¿…é¡»æœ‰å€¼,å¦‚: 'src/main/jni/'</span></div><div class="line">        jni.srcDirs = [<span class="string">'src/main/jni/'</span>]</div><div class="line">        <span class="comment">// jniLibs.srcDir "libs"</span></div><div class="line">    &#125;</div><div class="line">    ......</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ç›´æ¥ç‚¹å‡»è¿è¡ŒæŒ‰é’®ï¼Œå³å¯è·‘æˆ‘ä»¬çš„æµ‹è¯•ç¨‹åºäº†ã€‚å°±è¿™ä¹ˆç®€å•ã€‚</p>
<h2 id="0x03-JNIå±‚çš„Debug"><a href="/1970/01/01/[Android]Android Studio 2.0 NDKå¼€å‘ç¯å¢ƒæ­å»º/#0x03-JNIå±‚çš„Debug" class="headerlink" title="0x03 JNIå±‚çš„Debug"></a>0x03 JNIå±‚çš„Debug</h2><p>è¿™ä¸ªåŒæ ·ç®€å•ã€‚é¦–å…ˆéœ€è¦åœ¨å¤–é¢çš„build.gradleä¸­é…ç½®ä¸€ä¸‹ï¼š</p>
<figure class="highlight gradle"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">android &#123;</div><div class="line">    ......</div><div class="line">    buildTypes &#123;</div><div class="line">        debug &#123;</div><div class="line">            jniDebuggable = <span class="keyword">true</span></div><div class="line">        &#125;</div><div class="line">        ......</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>åœ¨ <code>C/C++</code> æºæ–‡ä»¶ä¸Šæ·»åŠ æ–­ç‚¹ï¼Œç‚¹å‡»debugï¼Œå°±å¯ä»¥åƒdebugæˆ‘ä»¬çš„javaä»£ç ä¸€æ ·è°ƒè¯•æˆ‘ä»¬çš„åŸç”Ÿä»£ç äº†ã€‚</p>
]]></content>
      
        <categories>
            
            <category> æŠ€æœ¯ </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Android </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[ã€ŒAndroidã€Androidä½ å¯èƒ½è¦ç”¨åˆ°çš„è‡ªå®šä¹‰Viewåˆ†äº«]]></title>
      <url>/1970/01/01/%5BAndroid%5DAndroid%E4%BD%A0%E5%8F%AF%E8%83%BD%E8%A6%81%E7%94%A8%E5%88%B0%E7%9A%84%E8%87%AA%E5%AE%9A%E4%B9%89View%E5%88%86%E4%BA%AB/</url>
      <content type="html"><![CDATA[<h2 id="0x00-main"><a href="/1970/01/01/[Android]Androidä½ å¯èƒ½è¦ç”¨åˆ°çš„è‡ªå®šä¹‰Viewåˆ†äº«/#0x00-main" class="headerlink" title="0x00 main"></a>0x00 main</h2><p>è¿›æ­¥ã€åˆ›æ–°éƒ½æ˜¯åœ¨ä¸æ–­å˜åŒ–çš„éœ€æ±‚ä¸­è¯ç”Ÿçš„ã€‚<br>                        ï¼ï¼ By ttdevs</p>
<p>è¿™ä¸ï¼Œæ–°çš„éœ€æ±‚åˆæ¥äº†ã€‚åºŸè¯ä¸å¤šè¯´ï¼Œå…ˆä¸Šè®¾è®¡ç¨¿ï¼š</p>
<p><img src="http://img.blog.csdn.net/20160619220030319" alt="boohee design"></p>
<p>ç®€å•åˆ†æä¸Šå›¾åŒ…æ‹¬ä¸‰éƒ¨åˆ†ï¼šæœ€ä¸Šé¢çš„ç±»Progressbarï¼Œä¸­é—´ä¸¤ä¸ªæŒ‡ç¤ºç›˜å’Œæœ€ä¸‹é¢çš„æŒ‡ç¤ºç›˜ã€‚ç¬¬ä¸€ä¸ªç±»Progressbaræˆ‘ä»¬é¡¹ç›®ä¹‹å‰æœ‰å®ç°è¿‡ï¼Œä½†æ˜¯å’Œè¿™ä¸ªéœ€æ±‚æœ‰ä¸€äº›å·®å¼‚ï¼Œå› æ­¤å†³å®šé‡æ–°å®ç°ä¸€éã€‚å¦å¤–ä¸¤ä¸ªåœ†å½¢æŒ‡ç¤ºç›˜æœ¬æƒ³é€šè¿‡åœ¨ä¸€å¼ èƒŒæ™¯å›¾ç‰‡ä¸Šæ”¾ä¸€å¼ æŒ‡é’ˆå›¾ï¼Œæ§åˆ¶æŒ‡é’ˆå›¾çš„æ—‹è½¬æ¥å®ç°ï¼Œä½†æ˜¯è€ƒè™‘åˆ°è¿™æ ·ä¸å¤Ÿçµæ´»ï¼Œå› æ­¤ä¹Ÿå†³å®šè‡ªå·±æ¥ç”»ã€‚Soï¼Œæˆ‘ä»¬æ¥ä¸‹æ¥å®ç°è¿™ä¸‰ä¸ªViewã€‚</p>
<p>æ­£å¼å¼€å§‹ä¹‹å‰ï¼Œå…ˆçœ‹çœ‹æˆ‘ä»¬æœ€ç»ˆæ•ˆæœå›¾ï¼ˆå½“ç„¶ï¼ŒæŒ‡é’ˆæ˜¯å¯ä»¥åŠ¨çš„ï¼‰ï¼š</p>
<p><img src="http://img.blog.csdn.net/20160629135550259" alt="Indicator view"></p>
<h2 id="0x01-åˆ†æ"><a href="/1970/01/01/[Android]Androidä½ å¯èƒ½è¦ç”¨åˆ°çš„è‡ªå®šä¹‰Viewåˆ†äº«/#0x01-åˆ†æ" class="headerlink" title="0x01 åˆ†æ"></a>0x01 åˆ†æ</h2><ul>
<li><p>LineIndicator ï¼ˆç¬¬ä¸€ä¸ªï¼Œç±»Progressbarï¼‰</p>
<p>  ä¸»è¦åŒ…æ‹¬ä¸‰éƒ¨åˆ†ï¼šå·¦ä¾§çš„æç¤ºå’Œå†…å®¹ï¼Œå³ä¾§çš„æç¤ºå’Œå†…å®¹ï¼Œä¸­é—´çš„ç±»Progressbarã€‚ä¸¤ä¾§çš„æ–‡å­—æ¯”è¾ƒå®¹æ˜“å¤„ç†ï¼ŒæŒæ¡äº†æ–‡å­—çš„åŸºæœ¬ç»˜åˆ¶ï¼Œç”»èµ·æ¥æ˜¯å¾ˆå®¹æ˜“çš„ã€‚ä¸­é—´çš„ç±»Progressbarç”±äºæ‰“ç®—è‡ªå·±ç”»ï¼Œæ‰€ä»¥ä¸ä¼šç›´æ¥è´´ä¸ªProgressbaråœ¨ä¸Šé¢ã€‚æˆ‘çš„æ€è·¯æ˜¯ç”»ä¸€æ¡é•¿çš„ç›´çº¿ä½œä¸ºèƒŒæ™¯ï¼Œä¸­é—´çš„æŒ‡ç¤ºä¹Ÿæ˜¯ç›´çº¿ï¼Œæ¯”èƒŒæ™¯ç›´çº¿ç²—ï¼Œç›´çº¿çš„Paintè®¾ç½® <code>StrokeCap</code> ä¸º <code>Paint.Cap.ROUND</code> å³ <code>paint.setStrokeCap(Paint.Cap.ROUND);</code>ï¼Œè¿™æ ·å°±å¯ä»¥æœ‰ä¸¤å¤´åŠåœ†çš„æ•ˆæœï¼›ä¸­é—´çš„æŒ‡ç¤ºæ•°å­—ç›´æ¥ç”»åœ¨ç²—çš„æŒ‡ç¤ºç›´çº¿ä¸Šé¢å³å¯ã€‚è¿™é‡Œå¯èƒ½é‡åˆ°çš„é—®é¢˜æœ‰ä¸‹é¢ä¸¤ä¸ªï¼š</p>
<ul>
<li><p><code>StrokeCap</code> è®¾ç½® ä¸º <code>Paint.Cap.ROUND</code>æ—¶çš„ä½ç½®å…³ç³»</p>
<p>  <code>StrokeCap</code> è®¾ç½® ä¸º <code>Paint.Cap.ROUND</code>ï¼Œç›´çº¿ä¸¤ä¾§çš„åŠåœ†æ˜¯ä¸ç®—åœ¨ç›´çº¿çš„é•¿åº¦é‡Œçš„ã€‚ç®€å•æ¥è¯´ï¼Œå¦‚æœviewçš„é•¿åº¦å’Œæˆ‘ç”»çš„ç›´çº¿é•¿åº¦ä¸€è‡´ï¼Œé‚£ä¹ˆè¿™ä¸ªç›´çº¿å°±æ˜¯çŸ©å½¢è€Œä¸æ˜¯æœŸå¾…çš„ä¸¤ä¾§éƒ½æ˜¯åŠåœ†çš„æ¤­åœ†ã€‚</p>
</li>
<li><p>å½“è¿›åº¦ä¸º0æˆ–è€…ä¸º100ï¼…æ—¶çš„å±•ç¤º</p>
<p>  å¦‚æœæˆ‘ä»¬èƒŒæ™¯ç›´çº¿å’ŒæŒ‡ç¤ºç›´çº¿èµ·ç‚¹ç»ˆç‚¹ä½ç½®ä¸€è‡´ï¼Œé‚£ä¹ˆæœ€ç»ˆæ•ˆæœå°±æ˜¯å½“è¿›åº¦ä¸º0æˆ–è€…100%çš„æ—¶å€™ï¼ŒæŒ‡ç¤ºç›´çº¿æ˜¯æ˜¾ç¤ºä¸å…¨çš„ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦å¯¹è¿™ä¸¤ä¸ªä½ç½®è¿›è¡ŒçŸ«æ­£ã€‚æˆ‘çš„çŸ«æ­£æ–¹æ³•æ¯”è¾ƒç®€å•ï¼Œåœ¨0ï½xå’Œyï½100%è¿›åº¦çš„æ—¶å€™åˆ†åˆ«æ˜¾ç¤ºxå’Œyï¼ˆæœ¬ä»¥ä¸ºè‡ªå·±çš„æ€è·¯å¾ˆå±Œï¼Œåæ¥å‘ç°åˆ«äººä¹Ÿæ˜¯è¿™ä¹ˆå¹²çš„ï¼‰ã€‚</p>
</li>
</ul>
</li>
<li><p>CircleIndicator ï¼ˆä¸­é—´çš„å¤šç§é¢œè‰²ç¯ï¼‰</p>
<p>  è¿™ä¸ªViewæˆ‘å°†å…¶åˆ†è§£ä¸ºå››éƒ¨åˆ†ï¼Œä»ä¸Šå±‚åˆ°ä¸‹å±‚ï¼šä¸­é—´æŒ‡é’ˆï¼Œåˆ»åº¦ç¯ï¼Œæ˜¾ç¤ºçš„å†…å®¹ï¼Œåœ†ç¯èƒŒæ™¯å’Œå¤–å±‚æŒ‡ç¤ºæ–‡å­—ã€‚æ¯ä¸€éƒ¨åˆ†å†åšåˆ†è§£ï¼š</p>
<ul>
<li><p>ä¸­é—´æŒ‡é’ˆ</p>
<p>  è¿™ä¸ªåˆåˆ†è§£ä¸ºå…­ä¸ªéƒ¨åˆ†ï¼šæœ€ä¸‹å±‚å¤§åœ†ï¼Œä¸¤ä¸ªåœ†å½¢åŠåœ†ï¼Œä¸¤ä¸ªä¸‰è§’å½¢å’Œä¸Šå±‚å°åœ†ã€‚</p>
</li>
<li><p>åˆ»åº¦ç¯</p>
<p>  ç”±äºæ˜¯åœ†ç¯ï¼Œæ‰€ä»¥å¿…é¡»ç”»å¼§çº¿äº†ã€‚ä½†æ˜¯è¿™ä¸ªå¼§çº¿åˆæœ‰ç‚¹ç‰¹æ®Šï¼Œä¸¤ä¾§å¸¦åœ†è§’ï¼Œä¸­é—´åœ†ç¯ç›´è§’ï¼Œè¿™ä¸ªæ²¡æƒ³åˆ°å•¥å¥½åŠæ³•ï¼Œç”¨äº†å¾ˆä¸€èˆ¬çš„æ€è·¯ï¼šå…ˆç”¨ <code>Paint.Cap.ROUND</code> ç”»ä¸¤ä¾§çš„å¼§ï¼Œç„¶å <code>Paint.Style.STROKE</code> ç”»ä¸­é—´çš„éƒ¨åˆ†ã€‚</p>
</li>
<li><p>æ˜¾ç¤ºçš„å†…å®¹</p>
<p>  è¿™ä¸ªå°±æ¯”è¾ƒç®€å•äº†ï¼Œä¸»è¦åœ¨äºè®¡ç®—æ–‡å­—çš„æ˜¾ç¤ºä½ç½®ã€‚</p>
</li>
<li><p>åœ†ç¯èƒŒæ™¯å’Œå¤–å±‚æ–‡å­—</p>
<p>  æœ€ç®€å•çš„ä¸€ä¸ªåœ†ï¼ŒåŠ ä¸€ä¸ªä»¥åœ†ä¸ºè·¯å¾„ç”»çš„æ–‡å­—ã€‚</p>
</li>
</ul>
</li>
</ul>
<pre><code>æœ€åæˆ‘ä»¬ç”»çš„é¡ºåºæ­£å¥½ä¸ä¸Šé¢æ‰€è¿°é¡ºåºç›¸åã€‚
</code></pre><ul>
<li><p>ProgressIndicator ï¼ˆæœ€ä¸‹é¢çš„ä¸¤ç§é¢œè‰²ç¯ï¼‰</p>
<p>  è¿™ä¸ªç›¸è¾ƒ CircleIndicator å°±ç®€å•äº†ä¸€äº›ã€‚åœ¨ç”»åœ†ç¯çš„æ—¶å€™ï¼Œæˆ‘ä»¬åªéœ€è¦å…ˆç”»ä¸€ä¸ªç°è‰²èƒŒæ™¯ï¼Œç„¶åå†ç”»ä¸€ä¸ªç»¿è‰²åœ†å¼§å³å¯ã€‚</p>
</li>
</ul>
<h2 id="0x02-å®ç°"><a href="/1970/01/01/[Android]Androidä½ å¯èƒ½è¦ç”¨åˆ°çš„è‡ªå®šä¹‰Viewåˆ†äº«/#0x02-å®ç°" class="headerlink" title="0x02 å®ç°"></a>0x02 å®ç°</h2><p>Viewçš„ç»˜åˆ¶æˆ‘ä»¬åº”è¯¥éƒ½æ¯”è¾ƒç†Ÿæ‚‰ï¼Œä¸»è¦æœ‰ä¸‹é¢ä¸‰ä¸ªè¿‡ç¨‹ï¼š onMeasureï¼ˆæµ‹é‡ï¼‰ã€onLayoutï¼ˆå¸ƒå±€ï¼‰ã€onDrawï¼ˆç»˜åˆ¶ï¼‰ã€‚é’ˆå¯¹ä¸Šè¿°ä¸‰ä¸ªViewï¼šLineIndicatorï¼Œæˆ‘ä»¬æ ¹æ®å®é™…çš„å†…å®¹æ¥è®¡ç®—Viewçš„é«˜åº¦ï¼Œå®½åº¦ç”¨æˆ·è®¾å®šï¼›CircleIndicatorå’ŒProgressIndicatorçš„å®½åº¦ç”¨æˆ·è®¾å®šï¼Œé«˜åº¦è‡ªå®šè®¡ç®—ä¸å®½åº¦ç›¸åŒã€‚onLayoutæˆ‘ä»¬ä¸éœ€è¦ã€‚æœ€åçš„æ ¹æ®å®é™…çš„å±•ç¤ºå†…å®¹æ¥ç»˜åˆ¶ã€‚</p>
<p>å¦å¤–ï¼Œç”±äºCircleIndicatorå’ŒProgressIndicatorå’Œç›¸ä¼¼åº¦é«˜ï¼Œå¾ˆå¤šä»£ç å¯ä»¥æ‹¿æ¥é‡ç”¨ï¼Œå› æ­¤ï¼Œæˆ‘å†™äº†ä¸€ä¸ªåŸºç±»æ¥å®Œæˆå…¬å…±çš„éƒ¨åˆ†ï¼Œç‰¹æ®Šéƒ¨åˆ†æ¯ä¸ª å­ç±»è‡ªå·±å®Œæˆã€‚æœ€åå†å­ç±»åœ°onDrawæ–¹æ³•ä¸­æŒ‰ç…§é¡ºåºè°ƒç”¨å³å¯ã€‚</p>
<p>ç”±äºä¸»è¦æ˜¯è®¡ç®—å„ç§åæ ‡ä½ç½®ï¼Œä»£ç è¿˜æ˜¯ä¸å°‘çš„ï¼Œè¿™é‡Œå°±ä¸è´´ä»£ç ã€‚æœ€åçš„å®ç°è¯·ç§»æ­¥æˆ‘çš„ <a href="https://github.com/ttdevs/android/tree/master/modules/indicator" target="_blank" rel="external">github</a>ã€‚ä¸‰ä¸ªViewçš„ä»£ç å·²ç»æ•´ç†å®ŒLineIndicatorï¼Œå…¶å®ƒçš„ä¸¤ä¸ªè¿˜éœ€è¦ç‚¹æ—¶é—´ï¼ˆ2016-06-19ï¼‰ã€‚</p>
<h2 id="0x03-çŸ¥è¯†ç‚¹"><a href="/1970/01/01/[Android]Androidä½ å¯èƒ½è¦ç”¨åˆ°çš„è‡ªå®šä¹‰Viewåˆ†äº«/#0x03-çŸ¥è¯†ç‚¹" class="headerlink" title="0x03 çŸ¥è¯†ç‚¹"></a>0x03 çŸ¥è¯†ç‚¹</h2><ul>
<li><p>è‡ªå®šä¹‰Viewçš„æ€è·¯</p>
<ul>
<li>åˆ›å»ºç±»ï¼Œç»§æ‰¿è‡ªViewæˆ–è€…ViewGroupæˆ–è€…å…¶å®ƒViewGroup</li>
<li>å®šä¹‰Viewçš„å¯é…ç½®å‚æ•°ï¼Œå¦‚æœä½ éœ€è¦çš„è¯</li>
<li><p>å®ç°Viewçš„å…·ä½“é€»è¾‘</p>
<p>è¿™ä¸ªå¤ªç²—ç•¥äº†ï¼Œå„ä½å¯ä»¥å‚è€ƒå…·ä½“æºç ã€‚</p>
</li>
</ul>
</li>
<li><p>æ–‡å­—ä½ç½®çš„è®¡ç®—</p>
<p>  å¦‚æœä½ æ²¡æœ‰è‡ªå·±ç”»è¿‡æ–‡å­—ï¼Œé‚£ä½ è‚¯å®šä¸å¯èƒ½ä¸€ä¸‹å­æ˜ç™½æ–‡å­—çš„ç”»æ³•ï¼Œæˆ–å¤šæˆ–å°‘çš„å‡ºç°åç§»ã€‚è¿™é‡Œç›´æ¥ç»™å¤§å®¶æ¨èä¸€ç¯‡è®²çš„éå¸¸è¯¦ç»†çš„æ–‡ç« ï¼š<a href="http://blog.csdn.net/aigestudio/article/details/41447349" target="_blank" rel="external">http://blog.csdn.net/aigestudio/article/details/41447349</a></p>
</li>
<li><p>ä½ç½®ã€åŠå¾„ã€å¼§é•¿ç­‰çš„è®¡ç®—</p>
<p>  è¿™é‡Œä¼šæ¶‰åŠåˆ°ç®€å•çš„ä¸‰è§’å‡½æ•°å’Œåœ†çš„å‘¨é•¿å¼§åº¦çš„è®¡ç®—ï¼Œå¯èƒ½è¦è¯´çš„å°±æ˜¯ä¸‰è§’å‡½æ•°çš„å‚æ•°æ˜¯å¼§åº¦åˆ¶åº¦ã€‚</p>
</li>
<li><p>ObjectAnimator</p>
  <figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"> * è®¾ç½®å†…å®¹çš„é¢œè‰²å€¼ï¼ˆéresourceçš„idï¼‰</div><div class="line"> *</div><div class="line"> * <span class="doctag">@param</span> contentColor å†…å®¹çš„é¢œè‰²å€¼</div><div class="line"> * <span class="doctag">@param</span> unitColor    å•ä½çš„é¢œè‰²å€¼</div><div class="line"> */</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setContentColor</span><span class="params">(<span class="keyword">int</span> contentColor, <span class="keyword">int</span> unitColor)</span> </span>&#123;</div><div class="line">    mContentColor = contentColor;</div><div class="line">    mUnitColor = unitColor;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line"> * è®¾ç½®è¿›åº¦</div><div class="line"> *</div><div class="line"> * <span class="doctag">@param</span> indicator è¿›åº¦å€¼</div><div class="line"> */</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setIndicator</span><span class="params">(<span class="keyword">float</span> indicator)</span> </span>&#123;</div><div class="line">    <span class="keyword">if</span> (indicator &lt;= mStartIndicator) &#123;</div><div class="line">        mIndicator = mStartIndicator;</div><div class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (indicator &gt; mEndIndicator) &#123;</div><div class="line">        mIndicator = mEndIndicator;</div><div class="line">    &#125; <span class="keyword">else</span> &#123;</div><div class="line">        mIndicator = indicator;</div><div class="line">    &#125;</div><div class="line">    postInvalidate();</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line"> * è·å–è¿›åº¦</div><div class="line"> *</div><div class="line"> * <span class="doctag">@return</span> å½“å‰è¿›åº¦å€¼</div><div class="line"> */</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">float</span> <span class="title">getIndicator</span><span class="params">()</span> </span>&#123;</div><div class="line">    <span class="keyword">return</span> mStartIndicator;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">animateIndicator</span><span class="params">(<span class="keyword">float</span> indicator)</span> </span>&#123;</div><div class="line">    Interpolator interpolator = <span class="keyword">new</span> AnticipateOvershootInterpolator(<span class="number">1.8f</span>);</div><div class="line">    ObjectAnimator animation = ObjectAnimator.ofFloat(<span class="keyword">this</span>, <span class="string">"indicator"</span>, indicator);</div><div class="line">    animation.setDuration(<span class="number">2000</span>);</div><div class="line">    animation.setInterpolator(interpolator);</div><div class="line">    animation.start();</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>å¤„ç†å±å¹•çš„æ—‹è½¬</p>
<p>  ç”±äºæ—¶é—´æ¯”è¾ƒç´§ï¼Œè¿™ä¸ªæˆ‘è¿˜æ²¡åšã€‚ä¸»è¦åœ¨Viewçš„ä»¥ä¸‹ä¸¤ä¸ªæ–¹æ³•ä¸­å®ç°ï¼š</p>
  <figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@Override</span></div><div class="line"><span class="function"><span class="keyword">protected</span> Parcelable <span class="title">onSaveInstanceState</span><span class="params">()</span> </span>&#123;</div><div class="line">   <span class="keyword">return</span> <span class="keyword">super</span>.onSaveInstanceState();</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="meta">@Override</span></div><div class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onRestoreInstanceState</span><span class="params">(Parcelable state)</span> </span>&#123;</div><div class="line">   <span class="keyword">super</span>.onRestoreInstanceState(state);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ul>
<p>æœ€åæ¬¢è¿å„ä½åæ§½å¹¶æä¾›æ›´å¥½çš„å»ºè®®ï½ï½</p>
<p><img src="https://raw.githubusercontent.com/ttdevs/ttdevs.github.io/common/images/logo.png" alt="Create by ttdevs"></p>
]]></content>
      
        <categories>
            
            <category> æŠ€æœ¯ </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Android </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[ã€ŒAndroidã€MediaPlayerå•æ›²å¾ªç¯ä¸å¡é¡¿]]></title>
      <url>/1970/01/01/%5BAndroid%5DMediaPlayer%E5%8D%95%E6%9B%B2%E5%BE%AA%E7%8E%AF%E4%B8%8D%E5%8D%A1%E9%A1%BF/</url>
      <content type="html"><![CDATA[<h2 id="0x00-éœ€æ±‚"><a href="/1970/01/01/[Android]MediaPlayerå•æ›²å¾ªç¯ä¸å¡é¡¿/#0x00-éœ€æ±‚" class="headerlink" title="0x00 éœ€æ±‚"></a>0x00 éœ€æ±‚</h2><p>å•æ›²å¾ªç¯æ’­æ”¾æ­Œæ›²ï¼Œè¦æ±‚è¿‡åº¦è¿è´¯ï¼Œå¬ä¸å‡ºæ¥å¡é¡¿æ„Ÿè§‰ã€‚</p>
<h2 id="0x01-è§£å†³æ€è·¯"><a href="/1970/01/01/[Android]MediaPlayerå•æ›²å¾ªç¯ä¸å¡é¡¿/#0x01-è§£å†³æ€è·¯" class="headerlink" title="0x01 è§£å†³æ€è·¯"></a>0x01 è§£å†³æ€è·¯</h2><ol>
<li><p>MediaPlayer</p>
<p> å¯¹äºå¸¸è§çš„éŸ³ä¹æ’­æ”¾ï¼Œæˆ‘ä»¬ç¬¬ä¸€æ—¶é—´æƒ³åˆ°çš„åº”è¯¥å°±æ˜¯å®ƒï¼Œå®ƒæœ‰ä¸€ä¸ªæ–¹æ³•</p>
<p> <code>MediaPlayer.setLooping(true);</code></p>
<p> å°±æ˜¯ç”¨æ¥è¿›è¡Œå•æ›²å¾ªç¯çš„ã€‚ä½†æ˜¯å¾ˆé—æ†¾ï¼Œå¦‚æœä½ ç®€å•çš„è¿™ä¹ˆåšï¼Œä¸Šé¢çš„ç›®çš„æ˜¯è¾¾ä¸åˆ°çš„ï¼Œä¼šå‡ºç°ä¸Šä¸€éç»“æŸå‡ºç°ä¸€ä¸ªæ˜æ˜¾çš„åœæ­¢æ‰å¼€å§‹æ’­æ”¾ä¸‹ä¸€æ¬¡çš„ç°è±¡ã€‚</p>
<p> ä¸è¿‡æœ€åå°±æ˜¯ç”¨çš„è¿™ä¸ªç»„ä»¶ï¼Œä¸è¿‡ä¸æ˜¯ç®€å•çš„è®¾ç½® <code>setLooping(true)</code>ã€‚</p>
</li>
<li><p>SoundPool</p>
<p>ä¸€æ®µæ—¶é—´å†…å¯èƒ½ä¼šæ’­æ”¾å¾ˆå¤šéŸ³ä¹çš„æ—¶å€™ï¼Œæˆ‘ä»¬é¦–å…ˆåº”è¯¥é€‰æ‹©è¿™ä¸ªã€‚</p>
</li>
<li><p>ç¬¬ä¸‰æ–¹ç»„ä»¶</p>
<p> å¦‚æœæ²¡æœ‰ç‰¹æ®Šçš„éœ€æ±‚ï¼Œè¿™ä¸ªä¸æ˜¯é¦–é€‰ï¼Œç‰¹åˆ«æ˜¯å½“å¼•å…¥çš„ç»„ä»¶ç‰¹åˆ«é‡çš„æ—¶å€™ã€‚    </p>
</li>
</ol>
<p>å› ä¸ºä¹‹å‰è¸©è¿‡å‘ï¼šiOSä¸Šç›´æ¥æ’­æ”¾mp3æ–‡ä»¶ï¼Œå•æ›²å¾ªç¯çš„æ—¶å€™æ’­æ”¾çš„é—´éš™ç‰¹åˆ«é•¿ï¼Œå¡é¡¿çš„æ„Ÿè§‰æ— æ³•æ¥å—ï¼Œè§£å†³æ–¹æ³•æ˜¯å°†mp3è½¬æ¢æˆm4aï¼ŒåŸºæœ¬ä¸Šå¬ä¸å‡ºä¸­é—´çš„è¿‡åº¦é—´éš™ã€‚<br>é¦–å…ˆå°è¯•äº†ä½¿ç”¨ <code>MediaPlayer</code> æ¥æ’­æ”¾ï¼Œåœ¨æˆ‘çš„æœºå™¨ï¼ˆMX4 Proï¼‰ä¸Šæ’­æ”¾è¿˜å‹‰å¼ºèƒ½æ¥å—ï¼Œé—´éš™ä¸æ˜¯éå¸¸æ˜æ˜¾ï¼Œæ¢åˆ°é…ç½®å·®ä¸€ç‚¹çš„æœºå™¨ä¸Šå°±ä¸èƒ½å¿äº†ã€‚ç„¶åå°è¯•äº† <code>SoudPool</code> ï¼Œæ— è®ºæ˜¯é¢„åŠ è½½ä¸€æ¬¡å¾ªç¯æ’­æ”¾ï¼Œè¿˜æ˜¯é¢„åŠ è½½ä¸¤æ¬¡å¾ªç¯æ’­æ”¾ï¼Œä¸­é—´çš„å¡é¡¿æ„Ÿè§‰å’Œç”¨ <code>MediaPlayer.setLooping(true);</code> ä¸€æ ·ä¸€æ ·çš„ã€‚å†ç„¶åï¼Œå°è¯•macOS ä¸‹ç¼–è¯‘ <code>vlc for android</code> ï¼Œæˆ‘å¤±è´¥äº†â•®(â•¯â–½â•°)â•­ï¼‰é—®é¢˜æ€»è¦è§£å†³çš„ï¼Œå†æ‰¾å…¶ä»–åŠæ³•ã€‚</p>
<h2 id="0x02-æ­»å¾ªç¯"><a href="/1970/01/01/[Android]MediaPlayerå•æ›²å¾ªç¯ä¸å¡é¡¿/#0x02-æ­»å¾ªç¯" class="headerlink" title="0x02 æ­»å¾ªç¯"></a>0x02 æ­»å¾ªç¯</h2><p>æ‰¾äº†å¾ˆå¤šèµ„æ–™ï¼Œæœ€åä½¿ç”¨ä¸€ä¸ªå¾ªç¯æ’­æ”¾çš„æ–¹æ³•è§£å†³äº†è¿™ä¸ªé—®é¢˜ï¼š</p>
<ul>
<li>åˆ›å»ºç¬¬ä¸€ä¸ªæ’­æ”¾å™¨ï¼Œæ’­æ”¾ï¼›</li>
<li>åŒæ—¶åˆ›å»ºç¬¬äºŒä¸ªæ’­æ”¾å™¨ï¼Œå‡†å¤‡ï¼›</li>
<li>ç¬¬ä¸€ä¸ªæ’­æ”¾å™¨æ’­æ”¾å®Œæ¯•ç«‹é©¬å¯åŠ¨ç¬¬äºŒä¸ªï¼›</li>
<li>ç„¶ååˆ›å»ºç¬¬ä¸‰ä¸ªæ’­æ”¾å™¨ï¼Œå‡†å¤‡ï¼›</li>
<li>å¦‚æ­¤å¾€å¤ï¼Œç›´åˆ°ç”¨æˆ·åœæ­¢â€¦</li>
</ul>
<p>ç”±äºå¯¹ <code>MediaPlayer</code> æ²¡æœ‰è¿‡æ·±å…¥çš„ç ”ç©¶å’Œä½¿ç”¨ï¼Œè¿™ä¸ªæ€è·¯æ¥ä¸€æ—¶åŠä¼šè‡ªå·±è¿˜æ˜¯æƒ³ä¸å‡ºæ¥çš„ï¼ˆæ€»æ˜¯ä¼šæƒ³åªè¦åˆ›å»ºä¸€ä¸ªæ’­æ”¾å™¨å°±å¤Ÿäº†ï¼‰ã€‚è¿™ä¹ˆåšä¸‹æ¥çœŸçš„å¾ªç¯æ’­æ”¾å°±æ²¡æœ‰é—´éš™æ„Ÿäº†â€¦â€¦</p>
<p>ç”±äº <code>mPlayer.setLooping(true);</code> æ˜¯nativeæ–¹æ³•ï¼Œæ‰€ä»¥æ²¡æœ‰å»è·Ÿå…·ä½“çš„å®ç°é€»è¾‘ã€‚çŒœæµ‹å¯èƒ½æ˜¯é‡æ–°åŠ è½½æˆ–è€…å…¶ä»–åŸå› å¯¼è‡´å•æ›²å¾ªç¯ä¸­é—´é—´éš™è¾ƒå¤§ï¼ˆåŸè°…æˆ‘çš„æ‡’ï¼Œæ²¡æœ‰å»æ‹¿å¤§æ–‡ä»¶å°è¯•ï¼‰ã€‚è€Œä½¿ç”¨ä¸Šé¢çš„æ–¹å¼ï¼Œå½“æ’­æ”¾æ—¶é—´å¤§äºé¢„åŠ è½½æ—¶é—´çš„æ—¶å€™ï¼Œç¬¬ä¸€ä¸ªæ’­æ”¾å™¨æ’­æ”¾çš„æ—¶å€™æœ‰ç¬¬äºŒä¸ªæ’­æ”¾å™¨æœ‰å……è¶³çš„æœºä¼šå»å®ŒæˆåŠ è½½ç„¶åç­‰å¾…æ’­æ”¾ï¼ˆæ’­æ”¾æ—¶é—´å°äºåŠ è½½æ—¶é—´çš„å¯èƒ½æ€§ä¸æ˜¯å¾ˆå¤§ï¼‰ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">private</span> MediaPlayer mPlayer, mNextPlayer;</div><div class="line"><span class="keyword">private</span> <span class="keyword">int</span> mPlayResId = R.raw.water;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testLoopPlayer</span><span class="params">()</span> </span>&#123;</div><div class="line">    mPlayer = MediaPlayer.create(<span class="keyword">this</span>, mPlayResId);</div><div class="line">    mPlayer.setOnPreparedListener(<span class="keyword">new</span> MediaPlayer.OnPreparedListener() &#123;</div><div class="line">        <span class="meta">@Override</span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onPrepared</span><span class="params">(MediaPlayer mediaPlayer)</span> </span>&#123;</div><div class="line">            mPlayer.start();</div><div class="line">        &#125;</div><div class="line">    &#125;);</div><div class="line">    createNextMediaPlayer();</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">createNextMediaPlayer</span><span class="params">()</span> </span>&#123;</div><div class="line">    mNextPlayer = MediaPlayer.create(<span class="keyword">this</span>, mPlayResId);</div><div class="line">    mPlayer.setNextMediaPlayer(mNextPlayer);</div><div class="line">    mPlayer.setOnCompletionListener(<span class="keyword">new</span> MediaPlayer.OnCompletionListener() &#123;</div><div class="line">        <span class="meta">@Override</span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onCompletion</span><span class="params">(MediaPlayer mp)</span> </span>&#123;</div><div class="line">            mp.release();</div><div class="line"></div><div class="line">            mPlayer = mNextPlayer;</div><div class="line"></div><div class="line">            createNextMediaPlayer();</div><div class="line">        &#125;</div><div class="line">    &#125;);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="0x03-æ€»ç»“"><a href="/1970/01/01/[Android]MediaPlayerå•æ›²å¾ªç¯ä¸å¡é¡¿/#0x03-æ€»ç»“" class="headerlink" title="0x03 æ€»ç»“"></a>0x03 æ€»ç»“</h2><p>è¿™æ›´åƒä¸€ä¸ªå¼€è„‘æ´çš„é—®é¢˜ã€‚</p>
<h2 id="0x04-å‚è€ƒ"><a href="/1970/01/01/[Android]MediaPlayerå•æ›²å¾ªç¯ä¸å¡é¡¿/#0x04-å‚è€ƒ" class="headerlink" title="0x04 å‚è€ƒ"></a>0x04 å‚è€ƒ</h2><ul>
<li><a href="http://stackoverflow.com/questions/26274182/not-able-to-achieve-gapless-audio-looping-so-far-on-android" target="_blank" rel="external">http://stackoverflow.com/questions/26274182/not-able-to-achieve-gapless-audio-looping-so-far-on-android</a></li>
</ul>
<p><img src="https://raw.githubusercontent.com/ttdevs/ttdevs.github.io/common/images/logo.png" alt="Create by ttdevs"></p>
]]></content>
      
        <categories>
            
            <category> æŠ€æœ¯ </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Android </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[ã€ŒAndroidã€Toobarçš„ä¸€ä¸ªç®€å•å°è£…]]></title>
      <url>/1970/01/01/%5BAndroid%5DToobar%E7%9A%84%E4%B8%80%E4%B8%AA%E7%AE%80%E5%8D%95%E5%B0%81%E8%A3%85/</url>
      <content type="html"><![CDATA[<p>Toolbarå’ŒActionBarçš„ç›´è§‚åŒºåˆ«å°±æ˜¯éœ€è¦æˆ‘ä»¬è‡ªå·±å°†ToolBaråŠ åˆ°è‡ªå·±çš„å¸ƒå±€æ–‡ä»¶ä¸­ã€‚ç›®å‰çš„æƒ…å†µæ˜¯ï¼šåœ¨æˆ‘ä»¬çš„ç°æœ‰é¡¹ç›®ä¸Šæ”¹åŠ¨ï¼Œå¤šæ•°çš„Activityéƒ½æ˜¯ç»§æ‰¿ä¸€ä¸ªBaseActivityã€‚ä¸ºäº†ç”¨æœ€å°çš„ä»£ä»·è¾¾åˆ°ç›®çš„ï¼Œç®€å•çš„æ€è€ƒä¹‹åï¼Œåšäº†å¦‚ä¸‹çš„æ”¹åŠ¨ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"> * å¸¦ToolBarçš„åŸºç±»</div><div class="line"> */</div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BaseActivity</span> <span class="keyword">extends</span> <span class="title">ActionBarActivity</span> </span>&#123;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> BASE_VIEW_ID = R.layout.activity_base;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> LayoutParams LAYOUT_PARAMS = <span class="keyword">new</span> LayoutParams(LayoutParams.MATCH_PARENT, LayoutParams.MATCH_PARENT);</div><div class="line"></div><div class="line">    <span class="keyword">private</span> LinearLayout mParentView;</div><div class="line">    <span class="keyword">private</span> Toolbar mToolBar;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</div><div class="line">        ViewUtils.startTranslucent(<span class="keyword">this</span>);</div><div class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState);</div><div class="line">        setContentView(BASE_VIEW_ID);</div><div class="line"></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setContentView</span><span class="params">(<span class="keyword">int</span> layoutResID)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (BASE_VIEW_ID == layoutResID) &#123;</div><div class="line">            <span class="keyword">super</span>.setContentView(layoutResID);</div><div class="line"></div><div class="line">            mParentView = (LinearLayout) findViewById(R.id.base_parent_view);</div><div class="line">            mToolBar = (Toolbar) findViewById(R.id.toolbar);</div><div class="line">            initToolbar(mToolBar);</div><div class="line">            <span class="keyword">return</span>;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        mParentView.addView(getLayoutInflater().inflate(layoutResID, <span class="keyword">null</span>), LAYOUT_PARAMS);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setContentView</span><span class="params">(View view)</span> </span>&#123;</div><div class="line">        mParentView.addView(view, LAYOUT_PARAMS);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">initToolbar</span><span class="params">(Toolbar toolbar)</span> </span>&#123;</div><div class="line">        setSupportActionBar(toolbar);</div><div class="line">        getSupportActionBar().setDisplayHomeAsUpEnabled(<span class="keyword">true</span>);</div><div class="line">        toolbar.setNavigationOnClickListener(<span class="keyword">new</span> View.OnClickListener() &#123;</div><div class="line">            <span class="meta">@Override</span></div><div class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span><span class="params">(View v)</span> </span>&#123;</div><div class="line">                finish();</div><div class="line">            &#125;</div><div class="line">        &#125;);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> Toolbar <span class="title">getToolBar</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> mToolBar;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setBackground</span><span class="params">(<span class="keyword">int</span> colorId)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (<span class="keyword">null</span> != mParentView) &#123;</div><div class="line">            mParentView.setBackgroundColor(getResources().getColor(colorId));</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>å¸ƒå±€æ–‡ä»¶activity_base.xmlï¼š</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">&lt;?xml version="1.0" encoding="utf-8"?&gt;</div><div class="line">&lt;LinearLayout</div><div class="line">   xmlns:android="http://schemas.android.com/apk/res/android"</div><div class="line">   android:id="@+id/base_parent_view"</div><div class="line">   android:layout_width="match_parent"</div><div class="line">   android:layout_height="match_parent"</div><div class="line">   android:background="@color/global_background_status_bar"</div><div class="line">   android:fitsSystemWindows="true"</div><div class="line">   android:orientation="vertical"&gt;</div><div class="line">    </div><div class="line">   &lt;include layout="@layout/subview_toolbar"/&gt;</div><div class="line">&lt;/LinearLayout&gt;</div></pre></td></tr></table></figure>
<p>åœ¨åŸºç±»ä¸­æ·»åŠ å¦‚ä¸Šä»£ç ï¼ŒåŸºæœ¬å¯ä»¥ç”¨æœ€å°çš„æ”¹åŠ¨è¾¾åˆ°ä½¿ç”¨Toolbarçš„ç›®çš„ã€‚ä½†æ˜¯ï¼Œè¿™æ ·ä¹Ÿå­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯ä¼šä½¿æˆ‘ä»¬çš„æ¯ä¸ªActivityçš„å¸ƒå±€å±‚æ¬¡å¤šäº†ä¸€å±‚ã€‚</p>
<p>å¦‚æœæœ‰æ›´å¥½çš„æ€è·¯ï¼Œæ¬¢è¿åˆ†äº«ï½ï½</p>
<p><img src="https://raw.githubusercontent.com/ttdevs/ttdevs.github.io/common/images/logo.png" alt="Create by ttdevs"></p>
]]></content>
      
        <categories>
            
            <category> æŠ€æœ¯ </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Android </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[ã€ŒAndroidã€*ä¸åŒContextåŒºåˆ«]]></title>
      <url>/1970/01/01/%5BAndroid%5D%E4%B8%8D%E5%90%8CContext%E5%8C%BA%E5%88%AB/</url>
      <content type="html"><![CDATA[<p>ä»£ç ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">AlertDialog dialog = <span class="keyword">new</span> AlertDialog</div><div class="line">    .Builder(context)</div><div class="line">    .setTitle(title)</div><div class="line">    .setCancelable(<span class="keyword">false</span>)</div><div class="line">    .setPositiveButton(<span class="string">"ç¡®å®š"</span>, listener)</div><div class="line">    .create();</div><div class="line">dialog.show();</div></pre></td></tr></table></figure>
<p>é”™è¯¯ä¿¡æ¯ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">android.view.WindowManager$BadTokenException: Unable to add window -- token <span class="keyword">null</span> is not <span class="keyword">for</span> an </div><div class="line">	at android.view.ViewRootImpl.setView(ViewRootImpl.java:<span class="number">589</span>)</div><div class="line">	at android.view.WindowManagerImpl.addView(WindowManagerImpl.java:<span class="number">326</span>)</div><div class="line">	at android.view.WindowManagerImpl.addView(WindowManagerImpl.java:<span class="number">224</span>)</div><div class="line">	at android.view.WindowManagerImpl$CompatModeWrapper.addView(WindowManagerImpl.java:<span class="number">149</span>)</div><div class="line">	at android.app.Dialog.show(Dialog.java:<span class="number">293</span>)</div><div class="line">	at com.ttdevs.easysecuritysmartbar.StartHandler.handleMessage(StartHandler.java:<span class="number">39</span>)</div><div class="line">	at android.os.Handler.dispatchMessage(Handler.java:<span class="number">99</span>)</div><div class="line">	at android.os.Looper.loop(Looper.java:<span class="number">137</span>)</div><div class="line">	at android.app.ActivityThread.main(ActivityThread.java:<span class="number">4866</span>)</div><div class="line">	at java.lang.reflect.Method.invokeNative(Native Method)</div><div class="line">	at java.lang.reflect.Method.invoke(Method.java:<span class="number">511</span>)</div><div class="line">	at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:<span class="number">786</span>)</div><div class="line">	at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:<span class="number">553</span>)</div><div class="line">	at dalvik.system.NativeStart.main(Native Method)</div></pre></td></tr></table></figure>
<p>å…¶ä¸­contextæ˜¯é€š <code>getApplicationContext()</code> è·å–çš„ï¼Œå°†å…¶æ¢æˆ <code>Activity</code> é—®é¢˜è§£å†³ã€‚</p>
<h2 id="0xFF-å‚è€ƒ"><a href="/1970/01/01/[Android]ä¸åŒContextåŒºåˆ«/#0xFF-å‚è€ƒ" class="headerlink" title="0xFF å‚è€ƒ"></a>0xFF å‚è€ƒ</h2><ol>
<li><a href="http://blog.csdn.net/lmj623565791/article/details/40481055" target="_blank" rel="external">http://blog.csdn.net/lmj623565791/article/details/40481055</a></li>
</ol>
]]></content>
      
        <categories>
            
            <category> æŠ€æœ¯ </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Android </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[ã€ŒAndroidã€LayoutInflateé‡åˆ°çš„å‘]]></title>
      <url>/1970/01/01/%5BAndroid%5DLayoutInflate%E9%81%87%E5%88%B0%E7%9A%84%E5%9D%91/</url>
      <content type="html"><![CDATA[<h2 id="0x01-é—®é¢˜"><a href="/1970/01/01/[Android]LayoutInflateé‡åˆ°çš„å‘/#0x01-é—®é¢˜" class="headerlink" title="0x01 é—®é¢˜"></a>0x01 é—®é¢˜</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">initVoiceItem</span><span class="params">()</span> </span>&#123;</div><div class="line">    viewMusicList.removeAllViews();</div><div class="line">    </div><div class="line">    <span class="keyword">int</span> localResource = SysPreferences.getAlarmVoiceResource();</div><div class="line">    LayoutInflater inflater = LayoutInflater.from(<span class="keyword">this</span>);</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; VOICE_KEY.length; i++) &#123;</div><div class="line">        View view = inflater.inflate(R.layout.item_voice_name, viewMusicList); <span class="comment">// <span class="doctag">TODO:</span> 2017/2/10</span></div><div class="line">        view.setOnClickListener(mClickListener);</div><div class="line">        ...</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">private</span> <span class="keyword">final</span> View.OnClickListener mClickListener = <span class="keyword">new</span> View.OnClickListener() &#123;</div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span><span class="params">(View v)</span> </span>&#123;</div><div class="line">        <span class="keyword">int</span> size = viewMusicList.getChildCount();</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; size; i++) &#123;</div><div class="line">            View view = viewMusicList.getChildAt(i);</div><div class="line">            ...</div><div class="line">            <span class="keyword">if</span> (v == view) &#123;</div><div class="line">                &#123;...<span class="number">1</span>...&#125;</div><div class="line">            &#125; <span class="keyword">else</span> &#123;</div><div class="line">                &#123;...<span class="number">2</span>...&#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p>æœ‰ä¸Šé¢ä¸€ä¸²ä»£ç ï¼Œä½ èƒ½å‘ç°æœ‰ä»€ä¹ˆé—®é¢˜å—ï¼Ÿ</p>
<p>å—¯å—¯ï¼Œæ˜¯è¿™æ ·çš„ï¼šåªä¼šæ‰§è¡Œä»£ç å—{1}ï¼Œå¹¶æ²¡æœ‰åƒæˆ‘ä»¬æœŸå¾…çš„é‚£æ ·ç‚¹å‡»çš„æ—¶å€™æ‰§è¡Œåˆ°ä»£ç å—{2}ä¸­å»ã€‚æ²¡æœ‰ç»†ç©¶ï¼Œé€šè¿‡ä¸‹é¢çš„ä»£ç ç›´æ¥è·¨è¿‡å»ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">initVoiceItem</span><span class="params">()</span> </span>&#123;</div><div class="line">   viewMusicList.removeAllViews();</div><div class="line">   </div><div class="line">   <span class="keyword">int</span> localResource = SysPreferences.getAlarmVoiceResource();</div><div class="line">   LayoutInflater inflater = LayoutInflater.from(<span class="keyword">this</span>);</div><div class="line">   <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; VOICE_KEY.length; i++) &#123;</div><div class="line">       View view = inflater.inflate(R.layout.item_voice_name, <span class="keyword">null</span>); <span class="comment">// <span class="doctag">TODO:</span> 2017/2/10</span></div><div class="line">       view.setOnClickListener(mClickListener);</div><div class="line">       ...</div><div class="line">       viewMusicList.addView(view);</div><div class="line">   &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>è™½ç„¶ä¸çŸ¥é“ä»€ä¹ˆåŸå› ï¼Œä½†æ˜¯æ‰¾åˆ°è§£å†³åŠæ³•ï¼Œä¸è¿‡è¿˜æ˜¯æŒºæƒ­æ„§çš„Â·Â·Â·Â·Â·Â·</p>
<h2 id="0x02-åˆ†æ"><a href="/1970/01/01/[Android]LayoutInflateé‡åˆ°çš„å‘/#0x02-åˆ†æ" class="headerlink" title="0x02 åˆ†æ"></a>0x02 åˆ†æ</h2><p>å¾ˆå¤šäººå¯èƒ½è·Ÿæˆ‘ä¸€æ ·ï¼Œå¼€å§‹å­¦çš„æ—¶å€™ï¼Œè®°ä½è¯¥æ€ä¹ˆå†™ï¼Œè¿™ä¸ªæ–¹æ³•æ˜¯å¹²å˜›çš„ã€‚ä½†æ˜¯å¾ˆéš¾é¿å…ä¼šè®°é”™æŸä¸ªæ–¹æ³•ï¼Œå°±åƒæˆ‘ä»¬ä¼šå†™é”™æŸä¸ªå­—ä¸€æ ·ï¼Œå½“åˆ«äººçº æ­£çš„æ—¶å€™æ‰çŸ¥é“ï¼Œè¿™ä¸ªå­—è‡ªå·±å·²ç»å†™é”™åå‡ æ´»ç€å‡ åå¹´äº†ã€‚æ¥çœ‹ä¸€ä¸‹ <code>View.inflate()</code> è¿™ä¸ªæ–¹æ³•ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line">* Inflate a new view hierarchy from the specified xml resource. Throws</div><div class="line">* &#123;<span class="doctag">@link</span> InflateException&#125; if there is an error.</div><div class="line">* </div><div class="line">* <span class="doctag">@param</span> resource ID for an XML layout resource to load (e.g.,</div><div class="line">*        &lt;code&gt;R.layout.main_page&lt;/code&gt;)</div><div class="line">* <span class="doctag">@param</span> root Optional view to be the parent of the generated hierarchy.</div><div class="line">* <span class="doctag">@return</span> The root View of the inflated hierarchy. If root was supplied,</div><div class="line">*         this is the root View; otherwise it is the root of the inflated</div><div class="line">*         XML file.</div><div class="line">*/</div><div class="line"><span class="function"><span class="keyword">public</span> View <span class="title">inflate</span><span class="params">(@LayoutRes <span class="keyword">int</span> resource, @Nullable ViewGroup root)</span> </span>&#123;</div><div class="line">   <span class="keyword">return</span> inflate(resource, root, root != <span class="keyword">null</span>);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>å¦‚æœæˆ‘ä»¬ä¼ å…¥äº† <code>root</code> Viewï¼Œé‚£ä¹ˆè¿”å›çš„å°±æ˜¯root Viewï¼Œ å¦‚æœä¸ä¼ ï¼Œåˆ™è¿”å›æ ¹æ®å¸ƒå±€æ–‡ä»¶ç”Ÿæˆçš„ Viewã€‚è€Œæ ¹æ®æˆ‘ä¸Šé¢çš„ä»£ç ï¼Œæ˜¾ç„¶è¢«æˆ‘é”™è¯¯çš„ç†è§£ï¼Œæ— è®ºä¼ ä¸ä¼  <code>root</code> Viewï¼Œè¿”å›çš„éƒ½æ˜¯æ ¹æ®å¸ƒå±€æ–‡ä»¶ç”Ÿæˆçš„ Viewï¼Œè€Œæˆ‘å°±è¿™ä¹ˆç›¸å®‰æ— äº‹çš„ç”¨äº†å¥½å‡ å¹´Â·Â·Â·Â·Â·Â·</p>
<h2 id="0x03-ä½ ä»¥ä¸ºè¿™å°±è¿™æ ·ç»“æŸäº†"><a href="/1970/01/01/[Android]LayoutInflateé‡åˆ°çš„å‘/#0x03-ä½ ä»¥ä¸ºè¿™å°±è¿™æ ·ç»“æŸäº†" class="headerlink" title="0x03 ä½ ä»¥ä¸ºè¿™å°±è¿™æ ·ç»“æŸäº†"></a>0x03 ä½ ä»¥ä¸ºè¿™å°±è¿™æ ·ç»“æŸäº†</h2><p>å¦‚æœä½ æ‰§è¡Œæˆ‘çš„é”™è¯¯ä»£ç ï¼Œä½ ä¼šçœ‹åˆ°ä¸‹é¢è¿™ä¸ªå›¾ï¼š</p>
<p><img src="http://img.blog.csdn.net/20170212223305559?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvdHRkZXZz/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="è¿™é‡Œå†™å›¾ç‰‡æè¿°"></p>
<p>è¿™ä¸ªè¿™ä¸ªå›¾æœ‰ä¸¤ä¸ªä¿¡æ¯ï¼š</p>
<ul>
<li>åé¢å‡ ä¸ªItemæ˜¾ç¤ºçš„åç§°æ˜¯é”™è¯¯çš„</li>
<li>ç‚¹å‡»æŸä¸ªItemï¼Œå…¶ä»–å‡ ä¸ªItemçš„checkboxä¹Ÿè¢«é€‰æ‹©</li>
</ul>
<p>æˆ‘ä»¬æŒ‰ç…§é”™è¯¯çš„ä»£ç æ‰§è¡Œçš„é€»è¾‘è¿›è¡Œåˆ†æã€‚é¦–å…ˆï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; VOICE_KEY.length; i++) &#123;</div><div class="line">  View view = inflater.inflate(R.layout.item_voice_name, viewMusicList);</div><div class="line">  ...</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>è¿™æ®µä»£ç ä¼šå¾ªç¯å¤šæ¬¡ï¼Œå°†inflateåçš„å¸ƒå±€æ·»åŠ åˆ°viewMusicListï¼Œè¿™æ ·viewMusicListä¸‹é¢å°±æœ‰å¤šä¸ª <code>item_voice_name</code> å› æ­¤æœ€ç»ˆç»™æˆ‘ä»¬å±•ç°çš„ç»“æœå°±æ˜¯çœ‹åˆ°æœ‰å¤šä¸ªItemã€‚</p>
<p>å¯¹äºç¬¬ä¸€ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬éœ€è¦ä» <code>view.findViewById()</code> è¯´èµ·ï¼Œä»Viewä¸­ä½ ä¼šå‘ç°è¿™ä¸¤æ®µä»£ç ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line">* Look for a child view with the given id.  If this view has the given</div><div class="line">* id, return this view.</div><div class="line">*</div><div class="line">* <span class="doctag">@param</span> id The id to search for.</div><div class="line">* <span class="doctag">@return</span> The view that has the given id in the hierarchy or null</div><div class="line">*/</div><div class="line"><span class="meta">@Nullable</span></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">final</span> View <span class="title">findViewById</span><span class="params">(@IdRes <span class="keyword">int</span> id)</span> </span>&#123;</div><div class="line">   <span class="keyword">if</span> (id &lt; <span class="number">0</span>) &#123;</div><div class="line">       <span class="keyword">return</span> <span class="keyword">null</span>;</div><div class="line">   &#125;</div><div class="line">   <span class="keyword">return</span> findViewTraversal(id);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line">* &#123;<span class="doctag">@hide</span>&#125;</div><div class="line">* <span class="doctag">@param</span> id the id of the view to be found</div><div class="line">* <span class="doctag">@return</span> the view of the specified id, null if cannot be found</div><div class="line">*/</div><div class="line"><span class="function"><span class="keyword">protected</span> View <span class="title">findViewTraversal</span><span class="params">(@IdRes <span class="keyword">int</span> id)</span> </span>&#123;</div><div class="line">   <span class="keyword">if</span> (id == mID) &#123;</div><div class="line">       <span class="keyword">return</span> <span class="keyword">this</span>;</div><div class="line">   &#125;</div><div class="line">   <span class="keyword">return</span> <span class="keyword">null</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>æ˜¯ä¸æ˜¯å¤ªç®€å•ï¼Œæ ¹æœ¬æ²¡æ‰¾åˆ°æˆ‘ä»¬æœŸå¾…çš„é€»è¾‘â€”â€”ViewGroupä¸­æ€ä¹ˆå¤„ç†ï¼Œç»†å¿ƒçš„ä½ ä¼šå‘ç°ViewGroupé‡å†™äº† <code>findViewTraversal()</code> æ–¹æ³•ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@Override</span></div><div class="line"><span class="function"><span class="keyword">protected</span> View <span class="title">findViewTraversal</span><span class="params">(@IdRes <span class="keyword">int</span> id)</span> </span>&#123;</div><div class="line">   <span class="keyword">if</span> (id == mID) &#123;</div><div class="line">       <span class="keyword">return</span> <span class="keyword">this</span>;</div><div class="line">   &#125;</div><div class="line"></div><div class="line">   <span class="keyword">final</span> View[] where = mChildren;</div><div class="line">   <span class="keyword">final</span> <span class="keyword">int</span> len = mChildrenCount;</div><div class="line"></div><div class="line">   <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; i++) &#123;</div><div class="line">       View v = where[i];</div><div class="line"></div><div class="line">       <span class="keyword">if</span> ((v.mPrivateFlags &amp; PFLAG_IS_ROOT_NAMESPACE) == <span class="number">0</span>) &#123;</div><div class="line">           v = v.findViewById(id);</div><div class="line"></div><div class="line">           <span class="keyword">if</span> (v != <span class="keyword">null</span>) &#123;</div><div class="line">               <span class="keyword">return</span> v;</div><div class="line">           &#125;</div><div class="line">       &#125;</div><div class="line">   &#125;</div><div class="line"></div><div class="line">   <span class="keyword">return</span> <span class="keyword">null</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä»è¿™æ®µä»£ç å¯ä»¥çœ‹å‡ºï¼Œåœ¨ViewGroupä¸­æ ¹æ®IDæŸ¥æ‰¾ï¼Œæ‰¾åˆ°å°±è¿”å›ï¼Œè€Œæ‰¾åˆ°çš„æ°¸è¿œæ˜¯æœ€å‰é¢çš„Viewã€‚è¿™å°±è§£é‡Šäº†ä¸ºä»€ä¹ˆç¬¬ä¸€ä¸ªItemå’Œå…¶ä»–çš„ä¸åŒäº†ã€‚</p>
<p>ï¼ˆå¯¹äºç‚¹å‡»æŸä¸ªItemï¼Œå…¶ä»–Itemä¹Ÿå‡ºç°æ³¢çº¹æ•ˆæœï¼ŒçŒœæµ‹å¯èƒ½æ˜¯å› ä¸ºæ³¢çº¹æ•ˆæœæ˜¯æ ¹æ®IDæ¥å®ç°çš„ã€‚TODO ï¼‰</p>
<h2 id="0x04-æ€»ç»“"><a href="/1970/01/01/[Android]LayoutInflateé‡åˆ°çš„å‘/#0x04-æ€»ç»“" class="headerlink" title="0x04 æ€»ç»“"></a>0x04 æ€»ç»“</h2><p>ä¸Šé¢é‡åˆ°çš„View inflateæ˜¯æˆ‘ä¸ªäººé‡åˆ°çš„é—®é¢˜ï¼Œä¸»è¦æ˜¯å› ä¸ºå¯¹åŸºç¡€çŸ¥è¯†æŒæ¡æœ‰é—®é¢˜ã€‚å¦å¤–åœ¨ä½¿ç”¨inflateçš„æ—¶å€™ï¼Œå¯èƒ½è¿˜ä¼šé‡åˆ°LayoutParamè®¾ç½®æ— æ•ˆçš„é—®é¢˜ï¼Œè¿™ä¸ªå¯ä»¥é€šè¿‡å¥—ä¸€ä¸ªViewçš„æ–¹å¼è§£å†³ï¼Œä»…æ­¤è®°å½•ã€‚ </p>
<p><img src="https://raw.githubusercontent.com/ttdevs/ttdevs.github.io/common/images/logo.png" alt="Create by ttdevs"></p>
]]></content>
      
        <categories>
            
            <category> æŠ€æœ¯ </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Android </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[ã€ŒAndroidã€ä»æµè§ˆå™¨ä¸­æ‰“å¼€æˆ‘ä»¬çš„åº”ç”¨]]></title>
      <url>/1970/01/01/%5BAndroid%5D%E4%BB%8E%E6%B5%8F%E8%A7%88%E5%99%A8%E4%B8%AD%E6%89%93%E5%BC%80%E6%88%91%E4%BB%AC%E7%9A%84%E5%BA%94%E7%94%A8/</url>
      <content type="html"><![CDATA[<h2 id="0x01-éœ€æ±‚"><a href="/1970/01/01/[Android]ä»æµè§ˆå™¨ä¸­æ‰“å¼€æˆ‘ä»¬çš„åº”ç”¨/#0x01-éœ€æ±‚" class="headerlink" title="0x01 éœ€æ±‚"></a>0x01 éœ€æ±‚</h2><p>æœ‰æ—¶å€™ä½ ä¼šå‘ç°ï¼Œç”¨Androidç³»ç»Ÿè‡ªå¸¦çš„æµè§ˆå™¨ï¼ˆchromeï¼‰æ‰“å¼€ä¸€ä¸ªwebé¡µé¢ï¼Œå¦‚æœå®‰è£…äº†ç›¸åº”çš„Appï¼Œå°±ä¼šè‡ªåŠ¨æ‰“å¼€è¿™ä¸ªAppå¹¶è¿›å…¥å…·ä½“çš„ç•Œé¢ä¸­ï¼Œæ¯”å¦‚æ‰‹æœºä¸Šæ‰“å¼€ï¼š</p>
<p><code>https://www.zhihu.com/openinapp_instruction?app-id=432274380&amp;app-argument=zhihu://questions/24122524</code></p>
<p>å¦‚æœæˆ‘ä»¬å®‰è£…äº†çŸ¥ä¹æ‰‹æœºå®¢æˆ·ç«¯ï¼Œè¿™ä¸ªæ—¶å€™ä¼šè‡ªåŠ¨æ‰“å¼€çŸ¥ä¹æ‰‹æœºå®¢æˆ·ç«¯ï¼Œå¹¶ä¸”è¿›å…¥é—®é¢˜å±•ç¤ºç•Œé¢ã€‚è¿˜æ¯”å¦‚ç½‘æ˜“äº‘éŸ³ä¹ï¼Œä»Šæ—¥å¤´æ¡ç­‰ç­‰Appéƒ½æ˜¯æ”¯æŒè¿™ä¸ªåŠŸèƒ½çš„ã€‚ä¹‹å‰æˆ‘ä»¬è‡ªå®¶Appçš„åˆ†äº«éƒ½æ˜¯æ‰“å¼€ä¸€ä¸ªAppä»‹ç»çš„ç•Œé¢ï¼Œå³ä½¿å®‰è£…äº†æ‰‹æœºå®¢æˆ·ç«¯ï¼Œä¹Ÿä¸ä¼šè‡ªåŠ¨æ‰“å¼€æ‰‹æœºå®¢æˆ·ç«¯ã€‚ä¸ºäº†è¿½æ±‚æ›´å¥½çš„ä½“éªŒï¼Œæˆ‘ä»¬éœ€è¦å®ç°è¿™ä¸ªåŠŸèƒ½ã€‚</p>
<h2 id="0x01-Chromeæµè§ˆå™¨"><a href="/1970/01/01/[Android]ä»æµè§ˆå™¨ä¸­æ‰“å¼€æˆ‘ä»¬çš„åº”ç”¨/#0x01-Chromeæµè§ˆå™¨" class="headerlink" title="0x01 Chromeæµè§ˆå™¨"></a>0x01 Chromeæµè§ˆå™¨</h2><p>ç ”ç©¶è¿™ä¸ªåŠŸèƒ½ï¼Œè¿˜æ˜¯æŸ¥é˜…äº†ä¸å°‘èµ„æ–™ï¼Œæ¯”å¦‚ app linkã€deep linkã€chrome browserç­‰ç­‰ï¼Œå¦‚æœç´§ç´§æ˜¯å®ç°ä¸Šé¢ä»‹ç»çš„åŠŸèƒ½ï¼Œè¿˜æ˜¯ so easyçš„ï¼Œä»…ä»…éœ€è¦äº†è§£ <code>Chrome</code> æµè§ˆå™¨ åˆ›å»º Intent çš„æ–¹æ³•å³å¯ã€‚</p>
<p>Chromeæ„é€ ä¸€ä¸ª Intent çš„åŸºæœ¬è¯­æ³•å¦‚ä¸‹ï¼š</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">intent:</div><div class="line">   HOST/URI-path // Optional host </div><div class="line">   #Intent; </div><div class="line">      package=[string]; </div><div class="line">      action=[string]; </div><div class="line">      category=[string]; </div><div class="line">      component=[string]; </div><div class="line">      scheme=[string]; </div><div class="line">   end;</div></pre></td></tr></table></figure>
<p>æ ¹æ®ä¸Šé¢çš„è¯­æ³•ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªdemoï¼š</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">intent:</div><div class="line">   //article/51348656</div><div class="line">   #Intent; </div><div class="line">      package=com.ttdevs.android; </div><div class="line">      scheme=ttdevs; </div><div class="line">   end;</div></pre></td></tr></table></figure>
<p>å¯ä»¥ä½¿ç”¨ä¸‹é¢çš„ html ä»£ç è§¦å‘è¿™ä¸ªäº‹ä»¶ï¼š</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"intent://article/51348656/#Intent;scheme=ttdevs;package=com.ttdevs.android;end"</span>&gt;</span>ttdevs<span class="tag">&lt;/<span class="name">a</span>&gt;</span></div></pre></td></tr></table></figure>
<p>å¦å¤–è¿˜æœ‰ä¸ªå‚æ•°ï¼š</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">S.browser_fallback_url=[encoded_full_url]</div></pre></td></tr></table></figure>
<p>ä»‹ç»å¦‚ä¸‹ï¼ˆä¸è¿‡æˆ‘æ²¡ææ˜ç™½ï¼‰ï¼š</p>
<blockquote>
<p>When an intent could not be resolved, or an external application could not be launched, then the user will be redirected to the fallback URL if it was given.<br>Some example cases where Chrome does not launch an external application are as follows:</p>
<ul>
<li>The intent could not be resolved, i.e., no app can handle the intent.</li>
<li>JavaScript timer tried to open an application without user gesture.<br>Note that S.<name> is a way to define string extras. S.browser_fallback_url was chosen for backward compatibility, but the target app wonâ€™t see browser_fallback_url value as Chrome removes it.</name></li>
</ul>
</blockquote>
<h2 id="0x02-Appå†…å¤„ç†æµè§ˆå™¨å‘æ¥çš„Intent"><a href="/1970/01/01/[Android]ä»æµè§ˆå™¨ä¸­æ‰“å¼€æˆ‘ä»¬çš„åº”ç”¨/#0x02-Appå†…å¤„ç†æµè§ˆå™¨å‘æ¥çš„Intent" class="headerlink" title="0x02 Appå†…å¤„ç†æµè§ˆå™¨å‘æ¥çš„Intent"></a>0x02 Appå†…å¤„ç†æµè§ˆå™¨å‘æ¥çš„Intent</h2><p>é€šè¿‡ä¸Šé¢çš„ä»‹ç»ï¼Œå¦‚æœæˆ‘ä»¬ç‚¹å‡»é“¾æ¥ï¼Œå°±ä¼šè§¦å‘ä¸€ä¸ª Intentï¼Œæœ‰äº†Intentï¼Œæˆ‘ä»¬è¿˜éœ€è¦æ¥å¤„ç†å®ƒã€‚åœ¨ <code>AndroidManifest.xml</code> ä¸­ç›¸åº”çš„ Activity ä¸­çš„é…ç½®ä¸­æ·»åŠ å¦‚ä¸‹filterï¼š</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">intent-filter</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">action</span> <span class="attr">android:name</span>=<span class="string">"android.intent.action.VIEW"</span>/&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">category</span> <span class="attr">android:name</span>=<span class="string">"android.intent.category.DEFAULT"</span>/&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">category</span> <span class="attr">android:name</span>=<span class="string">"android.intent.category.BROWSABLE"</span>/&gt;</span></div><div class="line"></div><div class="line">    <span class="tag">&lt;<span class="name">data</span> <span class="attr">android:host</span>=<span class="string">"article"</span> <span class="attr">android:pathPattern</span>=<span class="string">"/.*"</span> <span class="attr">android:scheme</span>=<span class="string">"ttdevs"</span>/&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">intent-filter</span>&gt;</span></div></pre></td></tr></table></figure>
<p>åŒæ—¶åœ¨Activityä¸­å¤„ç†Intentï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RouterActivity</span> <span class="keyword">extends</span> <span class="title">BaseActivity</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</div><div class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState);</div><div class="line">        setContentView(R.layout.activity_router);</div><div class="line"></div><div class="line">        handleIntent(getIntent());</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">handleIntent</span><span class="params">(Intent intent)</span> </span>&#123;</div><div class="line">        String action = intent.getAction();</div><div class="line">        String data = intent.getDataString();</div><div class="line">        LogUtils.debug(action);</div><div class="line">        LogUtils.debug(data);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>è¿è¡Œä¸Šé¢çš„ä»£ç ï¼ŒåŒæ—¶ç”¨ç³»ç»Ÿæµè§ˆå™¨æ‰“å¼€ä¸Šé¢çš„htmlï¼Œç‚¹å‡»é“¾æ¥ï¼Œå³å¯è°ƒèµ·æˆ‘ä»¬çš„appã€‚æˆ–è€…ä¹Ÿå¯ä»¥é€šè¿‡ä¸‹é¢çš„adbå‘½ä»¤è§¦å‘ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">adb shell am start \</div><div class="line">-a android.intent.action.VIEW \</div><div class="line">-c android.intent.category.BROWSABLE \</div><div class="line">-d &quot;ttdevs://article/12345&quot; com.ttdevs.android</div></pre></td></tr></table></figure>
<p>åœ¨æˆ‘çš„è®¾å¤‡ï¼ˆé­…æ—MX4 Proï¼‰ä¸Šï¼Œå¦‚æœæ²¡æœ‰å®‰è£…å¤„ç†è¿™ä¸ª Intent çš„Appï¼Œåˆ™ä¼šæ‰“å¼€ç³»ç»Ÿè‡ªå¸¦çš„åº”ç”¨å¸‚åœºã€‚</p>
<p>å¯¹äºä¸€ä¸ªæä¾›æŸ¥è¯¢é£Ÿç‰©æ•°æ®çš„Appï¼Œå¦‚æœæˆ‘ä»¬åˆ†äº«å‡ºå»çš„é£Ÿç‰©ä¿¡æ¯å¸¦ä¸Šäº†ç›¸å…³çš„å‚æ•°ï¼Œåœ¨ç”¨æˆ·ç‚¹å‡»åˆ†äº«é“¾æ¥æ—¶ï¼Œå¦‚æœå®‰è£…äº†æˆ‘ä»¬çš„Appåˆ™å¯ä»¥è·³åˆ°Appä¸­å±•ç¤ºé£Ÿç‰©çš„ç•Œé¢ï¼Œå¦‚æœæ²¡æœ‰å®‰è£…ï¼Œåˆ™ä¼šè·³åˆ°åº”ç”¨å¸‚åœºä¸‹è½½ï¼Œå¾ˆå¥½çš„é€»è¾‘ï½ï½</p>
<h2 id="0xFF-å‚è€ƒ"><a href="/1970/01/01/[Android]ä»æµè§ˆå™¨ä¸­æ‰“å¼€æˆ‘ä»¬çš„åº”ç”¨/#0xFF-å‚è€ƒ" class="headerlink" title="0xFF å‚è€ƒ"></a>0xFF å‚è€ƒ</h2><ul>
<li><a href="https://developer.chrome.com/multidevice/android/intents" target="_blank" rel="external">https://developer.chrome.com/multidevice/android/intents</a></li>
</ul>
<p><img src="https://raw.githubusercontent.com/ttdevs/ttdevs.github.io/common/images/logo.png" alt="Create by ttdevs"></p>
]]></content>
      
        <categories>
            
            <category> æŠ€æœ¯ </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Android </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[ã€ŒAndroidã€ä½¿ç”¨VideoViewå’ŒMediaControllerè¿›è¡Œè§†é¢‘æ’­æ”¾]]></title>
      <url>/1970/01/01/%5BAndroid%5D%E4%BD%BF%E7%94%A8VideoView%E5%92%8CMediaController%E8%BF%9B%E8%A1%8C%E8%A7%86%E9%A2%91%E6%92%AD%E6%94%BE/</url>
      <content type="html"><![CDATA[<p><img src="http://img.blog.csdn.net/20131121171540296?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvdHRkZXZz/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="">  </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"> * è§†é¢‘æ’­æ”¾çš„activity&lt;br&gt;</div><div class="line"> * ä½¿ç”¨æ–¹æ³•ï¼š&lt;br&gt;</div><div class="line"> * 1ã€AndroidManifest.xmlä¸­æ·»åŠ æ­¤activity&lt;br&gt;</div><div class="line"> * 2ã€Intentä¸­å­˜å…¥å¾…æ’­æ”¾è§†é¢‘çš„URLï¼Œæ”¯æŒæœ¬åœ°å’Œç½‘ç»œ&lt;br&gt;</div><div class="line"> * 3ã€å¯åŠ¨è¿™ä¸ªactivity&lt;br&gt;</div><div class="line"> * &lt;br&gt;</div><div class="line"> * exampleï¼š&lt;br&gt;</div><div class="line"> * String url = "play url";&lt;br&gt;</div><div class="line"> * Intent intent = new Intent();&lt;br&gt;</div><div class="line"> * intent.setClass(this, VideoPlayActivity.class);&lt;br&gt;</div><div class="line"> * intent.putExtra(VideoPlayActivity.KEY_URL, url);&lt;br&gt;</div><div class="line"> * startActivity(intent);&lt;br&gt;</div><div class="line"> *</div><div class="line"> * <span class="doctag">@author</span> ttworking</div><div class="line"> */</div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">VideoPlayActivity</span> <span class="keyword">extends</span> <span class="title">Activity</span> <span class="keyword">implements</span> <span class="title">OnPreparedListener</span>, <span class="title">OnErrorListener</span> </span>&#123;</div><div class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String KEY_URL = <span class="string">"view_url"</span>;</div><div class="line"></div><div class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String TAG = <span class="string">"VideoPlayActivity"</span>;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> PLAY_RETURN = <span class="number">2</span> * <span class="number">1000</span>; <span class="comment">// 2 seconds</span></div><div class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String KEY_PLAY_POSITON = <span class="string">"paly_position"</span>;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String TOAST_ERROR_URL = <span class="string">"Paly url is null, please check parameter:"</span> + KEY_URL;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String TOAST_ERROR_PLAY = <span class="string">"Paly error, please check url exist!"</span>;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String DIALOG_TITILE = <span class="string">"å¥‹åŠ›åŠ è½½ä¸­ï¼Œè¯·ç¨å..."</span>;</div><div class="line"></div><div class="line">    <span class="keyword">private</span> <span class="keyword">static</span> String url;</div><div class="line"></div><div class="line">    <span class="keyword">private</span> ProgressDialog progressDialog;</div><div class="line">    <span class="keyword">private</span> MediaController mc;</div><div class="line">    <span class="keyword">private</span> VideoView videoView;</div><div class="line">    <span class="keyword">private</span> LinearLayout llMain;</div><div class="line">    <span class="keyword">private</span> LayoutParams params = <span class="keyword">new</span> LayoutParams(LayoutParams.MATCH_PARENT, LayoutParams.MATCH_PARENT);</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</div><div class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState);</div><div class="line"></div><div class="line">        url = getIntent().getStringExtra(KEY_URL);</div><div class="line">        <span class="keyword">if</span> (url == <span class="keyword">null</span> &amp;&amp; savedInstanceState != <span class="keyword">null</span>) &#123;</div><div class="line">            url = savedInstanceState.getString(KEY_URL);</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="keyword">if</span> (url == <span class="keyword">null</span>) &#123;</div><div class="line">            Toast.makeText(getApplicationContext(), TOAST_ERROR_URL, Toast.LENGTH_LONG).show();</div><div class="line">            finish();</div><div class="line">            <span class="keyword">return</span>;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        setTheme(android.R.style.Theme_NoTitleBar_Fullscreen);</div><div class="line"></div><div class="line">        videoView = <span class="keyword">new</span> VideoView(<span class="keyword">this</span>);</div><div class="line">        videoView.setVideoURI(Uri.parse(url));</div><div class="line">        videoView.requestFocus();</div><div class="line">        videoView.setOnPreparedListener(<span class="keyword">this</span>);</div><div class="line">        videoView.setOnErrorListener(<span class="keyword">this</span>);</div><div class="line"></div><div class="line">        mc = <span class="keyword">new</span> MediaController(<span class="keyword">this</span>);</div><div class="line">        mc.setAnchorView(videoView);</div><div class="line">        mc.setKeepScreenOn(<span class="keyword">true</span>);</div><div class="line"></div><div class="line">        videoView.setMediaController(mc);</div><div class="line"></div><div class="line">        llMain = <span class="keyword">new</span> LinearLayout(<span class="keyword">this</span>);</div><div class="line">        llMain.setGravity(Gravity.CENTER_VERTICAL);</div><div class="line">        llMain.setOrientation(LinearLayout.VERTICAL);</div><div class="line">        llMain.setLayoutParams(params);</div><div class="line"></div><div class="line">        llMain.addView(videoView, params);</div><div class="line">        setContentView(llMain);</div><div class="line"></div><div class="line">        initDialog();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onSaveInstanceState</span><span class="params">(Bundle outState)</span> </span>&#123;</div><div class="line">        <span class="keyword">super</span>.onSaveInstanceState(outState);</div><div class="line"></div><div class="line">        <span class="keyword">int</span> palyPosition = videoView.getCurrentPosition();</div><div class="line">        <span class="keyword">if</span> (palyPosition &gt; PLAY_RETURN) &#123;</div><div class="line">            palyPosition -= PLAY_RETURN;</div><div class="line">        &#125;</div><div class="line">        outState.putInt(KEY_PLAY_POSITON, palyPosition);</div><div class="line">        outState.putString(KEY_URL, url);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onRestoreInstanceState</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</div><div class="line">        <span class="keyword">super</span>.onRestoreInstanceState(savedInstanceState);</div><div class="line"></div><div class="line">        videoView.seekTo(savedInstanceState.getInt(KEY_PLAY_POSITON));</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onPrepared</span><span class="params">(MediaPlayer mp)</span> </span>&#123;</div><div class="line">        progressDialog.cancel();</div><div class="line"></div><div class="line">        videoView.start();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">onError</span><span class="params">(MediaPlayer mp, <span class="keyword">int</span> what, <span class="keyword">int</span> extra)</span> </span>&#123;</div><div class="line">        Log.d(TAG, <span class="string">"onError:"</span> + url);</div><div class="line"></div><div class="line">        Toast.makeText(getApplicationContext(), TOAST_ERROR_PLAY + <span class="string">"\n"</span> + url, Toast.LENGTH_LONG).show();</div><div class="line">        progressDialog.cancel();</div><div class="line">        finish();</div><div class="line"></div><div class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">initDialog</span><span class="params">()</span> </span>&#123;</div><div class="line">        progressDialog = <span class="keyword">new</span> ProgressDialog(<span class="keyword">this</span>);</div><div class="line">        progressDialog.setProgressStyle(ProgressDialog.STYLE_SPINNER);</div><div class="line">        progressDialog.setMessage(DIALOG_TITILE);</div><div class="line">        progressDialog.setCancelable(<span class="keyword">false</span>);</div><div class="line">        progressDialog.show();</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><img src="https://raw.githubusercontent.com/ttdevs/ttdevs.github.io/common/images/logo.png" alt="Create by ttdevs"></p>
]]></content>
      
        <categories>
            
            <category> æŠ€æœ¯ </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Android </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[ã€ŒAndroidã€ä»¿è”ç³»äººåˆ—è¡¨ä¸Šçš„å­—æ¯ç´¢å¼•]]></title>
      <url>/1970/01/01/%5BAndroid%5D%E4%BB%BF%E8%81%94%E7%B3%BB%E4%BA%BA%E5%88%97%E8%A1%A8%E4%B8%8A%E7%9A%84%E5%AD%97%E6%AF%8D%E7%B4%A2%E5%BC%95/</url>
      <content type="html"><![CDATA[<p>è¿™ä¸ªå°åŠŸèƒ½githubæœ‰å¾ˆå¤šã€‚ä¸åŒçš„åº”ç”¨éœ€æ±‚ä¼šæœ‰å°‘è®¸å·®åˆ«ï¼Œæ¯”å¦‚listviewæ»‘åŠ¨æ—¶å­—æ¯æ˜¯ä¸æ˜¯è·Ÿéšæ»‘åŠ¨ï¼›æ‰‹åŠ¨ç‚¹å‡»å­—æ¯æ˜¯ä¸æ˜¯åœ¨å±å¹•ä¸­é—´æ˜¾ç¤ºä¸€ä¸ªæç¤ºï¼›ç‚¹å‡»æ—¶ç´¢å¼•çš„èƒŒæ™¯æ˜¾ç¤ºå‡ºæ¥ï¼Œç¦»å¼€åèƒŒæ™¯æ¶ˆå¤±ç­‰ç­‰ï¼Œå½“ç„¶è¿™äº›éƒ½æ˜¯ç»†èŠ‚é—®é¢˜ã€‚å®ç°æ€è·¯ä¸Šä¹Ÿå¯ä»¥æœ‰å¤šç§ï¼Œæ¯”å¦‚è‡ªå·±å»drawæ¯ä¸ªå­—æ¯ï¼Œç„¶åå¤„ç†æ»‘åŠ¨ã€å€ŸåŠ©TextViewæ¥å±•ç¤ºå­—æ¯åˆ—è¡¨ç­‰ã€‚çœ‹äº†å‡ ä¸ªdemoï¼Œæ„Ÿè§‰å’Œè‡ªå·±çš„éœ€æ±‚æœ‰äº›å·®åˆ«ï¼Œè€Œä¸”è¿™äº›demoä¸ºäº†å®ç°â€å¤§è€Œå…¨â€æœ‰äº›å¤šä½™çš„ä¸œè¥¿ï¼Œå› æ­¤å†³å®šè‡ªå·±å†™ä¸ªã€‚</p>
<h2 id="0x01-åˆ†æ"><a href="/1970/01/01/[Android]ä»¿è”ç³»äººåˆ—è¡¨ä¸Šçš„å­—æ¯ç´¢å¼•/#0x01-åˆ†æ" class="headerlink" title="0x01 åˆ†æ"></a>0x01 åˆ†æ</h2><p>æˆ‘ä»¬çš„éœ€æ±‚æ˜¯è¿™æ ·çš„ï¼šä¸­æ–‡å‚ä¸ç´¢å¼•ï¼Œå­—æ¯æˆ–è€…å…¶ä»–å¼€å¤´çš„itemä¸å‚ä¸ç´¢å¼•ï¼Œç›´æ¥æ”¾åˆ°ç¬¬ä¸€ä¸ªâ€œ#â€é‡Œï¼›ç‚¹å‡»å­—æ¯ç´¢å¼•å…¶è¢«ç‚¹å‡»å­—æ¯åˆ—è¡¨é¢œè‰²è·Ÿéšå˜åŒ–ï¼›æ‰‹åŠ¨æ»‘åŠ¨listviewå­—æ¯ç´¢å¼•çš„å­—æ¯é¢œè‰²ä¹Ÿè·Ÿéšå˜åŒ–ï¼›è‡ªå·±é¡ºæ‰‹åŠ äº†ä¸ªç‚¹å‡»æŸä¸ªå­—æ¯å¼¹å‡ºæç¤ºçš„æ¥å£ã€‚æœ€åæ•ˆæœå¦‚ä¸‹å›¾ï¼š</p>
<p><img src="http://img.blog.csdn.net/20140831140659685?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvdHRkZXZz/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt="Letter Index">  </p>
<h2 id="0x02-å®ç°"><a href="/1970/01/01/[Android]ä»¿è”ç³»äººåˆ—è¡¨ä¸Šçš„å­—æ¯ç´¢å¼•/#0x02-å®ç°" class="headerlink" title="0x02 å®ç°"></a>0x02 å®ç°</h2><p>å†³å®šç›´æ¥ä½¿ç”¨å‚ç›´æ–¹å‘çš„LinearLayoutåµŒå¥—TextViewæ¥å±•ç¤ºå­—æ¯åˆ—è¡¨ã€‚æ€è·¯å¦‚ä¸‹ï¼šæ ¹æ®ç´¢å¼•é«˜åº¦ï¼Œå¤§æ¦‚è®¡ç®—æ¯ä¸ªå­—æ¯çš„é«˜åº¦ï¼Œç„¶åæ·»åŠ åˆ°Linearlayoutä¸­ï¼›ç„¶åå¤„ç†Linearlayoutçš„touchäº‹ä»¶ï¼Œæ‹¿åˆ°åæ ‡è®¡ç®—å½“å‰åº”è¯¥ç´¢å¼•å“ªä¸ªã€‚å…¶ä¸­é‡åˆ°çš„ä¸»è¦é—®é¢˜æ˜¯å¯¹TextViewçš„æŠŠæ¡ï¼Œæ¯”å¦‚å®ƒçš„é«˜åº¦å¦‚ä½•è®¡ç®—ï¼Ÿï¼ˆçœŸæ­£å®ç°çš„æ—¶å€™ä½ ä¼šå‘ç°å®ƒæœ‰ä¸ªpaddingTopå’ŒpaddingBottomï¼‰å…¶ä»–çš„æ¯”å¦‚æ»‘åŠ¨é€»è¾‘è¿™äº›è°ƒè¯•ä¸‹å³å¯ï¼Œç›´æ¥ä¸Šä»£ç ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div><div class="line">196</div><div class="line">197</div><div class="line">198</div><div class="line">199</div><div class="line">200</div><div class="line">201</div><div class="line">202</div><div class="line">203</div><div class="line">204</div><div class="line">205</div><div class="line">206</div><div class="line">207</div><div class="line">208</div><div class="line">209</div><div class="line">210</div><div class="line">211</div><div class="line">212</div><div class="line">213</div><div class="line">214</div><div class="line">215</div><div class="line">216</div><div class="line">217</div><div class="line">218</div><div class="line">219</div><div class="line">220</div><div class="line">221</div><div class="line">222</div><div class="line">223</div><div class="line">224</div><div class="line">225</div><div class="line">226</div><div class="line">227</div><div class="line">228</div><div class="line">229</div><div class="line">230</div><div class="line">231</div><div class="line">232</div><div class="line">233</div><div class="line">234</div><div class="line">235</div><div class="line">236</div><div class="line">237</div><div class="line">238</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"> * å³ä¾§å­—æ¯ç´¢å¼•ã€‚å¯ä½œä¸ºä¸€ä¸ªç‹¬ç«‹çš„viewæ’å…¥è‡ªå·±çš„å¸ƒå±€ä¸­&lt;br&gt;</div><div class="line"> * &lt;br&gt;</div><div class="line"> * æè¿°ï¼š&lt;br&gt;</div><div class="line"> * çº¿å‹å¸ƒå±€ä¸­åµŒå¥—ä¸€ä¸ªçº¿å‹å¸ƒå±€ï¼ˆç›®çš„ä¸ºäº†å¢å¤§å¯æ»‘åŠ¨åŒºåŸŸçš„é¢ç§¯ï¼Œè‹¥ä¸è€ƒè™‘æ­¤å¯ä¸ä½¿ç”¨åµŒå¥—ï¼‰ã€‚&lt;br&gt;</div><div class="line"> * æ¯ä¸ªå­—æ¯æ’å…¥å†…åµŒçš„çº¿æ€§å¸ƒå±€ä¸­ï¼Œæ ¹æ®æ§ä»¶çš„é«˜åº¦è®¡ç®—æ¯ä¸ªå­—æ¯çš„å°ºå¯¸ã€‚&lt;br&gt;</div><div class="line"> * &lt;br&gt;</div><div class="line"> * ä½¿ç”¨ï¼š&lt;br&gt;</div><div class="line"> * å°†æ­¤viewæ’å…¥ä½ çš„å¸ƒå±€æ–‡ä»¶ä¸­ï¼Œåˆå§‹åŒ–å®Œæˆä¹‹åè®¾ç½®ä½ çš„ListViewå’Œç´¢å¼•ç”¨çš„æ•°æ®æº(éœ€è¦è‡ªå·±ç»„ç»‡æ’åºæ•°æ®æº)å³å¯ã€‚&lt;br&gt;</div><div class="line"> * &lt;br&gt;</div><div class="line"> * æ•°æ®æºçš„ç»„ç»‡ï¼šè‹¥æŸé¡¹ä¸å‚ä¸æ’åºåˆ™æ•°æ®æºä¸­è®¾ç½®ä¸º'0'æˆ–å…¶ä»–å°äº'A'çš„ASCIIå­—ç¬¦ï¼Œå†…éƒ¨ä¼šå°†æ‰€æœ‰å­—ç¬¦è½¬æ¢æˆå¤§å†™ï¼Œæ‰€ä»¥åŠ¡å¿…åœ¨å¤–éƒ¨åšå¥½æ’åºã€‚&lt;br&gt;</div><div class="line"> * &lt;br&gt;</div><div class="line"> * å»ºè®®ï¼šè‹¥ä½ çš„æ•°æ®ä¸­åŒ…æ‹¬ASCIIç ä¸ºa0ã€20çš„å­—ç¬¦ï¼Œå»ºè®®å‰”é™¤ï¼Œå¦‚ï¼š&lt;br&gt;</div><div class="line"> * str.replace('Â ', ' '); // a0-&gt;20 str.replaceAll(" ", "");&lt;br&gt;</div><div class="line"> * &lt;br&gt;</div><div class="line"> * å¦‚æœä½ å¤„ç†çš„æ˜¯ä¸­æ–‡ï¼Œå¯ä½¿ç”¨libsä¸­çš„pinyin4jå¤„ç†</div><div class="line"> *</div><div class="line"> * <span class="doctag">@author</span> ttdevs 2014-07-31</div><div class="line"> */</div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ListViewLetterIndicator</span> <span class="keyword">extends</span> <span class="title">LinearLayout</span> <span class="keyword">implements</span> <span class="title">OnScrollListener</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String INDICATOR = <span class="string">"#ABCDEFGHIJKLMNOPQRSTUVWXYZ"</span>;</div><div class="line"></div><div class="line">    <span class="keyword">private</span> LinearLayout llMain;</div><div class="line"></div><div class="line">    <span class="keyword">private</span> ListView mListView; <span class="comment">// ListView</span></div><div class="line">    <span class="keyword">private</span> List&lt;String&gt; mData; <span class="comment">// æ•°æ®æº</span></div><div class="line">    <span class="keyword">private</span> TextView tvAlert; <span class="comment">// æ˜¾ç¤ºå½“å‰çš„å­—æ¯</span></div><div class="line"></div><div class="line">    <span class="keyword">private</span> <span class="keyword">int</span> mIndex; <span class="comment">// å½“å‰æ‰€å¤„çš„indicatorä½ç½®</span></div><div class="line">    <span class="keyword">private</span> <span class="keyword">boolean</span> scrollable = <span class="keyword">true</span>; <span class="comment">//</span></div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ListViewLetterIndicator</span><span class="params">(Context context)</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>(context, <span class="keyword">null</span>);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ListViewLetterIndicator</span><span class="params">(Context context, AttributeSet attrs)</span> </span>&#123;</div><div class="line">        <span class="keyword">super</span>(context, attrs);</div><div class="line"></div><div class="line">        setOrientation(LinearLayout.VERTICAL);</div><div class="line">        setBackgroundColor(getResources().getColor(R.color.letter_indicator_background));</div><div class="line">        <span class="comment">// setPadding(8, 8, 8, 8);</span></div><div class="line"></div><div class="line">        llMain = <span class="keyword">new</span> LinearLayout(getContext());</div><div class="line">        llMain.setOrientation(LinearLayout.VERTICAL);</div><div class="line">        llMain.setGravity(Gravity.CENTER);</div><div class="line">        <span class="comment">// llMain.setPadding(2, 2, 2, 2);</span></div><div class="line"></div><div class="line">        <span class="keyword">int</span> width = (<span class="keyword">int</span>) getResources().getDimension(R.dimen.letter_indicator_width);</div><div class="line">        addView(llMain, width, LinearLayout.LayoutParams.MATCH_PARENT);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * è®¾ç½®æ•°æ®æº</div><div class="line">     *</div><div class="line">     * <span class="doctag">@param</span> lv   ç»‘å®šçš„ListView</div><div class="line">     * <span class="doctag">@param</span> data æ’åºç”¨çš„æ•°æ®æº</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setData</span><span class="params">(ListView lv, List&lt;String&gt; data)</span> </span>&#123;</div><div class="line">        setData(lv, data, <span class="keyword">null</span>);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * è®¾ç½®æ•°æ®æº</div><div class="line">     *</div><div class="line">     * <span class="doctag">@param</span> lv   ç»‘å®šçš„ListView</div><div class="line">     * <span class="doctag">@param</span> data æ’åºç”¨çš„æ•°æ®æº</div><div class="line">     * <span class="doctag">@param</span> tv   æ˜¾ç¤ºå½“å‰æ‰€å¤„å­—æ¯çš„TextView</div><div class="line">     */</div><div class="line">    <span class="meta">@SuppressLint</span>(<span class="string">"DefaultLocale"</span>)</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setData</span><span class="params">(ListView lv, List&lt;String&gt; data, TextView tv)</span> </span>&#123;</div><div class="line">        mListView = lv;</div><div class="line">        mData = data;</div><div class="line">        tvAlert = tv;</div><div class="line"></div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; mData.size(); i++) &#123;</div><div class="line">            String str = mData.get(i);</div><div class="line">            mData.set(i, str.toUpperCase());</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        mListView.setOnScrollListener(<span class="keyword">this</span>);</div><div class="line">        mIndex = <span class="number">0</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onLayout</span><span class="params">(<span class="keyword">boolean</span> changed, <span class="keyword">int</span> left, <span class="keyword">int</span> top, <span class="keyword">int</span> right, <span class="keyword">int</span> bottom)</span> </span>&#123;</div><div class="line">        <span class="keyword">super</span>.onLayout(changed, left, top, right, bottom);</div><div class="line">        initView();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">initView</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">int</span> childCount = llMain.getChildCount();</div><div class="line">        <span class="keyword">if</span> (childCount == INDICATOR.length()) &#123;</div><div class="line">            <span class="comment">// llMain.invalidate();</span></div><div class="line">            <span class="keyword">return</span>;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="keyword">int</span> height = llMain.getHeight();</div><div class="line">        <span class="keyword">int</span> textHeight = (<span class="keyword">int</span>) Math.floor(height / (INDICATOR.length() + <span class="number">6</span>));</div><div class="line"></div><div class="line">        LinearLayout.LayoutParams llpText = <span class="keyword">new</span> LinearLayout.LayoutParams(LinearLayout.LayoutParams.WRAP_CONTENT,</div><div class="line">                LinearLayout.LayoutParams.WRAP_CONTENT);</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; INDICATOR.length(); i++) &#123;</div><div class="line">            String str = String.valueOf(INDICATOR.charAt(i));</div><div class="line">            TextView tvIndicator = <span class="keyword">new</span> TextView(getContext());</div><div class="line">            tvIndicator.setText(str);</div><div class="line">            tvIndicator.setIncludeFontPadding(<span class="keyword">false</span>);</div><div class="line">            tvIndicator.setTextSize(TypedValue.COMPLEX_UNIT_PX, textHeight);</div><div class="line">            tvIndicator.setTextColor(getResources().getColor(R.color.letter_indicator_text_normal));</div><div class="line">            <span class="comment">// tvIndicator.setPadding(0, -4, 0, -4);</span></div><div class="line">            llMain.addView(tvIndicator, llpText);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@SuppressLint</span>(<span class="string">"DefaultLocale"</span>)</div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">dispatchTouchEvent</span><span class="params">(MotionEvent ev)</span> </span>&#123;</div><div class="line">        <span class="keyword">int</span> action = ev.getAction();</div><div class="line">        <span class="keyword">switch</span> (action) &#123;</div><div class="line">            <span class="keyword">case</span> MotionEvent.ACTION_DOWN:</div><div class="line">            <span class="keyword">case</span> MotionEvent.ACTION_MOVE:</div><div class="line">                scrollable = <span class="keyword">false</span>;</div><div class="line">                <span class="keyword">float</span> y = ev.getY();</div><div class="line">                <span class="keyword">float</span> childY = <span class="number">0</span>;</div><div class="line">                <span class="keyword">int</span> index = <span class="number">0</span>;</div><div class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; INDICATOR.length(); i++) &#123;</div><div class="line">                    TextView view = (TextView) llMain.getChildAt(i);</div><div class="line">                    childY = view.getTop();</div><div class="line">                    <span class="keyword">int</span> height = view.getHeight();</div><div class="line">                    <span class="keyword">if</span> (childY &lt; y &amp;&amp; childY + height &gt; y) &#123;</div><div class="line">                        index = i;</div><div class="line">                        <span class="keyword">break</span>;</div><div class="line">                    &#125;</div><div class="line">                    view = <span class="keyword">null</span>; <span class="comment">// not neccessary</span></div><div class="line">                &#125;</div><div class="line"></div><div class="line">                TextView view = (TextView) llMain.getChildAt(INDICATOR.length() - <span class="number">1</span>);</div><div class="line">                <span class="keyword">if</span> (y &gt; view.getTop()) &#123;</div><div class="line">                    index = INDICATOR.length() - <span class="number">1</span>;</div><div class="line">                &#125;</div><div class="line">                view = <span class="keyword">null</span>;</div><div class="line"></div><div class="line">                changeIndicatorColor(index);</div><div class="line"></div><div class="line">                <span class="keyword">char</span> indexIndicator = INDICATOR.charAt(index);<span class="comment">// A:65, #:23</span></div><div class="line">                <span class="keyword">if</span> (indexIndicator &lt; <span class="string">'A'</span>) &#123;</div><div class="line">                    mListView.setSelection(<span class="number">0</span>);</div><div class="line">                &#125; <span class="keyword">else</span> &#123;</div><div class="line">                    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; mData.size(); i++) &#123;</div><div class="line">                        <span class="keyword">if</span> (mData.get(i).charAt(<span class="number">0</span>) &gt;= indexIndicator) &#123;</div><div class="line">                            mListView.setSelection(i);</div><div class="line">                            <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">                        &#125;</div><div class="line">                    &#125;</div><div class="line">                &#125;</div><div class="line"></div><div class="line">                <span class="keyword">break</span>;</div><div class="line">            <span class="keyword">case</span> MotionEvent.ACTION_UP:</div><div class="line">                postDelayed(<span class="keyword">new</span> Runnable() &#123;</div><div class="line"></div><div class="line">                    <span class="meta">@Override</span></div><div class="line">                    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</div><div class="line">                        scrollable = <span class="keyword">true</span>;</div><div class="line">                    &#125;</div><div class="line">                &#125;, <span class="number">100</span>);</div><div class="line">                showText(<span class="string">""</span>, <span class="keyword">false</span>);</div><div class="line">                <span class="keyword">break</span>;</div><div class="line"></div><div class="line">            <span class="keyword">default</span>:</div><div class="line">                <span class="keyword">break</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onScrollStateChanged</span><span class="params">(AbsListView view, <span class="keyword">int</span> scrollState)</span> </span>&#123;</div><div class="line">        <span class="comment">// invalidate();</span></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@SuppressLint</span>(<span class="string">"DefaultLocale"</span>)</div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onScroll</span><span class="params">(AbsListView view, <span class="keyword">int</span> firstVisibleItem, <span class="keyword">int</span> visibleItemCount, <span class="keyword">int</span> totalItemCount)</span> </span>&#123;</div><div class="line">        <span class="keyword">try</span> &#123;</div><div class="line">            <span class="keyword">if</span> (!scrollable || <span class="keyword">null</span> == mData || mData.size() == <span class="number">0</span>) &#123;</div><div class="line">                <span class="keyword">return</span>;</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">if</span> (<span class="keyword">null</span> != mData) &#123;</div><div class="line">                String str = mData.get(firstVisibleItem);</div><div class="line">                <span class="keyword">char</span> indicator = str.charAt(<span class="number">0</span>);</div><div class="line">                <span class="keyword">if</span> (indicator &lt; <span class="string">'A'</span>) &#123;</div><div class="line">                    changeIndicatorColor(<span class="number">0</span>);</div><div class="line">                    <span class="keyword">return</span>;</div><div class="line">                &#125;</div><div class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; INDICATOR.length(); i++) &#123;</div><div class="line">                    <span class="keyword">if</span> (INDICATOR.charAt(i) == indicator) &#123;</div><div class="line">                        changeIndicatorColor(i);</div><div class="line">                        <span class="keyword">return</span>;</div><div class="line">                    &#125;</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</div><div class="line">            e.printStackTrace();</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">changeIndicatorColor</span><span class="params">(<span class="keyword">int</span> index)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (mIndex != <span class="number">0</span> &amp;&amp; mIndex == index) &#123;</div><div class="line">            <span class="keyword">return</span>;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        TextView tv = (TextView) llMain.getChildAt(mIndex);</div><div class="line">        tv.setTextColor(getResources().getColor(R.color.letter_indicator_text_normal));</div><div class="line"></div><div class="line">        tv = (TextView) llMain.getChildAt(index);</div><div class="line">        tv.setTextColor(getResources().getColor(R.color.letter_indicator_text_select));</div><div class="line"></div><div class="line">        mIndex = index;</div><div class="line"></div><div class="line">        showText(String.valueOf(INDICATOR.charAt(mIndex)), <span class="keyword">true</span>);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">showText</span><span class="params">(String text, <span class="keyword">boolean</span> isShow)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (<span class="keyword">null</span> != tvAlert) &#123;</div><div class="line">            tvAlert.setText(text);</div><div class="line">            tvAlert.setVisibility(isShow ? View.VISIBLE : View.INVISIBLE);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">// private Drawable initBackground() &#123;</span></div><div class="line">    <span class="comment">// float[] roundRect = new float[] &#123; 12, 12, 12, 12, 12, 12, 12, 12 &#125;;</span></div><div class="line">    <span class="comment">// RoundRectShape reoundRechShape = new RoundRectShape(roundRect, null,</span></div><div class="line">    <span class="comment">// null);</span></div><div class="line">    <span class="comment">// ShapeDrawable drawable = new ShapeDrawable(reoundRechShape);</span></div><div class="line">    <span class="comment">// drawable.getPaint().setColor(Color.parseColor(GRAY_AA));</span></div><div class="line">    <span class="comment">// // drawable.getPaint().setStyle(Paint.Style.FILL);</span></div><div class="line">    <span class="comment">// return drawable;</span></div><div class="line">    <span class="comment">// &#125;</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>æµ‹è¯•è¿‡ç¨‹ä¸­å‘ç°ï¼Œæœ‰äº›itemæ˜æ˜æ˜¯æ±‰å­—å¼€å¤´çš„ï¼ˆè¿™ä¸ªæ—¶å€™ä½ å¯èƒ½è¿˜éœ€è¦ä¸ªæ±‰å­—è½¬æ‹¼éŸ³çš„å·¥å…·åŒ…ï¼‰ï¼Œå´å‡ºç°åœ¨â€œ#â€é‡Œï¼Œä»”ç»†æ£€æŸ¥ï¼Œä½ ä¼šå‘ç°ï¼Œé‚£ä¸ªå¹¶ä¸æ˜¯ç©ºæ ¼ï¼Œç»†èŠ‚è¯·çœ‹ä»£ç æ³¨é‡Šã€‚ ç”±äºå¾ˆç®€å•ï¼Œä¸åšè¯¦ç»†ä»‹ç»ï¼Œä»…ä»…åšä¸ªè®°å½•ï¼Œæœ‰é—®é¢˜å¯ä»¥ç•™è¨€ä¸€èµ·è®¨è®ºã€‚</p>
<h2 id="0x04-Demo"><a href="/1970/01/01/[Android]ä»¿è”ç³»äººåˆ—è¡¨ä¸Šçš„å­—æ¯ç´¢å¼•/#0x04-Demo" class="headerlink" title="0x04 Demo"></a>0x04 Demo</h2><p>æœ€åé™„ä¸ªæµ‹è¯•demoï¼š <a href="http://download.csdn.net/detail/ttdevs/7846559" target="_blank" rel="external">ä¸‹è½½</a></p>
<p><img src="https://raw.githubusercontent.com/ttdevs/ttdevs.github.io/common/images/logo.png" alt="Create by ttdevs"></p>
]]></content>
      
        <categories>
            
            <category> æŠ€æœ¯ </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Android </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[ã€ŒAndroidã€å†…å­˜æ³„æ¼ç›¸å…³å†…å®¹æ€»ç»“(ä¸Š)]]></title>
      <url>/1970/01/01/%5BAndroid%5D%E5%86%85%E5%AD%98%E6%B3%84%E6%BC%8F%E7%9B%B8%E5%85%B3%E5%86%85%E5%AE%B9%E6%80%BB%E7%BB%93(%E4%B8%8A)/</url>
      <content type="html"><![CDATA[<h2 id="0x00-å¿æ‚”"><a href="/1970/01/01/[Android]å†…å­˜æ³„æ¼ç›¸å…³å†…å®¹æ€»ç»“(ä¸Š)/#0x00-å¿æ‚”" class="headerlink" title="0x00 å¿æ‚”"></a>0x00 å¿æ‚”</h2><p>å¥½ä¹…æ²¡æœ‰è®¤çœŸçš„å†™åšå®¢äº†ï¼Œè‰ç¨¿ç®±ä¸­é™é™èººç€å¥½å‡ ç¯‡ï¼Œä½†æ€»æ˜¯ä¸èƒ½æŠŠä»–ä»¬å†™å®Œï¼Œä¸€ç›´æ²¡æœ‰å†™çš„å¿ƒæƒ…æŠŠï¼Œç½ªè¿‡â€¦</p>
<p>åºŸè¯ä¸€å¥è¯´å®Œï¼Œè¿›å…¥ä»Šå¤©çš„æ­£é¢˜ï¼šå†…å­˜æ³„éœ²çš„ç›¸å…³çŸ¥è¯†ã€‚</p>
<h2 id="0x01-å†…å­˜é—®é¢˜"><a href="/1970/01/01/[Android]å†…å­˜æ³„æ¼ç›¸å…³å†…å®¹æ€»ç»“(ä¸Š)/#0x01-å†…å­˜é—®é¢˜" class="headerlink" title="0x01 å†…å­˜é—®é¢˜"></a>0x01 å†…å­˜é—®é¢˜</h2><p>å¾ˆå¤šæ—¶å€™æˆ‘ä»¬æ˜¯éœ€è¦æŸ¥çœ‹è‡ªå·±çš„åº”ç”¨å†…å­˜å ç”¨æƒ…å†µï¼Œæ¯”å¦‚å½“å‡ºç°é—ªé€€ï¼Œå¼‚å¸¸é€€å‡ºæ—¶ï¼š</p>
<ul>
<li><p>ç•Œé¢å†…å­˜å ç”¨ï¼šæ¯”å¦‚æˆ‘ä»¬çš„å¯åŠ¨ç”»é¢ï¼Œå¦‚æœå‡ºç°OOMçš„é—®é¢˜ï¼Œè¿™ä¸ªæ—¶å€™å¯ä»¥é€šè¿‡å·®çœ‹å†…å­˜æƒ…å†µï¼Œå¦‚æœç¡®æ˜¯å†…å­˜å ç”¨æ¯”è¾ƒå¤§å°±å¯ä»¥è€ƒè™‘åšç›¸åº”ä¼˜åŒ–</p>
</li>
<li><p>å†…å­˜æ³„æ¼çš„åˆæ­¥æŸ¥æ‰¾ï¼šè¿™ä¸ªå’Œç›´æ¥çš„OOMæœ‰äº›å·®åˆ«ï¼Œè™½ç„¶ä»–æœ€ç»ˆä¹Ÿä¼šå¯¼è‡´OOMã€‚æ–¹æ³•ï¼šåå¤æ‰“å¼€ã€å…³é—­å¯èƒ½å†…å­˜æ³„æ¼çš„ç•Œé¢ï¼Œå¦‚æœæ¯æ¬¡æ‰“å¼€å…³é—­ä¹‹åå†…å­˜éƒ½æœ‰æ‰€å¢åŠ ï¼Œå°±å¯ä»¥åˆæ­¥åˆ¤æ–­ä¸ºå†…å­˜æ³„æ¼ã€‚æ­£å¸¸æƒ…å†µåº”ç”¨æ˜¯è¿›å…¥ç•Œé¢å†…å­˜å ç”¨æœ‰æ‰€å¢åŠ ï¼Œä½†æ˜¯ç¦»å¼€åå†…å­˜ä¼šé™åˆ°ä¹‹å‰çš„æ°´å¹³ã€‚</p>
</li>
</ul>
<h2 id="0x02-å†…å­˜æ³„æ¼ä¸å†…å­˜æº¢å‡º-OOM-çš„åŒºåˆ«ä¸è”ç³»"><a href="/1970/01/01/[Android]å†…å­˜æ³„æ¼ç›¸å…³å†…å®¹æ€»ç»“(ä¸Š)/#0x02-å†…å­˜æ³„æ¼ä¸å†…å­˜æº¢å‡º-OOM-çš„åŒºåˆ«ä¸è”ç³»" class="headerlink" title="0x02 å†…å­˜æ³„æ¼ä¸å†…å­˜æº¢å‡º(OOM)çš„åŒºåˆ«ä¸è”ç³»"></a>0x02 å†…å­˜æ³„æ¼ä¸å†…å­˜æº¢å‡º(OOM)çš„åŒºåˆ«ä¸è”ç³»</h2><p>å†…å­˜æº¢å‡ºåšandroidå¼€å‘çš„å„ä½åº”è¯¥æ˜¯æ¯”è¾ƒç†Ÿæ‚‰ï¼Œå›¾ç‰‡åŠ è½½ç¨å¾®ä¸å°å¿ƒå°±ä¼šå¯¼è‡´out of memoryçš„é”™è¯¯ï¼Œè¿™ä¸ªé”™è¯¯å‡ºç°çš„åŸå› å°±æ˜¯æˆ‘ä»¬çš„åº”ç”¨å»ç”³è¯·å†…å­˜æ—¶ç³»ç»Ÿæ— æ³•å†åˆ†é…å¯¼è‡´çš„ã€‚æ‰€ä»¥æˆ‘ä»¬éœ€è¦æœ‰èŠ‚åˆ¶çš„ä½¿ç”¨å†…å­˜ã€‚</p>
<p>å’ŒC++ç›¸æ¯”ï¼Œjavaçš„ä¸€ä¸ªå¾ˆå¤§ç‰¹ç‚¹å°±æ˜¯æœ‰GCï¼Œæˆ‘ä»¬ä¸éœ€è¦å»ä¸“æ³¨å†…å­˜çš„é‡Šæ”¾ä¸å›æ”¶ã€‚ä½†æ˜¯ï¼Œè¿™ä¹Ÿä¸æ˜¯ç»å¯¹çš„ï¼šå½“æˆ‘ä»¬çš„ä»£ç å‡ºç°é—®é¢˜å¯¼è‡´GCæ— æ³•åŠæ—¶çš„å›æ”¶ç›¸å…³çš„å†…å­˜æ—¶å°±ä¼šå¯¼è‡´å†…å­˜æ³„æ¼ã€‚è¿™å¥ä¸ç®—å¤ªè§„èŒƒçš„æè¿°ï¼ˆè¯­æ–‡å¤ªå·®ï¼Œè§è°…ï¼‰ä»–çš„é‡ç‚¹æ˜¯ä»€ä¹ˆå‘¢â€”â€”GCæ— æ³•åŠæ—¶çš„å›æ”¶ç›¸å…³å†…å­˜â€”â€”è¿™å°†å¯¼è‡´æˆ‘ä»¬çš„å†…å­˜å ç”¨è¶Šæ¥è¶Šå¤šâ€”â€”æœ€ç»ˆçš„ä½“ç°å°±æ˜¯OOMã€‚</p>
<p>å¸Œæœ›è¿™ä¸ªç®€å•çš„æè¿°ï¼Œå„ä½å¯ä»¥ç†è§£ä»€ä¹ˆæ˜¯memory leakå’ŒOOMã€‚</p>
<h2 id="0x03-DDMS-ç»™æˆ‘ä»¬çš„æç¤º"><a href="/1970/01/01/[Android]å†…å­˜æ³„æ¼ç›¸å…³å†…å®¹æ€»ç»“(ä¸Š)/#0x03-DDMS-ç»™æˆ‘ä»¬çš„æç¤º" class="headerlink" title="0x03 DDMS ç»™æˆ‘ä»¬çš„æç¤º"></a>0x03 DDMS ç»™æˆ‘ä»¬çš„æç¤º</h2><ul>
<li>logcatä¸­çš„ä¿¡æ¯</li>
</ul>
<p>å…³äºå†…å­˜çš„ä¿¡æ¯ï¼Œlogcatä¼šç»™æˆ‘ä»¬ä¸€äº›æç¤ºä¿¡æ¯ï¼Œæ¯”å¦‚ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">D/dalvikvm( 9050): GC_CONCURRENT freed 2049K, 65% free 3571K/9991K, external 4703K/5261K, paused 2ms+2ms</div></pre></td></tr></table></figure>
<p>è¿™è¡Œä¿¡æ¯æ€ä¹ˆç†è§£ï¼Ÿå®ƒåŒ…å«å“ªäº›ä¿¡æ¯å‘¢ï¼Ÿé€šè¿‡ <a href="https://developer.android.com/tools/debugging/debugging-memory.html#LogMessages" target="_blank" rel="external">DDMSçš„æ–‡æ¡£</a> æˆ‘ä»¬å¯ä»¥å¾—çŸ¥è¿™ä¸ªä¿¡æ¯çš„æ ¼å¼å¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">D/dalvikvm(dvm pid): &lt;GC_Reason&gt; &lt;Amount_freed&gt;, &lt;Heap_stats&gt;, &lt;External_memory_stats&gt;, &lt;Pause_time&gt;</div></pre></td></tr></table></figure>
<p>è¿™è¡Œä¿¡æ¯æˆ‘ä»¬ä¸»è¦å…³æ³¨çš„æ˜¯ï¼šGC_Reasonï¼Œä»–ä¸»è¦æœ‰ä¸‹é¢å‡ ç§ï¼š</p>
<pre><code>GC_CONCURRENT()

A concurrent garbage collection that frees up memory as your heap begins to
fill up.

GC_FOR_MALLOC(å½“æˆ‘ä»¬çš„åº”ç”¨ç”³è¯·å†…å­˜æ—¶è§¦å‘)

A garbage collection caused because your app attempted to allocate memory when
your heap was already full, so the system had to stop your app and reclaim
memory.

GC_HPROF_DUMP_HEAP()

A garbage collection that occurs when you create an HPROF file to analyze your
heap.

GC_EXPLICIT(å½“æˆ‘ä»¬æ‰‹åŠ¨ç‚¹å‡»DDMS&gt;heap&gt;Cause GCæŒ‰é’®æ—¶ä¼šè§¦å‘)

An explicit garbage collection, such as when you call gc() (which you should
avoid calling and instead trust the garbage collector to run when needed).

GC_EXTERNAL_ALLOC()

This happens only on API level 10 and lower (newer versions allocate everything in the Dalvik heap). A garbage collection for externally allocated memory (such as the pixel data stored in native memory or NIO byte buffers).
</code></pre><p>å½“æˆ‘ä»¬åœ¨appåœ¨å‡ºç°é—®é¢˜æ—¶å¯ä»¥æ ¹æ®è¿™äº›ä¿¡æ¯åšåˆæ­¥åˆ¤æ–­ã€‚æ¯”å¦‚é¢‘ç¹å‡ºç°GC_FOR_AMLLOCåˆ™é¢„ç¤ºç€æˆ‘ä»¬ä¸€ç›´åœ¨ç”³è¯·å†…å­˜ã€‚  </p>
<ul>
<li>heapé¡µç­¾çš„å†…å­˜ä¿¡æ¯</li>
</ul>
<p>é€šè¿‡è¿™ä¸ªå·¥å…·è¿™ä¸ªæˆ‘ä»¬å¯ä»¥æ›´è¯¦ç»†çš„çœ‹åˆ°å†…å­˜çš„åˆ†é…ä¸ä½¿ç”¨ã€‚å¯åŠ¨æ–¹æ³•ï¼š</p>
<p><code>ç‚¹å‡»DDMSä¸­æˆ‘ä»¬çš„è¿›ç¨‹</code> &gt; <code>ä¸Šéƒ¨çš„Update heapæŒ‰é’®</code> &gt; <code>Cause GC</code> å³å¯ï¼Œå¦‚ä¸‹å›¾ï¼š</p>
<p><img src="http://img.blog.csdn.net/20141214202523491?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvdHRkZXZz/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt=""></p>
<h2 id="0x04-é€šè¿‡å†…å­˜å¿«ç…§æ›´ç²¾å‡†çš„æŸ¥æ‰¾å†…å­˜ä¿¡æ¯"><a href="/1970/01/01/[Android]å†…å­˜æ³„æ¼ç›¸å…³å†…å®¹æ€»ç»“(ä¸Š)/#0x04-é€šè¿‡å†…å­˜å¿«ç…§æ›´ç²¾å‡†çš„æŸ¥æ‰¾å†…å­˜ä¿¡æ¯" class="headerlink" title="0x04 é€šè¿‡å†…å­˜å¿«ç…§æ›´ç²¾å‡†çš„æŸ¥æ‰¾å†…å­˜ä¿¡æ¯"></a>0x04 é€šè¿‡å†…å­˜å¿«ç…§æ›´ç²¾å‡†çš„æŸ¥æ‰¾å†…å­˜ä¿¡æ¯</h2><p>å½“æˆ‘ä»¬å‡ºç°å†…å­˜æ³„æ¼é—®é¢˜æ˜¯ï¼Œåˆå­¦è€…å¯èƒ½ä¼šä¸€å¤´é›¾æ°´ï¼Œä¸çŸ¥é“å¦‚ä½•è§£å†³ï¼Œä»ä½•ä¸‹æ‰‹ã€‚è¿™ä¸ªæ—¶å€™æˆ‘ä»¬å°±å¯ä»¥è€ƒè™‘ä½¿ç”¨matå¯¹æˆ‘ä»¬çš„å†…å­˜è¿›è¡Œè¯¦ç»†çš„åˆ†æï¼Œæ‰¾åˆ°å†…å­˜æ³„æ¼ç‚¹ï¼Œåšç›¸åº”çš„å¤„ç†ã€‚</p>
<ul>
<li><code>Shallow size</code> å’Œ <code>Retained Size</code></li>
</ul>
<p>åœ¨è¿›è¡Œå†…å­˜åˆ†æä¹‹å‰æˆ‘ä»¬éœ€è¦é¦–å…ˆäº†è§£è¿™ä¸¤ä¸ªæ¦‚å¿µã€‚</p>
<ul>
<li>Shallow size</li>
</ul>
<p>Shallow sizeå°±æ˜¯å¯¹è±¡æœ¬èº«å ç”¨å†…å­˜çš„å¤§å°ï¼Œä¸åŒ…å«å…¶å¼•ç”¨çš„å¯¹è±¡ã€‚å¸¸è§„å¯¹è±¡ï¼ˆéæ•°ç»„ï¼‰çš„Shallow sizeæœ‰å…¶æˆå‘˜å˜é‡çš„æ•°é‡å’Œç±»å‹å†³å®šã€‚æ•°ç»„çš„shallow sizeæœ‰æ•°ç»„å…ƒç´ çš„ç±»å‹ï¼ˆå¯¹è±¡ç±»å‹ã€åŸºæœ¬ç±»å‹ï¼‰å’Œæ•°ç»„é•¿åº¦å†³å®šã€‚Shallow size of a set of objects represents the sum of shallow sizes of all objects in the set.åœ¨32ä½ç³»ç»Ÿä¸Šï¼Œå¯¹è±¡å¤´å ç”¨8å­—èŠ‚ï¼Œintå ç”¨4å­—èŠ‚ï¼Œä¸ç®¡æˆå‘˜å˜é‡ï¼ˆå¯¹è±¡æˆ–æ•°ç»„ï¼‰æ˜¯å¦å¼•ç”¨äº†å…¶ä»–å¯¹è±¡ï¼ˆå®ä¾‹ï¼‰æˆ–è€…èµ‹å€¼ä¸ºnullå®ƒå§‹ç»ˆå ç”¨4å­—èŠ‚ã€‚æ•…æ­¤ï¼Œå¯¹äºStringå¯¹è±¡å®ä¾‹æ¥è¯´ï¼Œå®ƒæœ‰ä¸‰ä¸ªintæˆå‘˜ï¼ˆ3<em>4=12å­—èŠ‚ï¼‰ã€ä¸€ä¸ªchar[]æˆå‘˜ï¼ˆ1</em>4=4å­—èŠ‚ï¼‰ä»¥åŠä¸€ä¸ªå¯¹è±¡å¤´ï¼ˆ8å­—èŠ‚ï¼‰ï¼Œæ€»å…±3<em>4+1</em>4+8=24å­—èŠ‚ã€‚æ ¹æ®è¿™ä¸€åŸåˆ™ï¼Œå¯¹String a=â€rosen jiangâ€æ¥è¯´ï¼Œå®ä¾‹açš„shallow sizeä¹Ÿæ˜¯24å­—èŠ‚ã€‚</p>
<ul>
<li>Retained Size</li>
</ul>
<p>Retained Size=å½“å‰å¯¹è±¡å¤§å°+å½“å‰å¯¹è±¡å¯ç›´æ¥æˆ–é—´æ¥å¼•ç”¨åˆ°çš„å¯¹è±¡çš„å¤§å°æ€»å’Œ(é—´æ¥å¼•ç”¨çš„å«ä¹‰ï¼šA-&gt;B-&gt;C, Cå°±æ˜¯é—´æ¥å¼•ç”¨)ã€‚æ¢å¥è¯è¯´ï¼ŒRetained Size å°±æ˜¯å½“å‰å¯¹è±¡è¢«GCåï¼Œä»Heapä¸Šæ€»å…±èƒ½é‡Šæ”¾æ‰çš„å†…å­˜ã€‚<br>ä¸è¿‡ï¼Œé‡Šæ”¾çš„æ—¶å€™è¿˜è¦æ’é™¤è¢«GC Rootsç›´æ¥æˆ–é—´æ¥å¼•ç”¨çš„å¯¹è±¡ã€‚ä»–ä»¬æš‚æ—¶ä¸ä¼šè¢«è¢«å½“åšGarbageã€‚ä¸ºäº†æ›´å¥½çš„ç†è§£retained sizeï¼Œä¸å¦¨çœ‹ä¸ªä¾‹å­ã€‚æŠŠå†…å­˜ä¸­çš„å¯¹è±¡çœ‹æˆä¸‹å›¾ä¸­çš„èŠ‚ç‚¹ï¼Œå¹¶ä¸”å¯¹è±¡å’Œå¯¹è±¡ä¹‹é—´äº’ç›¸å¼•ç”¨ã€‚è¿™é‡Œæœ‰ä¸€ä¸ªç‰¹æ®Šçš„èŠ‚ç‚¹GC Rootsï¼Œè¿™å°±æ˜¯reference chainçš„èµ·ç‚¹ã€‚</p>
<p><img src="http://img.blog.csdn.net/20141214203439460?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvdHRkZXZz/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt=""></p>
<p><img src="http://img.blog.csdn.net/20141214203446937?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvdHRkZXZz/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="">  </p>
<p>ä»obj1å…¥æ‰‹ï¼Œä¸Šå›¾ä¸­è“è‰²èŠ‚ç‚¹ä»£è¡¨ä»…ä»…åªæœ‰é€šè¿‡obj1æ‰èƒ½ç›´æ¥æˆ–é—´æ¥è®¿é—®çš„å¯¹è±¡ã€‚å› ä¸ºå¯ä»¥é€šè¿‡GC Rootsè®¿é—®ï¼Œæ‰€ä»¥å·¦å›¾çš„obj3ä¸æ˜¯è“è‰²èŠ‚ç‚¹ï¼›è€Œåœ¨å³å›¾å´æ˜¯è“è‰²ï¼Œå› ä¸ºå®ƒå·²ç»è¢«åŒ…å«åœ¨retainedé›†åˆå†…ã€‚</p>
<p>æ‰€ä»¥å¯¹äºå·¦å›¾ï¼Œobj1çš„retained sizeæ˜¯obj1ã€obj2ã€obj4çš„shallow sizeæ€»å’Œï¼›å³å›¾çš„retained sizeæ˜¯obj1ã€obj2ã€obj3ã€obj4çš„shallow sizeæ€»å’Œã€‚</p>
<p>å¯¹äºobj2ï¼Œå®ƒçš„retained sizeæ˜¯ï¼šåœ¨å·¦å›¾ä¸­ï¼Œæ˜¯obj2å’Œobj4çš„shallow sizeçš„å’Œï¼›åœ¨å³å›¾ä¸­ï¼Œæ˜¯obj2ã€obj3å’Œobj4çš„shallow sizeçš„å’Œã€‚</p>
<p>æ€»ä¹‹ï¼Œretained sizeæ˜¯ä¸€ä¸ªæ•´ä½“åº¦é‡ï¼Œæœ‰åŠ©äºç†è§£å†…å­˜ç»“æ„å’Œå¯¹è±¡å›¾ä¸­çš„ä¾èµ–å…³ç³»å¹¶æ‰¾åˆ°æ ¹èŠ‚ç‚¹ã€‚</p>
<ul>
<li>HPROF fileâ€”â€”å†…å­˜å¿«ç…§æ–‡ä»¶</li>
</ul>
<p>é¦–å…ˆè¿™ä¸ªæ–‡ä»¶å¯ä»¥é€šè¿‡ç‚¹å‡» DDMS ä¸­ Update heap å³ä¾§çš„ Dump HPROF file å¾—åˆ°ï¼ˆè¿™ä¸ªæœ‰æ—¶å€™å¯èƒ½ä¼šæ¯”è¾ƒæ…¢ï¼Œç‰¹åˆ«æ˜¯å†…å­˜å ç”¨é«˜çš„æ—¶å€™ï¼Œéœ€è¦ç­‰ä¸€ä¼šï¼Œå‡ºç°hprof: dumping heap strings to â€œ[DDMS]â€.å³ä»£è¡¨å·²ç»è§¦å‘ï¼‰ã€‚</p>
<p>å¾—åˆ°è¿™ä¸ªæ–‡ä»¶ä¹‹åï¼Œæˆ‘ä»¬è¿˜éœ€è¦ä½¿ç”¨SDKçš„platform-toolsæ–‡ä»¶å¤¹ä¸‹çš„â€œhprof-convâ€å·¥å…·è¿›è¡Œè½¬æ¢ï¼Œç„¶åå°±å¯ä»¥ä½¿ç”¨å†…å­˜åˆ†æå·¥å…·æŸ¥çœ‹äº†ã€‚è½¬æ¢æ–¹æ³•ï¼š</p>
<p><code>hprof-conv heap-original.hprof heap-converted.hprof</code></p>
<h2 id="0x05-å†…å­˜åˆ†æå·¥å…·MAT"><a href="/1970/01/01/[Android]å†…å­˜æ³„æ¼ç›¸å…³å†…å®¹æ€»ç»“(ä¸Š)/#0x05-å†…å­˜åˆ†æå·¥å…·MAT" class="headerlink" title="0x05 å†…å­˜åˆ†æå·¥å…·MAT"></a>0x05 å†…å­˜åˆ†æå·¥å…·MAT</h2><p>è¿™ä¸ªæ˜¯ä¸“é—¨åšå†…å­˜åˆ†æçš„å·¥å…·ã€‚é€šè¿‡å®ƒæˆ‘ä»¬å¯ä»¥æ‰“å¼€åˆšæ‰è½¬æ¢åçš„åˆ°hprofæ–‡ä»¶ï¼Œè¿›è¡Œå†…å­˜åˆ†æã€‚æ¯æ¬¡éƒ½ç‚¹å‡»ä¿å­˜ï¼Œè½¬æ¢ï¼Œç„¶åæ‰“å¼€è¿˜æ˜¯æ¯”è¾ƒéº»çƒ¦çš„ã€‚è¿™ä¸ªæ—¶å€™æˆ‘ä»¬å¯ä»¥è€ƒè™‘<br>ä½¿ç”¨eclipseçš„matæ’ä»¶ã€‚</p>
<p>è¿™ç¯‡å°±å…ˆå†™åˆ°è¿™é‡Œã€‚ä¸‹ä¸€ç¯‡ç®€å•ä»‹ç»å¦‚ä½•é€šè¿‡MATæŸ¥æ‰¾å†…å­˜æ³„æ¼çš„é—®é¢˜ã€‚  </p>
<h2 id="0xFF-å‚è€ƒ"><a href="/1970/01/01/[Android]å†…å­˜æ³„æ¼ç›¸å…³å†…å®¹æ€»ç»“(ä¸Š)/#0xFF-å‚è€ƒ" class="headerlink" title="0xFF å‚è€ƒ"></a>0xFF å‚è€ƒ</h2><ol>
<li><a href="https://developer.android.com/tools/debugging/debugging-memory.html" target="_blank" rel="external">https://developer.android.com/tools/debugging/debugging-memory.html</a></li>
<li><a href="http://blog.csdn.net/kingzone_2008/article/details/9083327" target="_blank" rel="external">http://blog.csdn.net/kingzone_2008/article/details/9083327</a></li>
<li><a href="http://help.eclipse.org/luna/index.jsp?topic=%2Forg.eclipse.mat.ui.help%2Fconcepts%2Fshallowretainedheap.html&amp;resultof=%22Shallow%22%20%22shallow%22%20%22size%22%20" target="_blank" rel="external">http://help.eclipse.org/luna/index.jsp?topic=%2Forg.eclipse.mat.ui.help%2Fconcepts%2Fshallowretainedheap.html&amp;resultof=%22Shallow%22%20%22shallow%22%20%22size%22%20</a></li>
</ol>
<p><img src="https://raw.githubusercontent.com/ttdevs/ttdevs.github.io/common/images/logo.png" alt="Create by ttdevs"></p>
]]></content>
      
        <categories>
            
            <category> æŠ€æœ¯ </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Android </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[ã€ŒAndroidã€ç”¨support annotationæ›¿ä»£enum]]></title>
      <url>/1970/01/01/%5BAndroid%5D%E7%94%A8support%20annotation%E6%9B%BF%E4%BB%A3enum/</url>
      <content type="html"><![CDATA[<blockquote>
<p>Allocation.MipmapControl,<br>Authenticator.RequestorType,<br>AvoidXfermode.Mode,<br>Bitmap.CompressFormat,<br>Bitmap.Config, BlurMaskFilter.Blur,<br>Canvas.EdgeType,<br>Canvas.VertexMode,<br>ClientInfoStatus,<br>ConsoleMessage.MessageLevel,<br>CursorJoiner.Result,<br>and 48 others.</p>
</blockquote>
<p>ç®€å•çœ‹äº†ä¸‹ï¼ŒAndroidè¿˜æ˜¯æœ‰å¥½å¤šåœ°æ–¹ä½¿ç”¨äº†ã€‚é‚£ä¸ºä»€ä¹ˆè¿˜ä¸å»ºè®®ä½¿ç”¨å‘¢ï¼ŸæŸ¥äº†ä¸€ç•ªï¼Œçœ‹åˆ°googleå®˜æ–¹æœ‰ä¸€æ®µå…³äºenumä½¿ç”¨çš„<a href="/1970/01/01/[Android]ç”¨support annotationæ›¿ä»£enum/1">ä»‹ç»</a>ã€‚æ—¢ç„¶ä½¿ç”¨ä¸å½“å¯èƒ½ä¼šå¯¼è‡´æ€§èƒ½é—®é¢˜ï¼Œé‚£æˆ‘ä»¬æ€ä¹ˆåŠå‘¢ï¼Ÿ</p>
<p>è¿™é‡Œä»‹ç»ä¸‹SupportåŒ…ä¸­çš„annotationï¼Œä½¿ç”¨ <code>@IntDef</code> å’Œ <code>@StringDef</code> æ¥è¾¾åˆ°æˆ‘ä»¬æšä¸¾çš„æ•ˆæœã€‚ç”±äº<code>@IntDef</code> çš„ä»‹ç»æ¯”è¾ƒå¤šï¼Œè¿™é‡Œç»™ä¸ª<code>@StringDef</code> çš„Demoï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyClient</span> </span>&#123;</div><div class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String ONE = <span class="string">"one"</span>;</div><div class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String RECORD = <span class="string">"record"</span>;</div><div class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String STATUS = <span class="string">"status"</span>;</div><div class="line"></div><div class="line">    <span class="meta">@StringDef</span>(&#123;ONE, RECORD, STATUS&#125;)</div><div class="line">    <span class="keyword">public</span> <span class="meta">@interface</span> Client &#123;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">private</span> String mClient;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">MyClient</span><span class="params">(@Client String client)</span> </span>&#123;</div><div class="line">        mClient = client;</div><div class="line">    &#125;</div><div class="line">    ...</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>è¿™æ ·ï¼Œåœ¨å¤–é¢åˆ›å»ºMyClientå¯¹è±¡çš„æ—¶å€™ï¼Œæ„é€ æ–¹æ³•ä¸­ä¼ å…¥çš„å‚æ•°å°±å¿…é¡»ä¸º <code>ONE, RECORD, STATUS</code> å…¶ä¸­ä¹‹ä¸€ï¼Œä»è€Œè¾¾åˆ°ç±»ä¼¼enumçš„æ•ˆæœã€‚</p>
<h2 id="å‚è€ƒ"><a href="/1970/01/01/[Android]ç”¨support annotationæ›¿ä»£enum/#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><ol>
<li><a href="https://noobcoderblog.wordpress.com/2015/04/12/java-enum-and-android-intdefstringdef-annotation/" target="_blank" rel="external">https://noobcoderblog.wordpress.com/2015/04/12/java-enum-and-android-intdefstringdef-annotation/</a></li>
<li><a href="https://www.youtube.com/watch?v=Hzs6OBcvNQE" target="_blank" rel="external">The price of ENUMs</a></li>
<li><a href="http://tools.android.com/tech-docs/support-annotations" target="_blank" rel="external">http://tools.android.com/tech-docs/support-annotations</a></li>
<li><a href="http://developer.android.com/reference/java/lang/Enum.html" target="_blank" rel="external">http://developer.android.com/reference/java/lang/Enum.html</a></li>
<li><a href="http://stackoverflow.com/questions/29183904/should-i-strictly-avoid-using-enums-on-android" target="_blank" rel="external">http://stackoverflow.com/questions/29183904/should-i-strictly-avoid-using-enums-on-android</a></li>
</ol>
<p><img src="https://raw.githubusercontent.com/ttdevs/ttdevs.github.io/common/images/logo.png" alt="Create by ttdevs"></p>
]]></content>
      
        <categories>
            
            <category> æŠ€æœ¯ </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Android </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[ã€ŒAndroidã€å„ç§å°è®°å½•]]></title>
      <url>/1970/01/01/%5BAndroid%5D%E5%90%84%E7%A7%8D%E5%B0%8F%E8%AE%B0%E5%BD%95/</url>
      <content type="html"><![CDATA[<h2 id="0x00-å°è®°å½•"><a href="/1970/01/01/[Android]å„ç§å°è®°å½•/#0x00-å°è®°å½•" class="headerlink" title="0x00 å°è®°å½•"></a>0x00 å°è®°å½•</h2><p>è¿™é‡Œæ˜¯ä¸€äº›é›¶ç¢çŸ¥è¯†ç‚¹</p>
<h2 id="0x01-sqliteä¸­å¤„ç†å•å¼•å·"><a href="/1970/01/01/[Android]å„ç§å°è®°å½•/#0x01-sqliteä¸­å¤„ç†å•å¼•å·" class="headerlink" title="0x01 sqliteä¸­å¤„ç†å•å¼•å·"></a>0x01 sqliteä¸­å¤„ç†å•å¼•å·</h2><p>æ‰€æœ‰å•å¼•å·æ¢æˆåŒå•å¼•å·ï¼Œå¦‚ï¼š</p>
<p><code>content.replace(&quot;&#39;&quot;, &quot;&#39;&#39;&quot;);</code></p>
<p>è¿™æ ·æ˜¯ä¸è¡Œçš„ï¼Œä¸´æ—¶æŠ±ä½›è„šï¼Œæ¢æˆäº†å¸¦â€ï¼Ÿâ€çš„é€šé…å½¢å¼</p>
<h2 id="0x02-SimpleCursorAdapter-notifyDataSetChangedæ— æ•ˆ"><a href="/1970/01/01/[Android]å„ç§å°è®°å½•/#0x02-SimpleCursorAdapter-notifyDataSetChangedæ— æ•ˆ" class="headerlink" title="0x02 SimpleCursorAdapter.notifyDataSetChangedæ— æ•ˆ"></a>0x02 SimpleCursorAdapter.notifyDataSetChangedæ— æ•ˆ</h2><p>å¯ä»¥ä½¿ç”¨SimpleCursorAdapterçš„changeCursoræ–¹æ³•ï¼š</p>
<ul>
<li><a href="http://stackoverflow.com/questions/1985955/android-simplecursoradapter-not-updating-with-database-changes" target="_blank" rel="external">http://stackoverflow.com/questions/1985955/android-simplecursoradapter-not-updating-with-database-changes</a></li>
<li><a href="http://stackoverflow.com/questions/14034770/using-notifydatasetchanged-on-simplecursoradapter-does-not-work" target="_blank" rel="external">http://stackoverflow.com/questions/14034770/using-notifydatasetchanged-on-simplecursoradapter-does-not-work</a>  </li>
</ul>
<h2 id="0x03-listviewéšè—åˆ†å‰²çº¿"><a href="/1970/01/01/[Android]å„ç§å°è®°å½•/#0x03-listviewéšè—åˆ†å‰²çº¿" class="headerlink" title="0x03 listviewéšè—åˆ†å‰²çº¿"></a>0x03 listviewéšè—åˆ†å‰²çº¿</h2><ul>
<li><code>setDriver(null)</code> </li>
<li>åœ¨xmlæ–‡ä»¶ä¸­å±æ€§è®¾ç½®ä¸º <code>@null</code></li>
</ul>
<h2 id="0x04-sqliteä¸­replace-intoæ— æ•ˆ"><a href="/1970/01/01/[Android]å„ç§å°è®°å½•/#0x04-sqliteä¸­replace-intoæ— æ•ˆ" class="headerlink" title="0x04 sqliteä¸­replace intoæ— æ•ˆ"></a>0x04 sqliteä¸­replace intoæ— æ•ˆ</h2><p>ä¹‹å‰å†™å¥½çš„ä»£ç è°ƒè¯•éƒ½é€šè¿‡äº†ï¼Œä»Šå¤©çªç„¶å‘ç°ä¸èƒ½è¿è¡Œäº†ï¼š</p>
<blockquote>
<p>sqliteï¼Œè¡¨ä¸­åˆ›å»ºå”¯ä¸€ç´¢å¼•ï¼Œç„¶åä½¿ç”¨replace intoå®ç°æ’å…¥æˆ–è€…æ›´æ–°ï¼Œç»“æœå˜æˆäº†åªæ’å…¥</p>
</blockquote>
<p>æŠ˜è…¾äº†å‡ ä¸ªå°æ—¶ï¼Œæœ€åæ”¹æ‰äº†è¡¨ä¸­ä¸€ä¸ªåä¸ºidçš„å­—æ®µï¼Œå®åœ¨æ˜¯æ— è¯­</p>
<h2 id="0x05-ä¸´æ—¶å†™javaçš„Threadå°è£…"><a href="/1970/01/01/[Android]å„ç§å°è®°å½•/#0x05-ä¸´æ—¶å†™javaçš„Threadå°è£…" class="headerlink" title="0x05 ä¸´æ—¶å†™javaçš„Threadå°è£…"></a>0x05 ä¸´æ—¶å†™javaçš„Threadå°è£…</h2><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div></pre></td><td class="code"><pre><div class="line">public abstract class BaseThread extends Thread &#123;</div><div class="line"></div><div class="line">    private volatile boolean mQuit = false;</div><div class="line"></div><div class="line">    public BaseThread() &#123;</div><div class="line"></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    /**</div><div class="line">     * prepare if needed</div><div class="line">     */</div><div class="line">    public boolean prepare() &#123;</div><div class="line"></div><div class="line">        return true;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    /**</div><div class="line">     * run body</div><div class="line">     */</div><div class="line">    public abstract void execute() throws Exception; // third modify,second modify maybe not neccessary</div><div class="line"></div><div class="line">    /**</div><div class="line">     * recycle if needed</div><div class="line">     */</div><div class="line">    public void recycle() &#123;</div><div class="line"></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    /**</div><div class="line">     * stop thread</div><div class="line">     */</div><div class="line">    public final void quit() &#123;</div><div class="line">        mQuit = true;</div><div class="line">        interrupt();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    @Override</div><div class="line">    public void run() &#123;</div><div class="line">        // TODO</div><div class="line">        Process.setThreadPriority(Process.THREAD_PRIORITY_BACKGROUND);</div><div class="line">        if (!prepare()) &#123;</div><div class="line">            return;</div><div class="line">        &#125;</div><div class="line">        while (true) &#123;</div><div class="line">            if (mQuit) &#123; // second modify</div><div class="line">                recycle();</div><div class="line">                return;</div><div class="line">            &#125;</div><div class="line">            try &#123;</div><div class="line">                execute();</div><div class="line">            &#125; catch (Exception e) &#123;// &#125; catch (InterruptedException e) &#123;</div><div class="line">                if (mQuit) &#123;</div><div class="line">                    recycle();</div><div class="line">                    return;</div><div class="line">                &#125;</div><div class="line">                continue;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line">```  </div><div class="line"></div><div class="line"></div><div class="line">## 0x06 Volleyä¸­è®¾ç½®è¿æ¥è¶…æ—¶</div><div class="line"></div><div class="line">è®¾ç½®è¶…æ—¶çš„åœ°æ–¹ï¼š</div><div class="line"></div><div class="line">HurlStackï¼š</div><div class="line"></div><div class="line">``` java</div><div class="line">/**</div><div class="line">* Opens an &#123;@link HttpURLConnection&#125; with parameters.</div><div class="line">*</div><div class="line">* @param url</div><div class="line">* @return an open connection</div><div class="line">* @throws IOException</div><div class="line">*/</div><div class="line">private HttpURLConnection openConnection(URL url, Request&lt;?&gt; request) throws IOException &#123;</div><div class="line">   HttpURLConnection connection = createConnection(url);</div><div class="line"></div><div class="line">   int timeoutMs = request.getTimeoutMs();</div><div class="line">   connection.setConnectTimeout(timeoutMs);</div><div class="line">   connection.setReadTimeout(timeoutMs);</div><div class="line">   connection.setUseCaches(false);</div><div class="line">   connection.setDoInput(true);</div><div class="line"></div><div class="line">   // use caller-provided custom SslSocketFactory, if any, for HTTPS</div><div class="line">   if ("https".equals(url.getProtocol()) &amp;&amp; mSslSocketFactory != null) &#123;</div><div class="line">       ((HttpsURLConnection) connection).setSSLSocketFactory(mSslSocketFactory);</div><div class="line">   &#125;</div><div class="line"></div><div class="line">   return connection;</div><div class="line">&#125;</div><div class="line">```    </div><div class="line"></div><div class="line">HttpClientStackï¼š  </div><div class="line"></div><div class="line">``` java</div><div class="line">@Override</div><div class="line">public HttpResponse performRequest(Request&lt;?&gt; request, Map&lt;String, String&gt; additionalHeaders)</div><div class="line">        throws IOException, AuthFailureError &#123;</div><div class="line">    HttpUriRequest httpRequest = createHttpRequest(request, additionalHeaders);</div><div class="line">    addHeaders(httpRequest, additionalHeaders);</div><div class="line">    addHeaders(httpRequest, request.getHeaders());</div><div class="line">    onPrepareRequest(httpRequest);</div><div class="line">    HttpParams httpParams = httpRequest.getParams();</div><div class="line">    int timeoutMs = request.getTimeoutMs();</div><div class="line">    // TODO: Reevaluate this connection timeout based on more wide-scale</div><div class="line">    // data collection and possibly different for wifi vs. 3G.</div><div class="line">    HttpConnectionParams.setConnectionTimeout(httpParams, 5000);</div><div class="line">    HttpConnectionParams.setSoTimeout(httpParams, timeoutMs);</div><div class="line">    return mClient.execute(httpRequest);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>Requestä¸­ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line">* Sets the retry policy for this request.</div><div class="line">*/</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setRetryPolicy</span><span class="params">(RetryPolicy retryPolicy)</span> </span>&#123;</div><div class="line">   mRetryPolicy = retryPolicy;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>RetryPolicy ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line">* Retry policy for a request.</div><div class="line">*/</div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">RetryPolicy</span> </span>&#123;</div><div class="line"></div><div class="line">   <span class="comment">/**</span></div><div class="line">    * Returns the current timeout (used for logging).</div><div class="line">    */</div><div class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getCurrentTimeout</span><span class="params">()</span></span>;</div><div class="line"></div><div class="line">   <span class="comment">/**</span></div><div class="line">    * Returns the current retry count (used for logging).</div><div class="line">    */</div><div class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getCurrentRetryCount</span><span class="params">()</span></span>;</div><div class="line"></div><div class="line">   <span class="comment">/**</span></div><div class="line">    * Prepares for the next retry by applying a backoff to the timeout.</div><div class="line">    *</div><div class="line">    * <span class="doctag">@param</span> error The error code of the last attempt.</div><div class="line">    * <span class="doctag">@throws</span> VolleyError In the event that the retry could not be performed (for example if we</div><div class="line">    *                     ran out of attempts), the passed in error is thrown.</div><div class="line">    */</div><div class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">retry</span><span class="params">(VolleyError error)</span> <span class="keyword">throws</span> VolleyError</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="0x07-Androidä¸å›¾ç‰‡ç›¸å…³"><a href="/1970/01/01/[Android]å„ç§å°è®°å½•/#0x07-Androidä¸å›¾ç‰‡ç›¸å…³" class="headerlink" title="0x07 Androidä¸å›¾ç‰‡ç›¸å…³"></a>0x07 Androidä¸å›¾ç‰‡ç›¸å…³</h2><p><a href="http://developer.android.com/training/displaying-bitmaps/index.html" target="_blank" rel="external">http://developer.android.com/training/displaying-bitmaps/index.html</a>  </p>
<h2 id="0x08-å°†eclipseé¡¹ç›®ä¸­çš„æ–‡ä»¶å¤¹ç§»é™¤SVNçš„æ§åˆ¶ï¼ˆæ·»åŠ åˆ°svn-ignoreï¼‰"><a href="/1970/01/01/[Android]å„ç§å°è®°å½•/#0x08-å°†eclipseé¡¹ç›®ä¸­çš„æ–‡ä»¶å¤¹ç§»é™¤SVNçš„æ§åˆ¶ï¼ˆæ·»åŠ åˆ°svn-ignoreï¼‰" class="headerlink" title="0x08 å°†eclipseé¡¹ç›®ä¸­çš„æ–‡ä»¶å¤¹ç§»é™¤SVNçš„æ§åˆ¶ï¼ˆæ·»åŠ åˆ°svn:ignoreï¼‰"></a>0x08 å°†eclipseé¡¹ç›®ä¸­çš„æ–‡ä»¶å¤¹ç§»é™¤SVNçš„æ§åˆ¶ï¼ˆæ·»åŠ åˆ°svn:ignoreï¼‰</h2><p>ä»¥åˆ é™¤androidé¡¹ç›®ä¸­çš„binæ–‡ä»¶å¤¹ä¸ºä¾‹</p>
<p>aã€å…³é—­é¡¹ç›®çš„è‡ªåŠ¨buildï¼šproject-Build Automatically<br>bã€åˆ é™¤binæ–‡ä»¶å¤¹<br>cã€æäº¤<br>dã€æ‰“å¼€ é¡¹ç›®çš„è‡ªåŠ¨buildï¼Œè¿™ä¸ªæ—¶å€™ä¼šç”Ÿæˆbinæ–‡ä»¶å¤¹<br>eã€å°†binæ·»åŠ åˆ°svn:ignoreï¼šå³é”®-Team-æ·»åŠ è‡³svn:ignore<br>fã€æäº¤</p>
<h2 id="0x09-å±å¹•æ—‹è½¬ï¼ŒActivityçš„æˆå‘˜å˜é‡è¢«å…¨éƒ¨é‡Šæ”¾ï¼Ÿï¼"><a href="/1970/01/01/[Android]å„ç§å°è®°å½•/#0x09-å±å¹•æ—‹è½¬ï¼ŒActivityçš„æˆå‘˜å˜é‡è¢«å…¨éƒ¨é‡Šæ”¾ï¼Ÿï¼" class="headerlink" title="0x09 å±å¹•æ—‹è½¬ï¼ŒActivityçš„æˆå‘˜å˜é‡è¢«å…¨éƒ¨é‡Šæ”¾ï¼Ÿï¼"></a>0x09 å±å¹•æ—‹è½¬ï¼ŒActivityçš„æˆå‘˜å˜é‡è¢«å…¨éƒ¨é‡Šæ”¾ï¼Ÿï¼</h2><p>è²Œä¼¼æ˜¯è¿™æ ·å­çš„</p>
<h2 id="0x10-ViewPageré¢‘ç¹è¢«å›æ”¶"><a href="/1970/01/01/[Android]å„ç§å°è®°å½•/#0x10-ViewPageré¢‘ç¹è¢«å›æ”¶" class="headerlink" title="0x10 ViewPageré¢‘ç¹è¢«å›æ”¶"></a>0x10 ViewPageré¢‘ç¹è¢«å›æ”¶</h2><p><a href="http://developer.android.com/reference/android/support/v4/view/ViewPager.html#setOffscreenPageLimit\(int\" target="_blank" rel="external">ViewPager</a>)  </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line">* Set the number of pages that should be retained to either side of the</div><div class="line">* current page in the view hierarchy in an idle state. Pages beyond this</div><div class="line">* limit will be recreated from the adapter when needed.</div><div class="line">*</div><div class="line">* &lt;p&gt;This is offered as an optimization. If you know in advance the number</div><div class="line">* of pages you will need to support or have lazy-loading mechanisms in place</div><div class="line">* on your pages, tweaking this setting can have benefits in perceived smoothness</div><div class="line">* of paging animations and interaction. If you have a small number of pages (3-4)</div><div class="line">* that you can keep active all at once, less time will be spent in layout for</div><div class="line">* newly created view subtrees as the user pages back and forth.&lt;/p&gt;</div><div class="line">*</div><div class="line">* &lt;p&gt;You should keep this limit low, especially if your pages have complex layouts.</div><div class="line">* This setting defaults to 1.&lt;/p&gt;</div><div class="line">*</div><div class="line">* <span class="doctag">@param</span> limit How many pages will be kept offscreen in an idle state.</div><div class="line">*/</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setOffscreenPageLimit</span><span class="params">(<span class="keyword">int</span> limit)</span> </span>&#123;</div><div class="line">   <span class="keyword">if</span> (limit &lt; DEFAULT_OFFSCREEN_PAGES) &#123;</div><div class="line">       Log.w(TAG, <span class="string">"Requested offscreen page limit "</span> + limit + <span class="string">" too small; defaulting to "</span></div><div class="line">               + DEFAULT_OFFSCREEN_PAGES);</div><div class="line">       limit = DEFAULT_OFFSCREEN_PAGES;</div><div class="line">   &#125;</div><div class="line">   <span class="keyword">if</span> (limit != mOffscreenPageLimit) &#123;</div><div class="line">       mOffscreenPageLimit = limit;</div><div class="line">       populate();</div><div class="line">   &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="0x11-Android-SQLite-åˆ†é¡µæŸ¥è¯¢ï¼Œå‚æ•°ä¸ºé¡µå¤§å°å’Œèµ·å§‹ç¼–å·"><a href="/1970/01/01/[Android]å„ç§å°è®°å½•/#0x11-Android-SQLite-åˆ†é¡µæŸ¥è¯¢ï¼Œå‚æ•°ä¸ºé¡µå¤§å°å’Œèµ·å§‹ç¼–å·" class="headerlink" title="0x11 Android SQLite åˆ†é¡µæŸ¥è¯¢ï¼Œå‚æ•°ä¸ºé¡µå¤§å°å’Œèµ·å§‹ç¼–å·"></a>0x11 Android SQLite åˆ†é¡µæŸ¥è¯¢ï¼Œå‚æ•°ä¸ºé¡µå¤§å°å’Œèµ·å§‹ç¼–å·</h2><p>å…ˆçœ‹æ•°æ®ï¼š</p>
<p><img src="http://img.blog.csdn.net/20131126171733656?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvdHRkZXZz/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="">  </p>
<p>æŸ¥è¯¢ç¬¬0æ¡ä¹‹åçš„5æ¡ï¼š<br><code>select * from china_city where province = &#39;åŒ—äº¬&#39; order by code limit 5 offset 0</code></p>
<p><img src="http://img.blog.csdn.net/20131126171744390?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvdHRkZXZz/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="">  </p>
<p>æŸ¥è¯¢ç¬¬5æ¡ä¹‹åçš„5æ¡ï¼š<br><code>select * from china_city where province = &#39;åŒ—äº¬&#39; order by code limit 5 offset 5</code></p>
<p><img src="http://img.blog.csdn.net/20131126171750843?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvdHRkZXZz/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="">  </p>
<h2 id="0x12-è·å–è¿›ç¨‹å†…å­˜-å’Œ-å·²ä½¿ç”¨å†…å­˜"><a href="/1970/01/01/[Android]å„ç§å°è®°å½•/#0x12-è·å–è¿›ç¨‹å†…å­˜-å’Œ-å·²ä½¿ç”¨å†…å­˜" class="headerlink" title="0x12 è·å–è¿›ç¨‹å†…å­˜ å’Œ å·²ä½¿ç”¨å†…å­˜"></a>0x12 è·å–è¿›ç¨‹å†…å­˜ å’Œ å·²ä½¿ç”¨å†…å­˜</h2><ul>
<li>è¿›ç¨‹å†…å­˜</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">int</span> memClass = ((ActivityManager)context.getSystemService(Context.ACTIVITY_SERVICE)).getMemoryClass();</div><div class="line"></div><div class="line"><span class="keyword">int</span> maxMemory = (<span class="keyword">int</span>) (Runtime.getRuntime().maxMemory() / <span class="number">1024</span>);</div></pre></td></tr></table></figure>
<ul>
<li><p>å·²ä½¿ç”¨å†…å­˜</p>
<p>  <code>Log.i(&quot;tag&quot;, where+&quot;usedMemory: &quot;+Debug.getNativeHeapSize()/ 1048576L);</code></p>
</li>
</ul>
<h2 id="0x13-ä¸è”ç³»äººç›¸å…³"><a href="/1970/01/01/[Android]å„ç§å°è®°å½•/#0x13-ä¸è”ç³»äººç›¸å…³" class="headerlink" title="0x13 ä¸è”ç³»äººç›¸å…³"></a>0x13 ä¸è”ç³»äººç›¸å…³</h2><p><a href="http://developer.android.com/training/contacts-provider/display-contact-badge.html" target="_blank" rel="external">http://developer.android.com/training/contacts-provider/display-contact-badge.html </a>  </p>
<h2 id="0x14-è®¾ç½®å­—ä½“å¤§å°"><a href="/1970/01/01/[Android]å„ç§å°è®°å½•/#0x14-è®¾ç½®å­—ä½“å¤§å°" class="headerlink" title="0x14 è®¾ç½®å­—ä½“å¤§å°"></a>0x14 è®¾ç½®å­—ä½“å¤§å°</h2><p>å¯ä»¥ç”¨setTextSize()çš„å¦å¤–ä¸€ç§å½¢å¼ï¼Œå¯ä»¥æŒ‡å®šå•ä½ï¼š<br><code>setTextSize(int unit, int size)</code></p>
<ul>
<li>TypedValue.COMPLEX_UNIT_PX: Pixels</li>
<li>TypedValue.COMPLEX_UNIT_SP: Scaled Pixels</li>
<li>TypedValue.COMPLEX_UNIT_DIP: Device Independent Pixels</li>
</ul>
<h2 id="0x15-äº¤æ¢ä¸¤ä¸ªå˜é‡çš„å€¼"><a href="/1970/01/01/[Android]å„ç§å°è®°å½•/#0x15-äº¤æ¢ä¸¤ä¸ªå˜é‡çš„å€¼" class="headerlink" title="0x15 äº¤æ¢ä¸¤ä¸ªå˜é‡çš„å€¼"></a>0x15 äº¤æ¢ä¸¤ä¸ªå˜é‡çš„å€¼</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">date3 = date1;</div><div class="line">date1 = date2;</div><div class="line">date2 = date3;</div></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span> (date2 &gt; date1) &#123;</div><div class="line">    date2 = date2 + date1;</div><div class="line">    date1 = date2 - date1;</div><div class="line">    date2 = date2 - date1;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">date2 = date1 ^ date2;</div><div class="line">date1 = date1 ^ date2;</div><div class="line">date2 = date1 ^ date2;</div></pre></td></tr></table></figure>
<h2 id="0x16-è·å–URIçœŸå®çš„åœ°å€"><a href="/1970/01/01/[Android]å„ç§å°è®°å½•/#0x16-è·å–URIçœŸå®çš„åœ°å€" class="headerlink" title="0x16 è·å–URIçœŸå®çš„åœ°å€"></a>0x16 è·å–URIçœŸå®çš„åœ°å€</h2><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div></pre></td><td class="code"><pre><div class="line">private String getRealPath(Uri uri) &#123;</div><div class="line">   String path = "";</div><div class="line">   String[] proj = &#123;MediaStore.Images.Media.DATA&#125;;</div><div class="line">   Cursor cursor = getActivity().getContentResolver().query(uri, proj, null, null, null);</div><div class="line">   if (cursor != null &amp;&amp; cursor.moveToFirst()) &#123;</div><div class="line">       path = cursor.getString(cursor.getColumnIndexOrThrow(MediaStore.Images.Media.DATA));</div><div class="line">   &#125;</div><div class="line">   return path;</div><div class="line">&#125;</div><div class="line">```  </div><div class="line"></div><div class="line"></div><div class="line">## 0x17 è‡ªå®šä¹‰Gridviewï¼Œè§£å†³ScrollViewä¸­åµŒå¥—Gridviewæ˜¾ç¤ºä¸æ­£å¸¸çš„é—®é¢˜</div><div class="line"></div><div class="line">ç½‘ä¸Šåˆ°å¤„éƒ½å¯ä»¥æ‰¾åˆ°ä¸‹é¢çš„è§£å†³åŠæ³•ï¼Œä½†æ˜¯è¿™æ ·ä¼šæœ‰ä¸€ä¸ªé—®é¢˜ï¼šå½“å›¾ç‰‡éå¸¸å¤šçš„æ—¶å€™æ˜¯ä¸€æ¬¡åŠ è½½å®Œæ¯•çš„ï¼Œè€Œæˆ‘ä»¬å¸Œæœ›çš„åº”è¯¥æ˜¯æœ¬æ¥çš„GridViewå¯ä»¥é€šè¿‡æ»‘åŠ¨åˆ¤æ–­å½“å‰æ˜¾ç¤º</div><div class="line">æ¡ç›®çš„æƒ…å†µï¼Œåœ¨æ­¤è®°å½•ä¸€ä¸‹ã€‚</div><div class="line"></div><div class="line">``` java</div><div class="line">/**</div><div class="line">* è‡ªå®šä¹‰Gridviewï¼Œè§£å†³ScrollViewä¸­åµŒå¥—Gridviewæ˜¾ç¤ºä¸æ­£å¸¸çš„é—®é¢˜&lt;br&gt;</div><div class="line">* ä½†æ˜¯ï¼Œè¿™åˆäº§ç”Ÿäº†ä¸€ä¸ªæ–°çš„é—®é¢˜ï¼šæ‰€æœ‰çš„iteméƒ½æ˜¯ä¸€æ¬¡åŠ è½½å®Œæ¯•çš„ï¼Œå†æƒ³æ»‘åŠ¨åŠ è½½å°±ä¸è¡Œäº†</div><div class="line">*</div><div class="line">* @author ttdevs</div><div class="line">*/</div><div class="line">public class ImageGridView extends GridView &#123;</div><div class="line">   public ImageGridView(Context context) &#123;</div><div class="line">       this(context, null);</div><div class="line">   &#125;</div><div class="line"></div><div class="line">   public ImageGridView(Context context, AttributeSet attrs) &#123;</div><div class="line">       this(context, attrs, 0);</div><div class="line">   &#125;</div><div class="line"></div><div class="line">   public ImageGridView(Context context, AttributeSet attrs, int defStyle) &#123;</div><div class="line">       super(context, attrs, defStyle);</div><div class="line">   &#125;</div><div class="line"></div><div class="line">   @Override</div><div class="line">   public void onMeasure(int widthMeasureSpec, int heightMeasureSpec) &#123;</div><div class="line">       //super.onMeasure(widthMeasureSpec, heightMeasureSpec);</div><div class="line">       int expandSpec = MeasureSpec.makeMeasureSpec(Integer.MAX_VALUE &gt;&gt; 2, MeasureSpec.AT_MOST);</div><div class="line">       super.onMeasure(widthMeasureSpec, expandSpec);</div><div class="line">   &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="0x18-9å›¾ç‰‡çš„åˆ¶ä½œ"><a href="/1970/01/01/[Android]å„ç§å°è®°å½•/#0x18-9å›¾ç‰‡çš„åˆ¶ä½œ" class="headerlink" title="0x18 .9å›¾ç‰‡çš„åˆ¶ä½œ"></a>0x18 .9å›¾ç‰‡çš„åˆ¶ä½œ</h2><p>ä¸€ä¸ªå›¾ç‰‡åªæƒ³æ¨ªå‘æ‹‰ä¼¸ã€‚æ‰€ä»¥å°±æƒ³å½“ç„¶çš„åªåœ¨å·¦è¾¹ç”»äº†ä¸€æ¡æ¨ªçº¿ï¼Œè¿è¡Œçš„æ—¶å€™æ€ä¹ˆéƒ½æ˜¯æœ‰é»‘çº¿ï¼Œæ²¡æ‹‰ä¼¸ã€‚</p>
<p><code>æœ€åè§£å†³ï¼šç»™å·¦è¾¹ä¹ŸåŠ ä¸€æ¡ç«–çº¿ï¼</code></p>
<h2 id="0x20-listviewç‚¹å‡»èƒŒæ™¯ä¸å˜"><a href="/1970/01/01/[Android]å„ç§å°è®°å½•/#0x20-listviewç‚¹å‡»èƒŒæ™¯ä¸å˜" class="headerlink" title="0x20 listviewç‚¹å‡»èƒŒæ™¯ä¸å˜"></a>0x20 listviewç‚¹å‡»èƒŒæ™¯ä¸å˜</h2><p>è¿™ä¸ªåº”è¯¥è¿˜æ˜¯ç„¦ç‚¹çš„é—®é¢˜ï¼Œåœ¨itemçš„viewæœ€ä¸Šå±‚å¸ƒå±€ä¸­æ·»åŠ ä¸€ä¸ªå±æ€§ï¼š</p>
<p><code>android:descendantFocusability=&quot;blocksDescendants&quot;</code></p>
<h2 id="0x21-Volley-Cookies"><a href="/1970/01/01/[Android]å„ç§å°è®°å½•/#0x21-Volley-Cookies" class="headerlink" title="0x21 Volley Cookies"></a>0x21 Volley Cookies</h2><p><a href="http://stackoverflow.com/questions/16680701/using-cookies-with-android-volley-library" target="_blank" rel="external">http://stackoverflow.com/questions/16680701/using-cookies-with-android-volley-library</a></p>
<h2 id="0x22-EditTextè®¾ç½®readOnly"><a href="/1970/01/01/[Android]å„ç§å°è®°å½•/#0x22-EditTextè®¾ç½®readOnly" class="headerlink" title="0x22 EditTextè®¾ç½®readOnly"></a>0x22 EditTextè®¾ç½®readOnly</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">et.setCursorVisible(<span class="keyword">false</span>); </div><div class="line">et.setFocusable(<span class="keyword">false</span>); </div><div class="line">et.setFocusableInTouchMode(<span class="keyword">false</span>);</div></pre></td></tr></table></figure>
<h2 id="0x23-ä¿å­˜å¯¹è±¡åˆ°SharedPreferences"><a href="/1970/01/01/[Android]å„ç§å°è®°å½•/#0x23-ä¿å­˜å¯¹è±¡åˆ°SharedPreferences" class="headerlink" title="0x23 ä¿å­˜å¯¹è±¡åˆ°SharedPreferences"></a>0x23 ä¿å­˜å¯¹è±¡åˆ°SharedPreferences</h2><p>æƒ³ä¿å­˜ä¸€ä¸ªList<javabean> åˆ°SharedPreferencesã€‚ç½‘ä¸Šæ‰¾äº†ä¸€åœˆæœ‰ä¸€ç§è¯´æ³•åˆ©ç”¨setï¼Œæˆ–è€…base64ï¼Œéƒ½æ„Ÿè§‰ä¸å¥½ã€‚æœ‹å‹ä¸€å¥æç¤ºï¼šjsonã€‚ç„¶åè±ç„¶å¼€æœ—ã€‚ç°è½¬åŒ–æˆjsonï¼Œç„¶åä¿å­˜ï¼Œæ•ˆæœä¸é”™ã€‚</javabean></p>
<h2 id="0x24-è·å–å­—ç¬¦"><a href="/1970/01/01/[Android]å„ç§å°è®°å½•/#0x24-è·å–å­—ç¬¦" class="headerlink" title="0x24 è·å–å­—ç¬¦"></a>0x24 è·å–å­—ç¬¦</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> String <span class="title">getCharacter</span><span class="params">(String str)</span> </span>&#123;</div><div class="line">    StringBuilder sb = <span class="keyword">new</span> StringBuilder();</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; str.length(); i++) &#123;</div><div class="line">        <span class="keyword">if</span> (String.valueOf(str.charAt(i)).getBytes().length &gt; <span class="number">1</span>) &#123;</div><div class="line">            sb.append(str.charAt(i));</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> sb.toString();</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="0x25-Android-4-æŒ‰é’®æ ·å¼"><a href="/1970/01/01/[Android]å„ç§å°è®°å½•/#0x25-Android-4-æŒ‰é’®æ ·å¼" class="headerlink" title="0x25 Android 4 æŒ‰é’®æ ·å¼"></a>0x25 Android 4 æŒ‰é’®æ ·å¼</h2><p><code>style=&quot;?android:attr/buttonBarButtonStyle&quot;</code></p>
<h2 id="0x26-å‡ ä¸ªsqliteçš„sqlè¯­å¥"><a href="/1970/01/01/[Android]å„ç§å°è®°å½•/#0x26-å‡ ä¸ªsqliteçš„sqlè¯­å¥" class="headerlink" title="0x26 å‡ ä¸ªsqliteçš„sqlè¯­å¥"></a>0x26 å‡ ä¸ªsqliteçš„sqlè¯­å¥</h2><ul>
<li>select count(*) from notes</li>
<li>create table notes_new as select * from notes;</li>
<li>select count(*) from notes_new</li>
<li>delete from notes_new where word like â€˜% %â€™;</li>
<li>delete from notes_new where word like â€˜%-%â€™;</li>
<li>delete from notes_new where phonetic like â€˜â€™;</li>
<li>create table notes_new_new as select * from notes_new;</li>
<li>select count(*) from notes_new_new</li>
<li>delete from notes_new_new where _id not in (select min(_id) from notes_new_new group by word)</li>
<li>select * from notes_new_new</li>
<li>insert into notes_word(word,detail,created,phonetic) select word,detail,created,phonetic from notes_new_new;</li>
<li><p>Create Table:</p>
  <figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> notes_word(</div><div class="line">        _id <span class="built_in">INTEGER</span> PRIMARY <span class="keyword">KEY</span> AUTOINCREMENT,</div><div class="line">        word <span class="built_in">TEXT</span>,</div><div class="line">        detail <span class="built_in">TEXT</span>,</div><div class="line">        created <span class="built_in">INT</span>,</div><div class="line">        phonetic <span class="built_in">TEXT</span></div><div class="line">);</div></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="0x27-åŠ å¯†ç›¸å…³"><a href="/1970/01/01/[Android]å„ç§å°è®°å½•/#0x27-åŠ å¯†ç›¸å…³" class="headerlink" title="0x27 åŠ å¯†ç›¸å…³"></a>0x27 åŠ å¯†ç›¸å…³</h2><ul>
<li><a href="http://blog.csdn.net/androidsecurity/article/details/8666954" target="_blank" rel="external">http://blog.csdn.net/androidsecurity/article/details/8666954</a>  </li>
<li><a href="http://blog.csdn.net/baolong47/article/details/17335227" target="_blank" rel="external">http://blog.csdn.net/baolong47/article/details/17335227</a>  </li>
<li><a href="http://blog.csdn.net/guolin_blog/article/details/11952409" target="_blank" rel="external">http://blog.csdn.net/guolin_blog/article/details/11952409</a>  </li>
</ul>
<h2 id="0x28-FaceBookå¼€æºé¡¹ç›®"><a href="/1970/01/01/[Android]å„ç§å°è®°å½•/#0x28-FaceBookå¼€æºé¡¹ç›®" class="headerlink" title="0x28 FaceBookå¼€æºé¡¹ç›®"></a>0x28 FaceBookå¼€æºé¡¹ç›®</h2><p><a href="http://facebook.github.io/rebound/" target="_blank" rel="external"></a></p>
<h2 id="0x29-ScrollViewä¸é«˜åº¦å›ºå®šçš„GridViewæˆ–è€…ListViewåµŒå¥—æ—¶ï¼Œç•Œé¢ä¸æ˜¾ç¤ºåœ¨æœ€ä¸Šé¢"><a href="/1970/01/01/[Android]å„ç§å°è®°å½•/#0x29-ScrollViewä¸é«˜åº¦å›ºå®šçš„GridViewæˆ–è€…ListViewåµŒå¥—æ—¶ï¼Œç•Œé¢ä¸æ˜¾ç¤ºåœ¨æœ€ä¸Šé¢" class="headerlink" title="0x29 ScrollViewä¸é«˜åº¦å›ºå®šçš„GridViewæˆ–è€…ListViewåµŒå¥—æ—¶ï¼Œç•Œé¢ä¸æ˜¾ç¤ºåœ¨æœ€ä¸Šé¢"></a>0x29 ScrollViewä¸é«˜åº¦å›ºå®šçš„GridViewæˆ–è€…ListViewåµŒå¥—æ—¶ï¼Œç•Œé¢ä¸æ˜¾ç¤ºåœ¨æœ€ä¸Šé¢</h2><ul>
<li><p>gvGroup.setFocusable(false);</p>
<p>  lvGroup.setFocusable(false);åœ¨è®¾ç½®Adapterä¹‹å‰è®©å…¶å¤±å»ç„¦ç‚¹</p>
</li>
<li><p>svMain.fullScroll(ScrollView.FOCUS_UP);</p>
<p>  åœ¨åˆé€‚çš„æ—¶å€™(å¦‚delay10ms)è®©ScrollViewæ»šåŠ¨åˆ°æœ€é¡¶ç«¯</p>
</li>
</ul>
<h2 id="0x30-è·å–viewçš„é«˜åº¦"><a href="/1970/01/01/[Android]å„ç§å°è®°å½•/#0x30-è·å–viewçš„é«˜åº¦" class="headerlink" title="0x30 è·å–viewçš„é«˜åº¦"></a>0x30 è·å–viewçš„é«˜åº¦</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">Rect rect = <span class="keyword">new</span> Rect();</div><div class="line">getDrawingRect(rect);</div><div class="line"><span class="keyword">int</span> height = rect.bottom - rect.top;</div></pre></td></tr></table></figure>
<h2 id="0x31-http-hold-on-iteye-com-blog-1943437"><a href="/1970/01/01/[Android]å„ç§å°è®°å½•/#0x31-http-hold-on-iteye-com-blog-1943437" class="headerlink" title="0x31 http://hold-on.iteye.com/blog/1943437"></a>0x31 <a href="http://hold-on.iteye.com/blog/1943437" target="_blank" rel="external">http://hold-on.iteye.com/blog/1943437</a></h2><h2 id="0x32-è°ƒç”¨ç³»ç»Ÿçš„æµè§ˆå™¨æ‰“å¼€ç½‘é¡µ"><a href="/1970/01/01/[Android]å„ç§å°è®°å½•/#0x32-è°ƒç”¨ç³»ç»Ÿçš„æµè§ˆå™¨æ‰“å¼€ç½‘é¡µ" class="headerlink" title="0x32 è°ƒç”¨ç³»ç»Ÿçš„æµè§ˆå™¨æ‰“å¼€ç½‘é¡µ"></a>0x32 è°ƒç”¨ç³»ç»Ÿçš„æµè§ˆå™¨æ‰“å¼€ç½‘é¡µ</h2><p><code>åŒºåˆ†å¤§å°å†™ï¼Œhttpå¿…é¡»ä¸ºå°å†™</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">String url = <span class="string">"http://www.baidu.com"</span>;</div><div class="line">Intent intent = <span class="keyword">new</span> Intent(Intent.ACTION_VIEW);</div><div class="line">intent.setData(Uri.parse(url));</div><div class="line">startActivity(intent);</div></pre></td></tr></table></figure>
<h2 id="0x33-HTTP-POST-ä¹±ç "><a href="/1970/01/01/[Android]å„ç§å°è®°å½•/#0x33-HTTP-POST-ä¹±ç " class="headerlink" title="0x33 HTTP POST ä¹±ç "></a>0x33 HTTP POST ä¹±ç </h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">List&lt;NameValuePair&gt; postParameters = <span class="keyword">new</span> ArrayList&lt;NameValuePair&gt;();</div><div class="line">postParameters.add(<span class="keyword">new</span> BasicNameValuePair(<span class="string">"v"</span>, param));</div><div class="line">postParameters.add(<span class="keyword">new</span> BasicNameValuePair(<span class="string">"s"</span>, Utils.MD5Encode(param, <span class="string">""</span>)));</div><div class="line">postParameters.add(<span class="keyword">new</span> BasicNameValuePair(<span class="string">"e"</span>, String.valueOf(encryptType)));</div><div class="line"></div><div class="line">UrlEncodedFormEntity formEntity = <span class="keyword">new</span> UrlEncodedFormEntity(postParameters, <span class="string">"UTF-8"</span>);</div><div class="line">mPost.setEntity(formEntity);</div></pre></td></tr></table></figure>
<h2 id="0x34-è¯»å–è”ç³»äºº"><a href="/1970/01/01/[Android]å„ç§å°è®°å½•/#0x34-è¯»å–è”ç³»äºº" class="headerlink" title="0x34 è¯»å–è”ç³»äºº"></a>0x34 è¯»å–è”ç³»äºº</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"> * è¯»å–æœ¬åœ°é€šè®¯å½•ï¼ˆæ‰‹æœºï¼‰&lt;br&gt;</div><div class="line"> * ç”¨æˆ·é€šè®¯å½•ï¼š æ‰‹æœºå·ç ã€è”ç³»äººå‘½åã€å¤‡æ³¨ä¿¡æ¯ã€åˆ†ç»„ä¿¡æ¯&lt;br&gt;</div><div class="line"> * è€—æ—¶</div><div class="line"> *</div><div class="line"> * <span class="doctag">@param</span> context</div><div class="line"> * <span class="doctag">@return</span></div><div class="line"> */</div><div class="line"><span class="meta">@SuppressLint</span>(<span class="string">"UseSparseArrays"</span>)</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Map&lt;String, ContactInfo&gt; <span class="title">getContracts</span><span class="params">(Context context)</span> </span>&#123;</div><div class="line">    Map&lt;String, ContactInfo&gt; contactMap = <span class="keyword">new</span> HashMap&lt;String, ContactInfo&gt;();</div><div class="line">    <span class="keyword">try</span> &#123;</div><div class="line"></div><div class="line">        ContentResolver resolver = context.getContentResolver();</div><div class="line">        <span class="keyword">if</span> (<span class="keyword">null</span> == resolver) &#123;</div><div class="line">            <span class="keyword">return</span> contactMap;</div><div class="line">        &#125;</div><div class="line">        <span class="comment">// æ‰‹æœºï¼šå§“åå’Œæ‰‹æœºå·</span></div><div class="line">        Cursor curosr = resolver.query(Phone.CONTENT_URI, <span class="keyword">new</span> String[]&#123;Phone.CONTACT_ID, Phone.DISPLAY_NAME, Phone.NUMBER&#125;, <span class="keyword">null</span>, <span class="keyword">null</span>, <span class="keyword">null</span>);</div><div class="line">        <span class="keyword">if</span> (<span class="keyword">null</span> != curosr &amp;&amp; curosr.moveToFirst()) &#123;</div><div class="line">            <span class="keyword">int</span> keyId = curosr.getColumnIndex(Phone.CONTACT_ID);</div><div class="line">            <span class="keyword">int</span> keyName = curosr.getColumnIndex(Phone.DISPLAY_NAME);</div><div class="line">            <span class="keyword">int</span> keyNumber = curosr.getColumnIndex(Phone.NUMBER);</div><div class="line">            <span class="keyword">do</span> &#123;</div><div class="line">                String id = curosr.getString(keyId);</div><div class="line">                String name = curosr.getString(keyName);</div><div class="line">                String number = curosr.getString(keyNumber);</div><div class="line">                ContactInfo info = <span class="keyword">new</span> ContactInfo();</div><div class="line">                info.setName(name);</div><div class="line">                <span class="keyword">if</span> (!TextUtils.isEmpty(number)) &#123;</div><div class="line">                    number = number.replace(<span class="string">"-"</span>, <span class="string">""</span>);</div><div class="line">                    number = number.replace(<span class="string">" "</span>, <span class="string">""</span>);</div><div class="line">                    info.setNumber(number);</div><div class="line">                &#125;</div><div class="line">                contactMap.put(id, info);</div><div class="line">            &#125; <span class="keyword">while</span> (curosr.moveToNext());</div><div class="line">        &#125;</div><div class="line">        curosr.close();</div><div class="line"></div><div class="line">        <span class="comment">// SIMå¡ï¼šå§“åå’Œæ‰‹æœºå·</span></div><div class="line">        curosr = resolver.query(Uri.parse(<span class="string">"content://icc/adn"</span>), <span class="keyword">new</span> String[]&#123;Phone.CONTACT_ID, Phone.DISPLAY_NAME, Phone.NUMBER&#125;, <span class="keyword">null</span>, <span class="keyword">null</span>, <span class="keyword">null</span>);</div><div class="line">        <span class="keyword">if</span> (<span class="keyword">null</span> != curosr &amp;&amp; curosr.moveToFirst()) &#123;</div><div class="line">            <span class="keyword">int</span> keyId = curosr.getColumnIndex(Phone.CONTACT_ID);</div><div class="line">            <span class="keyword">int</span> keyName = curosr.getColumnIndex(Phone.DISPLAY_NAME);</div><div class="line">            <span class="keyword">int</span> keyNumber = curosr.getColumnIndex(Phone.NUMBER);</div><div class="line">            <span class="keyword">do</span> &#123;</div><div class="line">                String id = curosr.getString(keyId);</div><div class="line">                String name = curosr.getString(keyName);</div><div class="line">                String number = curosr.getString(keyNumber);</div><div class="line">                ContactInfo info = <span class="keyword">new</span> ContactInfo();</div><div class="line">                info.setName(name);</div><div class="line">                info.setNumber(number);</div><div class="line">                contactMap.put(id, info);</div><div class="line">            &#125; <span class="keyword">while</span> (curosr.moveToNext());</div><div class="line">        &#125;</div><div class="line">        curosr.close();</div><div class="line"></div><div class="line">        <span class="comment">// å¤‡æ³¨</span></div><div class="line">        curosr = resolver.query(Data.CONTENT_URI, <span class="keyword">new</span> String[]&#123;Data.CONTACT_ID, Data.DATA1&#125;, <span class="keyword">null</span>, <span class="keyword">null</span>, <span class="keyword">null</span>);</div><div class="line">        <span class="keyword">if</span> (<span class="keyword">null</span> != curosr &amp;&amp; curosr.moveToFirst()) &#123;</div><div class="line">            <span class="keyword">int</span> keyId = curosr.getColumnIndex(Data.CONTACT_ID);</div><div class="line">            <span class="keyword">int</span> keyRemark = curosr.getColumnIndex(Data.DATA1);</div><div class="line">            <span class="keyword">do</span> &#123;</div><div class="line">                String id = curosr.getString(keyId);</div><div class="line">                String remark = curosr.getString(keyRemark);</div><div class="line">                ContactInfo info = contactMap.get(id);</div><div class="line">                <span class="keyword">if</span> (<span class="keyword">null</span> != info) &#123;</div><div class="line">                    info.setRemark(remark);</div><div class="line">                &#125;</div><div class="line">            &#125; <span class="keyword">while</span> (curosr.moveToNext());</div><div class="line">        &#125;</div><div class="line">        curosr.close();</div><div class="line"></div><div class="line">        <span class="comment">// è·å–æ‰€æœ‰åˆ†ç»„</span></div><div class="line">        Map&lt;String, String&gt; groupData = <span class="keyword">new</span> HashMap&lt;String, String&gt;();</div><div class="line">        curosr = resolver.query(Groups.CONTENT_URI, <span class="keyword">new</span> String[]&#123;Groups._ID, Groups.TITLE&#125;, <span class="keyword">null</span>, <span class="keyword">null</span>, <span class="keyword">null</span>);</div><div class="line">        <span class="keyword">if</span> (<span class="keyword">null</span> != curosr &amp;&amp; curosr.moveToFirst()) &#123;</div><div class="line">            <span class="keyword">int</span> keyId = curosr.getColumnIndex(Groups._ID);</div><div class="line">            <span class="keyword">int</span> keyGroupName = curosr.getColumnIndex(Groups.TITLE);</div><div class="line">            <span class="keyword">do</span> &#123;</div><div class="line">                String id = curosr.getString(keyId);</div><div class="line">                String name = curosr.getString(keyGroupName);</div><div class="line">                groupData.put(id, name);</div><div class="line">            &#125; <span class="keyword">while</span> (curosr.moveToNext());</div><div class="line">        &#125;</div><div class="line">        curosr.close();</div><div class="line"></div><div class="line">        <span class="comment">// å…³è”è”ç³»äººå’Œåˆ†ç»„</span></div><div class="line">        curosr = resolver.query(Data.CONTENT_URI, <span class="keyword">new</span> String[]&#123;GroupMembership.CONTACT_ID, GroupMembership.GROUP_ROW_ID&#125;, Data.MIMETYPE + <span class="string">" = ?"</span>,</div><div class="line">                <span class="keyword">new</span> String[]&#123;GroupMembership.CONTENT_ITEM_TYPE&#125;, <span class="keyword">null</span>);</div><div class="line">        <span class="keyword">if</span> (<span class="keyword">null</span> != curosr &amp;&amp; curosr.moveToFirst()) &#123;</div><div class="line">            <span class="keyword">int</span> keyId = curosr.getColumnIndex(GroupMembership.CONTACT_ID);</div><div class="line">            <span class="keyword">int</span> keyGroupId = curosr.getColumnIndex(GroupMembership.GROUP_ROW_ID);</div><div class="line">            <span class="keyword">do</span> &#123;</div><div class="line">                String id = curosr.getString(keyId);</div><div class="line">                String groupId = curosr.getString(keyGroupId);</div><div class="line">                String groupName = groupData.get(groupId);</div><div class="line">                ContactInfo info = contactMap.get(id);</div><div class="line">                <span class="keyword">if</span> (<span class="keyword">null</span> != info &amp;&amp; !TextUtils.isEmpty(groupName)) &#123;</div><div class="line">                    info.setGroup(groupName);</div><div class="line">                &#125;</div><div class="line">            &#125; <span class="keyword">while</span> (curosr.moveToNext());</div><div class="line">        &#125;</div><div class="line">        curosr.close();</div><div class="line"></div><div class="line">        Iterator&lt;String&gt; iterator = contactMap.keySet().iterator();</div><div class="line">        <span class="keyword">while</span> (iterator.hasNext()) &#123;</div><div class="line">            String id = iterator.next();</div><div class="line">            ContactInfo info = contactMap.get(id);</div><div class="line">            System.out.println(String.format(<span class="string">"%s, %s, %s, %s."</span>, info.getName(), info.getNumber(), info.getGroup(), info.getRemark()));</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        groupData.clear();</div><div class="line">        groupData = <span class="keyword">null</span>;</div><div class="line">    &#125; <span class="keyword">catch</span> (Exception e) &#123;</div><div class="line">        e.printStackTrace();</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> contactMap;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="0x35-å•å…ƒæµ‹è¯•â€”â€”æµ‹è¯•å¼‚æ­¥ä»»åŠ¡"><a href="/1970/01/01/[Android]å„ç§å°è®°å½•/#0x35-å•å…ƒæµ‹è¯•â€”â€”æµ‹è¯•å¼‚æ­¥ä»»åŠ¡" class="headerlink" title="0x35 å•å…ƒæµ‹è¯•â€”â€”æµ‹è¯•å¼‚æ­¥ä»»åŠ¡"></a>0x35 å•å…ƒæµ‹è¯•â€”â€”æµ‹è¯•å¼‚æ­¥ä»»åŠ¡</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testAsynchronous</span><span class="params">()</span> </span>&#123;</div><div class="line">    <span class="keyword">try</span> &#123;</div><div class="line">        CountDownLatch signal = <span class="keyword">new</span> CountDownLatch(<span class="number">1</span>);</div><div class="line">        <span class="keyword">new</span> Thread(<span class="keyword">new</span> Runnable() &#123;</div><div class="line"></div><div class="line">            <span class="meta">@Override</span></div><div class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</div><div class="line">                Looper.prepare();</div><div class="line">                signal.countDown();</div><div class="line">                Looper.loop();</div><div class="line">            &#125;</div><div class="line">        &#125;).start();</div><div class="line">        signal.await();</div><div class="line">    &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</div><div class="line">        e.printStackTrace();</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="0x36-GridLayoutåˆå¹¶"><a href="/1970/01/01/[Android]å„ç§å°è®°å½•/#0x36-GridLayoutåˆå¹¶" class="headerlink" title="0x36 GridLayoutåˆå¹¶"></a>0x36 GridLayoutåˆå¹¶</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">GridLayout</span></span></div><div class="line">    <span class="attr">android:id</span>=<span class="string">"@+id/glNumber"</span></div><div class="line">    <span class="attr">android:layout_width</span>=<span class="string">"wrap_content"</span></div><div class="line">    <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span></div><div class="line">    <span class="attr">android:layout_below</span>=<span class="string">"@+id/etPassword"</span></div><div class="line">    <span class="attr">android:layout_centerHorizontal</span>=<span class="string">"true"</span></div><div class="line">    <span class="attr">android:alignmentMode</span>=<span class="string">"alignBounds"</span></div><div class="line">    <span class="attr">android:columnCount</span>=<span class="string">"3"</span></div><div class="line">    <span class="attr">android:orientation</span>=<span class="string">"horizontal"</span></div><div class="line">    <span class="attr">android:rowCount</span>=<span class="string">"4"</span>&gt;</div><div class="line"></div><div class="line">    <span class="tag">&lt;<span class="name">com.ttdevs.blur.CircleButton</span></span></div><div class="line">        <span class="attr">android:id</span>=<span class="string">"@+id/cbt1"</span></div><div class="line">        <span class="attr">android:layout_width</span>=<span class="string">"64dp"</span></div><div class="line">        <span class="attr">android:layout_height</span>=<span class="string">"64dp"</span> /&gt;</div><div class="line"></div><div class="line">    <span class="tag">&lt;<span class="name">com.ttdevs.blur.CircleButton</span></span></div><div class="line">        <span class="attr">android:id</span>=<span class="string">"@+id/cbt2"</span></div><div class="line">        <span class="attr">android:layout_width</span>=<span class="string">"64dp"</span></div><div class="line">        <span class="attr">android:layout_height</span>=<span class="string">"64dp"</span></div><div class="line">        <span class="attr">android:layout_margin</span>=<span class="string">"10dp"</span> /&gt;</div><div class="line"></div><div class="line">    <span class="tag">&lt;<span class="name">com.ttdevs.blur.CircleButton</span></span></div><div class="line">        <span class="attr">android:id</span>=<span class="string">"@+id/cbt3"</span></div><div class="line">        <span class="attr">android:layout_width</span>=<span class="string">"64dp"</span></div><div class="line">        <span class="attr">android:layout_height</span>=<span class="string">"64dp"</span> /&gt;</div><div class="line"></div><div class="line">    <span class="tag">&lt;<span class="name">com.ttdevs.blur.CircleButton</span></span></div><div class="line">        <span class="attr">android:id</span>=<span class="string">"@+id/cbt0"</span></div><div class="line">        <span class="attr">android:layout_width</span>=<span class="string">"64dp"</span></div><div class="line">        <span class="attr">android:layout_height</span>=<span class="string">"64dp"</span></div><div class="line">        <span class="attr">android:layout_columnSpan</span>=<span class="string">"2"</span></div><div class="line">        <span class="attr">android:layout_gravity</span>=<span class="string">"right"</span> /&gt;</div><div class="line"></div><div class="line">    <span class="tag">&lt;<span class="name">com.ttdevs.blur.CircleButton</span></span></div><div class="line">        <span class="attr">android:id</span>=<span class="string">"@+id/cbtDel"</span></div><div class="line">        <span class="attr">android:layout_width</span>=<span class="string">"64dp"</span></div><div class="line">        <span class="attr">android:layout_height</span>=<span class="string">"64dp"</span> /&gt;</div><div class="line"><span class="tag">&lt;/<span class="name">GridLayout</span>&gt;</span></div></pre></td></tr></table></figure>
<h2 id="0x37-PopupWindowæ˜¾ç¤ºçš„æ—¶å€™å·¦å³ä¸é è¾¹ï¼ˆæœ‰è¾¹ç¼ï¼‰"><a href="/1970/01/01/[Android]å„ç§å°è®°å½•/#0x37-PopupWindowæ˜¾ç¤ºçš„æ—¶å€™å·¦å³ä¸é è¾¹ï¼ˆæœ‰è¾¹ç¼ï¼‰" class="headerlink" title="0x37 PopupWindowæ˜¾ç¤ºçš„æ—¶å€™å·¦å³ä¸é è¾¹ï¼ˆæœ‰è¾¹ç¼ï¼‰"></a>0x37 PopupWindowæ˜¾ç¤ºçš„æ—¶å€™å·¦å³ä¸é è¾¹ï¼ˆæœ‰è¾¹ç¼ï¼‰</h2><p><code>setBackgroundDrawable(new ColorDrawable(0xa0000000));</code></p>
<h2 id="0x38-EditTexté™åˆ¶å¯è¾“å…¥å°æ•°"><a href="/1970/01/01/[Android]å„ç§å°è®°å½•/#0x38-EditTexté™åˆ¶å¯è¾“å…¥å°æ•°" class="headerlink" title="0x38 EditTexté™åˆ¶å¯è¾“å…¥å°æ•°"></a>0x38 EditTexté™åˆ¶å¯è¾“å…¥å°æ•°</h2><p><code>etInput.setInputType(InputType.TYPE_CLASS_NUMBER | InputType.TYPE_NUMBER_FLAG_DECIMAL);</code></p>
<p><a href="http://stackoverflow.com/questions/4276068/how-to-make-edittext-field-for-decimals" target="_blank" rel="external"></a></p>
<h2 id="0x39-éšè—é”®ç›˜"><a href="/1970/01/01/[Android]å„ç§å°è®°å½•/#0x39-éšè—é”®ç›˜" class="headerlink" title="0x39 éšè—é”®ç›˜"></a>0x39 éšè—é”®ç›˜</h2><p>éšè—é”®ç›˜è²Œä¼¼åœ¨onDestoryä¸­è°ƒç”¨æ— æ•ˆï¼Œæœ€åè‡ªå·±æŠŠå®ƒå†™åœ¨äº†onStopä¸­</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"> * å…³é—­é”®ç›˜</div><div class="line"> * <span class="doctag">@param</span> context</div><div class="line"> * <span class="doctag">@param</span> windowToken</div><div class="line"> * <span class="doctag">@param</span> flag</div><div class="line"> */</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">close</span><span class="params">(Context context, IBinder windowToken, <span class="keyword">int</span> flag)</span> </span>&#123;</div><div class="line">    InputMethodManager imm = (InputMethodManager) context</div><div class="line">            .getSystemService(Context.INPUT_METHOD_SERVICE);</div><div class="line">    imm.hideSoftInputFromWindow(windowToken, flag);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="0x40-Android-TextView-æ˜¾ç¤ºä¸å…¨çš„é—®é¢˜"><a href="/1970/01/01/[Android]å„ç§å°è®°å½•/#0x40-Android-TextView-æ˜¾ç¤ºä¸å…¨çš„é—®é¢˜" class="headerlink" title="0x40 Android TextView æ˜¾ç¤ºä¸å…¨çš„é—®é¢˜"></a>0x40 Android TextView æ˜¾ç¤ºä¸å…¨çš„é—®é¢˜</h2><p>ä»£ç å¦‚ä¸‹ï¼Œå½“ç»™TextViewçš„å±æ€§è®¾ç½®æˆmatch_parentçš„æ—¶å€™ï¼Œtextä¸­è®¾ç½®çš„æ–‡å­—æ¯”è¾ƒé•¿çš„æ—¶å€™ä¼šå‡ºç°æ˜¾ç¤ºä¸å…¨çš„é—®é¢˜</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">LinearLayout</span></span></div><div class="line">    <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></div><div class="line">    <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span></div><div class="line">    <span class="attr">android:gravity</span>=<span class="string">"top"</span></div><div class="line">    <span class="attr">android:orientation</span>=<span class="string">"horizontal"</span></div><div class="line">    <span class="attr">android:padding</span>=<span class="string">"@dimen/global_padding_normal"</span>&gt;</div><div class="line"></div><div class="line">    <span class="tag">&lt;<span class="name">ImageView</span></span></div><div class="line">        <span class="attr">android:id</span>=<span class="string">"@+id/iv_health_light"</span></div><div class="line">        <span class="attr">android:layout_width</span>=<span class="string">"@dimen/detail_light_width"</span></div><div class="line">        <span class="attr">android:layout_height</span>=<span class="string">"@dimen/detail_light_height"</span></div><div class="line">        <span class="attr">android:gravity</span>=<span class="string">"center_horizontal"</span> /&gt;</div><div class="line"></div><div class="line">    <span class="tag">&lt;<span class="name">TextView</span></span></div><div class="line">        <span class="attr">android:id</span>=<span class="string">"@+id/tv_appraise"</span></div><div class="line">        <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></div><div class="line">        <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span></div><div class="line">        <span class="attr">android:layout_marginLeft</span>=<span class="string">"@dimen/global_margin_normal"</span></div><div class="line">        <span class="attr">android:gravity</span>=<span class="string">"left|top"</span></div><div class="line">        <span class="attr">android:lineSpacingExtra</span>=<span class="string">"@dimen/global_line_space"</span></div><div class="line">        <span class="attr">android:textColor</span>=<span class="string">"@color/global_gray_dark"</span></div><div class="line">        <span class="attr">android:textSize</span>=<span class="string">"@dimen/global_font_small"</span> /&gt;</div><div class="line"></div><div class="line"><span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span></div></pre></td></tr></table></figure>
<h2 id="0x41-æŸ¥çœ‹ç³»ç»Ÿalarm-é—¹é’Ÿ-é˜Ÿåˆ—"><a href="/1970/01/01/[Android]å„ç§å°è®°å½•/#0x41-æŸ¥çœ‹ç³»ç»Ÿalarm-é—¹é’Ÿ-é˜Ÿåˆ—" class="headerlink" title="0x41 æŸ¥çœ‹ç³»ç»Ÿalarm(é—¹é’Ÿ)é˜Ÿåˆ—"></a>0x41 æŸ¥çœ‹ç³»ç»Ÿalarm(é—¹é’Ÿ)é˜Ÿåˆ—</h2><ul>
<li><p>Alarmäº‹ä»¶é˜Ÿåˆ—</p>
<p>  <code>adb shell dumpsys alarm</code></p>
</li>
<li><p>æŸ¥çœ‹intent</p>
<p>  <code>adb shell dumpsys activity intents</code></p>
</li>
</ul>
<p><a href="https://plus.google.com/+RomanNurik/posts/5w3Mi9EoniT" target="_blank" rel="external"></a></p>
<h2 id="0x42-singleTaskä¸onNewIntent"><a href="/1970/01/01/[Android]å„ç§å°è®°å½•/#0x42-singleTaskä¸onNewIntent" class="headerlink" title="0x42 singleTaskä¸onNewIntent"></a>0x42 singleTaskä¸onNewIntent</h2><p>singleTaskä¸onNewIntentåŒæ—¶å­˜åœ¨æ—¶ï¼ŒonNewIntentä¸æ˜¯æ€»è¢«è°ƒç”¨ã€‚æ¯”å¦‚ï¼šå½“å‰Appå¯åŠ¨è¿‡ï¼Œç¬¬ä¸‰æ–¹Appå†æ¬¡å¯åŠ¨æ—¶æ˜¯ä¸ä¼šè°ƒç”¨onNewIntentçš„ï¼Œå†æˆ–è€…æˆ‘ä»¬ä»ä»»åŠ¡åˆ—è¡¨ä¸­å†æ¬¡å¯åŠ¨å½“å‰Appä¹Ÿæ˜¯ä¸ä¼šè§¦å‘onNewIntentçš„ã€‚  </p>
<p><img src="https://raw.githubusercontent.com/ttdevs/ttdevs.github.io/common/images/logo.png" alt="Create by ttdevs"></p>
]]></content>
      
        <categories>
            
            <category> æŠ€æœ¯ </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Android </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[ã€ŒFlaskã€0x00Welcome]]></title>
      <url>/1970/01/01/%5BFlask%5D0x00Welcome/</url>
      <content type="html"><![CDATA[<h2 id="0x00-Welcome-to-Flask"><a href="/1970/01/01/[Flask]0x00Welcome/#0x00-Welcome-to-Flask" class="headerlink" title="0x00 Welcome to Flask"></a>0x00 Welcome to Flask</h2><blockquote>
<p>Flask is a microframework for Python based on Werkzeug, Jinja 2 and good intentions. And before you ask: Itâ€™s BSD licensed! </p>
</blockquote>
<h2 id="0xFF-å‚è€ƒ"><a href="/1970/01/01/[Flask]0x00Welcome/#0xFF-å‚è€ƒ" class="headerlink" title="0xFF å‚è€ƒ"></a>0xFF å‚è€ƒ</h2><ol>
<li><a href="https://pypi.python.org/pypi/Flask/0.10.1" target="_blank" rel="external">https://pypi.python.org/pypi/Flask/0.10.1</a></li>
<li><a href="http://flask.pocoo.org/docs/0.10/" target="_blank" rel="external">http://flask.pocoo.org/docs/0.10/</a></li>
<li><a href="https://github.com/pallets/flask" target="_blank" rel="external">https://github.com/pallets/flask</a></li>
</ol>
<p><img src="https://raw.githubusercontent.com/ttdevs/ttdevs.github.io/common/images/logo.png" alt="Create by ttdevs"></p>
]]></content>
      
        <categories>
            
            <category> æŠ€æœ¯ </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Flask </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[ã€ŒAndroidã€é€šè¿‡Intentä¼ é€’æ•°æ®]]></title>
      <url>/1970/01/01/%5BAndroid%5D%E9%80%9A%E8%BF%87Intent%E4%BC%A0%E9%80%92%E6%95%B0%E6%8D%AE/</url>
      <content type="html"><![CDATA[<h2 id="0x00-éœ€æ±‚"><a href="/1970/01/01/[Android]é€šè¿‡Intentä¼ é€’æ•°æ®/#0x00-éœ€æ±‚" class="headerlink" title="0x00 éœ€æ±‚"></a>0x00 éœ€æ±‚</h2><p>æ—¥å¸¸å¼€å‘ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸é‡åˆ°é€šè¿‡ Intent æ¥ä¼ é€’æ•°æ®ï¼ˆå¦‚æœä½ ä½¿ç”¨Bundleä¹Ÿæ˜¯ä¸€æ ·çš„ï¼‰ï¼Œé»˜è®¤æƒ…å†µï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°æ”¯æŒçš„æ•°æ®ç±»å‹ï¼š</p>
<p><img src="http://img.blog.csdn.net/20160807214929418" alt="intent"></p>
<ul>
<li><p>åŸºæœ¬ç±»å‹</p>
<p>  booleanã€byteã€char ã€shortã€doubleã€floatã€intã€long</p>
</li>
<li><p>å­—ç¬¦ä¸²ç±»å‹</p>
<p>  Stringã€String[]ã€CharSequenceã€CharSequence[]</p>
</li>
<li><p>åºåˆ—åŒ–ç±»å‹</p>
<p>  Serializableã€Parcelable</p>
</li>
<li><p>å…¶ä»–ç±»å‹</p>
<p>  å…«ç§åŸºæœ¬ç±»å‹çš„æ•°ç»„ã€IntegerArrayã€StringArrayã€CharSequenceArrayã€ParcelableArray</p>
</li>
</ul>
<p>å¯¹äºåŸºæœ¬ç±»å‹æˆ‘ä»¬å¯ä»¥ä¸åšä»»ä½•å¤„ç†å³å¯åœ¨Activityæˆ–è€…Serviceä¸­ä¼ é€’ã€‚é‚£ä¹ˆå¯¹äºè‡ªå®šä¹‰ç±»å‹ï¼Œæˆ‘ä»¬æ€ä¹ˆåšå‘¢ï¼Ÿ</p>
<h2 id="0x01-ä½•è°“åºåˆ—åŒ–"><a href="/1970/01/01/[Android]é€šè¿‡Intentä¼ é€’æ•°æ®/#0x01-ä½•è°“åºåˆ—åŒ–" class="headerlink" title="0x01 ä½•è°“åºåˆ—åŒ–"></a>0x01 ä½•è°“åºåˆ—åŒ–</h2><p>å½“æˆ‘ä»¬éœ€è¦å¯¹JVMä¸­çš„javaå¯¹è±¡è¿›è¡Œè½¬å‚¨æ—¶ï¼Œå°±éœ€è¦å°†å…¶è½¬åŒ–æˆäºŒè¿›åˆ¶åºåˆ—ï¼Œç„¶åæ‰èƒ½å­˜å‚¨åˆ°å¤–éƒ¨ã€‚è¿™ä¸ªåºåˆ—ä¸­ä¿å­˜äº†javaå¯¹è±¡çš„ç±»å‹ï¼Œæ•°æ®ï¼Œæ•°æ®ç±»å‹ç­‰ã€‚å½“éœ€è¦çš„æ—¶å€™ï¼Œå†å¯¹å­˜å‚¨çš„äºŒè¿›åˆ¶åºåˆ—è¿›è¡Œååºåˆ—åŒ–ï¼Œå³å¯å°†å…¶è¿˜åŸã€‚å¸¸è§çš„åœºæ™¯æ¯”å¦‚ï¼šå­˜å‚¨JVMä¸­å¯¹è±¡ï¼Œé€šè¿‡Socketä¼ é€’javaå¯¹è±¡ï¼ŒRMIç­‰ç­‰ã€‚</p>
<h2 id="0x02-Stringç±»å‹"><a href="/1970/01/01/[Android]é€šè¿‡Intentä¼ é€’æ•°æ®/#0x02-Stringç±»å‹" class="headerlink" title="0x02 Stringç±»å‹"></a>0x02 Stringç±»å‹</h2><blockquote>
<p>ä¸ºä»€ä¹ˆæŠŠè¿™ä¸ªæ”¾åœ¨ç¬¬ä¸€ä½å‘¢ï¼Ÿ<br>åŸå› å¾ˆç®€å•ï¼šç®€å•</p>
</blockquote>
<p>åŸºæœ¬ç±»å‹ä¸ç”¨è¯´ï¼Œç›´æ¥ä¼ é€’å³å¯ï¼Œå¯¹äºæˆ‘ä»¬çš„è‡ªå®šä¹‰ç±»å‹ï¼Œå¦‚æœä½ è·Ÿæˆ‘ä¸€æ ·ï¼Œä¸å¤ªå–œæ¬¢ï¼ˆç†Ÿæ‚‰ T-Tï¼‰Serializableå’ŒParcelableï¼Œé‚£ç”¨Stringç±»å‹æœ€ç®€å•äº†ã€‚å…¶å®è¿™ä¸ªè¯´æ³•è¿˜æœ‰ä¸ªå‰æï¼Œå°±æ˜¯æˆ‘ä»¬çš„é¡¹ç›®ä¸­éœ€è¦é›†æˆjsonå·¥å…·ï¼ˆä¸è¿‡è‡³å°‘æœ‰gsonï¼‰ã€‚ä½¿ç”¨æ–¹æ³•å¦‚ä¸‹ï¼šé¦–å…ˆé€šè¿‡jsonå·¥å…·å°†æˆ‘ä»¬çš„Objectè½¬æ¢æˆjsonå­—ç¬¦ä¸²ï¼Œç„¶ååœ¨æ¥æ”¶å¤„åœ¨é€šè¿‡jsonå·¥å…·è¿˜åŸä¸ºObjectã€‚</p>
<p>ä»æ•ˆç‡æ¥çœ‹ï¼Œä¼šæ¯”ä¸‹é¢ä¸¤ç§æƒ…å†µä½ã€‚ä½†æ˜¯å¯¹åˆå­¦è€…æ¥è¯´ï¼Œä¼šæ¯”ä¸‹é¢ä¸¤ç§ç”¨èµ·æ¥ç®€å•ã€‚ç›®å‰è¿˜æ²¡æœ‰é‡åˆ°å‡ºé”™çš„é—®é¢˜ï¼ˆå¯èƒ½æ—¶å› ä¸ºæˆ‘ä¼ é€’çš„æ•°æ®æ¯”è¾ƒå°æ¯”è¾ƒç®€å•å§ï¼‰ã€‚</p>
<h2 id="0x02-Serializable"><a href="/1970/01/01/[Android]é€šè¿‡Intentä¼ é€’æ•°æ®/#0x02-Serializable" class="headerlink" title="0x02 Serializable"></a>0x02 Serializable</h2><p>Javaä¸­ç»å¸¸ä¼šé‡åˆ° Serializableï¼Œæ¯”å¦‚è¿™æ ·ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Person</span> <span class="keyword">implements</span> <span class="title">Serializable</span> </span>&#123;</div><div class="line">    <span class="keyword">public</span> String name;</div><div class="line">    <span class="keyword">public</span> <span class="keyword">int</span> age;</div><div class="line">    <span class="keyword">public</span> <span class="keyword">boolean</span> login;</div><div class="line">    <span class="keyword">public</span> <span class="keyword">float</span> score;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>æœ‰äº›åœ°æ–¹éœ€è¦è¿›è¡Œåºåˆ—åŒ–æ—¶ï¼ŒIDEä¼šæç¤ºæˆ‘ä»¬å®ç°ä¸€ä¸ªæ¥å£ï¼š<code>Serializable</code>ï¼Œç„¶åæˆ‘ä»¬ä¹–ä¹–åœ°åŠ ä¸Šè¿™ä¸ªæ¥å£å³å¯ï¼ˆæœ‰æ—¶å€™IDEè¿˜ä¼šè‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªé™æ€å¸¸é‡ï¼š<code>private static final long serialVersionUID = 23333333333333333333L;</code>ï¼‰ã€‚å¦‚æœä½ æ²¡æœ‰å»è¿½ç©¶ä¸ºä»€ä¹ˆï¼Œé‚£ä¹ˆäº‹æƒ…å°±æ­¤ç»“æŸã€‚é€šè¿‡Intentä¼ é€’æ•°æ®æ—¶ï¼Œä¹Ÿæ˜¯å¦‚æ­¤ã€‚å¥½äº†ï¼Œæˆ‘ä»¬è¿›å…¥ä¸‹ä¸€éƒ¨åˆ†ï½ï½</p>
<p>å“ˆå“ˆï¼Œå“ªèƒ½è¿™ä¹ˆç®€å•ã€‚ä½ å¯èƒ½ä¼šé—®ï¼Œä¸ºä»€ä¹ˆåŠ ä¸ªè¿™ä¸ªæ¥å£å³å¯ï¼ŸSerializableæ˜¯ä¸€ç§ æ ‡è®°æ¥å£ï¼Œå½“æˆ‘ä»¬å®ç°è¿™ä¸ªæ¥å£ä¹‹åï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨é€šè¿‡åå°„æœºåˆ¶å°†æˆ‘ä»¬å¯¹è±¡çš„æˆå‘˜è¿›è¡Œåºåˆ—åŒ–ã€‚è¿™é‡Œä¼šæ¶‰åŠä¸€äº›å…¶ä»–ä¿¡æ¯ï¼Œæ¯”å¦‚ï¼šserialVersionUIDã€é™æ€å¸¸é‡çš„åºåˆ—åŒ–ç­‰ç­‰ï¼Œæ›´å¤šä¿¡æ¯è¯·å‚è€ƒ<a href="http://www.ibm.com/developerworks/cn/java/j-lo-serial/index.html" target="_blank" rel="external">è¿™é‡Œ</a>ã€‚</p>
<h2 id="0x03-Parcelable"><a href="/1970/01/01/[Android]é€šè¿‡Intentä¼ é€’æ•°æ®/#0x03-Parcelable" class="headerlink" title="0x03 Parcelable"></a>0x03 Parcelable</h2><p>Parcelableæ˜¯androidç‰¹æœ‰çš„å¤„ç†åºåˆ—åŒ–çš„æ–¹æ³•ã€‚å…ˆçœ‹ç®€å•çš„ä½¿ç”¨ï¼š</p>
<ul>
<li><p>åˆ›å»ºä¸€ä¸ªç±»ï¼š</p>
  <figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> <span class="keyword">implements</span> <span class="title">Parcelable</span> </span>&#123;</div><div class="line">	    <span class="keyword">public</span> String userName;</div><div class="line">	    <span class="keyword">public</span> <span class="keyword">int</span> age;</div><div class="line">	    <span class="keyword">public</span> <span class="keyword">boolean</span> login;</div><div class="line">	    <span class="keyword">public</span> <span class="keyword">float</span> score;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>ä½¿ç”¨AndroidStudioçš„ä»£ç ç”ŸæˆåŠŸèƒ½ç”Ÿæˆå¦‚ä¸‹ æ¨¡ç‰ˆ ä»£ç ï¼š</p>
  <figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div></pre></td><td class="code"><pre><div class="line"> <span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> <span class="keyword">implements</span> <span class="title">Parcelable</span> </span>&#123;</div><div class="line">    <span class="keyword">public</span> String userName;</div><div class="line">    <span class="keyword">public</span> <span class="keyword">int</span> age;</div><div class="line">    <span class="keyword">public</span> <span class="keyword">boolean</span> login;</div><div class="line">    <span class="keyword">public</span> <span class="keyword">float</span> score;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">protected</span> <span class="title">User</span><span class="params">(Parcel in)</span> </span>&#123;</div><div class="line">        userName = in.readString();</div><div class="line">        age = in.readInt();</div><div class="line">        login = in.readByte() != <span class="number">0</span>;</div><div class="line">        score = in.readFloat();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">writeToParcel</span><span class="params">(Parcel dest, <span class="keyword">int</span> flags)</span> </span>&#123;</div><div class="line">        dest.writeString(userName);</div><div class="line">        dest.writeInt(age);</div><div class="line">        dest.writeByte((<span class="keyword">byte</span>) (login ? <span class="number">1</span> : <span class="number">0</span>));</div><div class="line">        dest.writeFloat(score);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">describeContents</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> Creator&lt;User&gt; CREATOR = <span class="keyword">new</span> Creator&lt;User&gt;() &#123;</div><div class="line">        <span class="meta">@Override</span></div><div class="line">        <span class="function"><span class="keyword">public</span> User <span class="title">createFromParcel</span><span class="params">(Parcel in)</span> </span>&#123;</div><div class="line">            <span class="keyword">return</span> <span class="keyword">new</span> User(in);</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="meta">@Override</span></div><div class="line">        <span class="keyword">public</span> User[] newArray(<span class="keyword">int</span> size) &#123;</div><div class="line">            <span class="keyword">return</span> <span class="keyword">new</span> User[size];</div><div class="line">        &#125;</div><div class="line">    &#125;;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ul>
<p> å¯¹æ¯”ä¸Šé¢çš„ä¸¤æ®µä»£ç ï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°ï¼š</p>
<ul>
<li>æ„é€ æ–¹æ³•ä¸­æ¥æ”¶ä¸€ä¸ª Parcel å¯¹è±¡ï¼Œé€šè¿‡è¿™ä¸ªå¯¹è±¡å¯¹æˆå‘˜å˜é‡èµ‹å€¼</li>
<li><p>å®ç°äº† <code>Parcelable</code> æ¥å£çš„æ–¹æ³•</p>
<ul>
<li>åœ¨ <code>writeToParcel</code> æ–¹æ³•ä¸­å°†æˆ‘ä»¬çš„æˆå‘˜å˜é‡å†™å…¥ <code>Parcel</code></li>
<li><p>åœ¨ <code>describeContents</code> ä¸­è¿”å›ä¸€ä¸ªæ•°å­— 0</p>
<blockquote>
<p>Describe the kinds of special objects contained in this Parcelable instanceâ€™s marshaled representation. For example, if the object will include a file descriptor in the output of writeToParcel(Parcel, int), the return value of this method must include the CONTENTS_FILE_DESCRIPTOR bit.</p>
</blockquote>
</li>
</ul>
</li>
<li><p>åˆ›å»ºäº†ä¸€ä¸ª <code>public static final</code> å¸¸é‡ <code>CREATOR</code></p>
</li>
</ul>
<p>è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥é€šè¿‡Intentä¼ é€’å¯¹è±¡äº†ã€‚</p>
<p>åœ¨androidçš„å¾ˆå¤šæ–‡ç« ä¸­éƒ½å¯ä»¥çœ‹åˆ°ï¼ŒIntentä¸­ä¼ é€’æ•°æ®ï¼Œå¼ºçƒˆæ¨èä½¿ç”¨  <code>Parcelable</code> ä»–çš„æ•ˆç‡ä¼šæ¯” <code>Serializable</code>æ›´é«˜ï¼ˆæ¯”å¦‚åè€…æ²¡æœ‰ä½¿ç”¨åå°„ç­‰ç­‰ï¼‰ã€‚å½“ç„¶æ²¡æœ‰å®Œç¾çš„äº‹æƒ…ï¼Œ<code>Parcelable</code> å¹¶ä¸èƒ½å®Œå…¨å–ä»£<code>Serializable</code>ï¼Œæ¯”å¦‚å°†JVMå¯¹è±¡å­˜å‚¨åˆ°ç£ç›˜ç­‰ç­‰ã€‚ä½†æ˜¯å¯¹äºAndroidå¼€å‘ä¸­çš„é€šè¿‡Intentä¼ é€’æ•°æ®æ¥è¯´ï¼Œå·²ç»è¶³å¤Ÿã€‚</p>
<h2 id="0xFF-å‚è€ƒ"><a href="/1970/01/01/[Android]é€šè¿‡Intentä¼ é€’æ•°æ®/#0xFF-å‚è€ƒ" class="headerlink" title="0xFF å‚è€ƒ"></a>0xFF å‚è€ƒ</h2><ol>
<li><a href="http://stackoverflow.com/questions/3611843/is-using-serializable-in-android-bad/3612364#3612364" target="_blank" rel="external">http://stackoverflow.com/questions/3611843/is-using-serializable-in-android-bad/3612364#3612364</a></li>
<li><a href="http://www.ibm.com/developerworks/cn/java/j-lo-serial/index.html" target="_blank" rel="external">http://www.ibm.com/developerworks/cn/java/j-lo-serial/index.html</a></li>
<li><a href="https://developer.android.com/reference/android/os/Parcelable.html" target="_blank" rel="external">https://developer.android.com/reference/android/os/Parcelable.html</a></li>
<li><a href="http://blog.csdn.net/js931178805/article/details/8268144" target="_blank" rel="external">http://blog.csdn.net/js931178805/article/details/8268144</a></li>
</ol>
<p><img src="https://raw.githubusercontent.com/ttdevs/ttdevs.github.io/common/images/logo.png" alt="Create by ttdevs"></p>
]]></content>
      
        <categories>
            
            <category> æŠ€æœ¯ </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Android </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[ã€ŒAndroidã€æ»šè½®åˆ»åº¦å°ºçš„å®ç°]]></title>
      <url>/1970/01/01/%5BAndroid%5D%E6%BB%9A%E8%BD%AE%E5%88%BB%E5%BA%A6%E5%B0%BA%E7%9A%84%E5%AE%9E%E7%8E%B0/</url>
      <content type="html"><![CDATA[<h2 id="0x00-æ»šè½®åˆ»åº¦å°ºï¼ˆå·å°ºï¼‰"><a href="/1970/01/01/[Android]æ»šè½®åˆ»åº¦å°ºçš„å®ç°/#0x00-æ»šè½®åˆ»åº¦å°ºï¼ˆå·å°ºï¼‰" class="headerlink" title="0x00 æ»šè½®åˆ»åº¦å°ºï¼ˆå·å°ºï¼‰"></a>0x00 æ»šè½®åˆ»åº¦å°ºï¼ˆå·å°ºï¼‰</h2><p>é‡åˆ°ä¸‹é¢è¿™æ ·ä¸€ä¸ªéœ€æ±‚ï¼š</p>
<p><img src="http://img.blog.csdn.net/20140831150159887?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvdHRkZXZz/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt="æ»šè½®åˆ»åº¦å°º">  </p>
<h2 id="0x01-é—®é¢˜åˆ†æ"><a href="/1970/01/01/[Android]æ»šè½®åˆ»åº¦å°ºçš„å®ç°/#0x01-é—®é¢˜åˆ†æ" class="headerlink" title="0x01 é—®é¢˜åˆ†æ"></a>0x01 é—®é¢˜åˆ†æ</h2><p>å·å°ºï¼Œé€šè¿‡å·¦å³æ»‘åŠ¨æ¥é€‰æ‹©ä¸åŒçš„åˆ»åº¦å€¼ã€‚è¿™æ–¹é¢çš„ä¸œè¥¿ä»¥å‰æ²¡å¼„è¿‡ï¼Œä»¥ç›®å‰ä½ çš„èƒ½åŠ›ï¼Œæƒ³äº†å‡ ç§æ€è·¯éƒ½æ­»åœ¨äº†åŠè·¯ä¸Šã€‚æ¯”å¦‚ä¸Šé¢çš„åˆ»åº¦çº¿å¦‚ä½•å¼„ï¼Œæ»‘åŠ¨çš„æ—¶å€™åˆè¯¥å¦‚ä½•å¼„ï¼›ä¸‹é¢çš„æ•°å­—åˆå¦‚ä½•å¼„ï¼›çœ‹èµ·æ¥åƒåœ†åœˆçš„æ•ˆæœè¯¥å¦‚ä½•å¼„ã€‚æ—¶é—´ç´§è¿«ï¼Œå°±ä¿©æ™šä¸Šçš„æ—¶é—´ã€‚æ²¡æœ‰å¥½çš„æ€è·¯å°±å‚è€ƒåˆ«äººçš„å…ˆå§ï¼Œè¯´æ¥ä¹Ÿå·§ï¼Œä¸¤å¤©å‰åˆšçœ‹è¿‡ä¸€ä¸ªæ—¥æœŸé€‰æ‹©æ§ä»¶ï¼Œè¿˜æœ‰ä»¥å‰çœ‹çš„ä¸€ä¸ª<a href="http://blog.csdn.net/lilu_leo/article/details/7397697" target="_blank" rel="external">ä»¿iPhoneæ»šåŠ¨æ§ä»¶</a> ï¼Œæ•ˆæœç±»ä¼¼ï¼š</p>
<p><img src="http://img.blog.csdn.net/20140831151514968?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvdHRkZXZz/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt=""> </p>
<p><img src="http://img.blog.csdn.net/20140831151748056?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvdHRkZXZz/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt="">  </p>
<p>æœ¬æƒ³æ‰¾ä½œè€…<a href="http://blog.csdn.net/lilu_leo" target="_blank" rel="external">å‚²æ…¢çš„ä¸Šæ ¡</a>äº¤æµä¸‹ï¼Œä½†æ˜¯æ—¶é—´æ¯”è¾ƒç´§ï¼Œæºç éƒ½ç»™äº†ä¹Ÿä¸æ˜¯å¾ˆå¥½æ„æ€ã€‚å¤§è‡´çš„æµè§ˆäº†ä¸‹ï¼Œå¯èƒ½æ¶‰åŠä¸‹é¢å‡ ä¸ªä¸œè¥¿ï¼š</p>
<ul>
<li>èƒŒæ™¯ï¼šè¿™ä¸ªç”¨shapeå®ç°ã€‚ä¹‹å‰æœ‰ç ”ç©¶è¿‡ï¼Œä¹Ÿç”¨è¿‡ï¼Œä½†æ˜¯è¿˜æ²¡å®ç°è¿‡è¦æ±‚çš„æ•ˆæœ</li>
<li>åˆ»åº¦å’Œæ•°å­—ï¼šè¿™ä¸ªå°±ä¸è¦ä¹±æƒ³äº†ï¼Œç›´æ¥drawã€‚ç›¸å¯¹æ¥è¯´è¿˜æ˜¯æ¯”è¾ƒç®€å•çš„ï¼Œå°±æ˜¯ç”»ç›´çº¿å’Œå­—</li>
<li>æ»šåŠ¨ï¼šæ»šåŠ¨çš„æ—¶å€™ä¸åœçš„é‡ç»˜å®ç°ä¸€ä¸ªæ»šåŠ¨çš„æ•ˆæœã€‚å¼„è¿‡ï¼Œä½†æ˜¯ä¸ç¡®å®šå®ç°çš„æ˜¯å•¥æ ·çš„æ•ˆæœ</li>
<li>å¿«é€Ÿæ»šåŠ¨ï¼šScrollerå’ŒVelocityTrackerå¯èƒ½æ˜¯éœ€è¦ç”¨åˆ°çš„ä¸œè¥¿ã€‚å‡ ä¹å®Œå…¨æ²¡å¼„è¿‡ï¼Œéªšå¹´ï¼Œå­¦ä¹ å§ï¼ˆéœ€æ±‚çš„è¦æ±‚ä¸­ï¼Œè¿™ä¸ªä¼˜å…ˆçº§å¯ä»¥æœ€ä½ï¼‰</li>
<li>éœ€æ±‚ï¼šåˆ»åº¦çš„å•ä½æ˜¯å¯ä»¥å˜çš„ï¼Œæ¯”å¦‚åæ ¼ä¸€ä¸ªå•ä½ï¼Œæˆ–è€…ä¸¤æ ¼ä¸€ä¸ªå•ä½ï¼Œåœ¨æˆ–è€…å¯ä»¥æ˜¯ä»»æ„çš„ï¼ˆè¿™ä¸ªå‰æœŸæ€è·¯æ²¡æƒ³å¥½ï¼Œå®ç°èµ·æ¥å°±å›°éš¾äº†ï¼Œæœ€ååªå¼„äº†ä¸¤ç§ï¼‰</li>
</ul>
<p>å…¶å®ï¼Œåˆ°äº†è¿™ä¸€æ­¥åŸºæœ¬ä¸Šå°±å·²ç»å¯ä»¥å®ç°äº†ï¼Œçœ‹ä¸ªæœ€ç»ˆæ•ˆæœå…ˆï¼š</p>
<p><img src="http://img.blog.csdn.net/20140831153554458?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvdHRkZXZz/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt="">  </p>
<h2 id="0x02-å®ç°"><a href="/1970/01/01/[Android]æ»šè½®åˆ»åº¦å°ºçš„å®ç°/#0x02-å®ç°" class="headerlink" title="0x02 å®ç°"></a>0x02 å®ç°</h2><p>ä¸‹é¢ä¸€æ­¥ä¸€æ­¥æ¥ã€‚</p>
<p>åœ¨è¿™ä¹‹å‰è¿˜æœ‰ä¸ªåœ°æ–¹è¦è¯´çš„ï¼Œå°±æ˜¯æ§ä»¶çš„æ¥å£ï¼šå¯¹å¤–æä¾›ä¸€ä¸ªæ–¹æ³•å®ç°æ§ä»¶åˆå§‹åŒ–å’Œæ¥æ”¶æ§ä»¶é€‰æ‹©çš„å€¼ï¼šæ˜¾ç¤ºçš„å•ä½ï¼Œæœ€å¤§å€¼ï¼Œæœ€å°å€¼ï¼Œå½“å‰å€¼ï¼Œå›è°ƒæ¥å£ã€‚æœ‰äº†è¿™äº›ï¼Œå…ˆä»æœ€éš¾çš„å…¥æ‰‹ã€‚</p>
<ul>
<li>å®ç°åˆ»åº¦å’Œæ•°å­—ï¼Œå¹¶å¯ä»¥æ»‘åŠ¨</li>
</ul>
<p>è¿™ä¸ªåœ°æ–¹å¾ˆå…³é”®ï¼Œæ¯ä¸ªäººæœ‰æ¯ä¸ªäººçš„æ€è·¯ï¼Œè€Œä¸”æ€è·¯çš„å¥½åç›´æ¥å½±å“åˆ°åé¢å¯¹ä¸åŒå•ä½çš„å®ç°ã€‚ç›®å‰çš„æ€è·¯æ˜¯æ ¹æ®å½“å‰æ˜¾ç¤ºçš„æ•°å€¼mValueï¼Œä»æ§ä»¶ä¸­é—´å‘ä¸¤è¾¹ç”»åˆ»åº¦çº¿ï¼Œæ»‘åŠ¨çš„æ—¶å€™åŒæ—¶æ”¹å˜æ˜¾ç¤ºçš„å€¼mValueï¼Œä¸è¶³æœ€å°åˆ»åº¦çš„å››èˆäº”å…¥ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@Override</span></div><div class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onDraw</span><span class="params">(Canvas canvas)</span> </span>&#123;</div><div class="line">   <span class="keyword">super</span>.onDraw(canvas);</div><div class="line"></div><div class="line">   drawScaleLine(canvas);</div><div class="line">   <span class="comment">// drawWheel(canvas);</span></div><div class="line">   drawMiddleLine(canvas);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">drawWheel</span><span class="params">(Canvas canvas)</span> </span>&#123;</div><div class="line">   Drawable wheel = getResources().getDrawable(R.drawable.bg_wheel);</div><div class="line">   wheel.setBounds(<span class="number">0</span>, <span class="number">0</span>, getWidth(), getHeight());</div><div class="line">   wheel.draw(canvas);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line">* ä»ä¸­é—´å¾€ä¸¤è¾¹å¼€å§‹ç”»åˆ»åº¦çº¿</div><div class="line">*</div><div class="line">* <span class="doctag">@param</span> canvas</div><div class="line">*/</div><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">drawScaleLine</span><span class="params">(Canvas canvas)</span> </span>&#123;</div><div class="line">   canvas.save();</div><div class="line"></div><div class="line">   Paint linePaint = <span class="keyword">new</span> Paint();</div><div class="line">   linePaint.setStrokeWidth(<span class="number">2</span>);</div><div class="line">   linePaint.setColor(Color.BLACK);</div><div class="line"></div><div class="line">   TextPaint textPaint = <span class="keyword">new</span> TextPaint(Paint.ANTI_ALIAS_FLAG);</div><div class="line">   textPaint.setTextSize(TEXT_SIZE * mDensity);</div><div class="line"></div><div class="line">   <span class="keyword">int</span> width = mWidth, drawCount = <span class="number">0</span>;</div><div class="line">   <span class="keyword">float</span> xPosition = <span class="number">0</span>, textWidth = Layout.getDesiredWidth(<span class="string">"0"</span>, textPaint);</div><div class="line"></div><div class="line">   <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; drawCount &lt;= <span class="number">4</span> * width; i++) &#123;</div><div class="line">       <span class="keyword">int</span> numSize = String.valueOf(mValue + i).length();</div><div class="line"></div><div class="line">       xPosition = (width / <span class="number">2</span> - mMove) + i * mLineDivider * mDensity;</div><div class="line">       <span class="keyword">if</span> (xPosition + getPaddingRight() &lt; mWidth) &#123;</div><div class="line">           <span class="keyword">if</span> ((mValue + i) % mModType == <span class="number">0</span>) &#123;</div><div class="line">               canvas.drawLine(xPosition, getPaddingTop(), xPosition, mDensity * ITEM_MAX_HEIGHT, linePaint);</div><div class="line"></div><div class="line">               <span class="keyword">if</span> (mValue + i &lt;= mMaxValue) &#123;</div><div class="line">                   <span class="keyword">switch</span> (mModType) &#123;</div><div class="line">                       <span class="keyword">case</span> MOD_TYPE_HALF:</div><div class="line">                           canvas.drawText(String.valueOf((mValue + i) / <span class="number">2</span>), countLeftStart(mValue + i, xPosition, textWidth), getHeight() - textWidth, textPaint);</div><div class="line">                           <span class="keyword">break</span>;</div><div class="line">                       <span class="keyword">case</span> MOD_TYPE_ONE:</div><div class="line">                           canvas.drawText(String.valueOf(mValue + i), xPosition - (textWidth * numSize / <span class="number">2</span>), getHeight() - textWidth, textPaint);</div><div class="line">                           <span class="keyword">break</span>;</div><div class="line"></div><div class="line">                       <span class="keyword">default</span>:</div><div class="line">                           <span class="keyword">break</span>;</div><div class="line">                   &#125;</div><div class="line">               &#125;</div><div class="line">           &#125; <span class="keyword">else</span> &#123;</div><div class="line">               canvas.drawLine(xPosition, getPaddingTop(), xPosition, mDensity * ITEM_MIN_HEIGHT, linePaint);</div><div class="line">           &#125;</div><div class="line">       &#125;</div><div class="line"></div><div class="line">       xPosition = (width / <span class="number">2</span> - mMove) - i * mLineDivider * mDensity;</div><div class="line">       <span class="keyword">if</span> (xPosition &gt; getPaddingLeft()) &#123;</div><div class="line">           <span class="keyword">if</span> ((mValue - i) % mModType == <span class="number">0</span>) &#123;</div><div class="line">               canvas.drawLine(xPosition, getPaddingTop(), xPosition, mDensity * ITEM_MAX_HEIGHT, linePaint);</div><div class="line"></div><div class="line">               <span class="keyword">if</span> (mValue - i &gt;= <span class="number">0</span>) &#123;</div><div class="line">                   <span class="keyword">switch</span> (mModType) &#123;</div><div class="line">                       <span class="keyword">case</span> MOD_TYPE_HALF:</div><div class="line">                           canvas.drawText(String.valueOf((mValue - i) / <span class="number">2</span>), countLeftStart(mValue - i, xPosition, textWidth), getHeight() - textWidth, textPaint);</div><div class="line">                           <span class="keyword">break</span>;</div><div class="line">                       <span class="keyword">case</span> MOD_TYPE_ONE:</div><div class="line">                           canvas.drawText(String.valueOf(mValue - i), xPosition - (textWidth * numSize / <span class="number">2</span>), getHeight() - textWidth, textPaint);</div><div class="line">                           <span class="keyword">break</span>;</div><div class="line"></div><div class="line">                       <span class="keyword">default</span>:</div><div class="line">                           <span class="keyword">break</span>;</div><div class="line">                   &#125;</div><div class="line">               &#125;</div><div class="line">           &#125; <span class="keyword">else</span> &#123;</div><div class="line">               canvas.drawLine(xPosition, getPaddingTop(), xPosition, mDensity * ITEM_MIN_HEIGHT, linePaint);</div><div class="line">           &#125;</div><div class="line">       &#125;</div><div class="line"></div><div class="line">       drawCount += <span class="number">2</span> * mLineDivider * mDensity;</div><div class="line">   &#125;</div><div class="line"></div><div class="line">   canvas.restore();</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>æ»‘åŠ¨çš„åŠ é€Ÿé—®é¢˜</li>
</ul>
<p>è¿™é‡Œç”¨åˆ°ä¸¤ä¸ªç±»Scrollerå’ŒVelocityTrackerï¼Œå…³äºè¿™ä¸¤ä¸ªç±»ä¹‹åæœ‰æœºä¼šä¼šè¯¦ç»†ä»‹ç»ï¼Œè¿™é‡Œç®€å•æä¸‹ï¼šVelocityTrackerçš„ä½œç”¨æ˜¯åœ¨ç”¨æˆ·åŠ é€Ÿæ»‘åŠ¨æ—¶è®¡ç®—è¯¥æ»‘åŠ¨å¤šè¿œï¼Œæ‹¿åˆ°è¿™ä¸ªä¹‹åé€šè¿‡Scrolleræ¥æ‰§è¡Œæ»‘åŠ¨è¿‡ç¨‹çš„è®¡ç®—ï¼Œæœ€åæ˜¯çœŸå®çš„â€œç§»åŠ¨â€â€”â€”æ ¹æ®mValueçš„å€¼è¿›è¡Œé‡ç»˜ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@Override</span></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">onTouchEvent</span><span class="params">(MotionEvent event)</span> </span>&#123;</div><div class="line">   <span class="keyword">int</span> action = event.getAction();</div><div class="line">   <span class="keyword">int</span> xPosition = (<span class="keyword">int</span>) event.getX();</div><div class="line"></div><div class="line">   <span class="keyword">if</span> (mVelocityTracker == <span class="keyword">null</span>) &#123;</div><div class="line">       mVelocityTracker = VelocityTracker.obtain();</div><div class="line">   &#125;</div><div class="line">   mVelocityTracker.addMovement(event);</div><div class="line"></div><div class="line">   <span class="keyword">switch</span> (action) &#123;</div><div class="line">       <span class="keyword">case</span> MotionEvent.ACTION_DOWN:</div><div class="line"></div><div class="line">           mScroller.forceFinished(<span class="keyword">true</span>);</div><div class="line"></div><div class="line">           mLastX = xPosition;</div><div class="line">           mMove = <span class="number">0</span>;</div><div class="line">           <span class="keyword">break</span>;</div><div class="line">       <span class="keyword">case</span> MotionEvent.ACTION_MOVE:</div><div class="line">           mMove += (mLastX - xPosition);</div><div class="line">           changeMoveAndValue();</div><div class="line">           <span class="keyword">break</span>;</div><div class="line">       <span class="keyword">case</span> MotionEvent.ACTION_UP:</div><div class="line">       <span class="keyword">case</span> MotionEvent.ACTION_CANCEL:</div><div class="line">           countMoveEnd();</div><div class="line">           countVelocityTracker(event);</div><div class="line">           <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">       <span class="comment">// break;</span></div><div class="line">       <span class="keyword">default</span>:</div><div class="line">           <span class="keyword">break</span>;</div><div class="line">   &#125;</div><div class="line"></div><div class="line">   mLastX = xPosition;</div><div class="line">   <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">countVelocityTracker</span><span class="params">(MotionEvent event)</span> </span>&#123;</div><div class="line">   mVelocityTracker.computeCurrentVelocity(<span class="number">1000</span>);</div><div class="line">   <span class="keyword">float</span> xVelocity = mVelocityTracker.getXVelocity();</div><div class="line">   <span class="keyword">if</span> (Math.abs(xVelocity) &gt; mMinVelocity) &#123;</div><div class="line">       mScroller.fling(<span class="number">0</span>, <span class="number">0</span>, (<span class="keyword">int</span>) xVelocity, <span class="number">0</span>, Integer.MIN_VALUE, Integer.MAX_VALUE, <span class="number">0</span>, <span class="number">0</span>);</div><div class="line">   &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">changeMoveAndValue</span><span class="params">()</span> </span>&#123;</div><div class="line">   <span class="keyword">int</span> tValue = (<span class="keyword">int</span>) (mMove / (mLineDivider * mDensity));</div><div class="line">   <span class="keyword">if</span> (Math.abs(tValue) &gt; <span class="number">0</span>) &#123;</div><div class="line">       mValue += tValue;</div><div class="line">       mMove -= tValue * mLineDivider * mDensity;</div><div class="line">       <span class="keyword">if</span> (mValue &lt;= <span class="number">0</span> || mValue &gt; mMaxValue) &#123;</div><div class="line">           mValue = mValue &lt;= <span class="number">0</span> ? <span class="number">0</span> : mMaxValue;</div><div class="line">           mMove = <span class="number">0</span>;</div><div class="line">           mScroller.forceFinished(<span class="keyword">true</span>);</div><div class="line">       &#125;</div><div class="line">       notifyValueChange();</div><div class="line">   &#125;</div><div class="line">   postInvalidate();</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">countMoveEnd</span><span class="params">()</span> </span>&#123;</div><div class="line">   <span class="keyword">int</span> roundMove = Math.round(mMove / (mLineDivider * mDensity));</div><div class="line">   mValue = mValue + roundMove;</div><div class="line">   mValue = mValue &lt;= <span class="number">0</span> ? <span class="number">0</span> : mValue;</div><div class="line">   mValue = mValue &gt; mMaxValue ? mMaxValue : mValue;</div><div class="line"></div><div class="line">   mLastX = <span class="number">0</span>;</div><div class="line">   mMove = <span class="number">0</span>;</div><div class="line"></div><div class="line">   notifyValueChange();</div><div class="line">   postInvalidate();</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">notifyValueChange</span><span class="params">()</span> </span>&#123;</div><div class="line">   <span class="keyword">if</span> (<span class="keyword">null</span> != mListener) &#123;</div><div class="line">       <span class="keyword">if</span> (mModType == MOD_TYPE_ONE) &#123;</div><div class="line">           mListener.onValueChange(mValue);</div><div class="line">       &#125;</div><div class="line">       <span class="keyword">if</span> (mModType == MOD_TYPE_HALF) &#123;</div><div class="line">           mListener.onValueChange(mValue / <span class="number">2f</span>);</div><div class="line">       &#125;</div><div class="line">   &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="meta">@Override</span></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">computeScroll</span><span class="params">()</span> </span>&#123;</div><div class="line">   <span class="keyword">super</span>.computeScroll();</div><div class="line">   <span class="keyword">if</span> (mScroller.computeScrollOffset()) &#123;</div><div class="line">       <span class="keyword">if</span> (mScroller.getCurrX() == mScroller.getFinalX()) &#123; <span class="comment">// over</span></div><div class="line">           countMoveEnd();</div><div class="line">       &#125; <span class="keyword">else</span> &#123;</div><div class="line">           <span class="keyword">int</span> xPosition = mScroller.getCurrX();</div><div class="line">           mMove += (mLastX - xPosition);</div><div class="line">           changeMoveAndValue();</div><div class="line">           mLastX = xPosition;</div><div class="line">       &#125;</div><div class="line">   &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>åœ†åœˆèƒŒæ™¯çš„å®ç°</li>
</ul>
<p>è¿™ä¸ªç”¨shapeæ¥åšï¼Œå¯ä»¥ä½¿ç”¨setBackgroundDrawable()æ¥åšï¼Œä¹Ÿå¯ä»¥åœ¨drawä¸­è¿›è¡Œç›´æ¥ç»˜åˆ¶ï¼Œæ•ˆæœç›¸åŒã€‚è¿˜æœ‰ä¸€äº›ç»†èŠ‚é—®é¢˜ï¼Œæ¯”å¦‚æ»‘åŠ¨æ—¶åˆ»åº¦çº¿è¶…è¿‡è¾¹ç•Œï¼Œæ»‘åŠ¨è·ç¦»å¤§æ—¶å€™æ˜¾ç¤ºä¸å®Œæ•´ç­‰é—®é¢˜ï¼Œè¿™ä¸ªåªæœ‰åšäº†æ‰ä¼šå‘ç°ã€‚ä¸‹é¢æ˜¯shapeèƒŒæ™¯çš„ä»£ç ï¼š</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">&lt;?xml version="1.0" encoding="utf-8"?&gt;</div><div class="line"><span class="tag">&lt;<span class="name">shape</span> <span class="attr">xmlns:android</span>=<span class="string">"http://schemas.android.com/apk/res/android"</span></span></div><div class="line">   <span class="attr">android:shape</span>=<span class="string">"rectangle"</span> &gt;</div><div class="line">    </div><div class="line">   <span class="comment">&lt;!-- two set color way --&gt;</span></div><div class="line">   <span class="tag">&lt;<span class="name">gradient</span></span></div><div class="line">       <span class="attr">android:angle</span>=<span class="string">"0"</span></div><div class="line">       <span class="attr">android:centerColor</span>=<span class="string">"#66FFFFFF"</span></div><div class="line">       <span class="attr">android:endColor</span>=<span class="string">"#66AAAAAA"</span></div><div class="line">       <span class="attr">android:startColor</span>=<span class="string">"#66AAAAAA"</span> /&gt;</div><div class="line">    </div><div class="line">   <span class="tag">&lt;<span class="name">corners</span> <span class="attr">android:radius</span>=<span class="string">"6dp"</span> /&gt;</span></div><div class="line">    </div><div class="line">   <span class="tag">&lt;<span class="name">stroke</span></span></div><div class="line">       <span class="attr">android:width</span>=<span class="string">"6dp"</span></div><div class="line">       <span class="attr">android:color</span>=<span class="string">"#FF666666"</span> /&gt;</div><div class="line">    </div><div class="line"><span class="tag">&lt;/<span class="name">shape</span>&gt;</span></div></pre></td></tr></table></figure>
<p>ç”¨ä»£ç å¯ä»¥è¿™æ ·å†™ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">private</span> GradientDrawable <span class="title">createBackground</span><span class="params">()</span> </span>&#123;</div><div class="line">   <span class="keyword">float</span> strokeWidth = <span class="number">4</span> * mDensity; <span class="comment">// è¾¹æ¡†å®½åº¦</span></div><div class="line">   <span class="keyword">float</span> roundRadius = <span class="number">6</span> * mDensity; <span class="comment">// åœ†è§’åŠå¾„</span></div><div class="line">   <span class="keyword">int</span> strokeColor = Color.parseColor(<span class="string">"#FF666666"</span>);<span class="comment">// è¾¹æ¡†é¢œè‰²</span></div><div class="line">   <span class="comment">// int fillColor = Color.parseColor("#DFDFE0");// å†…éƒ¨å¡«å……é¢œè‰²</span></div><div class="line"></div><div class="line">   setPadding((<span class="keyword">int</span>) strokeWidth, (<span class="keyword">int</span>) strokeWidth, (<span class="keyword">int</span>) strokeWidth, <span class="number">0</span>);</div><div class="line"></div><div class="line">   <span class="keyword">int</span> colors[] = &#123;<span class="number">0xFF999999</span>, <span class="number">0xFFFFFFFF</span>, <span class="number">0xFF999999</span>&#125;;<span class="comment">// åˆ†åˆ«ä¸ºå¼€å§‹é¢œè‰²ï¼Œä¸­é—´å¤œè‰²ï¼Œç»“æŸé¢œè‰²</span></div><div class="line">   GradientDrawable bgDrawable = <span class="keyword">new</span> GradientDrawable(GradientDrawable.Orientation.LEFT_RIGHT, colors);<span class="comment">// åˆ›å»ºdrawable</span></div><div class="line">   <span class="comment">// bgDrawable.setColor(fillColor);</span></div><div class="line">   bgDrawable.setCornerRadius(roundRadius);</div><div class="line">   bgDrawable.setStroke((<span class="keyword">int</span>) strokeWidth, strokeColor);</div><div class="line">   <span class="comment">// setBackgroundDrawable(gd);</span></div><div class="line">   <span class="keyword">return</span> bgDrawable;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="0x03-å®Œæ•´çš„ä»£ç "><a href="/1970/01/01/[Android]æ»šè½®åˆ»åº¦å°ºçš„å®ç°/#0x03-å®Œæ•´çš„ä»£ç " class="headerlink" title="0x03 å®Œæ•´çš„ä»£ç "></a>0x03 å®Œæ•´çš„ä»£ç </h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div><div class="line">196</div><div class="line">197</div><div class="line">198</div><div class="line">199</div><div class="line">200</div><div class="line">201</div><div class="line">202</div><div class="line">203</div><div class="line">204</div><div class="line">205</div><div class="line">206</div><div class="line">207</div><div class="line">208</div><div class="line">209</div><div class="line">210</div><div class="line">211</div><div class="line">212</div><div class="line">213</div><div class="line">214</div><div class="line">215</div><div class="line">216</div><div class="line">217</div><div class="line">218</div><div class="line">219</div><div class="line">220</div><div class="line">221</div><div class="line">222</div><div class="line">223</div><div class="line">224</div><div class="line">225</div><div class="line">226</div><div class="line">227</div><div class="line">228</div><div class="line">229</div><div class="line">230</div><div class="line">231</div><div class="line">232</div><div class="line">233</div><div class="line">234</div><div class="line">235</div><div class="line">236</div><div class="line">237</div><div class="line">238</div><div class="line">239</div><div class="line">240</div><div class="line">241</div><div class="line">242</div><div class="line">243</div><div class="line">244</div><div class="line">245</div><div class="line">246</div><div class="line">247</div><div class="line">248</div><div class="line">249</div><div class="line">250</div><div class="line">251</div><div class="line">252</div><div class="line">253</div><div class="line">254</div><div class="line">255</div><div class="line">256</div><div class="line">257</div><div class="line">258</div><div class="line">259</div><div class="line">260</div><div class="line">261</div><div class="line">262</div><div class="line">263</div><div class="line">264</div><div class="line">265</div><div class="line">266</div><div class="line">267</div><div class="line">268</div><div class="line">269</div><div class="line">270</div><div class="line">271</div><div class="line">272</div><div class="line">273</div><div class="line">274</div><div class="line">275</div><div class="line">276</div><div class="line">277</div><div class="line">278</div><div class="line">279</div><div class="line">280</div><div class="line">281</div><div class="line">282</div><div class="line">283</div><div class="line">284</div><div class="line">285</div><div class="line">286</div><div class="line">287</div><div class="line">288</div><div class="line">289</div><div class="line">290</div><div class="line">291</div><div class="line">292</div><div class="line">293</div><div class="line">294</div><div class="line">295</div><div class="line">296</div><div class="line">297</div><div class="line">298</div><div class="line">299</div><div class="line">300</div><div class="line">301</div><div class="line">302</div><div class="line">303</div><div class="line">304</div><div class="line">305</div><div class="line">306</div><div class="line">307</div><div class="line">308</div><div class="line">309</div><div class="line">310</div><div class="line">311</div><div class="line">312</div><div class="line">313</div><div class="line">314</div><div class="line">315</div><div class="line">316</div><div class="line">317</div><div class="line">318</div><div class="line">319</div><div class="line">320</div><div class="line">321</div><div class="line">322</div><div class="line">323</div><div class="line">324</div><div class="line">325</div><div class="line">326</div><div class="line">327</div><div class="line">328</div><div class="line">329</div><div class="line">330</div><div class="line">331</div><div class="line">332</div><div class="line">333</div><div class="line">334</div><div class="line">335</div><div class="line">336</div><div class="line">337</div><div class="line">338</div><div class="line">339</div><div class="line">340</div><div class="line">341</div><div class="line">342</div><div class="line">343</div><div class="line">344</div><div class="line">345</div><div class="line">346</div><div class="line">347</div><div class="line">348</div><div class="line">349</div><div class="line">350</div><div class="line">351</div><div class="line">352</div><div class="line">353</div><div class="line">354</div><div class="line">355</div><div class="line">356</div><div class="line">357</div><div class="line">358</div><div class="line">359</div><div class="line">360</div><div class="line">361</div><div class="line">362</div><div class="line">363</div><div class="line">364</div><div class="line">365</div><div class="line">366</div><div class="line">367</div><div class="line">368</div><div class="line">369</div><div class="line">370</div><div class="line">371</div><div class="line">372</div><div class="line">373</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> com.ttdevs.wheel.widget;</div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line"> * å·å°ºæ§ä»¶ç±»ã€‚ç”±äºæ—¶é—´æ¯”è¾ƒç´§ï¼Œåªæœ‰ä¸‹ç­åæœ‰æ—¶é—´ï¼Œå› æ­¤åªå®ç°äº†åŸºæœ¬åŠŸèƒ½ã€‚&lt;br&gt;</div><div class="line"> * ç»†èŠ‚é—®é¢˜åŒ…æ‹¬æ»‘åŠ¨è¿‡ç¨‹ä¸­widgetè¾¹ç¼˜çš„åˆ»åº¦æ˜¾ç¤ºé—®é¢˜ç­‰&lt;br&gt;</div><div class="line"> * &lt;p&gt;</div><div class="line"> * å‘¨æœ«æœ‰æ—¶é—´ä¼šç»§ç»­æ›´æ–°&lt;br&gt;</div><div class="line"> *</div><div class="line"> * <span class="doctag">@author</span> ttdevs</div><div class="line"> * <span class="doctag">@version</span> createï¼š2014å¹´8æœˆ26æ—¥</div><div class="line"> */</div><div class="line"><span class="meta">@SuppressLint</span>(<span class="string">"ClickableViewAccessibility"</span>)</div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TuneWheel</span> <span class="keyword">extends</span> <span class="title">View</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">OnValueChangeListener</span> </span>&#123;</div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onValueChange</span><span class="params">(<span class="keyword">float</span> value)</span></span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> MOD_TYPE_HALF = <span class="number">2</span>;</div><div class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> MOD_TYPE_ONE = <span class="number">10</span>;</div><div class="line"></div><div class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> ITEM_HALF_DIVIDER = <span class="number">40</span>;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> ITEM_ONE_DIVIDER = <span class="number">10</span>;</div><div class="line"></div><div class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> ITEM_MAX_HEIGHT = <span class="number">50</span>;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> ITEM_MIN_HEIGHT = <span class="number">20</span>;</div><div class="line"></div><div class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> TEXT_SIZE = <span class="number">18</span>;</div><div class="line"></div><div class="line">    <span class="keyword">private</span> <span class="keyword">float</span> mDensity;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">int</span> mValue = <span class="number">50</span>, mMaxValue = <span class="number">100</span>, mModType = MOD_TYPE_HALF, mLineDivider = ITEM_HALF_DIVIDER;</div><div class="line">    <span class="comment">// private int mValue = 50, mMaxValue = 500, mModType = MOD_TYPE_ONE,</span></div><div class="line">    <span class="comment">// mLineDivider = ITEM_ONE_DIVIDER;</span></div><div class="line"></div><div class="line">    <span class="keyword">private</span> <span class="keyword">int</span> mLastX, mMove;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">int</span> mWidth, mHeight;</div><div class="line"></div><div class="line">    <span class="keyword">private</span> <span class="keyword">int</span> mMinVelocity;</div><div class="line">    <span class="keyword">private</span> Scroller mScroller;</div><div class="line">    <span class="keyword">private</span> VelocityTracker mVelocityTracker;</div><div class="line"></div><div class="line">    <span class="keyword">private</span> OnValueChangeListener mListener;</div><div class="line"></div><div class="line">    <span class="meta">@SuppressWarnings</span>(<span class="string">"deprecation"</span>)</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">TuneWheel</span><span class="params">(Context context, AttributeSet attrs)</span> </span>&#123;</div><div class="line">        <span class="keyword">super</span>(context, attrs);</div><div class="line"></div><div class="line">        mScroller = <span class="keyword">new</span> Scroller(getContext());</div><div class="line">        mDensity = getContext().getResources().getDisplayMetrics().density;</div><div class="line"></div><div class="line">        mMinVelocity = ViewConfiguration.get(getContext()).getScaledMinimumFlingVelocity();</div><div class="line"></div><div class="line">        <span class="comment">// setBackgroundResource(R.drawable.bg_wheel);</span></div><div class="line">        setBackgroundDrawable(createBackground());</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">private</span> GradientDrawable <span class="title">createBackground</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">float</span> strokeWidth = <span class="number">4</span> * mDensity; <span class="comment">// è¾¹æ¡†å®½åº¦</span></div><div class="line">        <span class="keyword">float</span> roundRadius = <span class="number">6</span> * mDensity; <span class="comment">// åœ†è§’åŠå¾„</span></div><div class="line">        <span class="keyword">int</span> strokeColor = Color.parseColor(<span class="string">"#FF666666"</span>);<span class="comment">// è¾¹æ¡†é¢œè‰²</span></div><div class="line">        <span class="comment">// int fillColor = Color.parseColor("#DFDFE0");// å†…éƒ¨å¡«å……é¢œè‰²</span></div><div class="line"></div><div class="line">        setPadding((<span class="keyword">int</span>) strokeWidth, (<span class="keyword">int</span>) strokeWidth, (<span class="keyword">int</span>) strokeWidth, <span class="number">0</span>);</div><div class="line"></div><div class="line">        <span class="keyword">int</span> colors[] = &#123;<span class="number">0xFF999999</span>, <span class="number">0xFFFFFFFF</span>, <span class="number">0xFF999999</span>&#125;;<span class="comment">// åˆ†åˆ«ä¸ºå¼€å§‹é¢œè‰²ï¼Œä¸­é—´å¤œè‰²ï¼Œç»“æŸé¢œè‰²</span></div><div class="line">        GradientDrawable bgDrawable = <span class="keyword">new</span> GradientDrawable(GradientDrawable.Orientation.LEFT_RIGHT, colors);<span class="comment">// åˆ›å»ºdrawable</span></div><div class="line">        <span class="comment">// bgDrawable.setColor(fillColor);</span></div><div class="line">        bgDrawable.setCornerRadius(roundRadius);</div><div class="line">        bgDrawable.setStroke((<span class="keyword">int</span>) strokeWidth, strokeColor);</div><div class="line">        <span class="comment">// setBackgroundDrawable(gd);</span></div><div class="line">        <span class="keyword">return</span> bgDrawable;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * è€ƒè™‘å¯æ‰©å±•ï¼Œä½†æ˜¯æ—¶é—´ç´§è¿«ï¼Œåªå¯ä»¥æ”¯æŒä¸¤ç§ç±»å‹æ•ˆæœå›¾ä¸­ä¸¤ç§ç±»å‹</div><div class="line">     *</div><div class="line">     * <span class="doctag">@param</span> value    åˆå§‹å€¼</div><div class="line">     * <span class="doctag">@param</span> maxValue æœ€å¤§å€¼</div><div class="line">     * <span class="doctag">@param</span> model    åˆ»åº¦ç›˜ç²¾åº¦ï¼š&lt;br&gt;</div><div class="line">     *                 &#123;<span class="doctag">@link</span> MOD_TYPE_HALF&#125;&lt;br&gt;</div><div class="line">     *                 &#123;<span class="doctag">@link</span> MOD_TYPE_ONE&#125;&lt;br&gt;</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">initViewParam</span><span class="params">(<span class="keyword">int</span> defaultValue, <span class="keyword">int</span> maxValue, <span class="keyword">int</span> model)</span> </span>&#123;</div><div class="line">        <span class="keyword">switch</span> (model) &#123;</div><div class="line">            <span class="keyword">case</span> MOD_TYPE_HALF:</div><div class="line">                mModType = MOD_TYPE_HALF;</div><div class="line">                mLineDivider = ITEM_HALF_DIVIDER;</div><div class="line">                mValue = defaultValue * <span class="number">2</span>;</div><div class="line">                mMaxValue = maxValue * <span class="number">2</span>;</div><div class="line">                <span class="keyword">break</span>;</div><div class="line">            <span class="keyword">case</span> MOD_TYPE_ONE:</div><div class="line">                mModType = MOD_TYPE_ONE;</div><div class="line">                mLineDivider = ITEM_ONE_DIVIDER;</div><div class="line">                mValue = defaultValue;</div><div class="line">                mMaxValue = maxValue;</div><div class="line">                <span class="keyword">break</span>;</div><div class="line"></div><div class="line">            <span class="keyword">default</span>:</div><div class="line">                <span class="keyword">break</span>;</div><div class="line">        &#125;</div><div class="line">        invalidate();</div><div class="line"></div><div class="line">        mLastX = <span class="number">0</span>;</div><div class="line">        mMove = <span class="number">0</span>;</div><div class="line">        notifyValueChange();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * è®¾ç½®ç”¨äºæ¥æ”¶ç»“æœçš„ç›‘å¬å™¨</div><div class="line">     *</div><div class="line">     * <span class="doctag">@param</span> listener</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setValueChangeListener</span><span class="params">(OnValueChangeListener listener)</span> </span>&#123;</div><div class="line">        mListener = listener;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * è·å–å½“å‰åˆ»åº¦å€¼</div><div class="line">     *</div><div class="line">     * <span class="doctag">@return</span></div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">float</span> <span class="title">getValue</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> mValue;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onLayout</span><span class="params">(<span class="keyword">boolean</span> changed, <span class="keyword">int</span> left, <span class="keyword">int</span> top, <span class="keyword">int</span> right, <span class="keyword">int</span> bottom)</span> </span>&#123;</div><div class="line">        mWidth = getWidth();</div><div class="line">        mHeight = getHeight();</div><div class="line">        <span class="keyword">super</span>.onLayout(changed, left, top, right, bottom);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onDraw</span><span class="params">(Canvas canvas)</span> </span>&#123;</div><div class="line">        <span class="keyword">super</span>.onDraw(canvas);</div><div class="line"></div><div class="line">        drawScaleLine(canvas);</div><div class="line">        <span class="comment">// drawWheel(canvas);</span></div><div class="line">        drawMiddleLine(canvas);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">drawWheel</span><span class="params">(Canvas canvas)</span> </span>&#123;</div><div class="line">        Drawable wheel = getResources().getDrawable(R.drawable.bg_wheel);</div><div class="line">        wheel.setBounds(<span class="number">0</span>, <span class="number">0</span>, getWidth(), getHeight());</div><div class="line">        wheel.draw(canvas);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * ä»ä¸­é—´å¾€ä¸¤è¾¹å¼€å§‹ç”»åˆ»åº¦çº¿</div><div class="line">     *</div><div class="line">     * <span class="doctag">@param</span> canvas</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">drawScaleLine</span><span class="params">(Canvas canvas)</span> </span>&#123;</div><div class="line">        canvas.save();</div><div class="line"></div><div class="line">        Paint linePaint = <span class="keyword">new</span> Paint();</div><div class="line">        linePaint.setStrokeWidth(<span class="number">2</span>);</div><div class="line">        linePaint.setColor(Color.BLACK);</div><div class="line"></div><div class="line">        TextPaint textPaint = <span class="keyword">new</span> TextPaint(Paint.ANTI_ALIAS_FLAG);</div><div class="line">        textPaint.setTextSize(TEXT_SIZE * mDensity);</div><div class="line"></div><div class="line">        <span class="keyword">int</span> width = mWidth, drawCount = <span class="number">0</span>;</div><div class="line">        <span class="keyword">float</span> xPosition = <span class="number">0</span>, textWidth = Layout.getDesiredWidth(<span class="string">"0"</span>, textPaint);</div><div class="line"></div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; drawCount &lt;= <span class="number">4</span> * width; i++) &#123;</div><div class="line">            <span class="keyword">int</span> numSize = String.valueOf(mValue + i).length();</div><div class="line"></div><div class="line">            xPosition = (width / <span class="number">2</span> - mMove) + i * mLineDivider * mDensity;</div><div class="line">            <span class="keyword">if</span> (xPosition + getPaddingRight() &lt; mWidth) &#123;</div><div class="line">                <span class="keyword">if</span> ((mValue + i) % mModType == <span class="number">0</span>) &#123;</div><div class="line">                    canvas.drawLine(xPosition, getPaddingTop(), xPosition, mDensity * ITEM_MAX_HEIGHT, linePaint);</div><div class="line"></div><div class="line">                    <span class="keyword">if</span> (mValue + i &lt;= mMaxValue) &#123;</div><div class="line">                        <span class="keyword">switch</span> (mModType) &#123;</div><div class="line">                            <span class="keyword">case</span> MOD_TYPE_HALF:</div><div class="line">                                canvas.drawText(String.valueOf((mValue + i) / <span class="number">2</span>), countLeftStart(mValue + i, xPosition, textWidth), getHeight() - textWidth, textPaint);</div><div class="line">                                <span class="keyword">break</span>;</div><div class="line">                            <span class="keyword">case</span> MOD_TYPE_ONE:</div><div class="line">                                canvas.drawText(String.valueOf(mValue + i), xPosition - (textWidth * numSize / <span class="number">2</span>), getHeight() - textWidth, textPaint);</div><div class="line">                                <span class="keyword">break</span>;</div><div class="line"></div><div class="line">                            <span class="keyword">default</span>:</div><div class="line">                                <span class="keyword">break</span>;</div><div class="line">                        &#125;</div><div class="line">                    &#125;</div><div class="line">                &#125; <span class="keyword">else</span> &#123;</div><div class="line">                    canvas.drawLine(xPosition, getPaddingTop(), xPosition, mDensity * ITEM_MIN_HEIGHT, linePaint);</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line"></div><div class="line">            xPosition = (width / <span class="number">2</span> - mMove) - i * mLineDivider * mDensity;</div><div class="line">            <span class="keyword">if</span> (xPosition &gt; getPaddingLeft()) &#123;</div><div class="line">                <span class="keyword">if</span> ((mValue - i) % mModType == <span class="number">0</span>) &#123;</div><div class="line">                    canvas.drawLine(xPosition, getPaddingTop(), xPosition, mDensity * ITEM_MAX_HEIGHT, linePaint);</div><div class="line"></div><div class="line">                    <span class="keyword">if</span> (mValue - i &gt;= <span class="number">0</span>) &#123;</div><div class="line">                        <span class="keyword">switch</span> (mModType) &#123;</div><div class="line">                            <span class="keyword">case</span> MOD_TYPE_HALF:</div><div class="line">                                canvas.drawText(String.valueOf((mValue - i) / <span class="number">2</span>), countLeftStart(mValue - i, xPosition, textWidth), getHeight() - textWidth, textPaint);</div><div class="line">                                <span class="keyword">break</span>;</div><div class="line">                            <span class="keyword">case</span> MOD_TYPE_ONE:</div><div class="line">                                canvas.drawText(String.valueOf(mValue - i), xPosition - (textWidth * numSize / <span class="number">2</span>), getHeight() - textWidth, textPaint);</div><div class="line">                                <span class="keyword">break</span>;</div><div class="line"></div><div class="line">                            <span class="keyword">default</span>:</div><div class="line">                                <span class="keyword">break</span>;</div><div class="line">                        &#125;</div><div class="line">                    &#125;</div><div class="line">                &#125; <span class="keyword">else</span> &#123;</div><div class="line">                    canvas.drawLine(xPosition, getPaddingTop(), xPosition, mDensity * ITEM_MIN_HEIGHT, linePaint);</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line"></div><div class="line">            drawCount += <span class="number">2</span> * mLineDivider * mDensity;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        canvas.restore();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * è®¡ç®—æ²¡æœ‰æ•°å­—æ˜¾ç¤ºä½ç½®çš„è¾…åŠ©æ–¹æ³•</div><div class="line">     *</div><div class="line">     * <span class="doctag">@param</span> value</div><div class="line">     * <span class="doctag">@param</span> xPosition</div><div class="line">     * <span class="doctag">@param</span> textWidth</div><div class="line">     * <span class="doctag">@return</span></div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">float</span> <span class="title">countLeftStart</span><span class="params">(<span class="keyword">int</span> value, <span class="keyword">float</span> xPosition, <span class="keyword">float</span> textWidth)</span> </span>&#123;</div><div class="line">        <span class="keyword">float</span> xp = <span class="number">0f</span>;</div><div class="line">        <span class="keyword">if</span> (value &lt; <span class="number">20</span>) &#123;</div><div class="line">            xp = xPosition - (textWidth * <span class="number">1</span> / <span class="number">2</span>);</div><div class="line">        &#125; <span class="keyword">else</span> &#123;</div><div class="line">            xp = xPosition - (textWidth * <span class="number">2</span> / <span class="number">2</span>);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> xp;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * ç”»ä¸­é—´çš„çº¢è‰²æŒ‡ç¤ºçº¿ã€é˜´å½±ç­‰ã€‚æŒ‡ç¤ºçº¿ä¸¤ç«¯ç®€å•çš„ç”¨äº†ä¸¤ä¸ªçŸ©å½¢ä»£æ›¿</div><div class="line">     *</div><div class="line">     * <span class="doctag">@param</span> canvas</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">drawMiddleLine</span><span class="params">(Canvas canvas)</span> </span>&#123;</div><div class="line">        <span class="comment">// TOOD å¸¸é‡å¤ªå¤šï¼Œæš‚æ—¶æ”¾è¿™ï¼Œæœ€ç»ˆä¼šæ”¾åœ¨ç±»çš„å¼€å§‹ï¼Œæ”¾è¿œäº†æ€•å¾ˆå¿«å¿˜è®°</span></div><div class="line">        <span class="keyword">int</span> gap = <span class="number">12</span>, indexWidth = <span class="number">8</span>, indexTitleWidth = <span class="number">24</span>, indexTitleHight = <span class="number">10</span>, shadow = <span class="number">6</span>;</div><div class="line">        String color = <span class="string">"#66999999"</span>;</div><div class="line"></div><div class="line">        canvas.save();</div><div class="line"></div><div class="line">        Paint redPaint = <span class="keyword">new</span> Paint();</div><div class="line">        redPaint.setStrokeWidth(indexWidth);</div><div class="line">        redPaint.setColor(Color.RED);</div><div class="line">        canvas.drawLine(mWidth / <span class="number">2</span>, <span class="number">0</span>, mWidth / <span class="number">2</span>, mHeight, redPaint);</div><div class="line"></div><div class="line">        Paint ovalPaint = <span class="keyword">new</span> Paint();</div><div class="line">        ovalPaint.setColor(Color.RED);</div><div class="line">        ovalPaint.setStrokeWidth(indexTitleWidth);</div><div class="line">        canvas.drawLine(mWidth / <span class="number">2</span>, <span class="number">0</span>, mWidth / <span class="number">2</span>, indexTitleHight, ovalPaint);</div><div class="line">        canvas.drawLine(mWidth / <span class="number">2</span>, mHeight - indexTitleHight, mWidth / <span class="number">2</span>, mHeight, ovalPaint);</div><div class="line"></div><div class="line">        <span class="comment">// RectF ovalRectF = new RectF(mWidth / 2 - 10, 0, mWidth / 2 + 10, 4 *</span></div><div class="line">        <span class="comment">// mDensity); //TODO æ¤­åœ†</span></div><div class="line">        <span class="comment">// canvas.drawOval(ovalRectF, ovalPaint);</span></div><div class="line">        <span class="comment">// ovalRectF.set(mWidth / 2 - 10, mHeight - 8 * mDensity, mWidth / 2 +</span></div><div class="line">        <span class="comment">// 10, mHeight); //TODO</span></div><div class="line"></div><div class="line">        Paint shadowPaint = <span class="keyword">new</span> Paint();</div><div class="line">        shadowPaint.setStrokeWidth(shadow);</div><div class="line">        shadowPaint.setColor(Color.parseColor(color));</div><div class="line">        canvas.drawLine(mWidth / <span class="number">2</span> + gap, <span class="number">0</span>, mWidth / <span class="number">2</span> + gap, mHeight, shadowPaint);</div><div class="line"></div><div class="line">        canvas.restore();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">onTouchEvent</span><span class="params">(MotionEvent event)</span> </span>&#123;</div><div class="line">        <span class="keyword">int</span> action = event.getAction();</div><div class="line">        <span class="keyword">int</span> xPosition = (<span class="keyword">int</span>) event.getX();</div><div class="line"></div><div class="line">        <span class="keyword">if</span> (mVelocityTracker == <span class="keyword">null</span>) &#123;</div><div class="line">            mVelocityTracker = VelocityTracker.obtain();</div><div class="line">        &#125;</div><div class="line">        mVelocityTracker.addMovement(event);</div><div class="line"></div><div class="line">        <span class="keyword">switch</span> (action) &#123;</div><div class="line">            <span class="keyword">case</span> MotionEvent.ACTION_DOWN:</div><div class="line"></div><div class="line">                mScroller.forceFinished(<span class="keyword">true</span>);</div><div class="line"></div><div class="line">                mLastX = xPosition;</div><div class="line">                mMove = <span class="number">0</span>;</div><div class="line">                <span class="keyword">break</span>;</div><div class="line">            <span class="keyword">case</span> MotionEvent.ACTION_MOVE:</div><div class="line">                mMove += (mLastX - xPosition);</div><div class="line">                changeMoveAndValue();</div><div class="line">                <span class="keyword">break</span>;</div><div class="line">            <span class="keyword">case</span> MotionEvent.ACTION_UP:</div><div class="line">            <span class="keyword">case</span> MotionEvent.ACTION_CANCEL:</div><div class="line">                countMoveEnd();</div><div class="line">                countVelocityTracker(event);</div><div class="line">                <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">            <span class="comment">// break;</span></div><div class="line">            <span class="keyword">default</span>:</div><div class="line">                <span class="keyword">break</span>;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        mLastX = xPosition;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">countVelocityTracker</span><span class="params">(MotionEvent event)</span> </span>&#123;</div><div class="line">        mVelocityTracker.computeCurrentVelocity(<span class="number">1000</span>);</div><div class="line">        <span class="keyword">float</span> xVelocity = mVelocityTracker.getXVelocity();</div><div class="line">        <span class="keyword">if</span> (Math.abs(xVelocity) &gt; mMinVelocity) &#123;</div><div class="line">            mScroller.fling(<span class="number">0</span>, <span class="number">0</span>, (<span class="keyword">int</span>) xVelocity, <span class="number">0</span>, Integer.MIN_VALUE, Integer.MAX_VALUE, <span class="number">0</span>, <span class="number">0</span>);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">changeMoveAndValue</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">int</span> tValue = (<span class="keyword">int</span>) (mMove / (mLineDivider * mDensity));</div><div class="line">        <span class="keyword">if</span> (Math.abs(tValue) &gt; <span class="number">0</span>) &#123;</div><div class="line">            mValue += tValue;</div><div class="line">            mMove -= tValue * mLineDivider * mDensity;</div><div class="line">            <span class="keyword">if</span> (mValue &lt;= <span class="number">0</span> || mValue &gt; mMaxValue) &#123;</div><div class="line">                mValue = mValue &lt;= <span class="number">0</span> ? <span class="number">0</span> : mMaxValue;</div><div class="line">                mMove = <span class="number">0</span>;</div><div class="line">                mScroller.forceFinished(<span class="keyword">true</span>);</div><div class="line">            &#125;</div><div class="line">            notifyValueChange();</div><div class="line">        &#125;</div><div class="line">        postInvalidate();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">countMoveEnd</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">int</span> roundMove = Math.round(mMove / (mLineDivider * mDensity));</div><div class="line">        mValue = mValue + roundMove;</div><div class="line">        mValue = mValue &lt;= <span class="number">0</span> ? <span class="number">0</span> : mValue;</div><div class="line">        mValue = mValue &gt; mMaxValue ? mMaxValue : mValue;</div><div class="line"></div><div class="line">        mLastX = <span class="number">0</span>;</div><div class="line">        mMove = <span class="number">0</span>;</div><div class="line"></div><div class="line">        notifyValueChange();</div><div class="line">        postInvalidate();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">notifyValueChange</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (<span class="keyword">null</span> != mListener) &#123;</div><div class="line">            <span class="keyword">if</span> (mModType == MOD_TYPE_ONE) &#123;</div><div class="line">                mListener.onValueChange(mValue);</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">if</span> (mModType == MOD_TYPE_HALF) &#123;</div><div class="line">                mListener.onValueChange(mValue / <span class="number">2f</span>);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">computeScroll</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">super</span>.computeScroll();</div><div class="line">        <span class="keyword">if</span> (mScroller.computeScrollOffset()) &#123;</div><div class="line">            <span class="keyword">if</span> (mScroller.getCurrX() == mScroller.getFinalX()) &#123; <span class="comment">// over</span></div><div class="line">                countMoveEnd();</div><div class="line">            &#125; <span class="keyword">else</span> &#123;</div><div class="line">                <span class="keyword">int</span> xPosition = mScroller.getCurrX();</div><div class="line">                mMove += (mLastX - xPosition);</div><div class="line">                changeMoveAndValue();</div><div class="line">                mLastX = xPosition;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
]]></content>
      
        <categories>
            
            <category> æŠ€æœ¯ </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Android </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[ã€ŒAndroidã€å¯¹Appè¿›è¡Œä»£ç æ··æ·†]]></title>
      <url>/1970/01/01/%5BAndroid%5D%E5%AF%B9App%E8%BF%9B%E8%A1%8C%E4%BB%A3%E7%A0%81%E6%B7%B7%E6%B7%86/</url>
      <content type="html"><![CDATA[<p>æ¥åˆ°ä¸€ä¸ªæ–°çš„ä»»åŠ¡ï¼Œå¯¹ç°æœ‰é¡¹ç›®è¿›è¡Œä»£ç æ··æ·†ã€‚ä¹‹å‰å¯¹æ··æ·†æœ‰è¿‡ä¸€äº›äº†è§£ï¼Œä½†æ˜¯ä¸å¤Ÿè¯¦ç»†å’Œå®Œæ•´ï¼ŒçŸ¥é“æœ‰äº›ä¸œè¥¿æ··æ·†èµ·æ¥è¿˜æ˜¯æ¯”è¾ƒæ£˜æ‰‹çš„ã€‚ä¸è¿‡å¹¸å¥½ç›®å‰çš„é¡¹ç›®ä¸æ˜¯å¤ªå¤æ‚ï¼ˆé’ˆå¯¹æ··æ·†è¿™å—æ¥è¯´ï¼‰ï¼Œæå‰å®Œæˆï½ï½ ç°æ€»ç»“ä¹‹ã€‚</p>
<h2 id="0x01-ç¬¬ä¸€éƒ¨åˆ†"><a href="/1970/01/01/[Android]å¯¹Appè¿›è¡Œä»£ç æ··æ·†/#0x01-ç¬¬ä¸€éƒ¨åˆ†" class="headerlink" title="0x01 ç¬¬ä¸€éƒ¨åˆ†"></a>0x01 ç¬¬ä¸€éƒ¨åˆ†</h2><p>ä»‹ç»ä¸‹æ“ä½œæµç¨‹ï¼ˆeclipseï¼‰ï¼š</p>
<ul>
<li><p>æ‰“å¼€æ··æ·†å™¨</p>
<p>  æ‰¾åˆ°é¡¹ç›®æ ¹ç›®å½•ä¸‹çš„ <code>project.properties</code> æ–‡ä»¶<br>  <code>#proguard.config=${sdk.dir}/tools/proguard/proguard-android.txt:proguard-project.txt</code><br>  å°†ä¸Šé¢è¿™è¡Œå‰çš„ <code>#</code> åˆ é™¤å³å¯</p>
</li>
<li><p>ä¿®æ”¹æ··æ·†é…ç½®æ–‡ä»¶</p>
<p>  æ‰¾åˆ°é¡¹ç›®æ ¹ç›®å½•ä¸‹çš„ <code>proguard-project.txt</code> æ–‡ä»¶ï¼Œä¿®æ”¹å…¶ä¸­ä»£ç ï¼Œè¿™éƒ¨åˆ†æ˜¯æœ€å…³é”®</p>
</li>
<li><p>ä¿å­˜ç›¸å…³æ–‡ä»¶ä¾›ä»¥åå‡ºé”™æ—¶ä½¿ç”¨</p>
<p>  ä¸»è¦æœ‰å¯¼å‡ºçš„apkæ–‡ä»¶ã€é¡¹ç›®æ ¹ç›®å½•ä¸‹çš„proguardç›®å½•ä¸‹çš„æ–‡ä»¶ï¼ˆä¸»è¦çš„æ˜¯mapping.txtï¼‰å’Œé¡¹ç›®æºç </p>
</li>
<li><p>é¡¹ç›®è¿è¡Œè¿‡ç¨‹å‡ºé”™å¤„ç†</p>
<p>  æ ¹æ®é”™è¯¯ä¿¡æ¯å’Œç¬¬3æ­¥ä¸­ä¿å­˜çš„mappingå®šä½é”™è¯¯ä½ç½®</p>
</li>
</ul>
<p>çŸ¥é“è¿™äº›ä¹‹åï¼Œæˆ‘ä»¬å¯¹å…¶è¿›è¡Œå±•å¼€ã€‚</p>
<p>æ‰“å¼€eclipseç„¶åæ–°å»ºä¸€ä¸ªé¡¹ç›®ï¼Œé»˜è®¤ä¼šåˆ›å»º <code>proguard-project.txt</code> å’Œ<code>project.properties</code>ã€‚ç¼–å†™æˆ‘ä»¬çš„ä»£ç ï¼Œä¿®æ”¹ <code>proguard-project.txt</code> ï¼š</p>
<p><code>#proguard.config=${sdk.dir}/tools/proguard/proguard-android.txt</code></p>
<p><code>:proguard-project.txt</code> </p>
<p>å°†è¿™è¡Œå‰çš„ <code>#</code> åˆ é™¤ï¼Œæœ€åå¯¼å‡ºå³å¯å®ç°å¯¹ä»£ç çš„æ··æ·†ï¼ˆå³ä½¿æˆ‘ä»¬æ²¡æœ‰å»ç¼–å†™proguard-<br>project.txtä¸­çš„å†…å®¹ï¼‰ã€‚ä¸‹é¢æ˜¯æˆ‘çš„æµ‹è¯•ä»£ç ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MainActivity</span> <span class="keyword">extends</span> <span class="title">Activity</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="keyword">private</span> String mName;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</div><div class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState);</div><div class="line">        setContentView(R.layout.activity_main);</div><div class="line"></div><div class="line">        mName = <span class="string">"ttdevs"</span>;</div><div class="line"></div><div class="line">        getString(mName);</div><div class="line">        setName(mName);</div><div class="line">        showDialog();</div><div class="line">        <span class="comment">// testError();</span></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getString</span><span class="params">(String name)</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> <span class="string">"hello "</span> + name;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</div><div class="line">        System.out.println(<span class="string">"I'm "</span> + name);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">showDialog</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">new</span> Handler().postDelayed(<span class="keyword">new</span> Runnable() &#123;</div><div class="line"></div><div class="line">            <span class="meta">@Override</span></div><div class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</div><div class="line">                ScoreAlertDialog.showDialog(MainActivity.<span class="keyword">this</span>);</div><div class="line">            &#125;</div><div class="line">        &#125;, <span class="number">2000</span>);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">ScoreAlertDialog</span> </span>&#123;</div><div class="line"></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">showDialog</span><span class="params">(<span class="keyword">final</span> Activity activity)</span> </span>&#123;</div><div class="line">            <span class="keyword">if</span> (activity.isFinishing()) &#123;</div><div class="line">                <span class="keyword">return</span>;</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">try</span> &#123;</div><div class="line">                AlertDialog.Builder builder = <span class="keyword">new</span> AlertDialog.Builder(activity);</div><div class="line">                builder.setTitle(<span class="string">"alert_title"</span>);</div><div class="line">                builder.setNegativeButton(<span class="string">"cancel"</span>, <span class="keyword">null</span>);</div><div class="line">                builder.setPositiveButton(<span class="string">"submit"</span>, <span class="keyword">new</span> DialogInterface.OnClickListener() &#123;</div><div class="line">                    <span class="meta">@Override</span></div><div class="line">                    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span><span class="params">(DialogInterface dialog, <span class="keyword">int</span> which)</span> </span>&#123;</div><div class="line">                        <span class="keyword">try</span> &#123;</div><div class="line">                            Toast.makeText(activity, <span class="string">"Welcome"</span>, Toast.LENGTH_LONG).show();</div><div class="line">                        &#125; <span class="keyword">catch</span> (Exception e) &#123;</div><div class="line">                            e.printStackTrace();</div><div class="line">                        &#125;</div><div class="line">                    &#125;</div><div class="line">                &#125;);</div><div class="line">                builder.show();</div><div class="line">            &#125; <span class="keyword">catch</span> (Exception e) &#123;</div><div class="line">                e.printStackTrace();</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">testError</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">try</span> &#123;</div><div class="line">            <span class="keyword">int</span> error = <span class="number">1</span> / <span class="number">0</span>;</div><div class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</div><div class="line">            e.printStackTrace();</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>æ‰“åŒ…ï¼Œåç¼–è¯‘ï¼Œæœ€åæˆ‘ä»¬å¾—åˆ°å¦‚ä¸‹çš„ä»£ç ï¼š</p>
<p><img src="http://img.blog.csdn.net/20140928202555529?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvdHRkZXZz/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="">  </p>
<p>åˆ†æä¸Šé¢çš„ä»£ç æˆ‘ä»¬ä¼šå‘ç°ï¼Œè‡ªå®šä¹‰çš„æ–¹æ³•åéƒ½è¢«æ›¿æ¢æˆæ— ç‰¹æ®Šæ„ä¹‰çš„çŸ­å­—æ¯ï¼Œè€Œactivityçš„onCreate()æ–¹æ³•å´æ²¡å˜ï¼›æœ€åä¸€ä¸ªtestError()æ–¹æ³•ç”±äºæˆ‘ä»¬æ²¡æœ‰è°ƒç”¨ä¹Ÿè¢«å‰”é™¤æ‰äº†ã€‚è¿™äº›å°±æ˜¯é»˜è®¤çš„æ··æ·†å¤„ç†ç­–ç•¥ã€‚çœ‹åˆ°è¿™é‡Œï¼Œæ„Ÿè§‰æ··æ·†è¿˜æ˜¯å°caseçš„å“ˆï½ï½</p>
<p>ç»§ç»­å¾€ä¸‹ï¼Œæˆ‘ä»¬å°†æ³¨é”€çš„testError()æ‰“å¼€ï¼Œæ‰“åŒ…è¿è¡Œè¿™ä¸ªæ—¶å€™ä¼šæŠ¥é”™ï¼Œé”™è¯¯ä¿¡æ¯å¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">java.lang.ArithmeticException: divide by zero</div><div class="line">	at com.ttdevs.proguard.MainActivity.b(Unknown Source)</div><div class="line">	at com.ttdevs.proguard.MainActivity.onCreate(Unknown Source)</div><div class="line">	at android.app.Activity.performCreate(Activity.java:<span class="number">4531</span>)</div><div class="line">	at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:<span class="number">1071</span>)</div><div class="line">	at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:<span class="number">2150</span>)</div><div class="line">	at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:<span class="number">2229</span>)</div><div class="line">	at android.app.ActivityThread.access$<span class="number">600</span>(ActivityThread.java:<span class="number">139</span>)</div><div class="line">	at android.app.ActivityThread$H.handleMessage(ActivityThread.java:<span class="number">1261</span>)</div><div class="line">	at android.os.Handler.dispatchMessage(Handler.java:<span class="number">99</span>)</div><div class="line">	at android.os.Looper.loop(Looper.java:<span class="number">154</span>)</div><div class="line">	at android.app.ActivityThread.main(ActivityThread.java:<span class="number">4945</span>)</div><div class="line">	at java.lang.reflect.Method.invokeNative(Native Method)</div><div class="line">	at java.lang.reflect.Method.invoke(Method.java:<span class="number">511</span>)</div><div class="line">	at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:<span class="number">784</span>)</div><div class="line">	at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:<span class="number">551</span>)</div><div class="line">	at dalvik.system.NativeStart.main(Native Method)</div></pre></td></tr></table></figure>
<p>ç”±äºè¿™ä¸ªä¾‹å­æ¯”è¾ƒç®€å•ï¼Œå¾ˆå®¹æ˜“çœ‹å‡ºæ¥æ˜¯ä½•åœ°æ–¹å‡ºäº†é—®é¢˜ï¼Œä¸è¿‡è¿˜æ˜¯å¯ä»¥ç”¨æ¥è¯´æ˜æˆ‘ä»¬æƒ³è¡¨è¾¾çš„é—®é¢˜ï¼šå¦‚ä½•è¿˜åŸæ··æ·†åçš„ä»£ç çš„é”™è¯¯ä¿¡æ¯ï¼Ÿ<br>ä¸ºäº†è¾¾åˆ°è¿™ä¸ªç›®çš„ï¼Œæˆ‘ä»¬éœ€è¦ä¸‰ä¸ªæ–‡ä»¶:</p>
<ul>
<li>android-sdk-windows\tools\proguard\bin\retrace.bat</li>
<li>mapping.txt</li>
<li>log.infoï¼ˆä¸Šé¢çš„é”™è¯¯ä¿¡æ¯ï¼‰</li>
</ul>
<p>ç„¶åæ‰§è¡Œä¸‹é¢çš„å‘½ä»¤ï¼ˆwindowç³»ç»Ÿï¼‰</p>
<p><code>retrace.bat mapping.txt log.txt</code></p>
<p><img src="http://img.blog.csdn.net/20140928221717551?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvdHRkZXZz/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="">  </p>
<p>ä»ä¸Šå›¾ä¸­å¯ä»¥å¾ˆæ¸…æ¥šçš„çœ‹åˆ°é”™è¯¯æ—¥å¿—ä¸­çš„b()æ–¹æ³•ä¸ºæˆ‘ä»¬å®é™…ä»£ç ä¸­çš„setName()æ–¹æ³•ã€‚</p>
<p>è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯æ¯æ¬¡å¯¼å‡ºapkéƒ½ä¼šåœ¨é¡¹ç›®ä¸­ç›®å½•ä¸‹çš„proguardæ–‡ä»¶å¤¹ä¸‹ç”Ÿæˆä¸€ä¸ªå¯¹åº”çš„mapping.txt æ–‡ä»¶ï¼Œæ‰€ä»¥å¯¹äºæ¯ä¸ªapkæˆ‘ä»¬éƒ½éœ€è¦ä¿å­˜ä¸ä¹‹å¯¹åº”çš„mapping.txtæ–‡ä»¶ã€‚è‡³æ­¤æ•´ä¸ªæ··æ·†çš„æµç¨‹ä»‹ç»å®Œæ¯•ã€‚</p>
<h3 id="å‚è€ƒ"><a href="/1970/01/01/[Android]å¯¹Appè¿›è¡Œä»£ç æ··æ·†/#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h3><ul>
<li>å®˜æ–¹æ–‡æ¡£</li>
</ul>
<p><a href="http://developer.android.com/tools/help/proguard.html" target="_blank" rel="external">http://developer.android.com/tools/help/proguard.html</a></p>
<ul>
<li>å®˜æ–¹æ–‡æ¡£çš„ç¿»è¯‘</li>
</ul>
<p><a href="http://www.cnblogs.com/over140/archive/2011/04/22/2024528.html" target="_blank" rel="external">http://www.cnblogs.com/over140/archive/2011/04/22/2024528.html</a></p>
<p>ï¼ˆæœ¬æƒ³è‡ªå·±å»ç¿»ä¸€ä¸ªï¼Œç»“æœå‘ç°å¾ˆä¹…ä»¥å‰å†œæ°‘ä¼¯ä¼¯å·²ç»ç¿»è¯‘ï¼Œåœ¨æ­¤ç›´æ¥å¼•ç”¨å¹¶æ„Ÿè°¢ä¹‹ï¼‰</p>
<h2 id="0x02-ç¬¬äºŒéƒ¨åˆ†"><a href="/1970/01/01/[Android]å¯¹Appè¿›è¡Œä»£ç æ··æ·†/#0x02-ç¬¬äºŒéƒ¨åˆ†" class="headerlink" title="0x02 ç¬¬äºŒéƒ¨åˆ†"></a>0x02 ç¬¬äºŒéƒ¨åˆ†</h2><p>ç¬¬ä¸€éƒ¨åˆ†è®²äº†å¦‚ä½•æ“ä½œï¼Œå‚ç…§å®˜æ–¹æ–‡æ¡£ï¼ŒåŸºæœ¬éƒ½ä¼šæŒæ¡ã€‚å‰©ä¸‹çš„ä¹Ÿæ˜¯æœ€éš¾çš„å°±æ˜¯ <code>proguard-project.txt</code> æ–‡ä»¶çš„ç¼–å†™ã€‚å¯¹äºè¿™éƒ¨åˆ†ï¼Œä¸¤ç§å¤„ç†ç­–ç•¥ï¼šè‡ªå·±ç¼–å†™<br>å’Œä½¿ç”¨åˆ«äººå†™å¥½çš„ã€‚å…ˆè¯´å¦‚ä½•ä½¿ç”¨åˆ«äººå†™å¥½çš„ï¼Œæˆ‘ä»¬å¼•ç”¨çš„ç¬¬ä¸‰æ–¹åº“æ— è®ºå¼€æºè¿˜æ˜¯é—­æºå¦‚æœ‰ç‰¹æ®Šæƒ…å†µæˆ‘ä»¬éƒ½å¯ä»¥åœ¨ä»–çš„User Guideä¸­æ‰¾åˆ°æ··æ·†ä»£ç çš„é…ç½®ï¼Œå¦‚æˆ‘ä»¬å¼•ç”¨çš„å¤§åé¼é¼çš„ <a href="https://github.com/guillep/PullToRefresh" target="_blank" rel="external">guillep PullToRefresh</a> ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨<a href="https://github.com/guillep/PullToRefresh/blob/master/PullToRefresh/proguard.cfg" target="_blank" rel="external">ä»–çš„æ–‡æ¡£</a> ä¸­æ‰¾åˆ°å¦‚ä¸‹çš„ä»£ç ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div></pre></td><td class="code"><pre><div class="line">-optimizationpasses <span class="number">5</span></div><div class="line">-dontusemixedcaseclassnames</div><div class="line">-dontskipnonpubliclibraryclasses</div><div class="line">-dontpreverify</div><div class="line">-verbose</div><div class="line">-optimizations !code/simplification/arithmetic,!field<span class="comment">/*,!class/merging/*</span></div><div class="line">    </div><div class="line">-keep public class * extends android.app.Activity</div><div class="line">-keep public class * extends android.app.Application</div><div class="line">-keep public class * extends android.app.Service</div><div class="line">-keep public class * extends android.content.BroadcastReceiver</div><div class="line">-keep public class * extends android.content.ContentProvider</div><div class="line">-keep public class * extends android.app.backup.BackupAgentHelper</div><div class="line">-keep public class * extends android.preference.Preference</div><div class="line">-keep public class com.android.vending.licensing.ILicensingService</div><div class="line">    </div><div class="line">-keepclasseswithmembernames class * &#123;</div><div class="line">   native &lt;methods&gt;;</div><div class="line">&#125;</div><div class="line">    </div><div class="line">-keepclasseswithmembernames class * &#123;</div><div class="line">   public &lt;init&gt;(android.content.Context, android.util.AttributeSet);</div><div class="line">&#125;</div><div class="line">    </div><div class="line">-keepclasseswithmembernames class * &#123;</div><div class="line">   public &lt;init&gt;(android.content.Context, android.util.AttributeSet, int);</div><div class="line">&#125;</div><div class="line">    </div><div class="line">-keepclassmembers enum * &#123;</div><div class="line">   public static **[] values();</div><div class="line">   public static ** valueOf(java.lang.String);</div><div class="line">&#125;</div><div class="line">    </div><div class="line">-keep class * implements android.os.Parcelable &#123;</div><div class="line"> public static final android.os.Parcelable$Creator *;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>æœ‰äº†è¿™éƒ¨åˆ†ä»£ç æˆ‘ä»¬å°±å¯ä»¥ç›´æ¥copyæ’å…¥æˆ‘ä»¬çš„é¡¹ç›®ä¸­å³å¯ã€‚è¿™ç§æ–¹å¼è¿˜æ˜¯copyå¼çš„ã€‚é‚£ä¸‹é¢æˆ‘ä»¬ä¸¾ä¸ªå°ä¾‹å­çœ‹çœ‹å¦‚ä½•è‡ªå·±å†™ä»£ç æ§åˆ¶æ˜¯å¦æ··æ·†ã€‚è¿˜æ˜¯ç”¨ç¬¬ä¸€éƒ¨åˆ†çš„ä¾‹å­ï¼Œæˆ‘ä»¬åœ¨è¿™ä¸ªé¡¹ç›®çš„ proguard-project.txt æ–‡ä»¶ä¸­ï¼ˆä¹‹å‰ä¸ºç©ºï¼‰åŠ å…¥å¦‚ä¸‹å‡ è¡Œï¼ˆproguard-project.txtä¸­â€œ#â€ä»£è¡¨æ³¨é‡Šï¼‰ï¼š</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"># -keep public class com.ttdevs.proguard.** &#123; *; &#125;</div><div class="line"># -keepclasseswithmembers public class com.ttdevs.proguard.** &#123; *; &#125;</div><div class="line">    </div><div class="line">-keep public class com.ttdevs.proguard.MainActivity &#123;</div><div class="line">java.lang.String getString(java.lang.String);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ç„¶åæˆ‘ä»¬å¯¼å‡ºapkå†åç¼–è¯‘ï¼Œå¾—åˆ°å¦‚ä¸‹ä»£ç ï¼š</p>
<p><img src="http://img.blog.csdn.net/20140928225529585?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvdHRkZXZz/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="">  </p>
<p>å’Œä¹‹å‰çš„å¯¹æ¯”ï¼Œæˆ‘ä»¬å‘ç°å…¶ä¸­çš„getStringæ–¹æ³•æ²¡æœ‰è¢«æ··æ·†ã€‚æ²¡é”™ï¼Œä¸Šé¢ proguard-project.txtçš„æ„æ€å°±æ˜¯ä¿æŒMainActivityçš„getString()æ–¹æ³•ä¸è¦è¢«æ··æ·†ã€‚å¤§å®¶ä¹Ÿå¯ä»¥è¯•è¯•ä¸Šè¿°æ··æ·†ä»£ç ä¸­è¢«æ³¨é‡Šçš„ä¸¤è¡Œåˆ†åˆ«æ˜¯ä»€ä¹ˆæ•ˆæœã€‚</p>
<p>è®²åˆ°è¿™é‡Œå·²ç»å¼€å§‹æ¶‰åŠProGuardçš„æ ¸å¿ƒéƒ¨åˆ†äº†ï¼Œå‰©ä¸‹çš„å°±æ˜¯ç ”è¯» <a href="http://proguard.sourceforge.net" target="_blank" rel="external">ProGuardçš„æ–‡æ¡£</a> ï¼ŒæŒæ¡çš„ä»–çš„è¯­æ³•å¹¶ä½¿ç”¨ä¹‹ã€‚æœ¬æƒ³æ‰¾ä¸€ä¸ªå®Œæ•´çš„ProGuardçš„ç¿»è¯‘æ–‡æ¡£ï¼Œä½†æ˜¯æ‰¾äº†Nä¹…æ²¡æœ‰å‘ç°ä¸€ä¸ªï¼Œè€Œä¸”è¿é›¶é›¶æ•£æ•£çš„ç¿»è¯‘ä¹Ÿéå¸¸çš„å°‘ï¼Œæœ€è¿‘æ—¶é—´å¾ˆç´§ï¼ŒåŠ ä¹‹èƒ½åŠ›æœ‰é™ï¼Œæƒ³ç¿»è¯‘ä¸€ä¸‹å¸¸ç”¨çš„å‡ ä¸ªå‘½ä»¤ä¹Ÿæ˜¯å¾ˆå›°ï¼Œæ‰€ä»¥ç»†è¯»çš„æƒ³æ³•åªèƒ½æš‚æ—¶å¾€åæ¨äº†ã€‚è¿™é‡Œå…ˆç®€å•ä»‹ç»ä¸‹keepå‘½ä»¤ï¼š</p>
<p><a href="http://proguard.sourceforge.net/manual/usage.html#keep" target="_blank" rel="external">-keep [,modifier,â€¦] class_specification</a></p>
<p>åœ¨ä½ çš„ä»£ç ä¸­æŒ‡å®šä½œä¸ºåˆ‡å…¥ç‚¹è€Œè¢«ä¿ç•™çš„ç±»æˆ–è€…ç±»çš„æˆå‘˜ï¼ˆå±æ€§å’Œæ–¹æ³•ï¼‰ã€‚ä¾‹å¦‚ï¼Œä¸ºäº†ä¿æŒä¸€ä¸ªåº”ç”¨ï¼Œä½ å¯ä»¥æŒ‡å®šä¸»ç±»å’Œä»–çš„mainæ–¹æ³•ã€‚ä¸ºäº†å¤„ç†ä¸€ä¸ªåº“ï¼Œä½ éœ€è¦è¯¦ç»†è¯´æ˜ä»–çš„publicè®¿é—®çš„å…ƒç´ ã€‚  </p>
<p><a href="http://proguard.sourceforge.net/manual/usage.html#keepoverview" target="_blank" rel="external">å¦å¤–è¿˜æœ‰keepçš„ç®€å•æ¦‚è¿°</a> å’Œ <a href="http://proguard.sourceforge.net/manual/usage.html#classspecification" target="_blank" rel="external">è¯­æ³•ä¸­è§„èŒƒ</a> ã€‚</p>
<p>Class Specificationä¸­ä¼šå‘Šè¯‰ä½ å¦‚ä½•è¡¨ç¤ºæ„é€ æ–¹æ³•ï¼Œå±æ€§å’Œæ–¹æ³•ï¼Œ<code>*</code> ä¸<code>**</code>çš„åŒºåˆ«ç­‰ç­‰ã€‚æ¯”å¦‚ <code>*</code> è¡¨ç¤ºåŒ¹é…ä»»ä½•çš„ç±»åä½†æ˜¯ä¸åŒ…æ‹¬åŒ…çš„åˆ†éš”ç¬¦ï¼Œè€Œ <code>**</code> åˆ™æ˜¯åŒ¹é…ä»»ä½•çš„ç±»åå¹¶ä¸”åŒ…æ‹¬ä»»æ„æ•°é‡çš„åŒ…åˆ†éš”ç¬¦ï¼Œå› æ­¤ä¸Šé¢æˆ‘ä»¬æ³¨é‡Šæ‰çš„ä»£ç æ„æ€å¦‚ä¸‹ï¼š</p>
<ul>
<li><p>ç¬¬ä¸€è¡Œ </p>
<p>  ä¿æŒcom.ttdevs.proguardä¸‹çš„æ‰€æœ‰ç±»å’Œå­åŒ…ä¸‹çš„ç±»çš„æ‰€æœ‰æ–¹æ³•éƒ½ä¸æ··æ·†</p>
</li>
<li><p>ç¬¬äºŒè¡Œ</p>
<p>  ä¿æŒcom.ttdevs.proguardä¸‹çš„æ‰€æœ‰ç±»å’Œå­åŒ…ä¸‹çš„ç±»çš„æ‰€æœ‰æ–¹æ³•å’Œæˆå‘˜å˜é‡éƒ½ä¸æ··æ·†ã€‚</p>
</li>
</ul>
<p>// TODO ç»†èŠ‚è¿˜æœ‰å¾ˆå¤šï¼Œæ¯”å¦‚-libraryjarsã€-dontwarnã€-keepattributesç­‰ç­‰ï¼Œè¿™äº›å¾…ç»­å§</p>
<h3 id="å‚è€ƒ-1"><a href="/1970/01/01/[Android]å¯¹Appè¿›è¡Œä»£ç æ··æ·†/#å‚è€ƒ-1" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h3><ul>
<li><p>ProGuard 5.0</p>
<p>  <a href="http://proguard.sourceforge.net/" target="_blank" rel="external">ProGuard 5.0</a> </p>
</li>
<li><p>ProGuard 4.7</p>
<p>  <a href="https://stuff.mit.edu/afs/sipb/project/android/sdk/android-sdk-linux/tools/proguard/docs/index.html" target="_blank" rel="external">ProGuard 4.7</a> </p>
</li>
</ul>
<p><img src="https://raw.githubusercontent.com/ttdevs/ttdevs.github.io/common/images/logo.png" alt="Create by ttdevs"></p>
]]></content>
      
        <categories>
            
            <category> æŠ€æœ¯ </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Android </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[ã€ŒFlaskã€0x01FlaskMail]]></title>
      <url>/1970/01/01/%5BFlask%5D0x01FlaskMail/</url>
      <content type="html"><![CDATA[<h2 id="0x00-ç®€ä»‹"><a href="/1970/01/01/[Flask]0x01FlaskMail/#0x00-ç®€ä»‹" class="headerlink" title="0x00  ç®€ä»‹"></a>0x00  ç®€ä»‹</h2><blockquote>
<p>Welcome to Flask-Mail, you can use to send mail in your web site.</p>
</blockquote>
<p>Flask-Mail æä¾›äº†ä¸€ä¸ªç®€å•çš„æ¥å£ï¼Œè®©æˆ‘ä»¬å¯ä»¥æ–¹ä¾¿çš„åœ¨ Flask åº”ç”¨ä¸­ä½¿ç”¨ SMTPåè®® å‘é€é‚®ä»¶ã€‚</p>
<h2 id="0x01-å®‰è£…"><a href="/1970/01/01/[Flask]0x01FlaskMail/#0x01-å®‰è£…" class="headerlink" title="0x01 å®‰è£…"></a>0x01 å®‰è£…</h2><p><code>pip install Flask-Mail</code></p>
<p>ç›®å‰æœ€æ–°ç‰ˆæœ¬æ˜¯ 0.9.1 ï¼Œä» <a href="https://github.com/mattupstate/flask-mail" target="_blank" rel="external">Flask-Mailçš„githubåœ°å€</a>å¯ä»¥å‘ç°ï¼Œä¸¤å¹´æ²¡æœ‰æ›´æ–°äº†ã€‚ä¸è¿‡è¿™ä¸ªå¹¶ä¸å½±å“æˆ‘ä»¬ä½¿ç”¨ï¼Œæ¯•ç«Ÿå‘é€é‚®ä»¶æ˜¯ä¸ªæ¯”è¾ƒæˆç†Ÿçš„ä¸œè¥¿ï¼Œåªç¥ˆæ±‚å’Œæœ€æ–°çš„Flaskä¸è¦å‡ºç°å…¼å®¹é—®é¢˜å³å¯ã€‚</p>
<p>å¦‚æœä½ ä¸æƒ³ä½¿ç”¨è¿™ä¸ªå·¥å…·ï¼Œå¯ä»¥æ‰¾æ‰¾å…¶ä»–çš„ï¼Œä¸è¿‡ä½ ä¼šå‘ç°ï¼Œå…¶ä»–çš„å¯èƒ½æ›´è€ï¼Œä¹Ÿæ˜¯é†‰äº†=_=</p>
<p>å¦‚æœæ—¶é—´å……è¶³ï¼Œæˆ‘ä»¬å¯ä»¥å»è¯»è¯» Flask-Mail çš„æºç ï¼Œä½ ä¼šå‘ç°ï¼Œæœ€ç»ˆæ˜¯ç”¨ç³»ç»Ÿè‡ªå¸¦çš„ smtplib å®ç°çš„ã€‚</p>
<h2 id="0x02-ä½¿ç”¨"><a href="/1970/01/01/[Flask]0x01FlaskMail/#0x02-ä½¿ç”¨" class="headerlink" title="0x02 ä½¿ç”¨"></a>0x02 ä½¿ç”¨</h2><p>ä¸€å¥è¯æ€»ç»“ï¼šFlask-Mail çš„ä½¿ç”¨è¿˜æ˜¯ç›¸å½“easyçš„ã€‚</p>
<h3 id="é…ç½®"><a href="/1970/01/01/[Flask]0x01FlaskMail/#é…ç½®" class="headerlink" title="é…ç½®"></a>é…ç½®</h3><p>Flask-Mail ä½¿ç”¨ Flask æ ‡å‡†çš„é…ç½® API è¿›è¡Œé…ç½®ã€‚ä¸‹é¢æ˜¯æ‰€æœ‰çš„é…ç½®é€‰é¡¹ï¼š</p>
<ul>
<li>MAIL_SERVER : é»˜è®¤ä¸º â€˜127.0.0.1â€™</li>
<li>MAIL_PORT : é»˜è®¤ä¸º 25</li>
<li>MAIL_USE_TLS : é»˜è®¤ä¸º False</li>
<li>MAIL_USE_SSL : é»˜è®¤ä¸º False</li>
<li>MAIL_DEBUG : é»˜è®¤ä¸º app.debug</li>
<li>MAIL_USERNAME : é»˜è®¤ä¸º None</li>
<li>MAIL_PASSWORD : é»˜è®¤ä¸º None</li>
<li>MAIL_DEFAULT_SENDER : é»˜è®¤ä¸º None</li>
<li>MAIL_MAX_EMAILS : é»˜è®¤ä¸º None</li>
<li>MAIL_SUPPRESS_SEND : é»˜è®¤ä¸º app.testing</li>
<li>MAIL_ASCII_ATTACHMENTS : é»˜è®¤ä¸º False</li>
</ul>
<p>è¿™ä¸ªé…ç½®çš„å‚æ•°æˆ‘ä»¬å¯ä»¥åœ¨<a href="https://github.com/mattupstate/flask-mail/blob/master/flask_mail.py" target="_blank" rel="external">è¿™é‡Œ</a>çœ‹åˆ°ã€‚</p>
<h3 id="åˆå§‹åŒ–"><a href="/1970/01/01/[Flask]0x01FlaskMail/#åˆå§‹åŒ–" class="headerlink" title="åˆå§‹åŒ–"></a>åˆå§‹åŒ–</h3><p>å¯ä»¥ä½¿ç”¨ä¸‹é¢çš„ä¸¤ç§æ–¹å¼è¿›è¡Œåˆå§‹åŒ–ï¼š</p>
<ul>
<li><p>ç¬¬ä¸€ç§æ–¹å¼ï¼š</p>
<p>  ä½¿ç”¨ä¼ å…¥åˆ° Mail å®ä¾‹ä¸­çš„åº”ç”¨ç¨‹åºçš„é…ç½®é¡¹è¿›è¡Œé‚®ä»¶å‘é€</p>
  <figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask</div><div class="line"><span class="keyword">from</span> flask_mail <span class="keyword">import</span> Mail</div><div class="line"></div><div class="line">app = Flask(__name__)</div><div class="line">mail = Mail(app)</div></pre></td></tr></table></figure>
</li>
<li><p>ç¬¬äºŒç§æ–¹å¼ï¼š</p>
<p>  ä½¿ç”¨ Flask çš„ current_app ä¸­çš„é…ç½®é¡¹è¿›è¡Œé‚®ä»¶å‘é€ï¼Œå¦‚æœæˆ‘ä»¬æœ‰å¤šä¸ª ä¸åŒé…ç½®çš„åº”ç”¨ç¨‹åº åˆ™ä½¿ç”¨æ­¤ç§æ–¹å¼æ¯”è¾ƒæ–¹ä¾¿</p>
  <figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">mail = Mail()</div><div class="line"></div><div class="line">app = Flask(__name__)</div><div class="line">mail.init_app(app)</div></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="å‘é€"><a href="/1970/01/01/[Flask]0x01FlaskMail/#å‘é€" class="headerlink" title="å‘é€"></a>å‘é€</h3><p>å‘é€ä¹‹å‰æˆ‘ä»¬éœ€è¦å…ˆæ„å»ºä¸€ä¸ª Message å¯¹è±¡ï¼Œå¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">from</span> flask_mail <span class="keyword">import</span> Message</div><div class="line"></div><div class="line">msg = Message(<span class="string">"Hello Flask"</span>, sender=<span class="string">"ttdevs@gmail.com"</span>,  recipients=[<span class="string">"ttdevs@live.com"</span>])</div></pre></td></tr></table></figure>
<p>æˆ‘ä»¬ä¹Ÿå¯ä»¥åŒæ—¶æŒ‡å®šå¤šä¸ªæ”¶ä»¶äºº</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">msg.recipients = [<span class="string">"ttdevs@gmail.com"</span>, <span class="string">"ttdevs@foxmail.com"</span>]</div><div class="line">msg.add_recipient(<span class="string">"ttdevs@live.com"</span>)</div></pre></td></tr></table></figure>
<p>å¦‚æœæˆ‘ä»¬é…ç½®äº† <code>MAIL_DEFAULT_SENDER</code> å­—æ®µï¼Œå°±å¯ä»¥ä¸å†è®¾ç½® sender ï¼Œè¿™ä¸ªæ—¶å€™ä¼šä½¿ç”¨  <code>MAIL_DEFAULT_SENDER</code> ä¸­æŒ‡å®šçš„å‘ä»¶äººï¼Œåƒè¿™æ ·ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">msg = Message(<span class="string">"Hello Flask"</span>, recipients=[<span class="string">"ttdevs@live.com"</span>])</div></pre></td></tr></table></figure>
<p>å¦‚æœæˆ‘ä»¬å¸Œæœ›åœ¨æ”¶ä»¶åˆ—è¡¨ä¸­æ˜¾ç¤ºä¸€ä¸ªåå­—ï¼Œå¯ä»¥é€šè¿‡ä¸€ä¸ªäºŒå…ƒç¥–æ¥æŒ‡å®šï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">msg = Message(<span class="string">"Hello"</span>, sender=(<span class="string">"ttdevs"</span>, <span class="string">"ttdevs@live.com"</span>))</div></pre></td></tr></table></figure>
<p>åŒæ—¶ï¼Œ æˆ‘ä»¬è¿˜å¯ä»¥æŒ‡å®šä¸‹é¢ä¸¤ä¸ªå­—æ®µï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">msg.body = <span class="string">"this is body string"</span></div><div class="line">msg.html = <span class="string">"&lt;h2&gt;this is html message&lt;/b&gt;"</span></div></pre></td></tr></table></figure>
<p>æœ€åå°±æ˜¯å‘é€ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">mail.send(msg)</div></pre></td></tr></table></figure>
<p>å‘é€å®Œæ¯•åï¼Œä¸é‚®ä»¶æœåŠ¡å™¨çš„é“¾æ¥å°±ä¼šå…³é—­ã€‚</p>
<h3 id="å‘é€å¤§é‡é‚®ä»¶"><a href="/1970/01/01/[Flask]0x01FlaskMail/#å‘é€å¤§é‡é‚®ä»¶" class="headerlink" title="å‘é€å¤§é‡é‚®ä»¶"></a>å‘é€å¤§é‡é‚®ä»¶</h3><p>å¦‚æœæˆ‘ä»¬ä¸€æ¬¡å‘é€å¤§é‡çš„é‚®ä»¶ï¼Œå¯ä»¥é€šè¿‡ä¸‹é¢çš„æ–¹å¼å‘é€ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">with</span> mail.connect() <span class="keyword">as</span> conn:</div><div class="line">    <span class="keyword">for</span> user <span class="keyword">in</span> users:</div><div class="line">        message = <span class="string">'...'</span></div><div class="line">        subject = <span class="string">"hello, %s"</span> % user.name</div><div class="line">        msg = Message(recipients=[user.email],</div><div class="line">                      body=message,</div><div class="line">                      subject=subject)</div><div class="line">        conn.send(msg)</div></pre></td></tr></table></figure>
<p>ä¸ç”µå­é‚®ä»¶æœåŠ¡å™¨çš„è¿æ¥ä¼šä¸€ç›´ä¿æŒç›´åˆ°æ‰€æœ‰çš„é‚®ä»¶éƒ½å·²ç»å‘é€å®Œæ¯•æ‰ä¼šæ–­å¼€ã€‚</p>
<blockquote>
<p>Some mail servers set a limit on the number of emails sent in a single connection. You can set the max amount of emails to send before reconnecting by specifying theMAIL_MAX_EMAILS setting.</p>
</blockquote>
<h3 id="æ·»åŠ é™„ä»¶"><a href="/1970/01/01/[Flask]0x01FlaskMail/#æ·»åŠ é™„ä»¶" class="headerlink" title="æ·»åŠ é™„ä»¶"></a>æ·»åŠ é™„ä»¶</h3><p>åœ¨é‚®ä»¶ä¸­æ·»åŠ é™„ä»¶åŒæ ·éå¸¸ç®€å•ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">image = <span class="string">'umbrella.jpg'</span></div><div class="line"><span class="keyword">with</span> app.open_resource(image) <span class="keyword">as</span> fp:</div><div class="line">    msg.attach(image, <span class="string">'image/jpg'</span>, fp.read())</div></pre></td></tr></table></figure>
<h2 id="0x03-Demo"><a href="/1970/01/01/[Flask]0x01FlaskMail/#0x03-Demo" class="headerlink" title="0x03 Demo"></a>0x03 Demo</h2><p>ä¸‹é¢æ˜¯ä¸€ä¸ªç®€å•çš„Demoï¼Œè£…å¥½ç›¸å…³çš„ç±»åº“ï¼Œ ç›´æ¥å¯ä»¥è·‘ï¼Œå¤§å®¶å¯ä»¥å‚è€ƒï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#!/usr/bin/env python3</span></div><div class="line"><span class="comment"># coding:utf-8</span></div><div class="line"></div><div class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask</div><div class="line"><span class="keyword">from</span> flask_mail <span class="keyword">import</span> Mail</div><div class="line"><span class="keyword">from</span> flask_mail <span class="keyword">import</span> Message</div><div class="line"></div><div class="line">app = Flask(__name__)</div><div class="line">app.config[<span class="string">'MAIL_SERVER'</span>] = <span class="string">'smtp.qq.com'</span></div><div class="line">app.config[<span class="string">'MAIL_PORT'</span>] = <span class="number">465</span></div><div class="line">app.config[<span class="string">'MAIL_USE_SSL'</span>] = <span class="keyword">True</span></div><div class="line">app.config[<span class="string">'MAIL_USERNAME'</span>] = <span class="string">'iot.raspi@qq.com'</span></div><div class="line">app.config[<span class="string">'MAIL_PASSWORD'</span>] = <span class="string">'********'</span></div><div class="line">app.config[<span class="string">'MAIL_DEFAULT_SENDER'</span>] = <span class="string">'iot.raspi@qq.com'</span></div><div class="line"></div><div class="line">mail = Mail(app)</div><div class="line"></div><div class="line"></div><div class="line"><span class="meta">@app.route('/')</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">welcome</span><span class="params">()</span>:</span></div><div class="line">    msg = Message(<span class="string">'è¿™æ˜¯ä¸€å°æµ‹è¯•é‚®ä»¶Header'</span>, recipients=[<span class="string">'56532799@qq.com'</span>])</div><div class="line">    msg.body = <span class="string">'è¿™æ˜¯ä¸€å°æµ‹è¯•é‚®ä»¶ bodyer'</span></div><div class="line">    msg.html = <span class="string">'è¿™æ˜¯ä¸€å°æµ‹è¯•é‚®ä»¶ htmler'</span></div><div class="line">    image = <span class="string">'umbrella_ä¼.jpg'</span></div><div class="line">    <span class="keyword">with</span> app.open_resource(image) <span class="keyword">as</span> fp:</div><div class="line">        msg.attach(image, <span class="string">'image/jpg'</span>, fp.read())</div><div class="line">    mail.send(msg)</div><div class="line">    <span class="keyword">return</span> <span class="string">'Hello world!'</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</div><div class="line">    app.run(debug=tuple)</div></pre></td></tr></table></figure>
<h3 id="é‚®ä»¶å‚æ•°è¯´æ˜"><a href="/1970/01/01/[Flask]0x01FlaskMail/#é‚®ä»¶å‚æ•°è¯´æ˜" class="headerlink" title="é‚®ä»¶å‚æ•°è¯´æ˜"></a>é‚®ä»¶å‚æ•°è¯´æ˜</h3><p>ä¸Šé¢çš„Demoä¸­ç”¨åˆ°QQé‚®ç®±ï¼Œè¿™é‡Œç®€å•ä»‹ç»ä¸‹ã€‚ç”±äºQQé‚®ç®±éœ€è¦å®‰å…¨éªŒè¯ï¼Œæ‰€ä»¥æˆ‘ä»¬é…ç½®ä¸‹é¢å‡ ä¸ªå‚æ•°ï¼š</p>
<ul>
<li><p>MAIL_SERVER</p>
<p>  SMTPåœ°å€ï¼šsmtp.qq.com</p>
</li>
<li><p>MAIL_PORT</p>
<p>  ç”±äºéœ€è¦å®‰å…¨éªŒè¯ï¼Œæ‰€ä»¥æ­¤å¤„ç”¨465</p>
</li>
<li><p>MAIL_USE_SSLï¼šTrue</p>
<p>  SSLï¼Œèµ°åŠ å¯†æ–¹å¼</p>
</li>
<li><p>MAIL_USERNAME</p>
<p>  iot.raspi@qq.com</p>
</li>
<li><p>MAIL_PASSWORD</p>
<p>  è¿™ä¸ªåœ°æ–¹æˆ‘ä»¬éœ€è¦ä½¿ç”¨æˆæƒç ï¼š<br>  æ‰“å¼€ <code>QQé‚®ç®±</code> &gt; <code>è®¾ç½®</code> &gt; <code>POP3/IMAP/SMTP/Exchange/CardDAV/CalDAVæœåŠ¡</code> &gt; <code>ç”Ÿæˆæˆæƒç </code></p>
</li>
</ul>
<p>æœ€ååˆ«å¿˜äº†æ‰“å¼€SMTPæœåŠ¡ï½ï½</p>
<h2 id="0x04-å…¶ä»–"><a href="/1970/01/01/[Flask]0x01FlaskMail/#0x04-å…¶ä»–" class="headerlink" title="0x04 å…¶ä»–"></a>0x04 å…¶ä»–</h2><p>ï¼ˆTODO ç•™å‘ï¼Œå…¶å®æš‚æ—¶è¿˜æ²¡å­¦åˆ°ï½ï½ï¼‰</p>
<h3 id="å•å…ƒæµ‹è¯•"><a href="/1970/01/01/[Flask]0x01FlaskMail/#å•å…ƒæµ‹è¯•" class="headerlink" title="å•å…ƒæµ‹è¯•"></a>å•å…ƒæµ‹è¯•</h3><h3 id="ç¦æ­¢å‘é€é‚®ä»¶"><a href="/1970/01/01/[Flask]0x01FlaskMail/#ç¦æ­¢å‘é€é‚®ä»¶" class="headerlink" title="ç¦æ­¢å‘é€é‚®ä»¶"></a>ç¦æ­¢å‘é€é‚®ä»¶</h3><h3 id="å¤´æ³¨å…¥"><a href="/1970/01/01/[Flask]0x01FlaskMail/#å¤´æ³¨å…¥" class="headerlink" title="å¤´æ³¨å…¥"></a>å¤´æ³¨å…¥</h3><h3 id="ä¿¡å·é‡"><a href="/1970/01/01/[Flask]0x01FlaskMail/#ä¿¡å·é‡" class="headerlink" title="ä¿¡å·é‡"></a>ä¿¡å·é‡</h3><h3 id="API"><a href="/1970/01/01/[Flask]0x01FlaskMail/#API" class="headerlink" title="API"></a>API</h3><h2 id="0xFF-å‚è€ƒ"><a href="/1970/01/01/[Flask]0x01FlaskMail/#0xFF-å‚è€ƒ" class="headerlink" title="0xFF å‚è€ƒ"></a>0xFF å‚è€ƒ</h2><ol>
<li><a href="http://pythonhosted.org/Flask-Mail/" target="_blank" rel="external">http://pythonhosted.org/Flask-Mail/</a></li>
<li><a href="http://www.pythondoc.com/flask-mail/" target="_blank" rel="external">http://www.pythondoc.com/flask-mail/</a></li>
<li><a href="https://pypi.python.org/pypi/Flask-Mail/" target="_blank" rel="external">https://pypi.python.org/pypi/Flask-Mail/</a></li>
</ol>
<p><img src="https://raw.githubusercontent.com/ttdevs/ttdevs.github.io/common/images/logo.png" alt="Create by ttdevs"></p>
]]></content>
      
        <categories>
            
            <category> æŠ€æœ¯ </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Flask </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[ã€ŒFlaskã€0x03æ ‘è“æ´¾ä¸Šä½¿ç”¨Nginxå’ŒuWSGIéƒ¨ç½²Flaskåº”ç”¨]]></title>
      <url>/1970/01/01/%5BFlask%5D0x03%E6%A0%91%E8%8E%93%E6%B4%BE%E4%B8%8A%E4%BD%BF%E7%94%A8Nginx%E5%92%8CuWSGI%E9%83%A8%E7%BD%B2Flask%E5%BA%94%E7%94%A8/</url>
      <content type="html"><![CDATA[<h2 id="0x00-éƒ¨ç½²ï¼šuWSGI-å’Œ-Nginx-ä»‹ç»"><a href="/1970/01/01/[Flask]0x03æ ‘è“æ´¾ä¸Šä½¿ç”¨Nginxå’ŒuWSGIéƒ¨ç½²Flaskåº”ç”¨/#0x00-éƒ¨ç½²ï¼šuWSGI-å’Œ-Nginx-ä»‹ç»" class="headerlink" title="0x00 éƒ¨ç½²ï¼šuWSGI å’Œ Nginx ä»‹ç»"></a>0x00 éƒ¨ç½²ï¼šuWSGI å’Œ Nginx ä»‹ç»</h2><p>Deploy Flask Application with Nginx and uWSGI</p>
<p>è€ƒè™‘åˆ°éƒ¨ç½²çš„é—®é¢˜ï¼Œç›¸ä¿¡æ‚¨å·²ç»å®Œæˆäº†è‡ªå·±Flaskåº”ç”¨çš„å¼€å‘å·¥ä½œï¼Œæˆ–è€…è·Ÿæˆ‘ä¸€æ ·ï¼Œä¸€ä¸ªdemo åº”ç”¨å·²ç»å®Œæˆã€‚å¥½å¥‡è‡ªå·±çš„åº”ç”¨å¦‚ä½•å‘å¸ƒå‡ºå»ã€‚æ¥ä¸‹æ¥ï¼Œé€šè¿‡ä»‹ç»ä¸€äº›å¸¸ç”¨çš„å·¥å…·æ¥å®Œæˆæˆ‘ä»¬åº”ç”¨çš„éƒ¨ç½²ã€‚å…ˆç®€å•ä»‹ç»ä¸‹æˆ‘çš„ç¯å¢ƒï¼š</p>
<ul>
<li>ä¸€å°å†…ç½‘ä¸­çš„æ ‘è“æ´¾</li>
<li>ä¸€ä¸ªèŠ±ç”Ÿæ£’(98RMBä¹°çš„ç¡¬ä»¶)</li>
</ul>
<p>ä½¿ç”¨èŠ±ç”Ÿæ£’åšäº†å†…ç½‘çš„ç«¯å£æ˜ å°„ï¼Œå¯¹å¤–æš´éœ²80ç«¯å£æä¾›httpæœåŠ¡ï¼Œè‡³äºä¸ºä»€ä¹ˆè¿™ä¹ˆåšï¼Œè¯·å‚è€ƒ<a href="http://www.jianshu.com/p/9855c15a1dd7" target="_blank" rel="external">è¿™é‡Œ</a>ã€‚</p>
<p>å¥½äº†ï¼Œæ¥ä¸‹æ¥è¿›å…¥æ­£é¢˜ã€‚</p>
<p>uWSGIä½œä¸ºWebæœåŠ¡å™¨ä½¿ç”¨ï¼Œnginxåšåå‘ä»£ç†ã€‚</p>
<h3 id="uWSGI"><a href="/1970/01/01/[Flask]0x03æ ‘è“æ´¾ä¸Šä½¿ç”¨Nginxå’ŒuWSGIéƒ¨ç½²Flaskåº”ç”¨/#uWSGI" class="headerlink" title="uWSGI"></a>uWSGI</h3><p>uWSGIåšWebæœåŠ¡å™¨</p>
<p>ã€ŠFlask Webå¼€å‘ï¼šåŸºäºPythonçš„Webåº”ç”¨å¼€å‘å®æˆ˜ã€‹æœ‰ä¸‹é¢ä¸¤æ®µæè¿°ï¼š</p>
<p>å…¶ä¸€ï¼š</p>
<blockquote>
<p>Flaskè‡ªå¸¦çš„å¼€å‘WebæœåŠ¡å™¨ä¸å¤Ÿå¼ºå¥ã€å®‰å…¨å’Œé«˜æ•ˆï¼Œæ— æ³•åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ä½¿ç”¨ã€‚</p>
</blockquote>
<p>å…¶äºŒï¼š</p>
<blockquote>
<p>Flaskè‡ªå¸¦çš„å¼€å‘WebæœåŠ¡å™¨è¡¨ç°å¾ˆå·®ï¼Œå› ä¸ºå®ƒä¸æ˜¯ä¸ºç”Ÿäº§ç¯å¢ƒè®¾è®¡çš„æœåŠ¡å™¨ã€‚æœ‰ä¸¤ä¸ªå¯ä»¥åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ä½¿ç”¨ã€æ€§èƒ½è‰¯å¥½ä¸”æ”¯æŒFlaskç¨‹åºçš„æœåŠ¡å™¨ï¼Œåˆ†åˆ«æ˜¯Gunicorn(<a href="http://gunicorn.org/" target="_blank" rel="external">http://gunicorn.org/</a>) å’Œ uWSGI(<a href="http://uwsgi-docs.readthedocs.org/en/latest/" target="_blank" rel="external">http://uwsgi-docs.readthedocs.org/en/latest/</a>) ã€‚</p>
</blockquote>
<p>å…ˆä»‹ç»ä¸€ä¸‹WSGIï¼ˆfromï¼š<a href="https://zh.wikipedia.org/wiki/WebæœåŠ¡å™¨ç½‘å…³æ¥å£" target="_blank" rel="external">ç»´åŸºç™¾ç§‘</a>ï¼‰ï¼š</p>
<blockquote>
<p>WebæœåŠ¡å™¨ç½‘å…³æ¥å£ï¼ˆPython Web Server Gateway Interfaceï¼Œç¼©å†™ä¸ºWSGIï¼‰æ˜¯ä¸ºPythonè¯­è¨€å®šä¹‰çš„WebæœåŠ¡å™¨å’ŒWebåº”ç”¨ç¨‹åºæˆ–æ¡†æ¶ä¹‹é—´çš„ä¸€ç§ç®€å•è€Œé€šç”¨çš„æ¥å£ã€‚è‡ªä»WSGIè¢«å¼€å‘å‡ºæ¥ä»¥åï¼Œè®¸å¤šå…¶å®ƒè¯­è¨€ä¸­ä¹Ÿå‡ºç°äº†ç±»ä¼¼æ¥å£ã€‚<br>ä»¥å‰ï¼Œå¦‚ä½•é€‰æ‹©åˆé€‚çš„Webåº”ç”¨ç¨‹åºæ¡†æ¶æˆä¸ºå›°æ‰°Pythonåˆå­¦è€…çš„ä¸€ä¸ªé—®é¢˜ï¼Œè¿™æ˜¯å› ä¸ºï¼Œä¸€èˆ¬è€Œè¨€ï¼ŒWebåº”ç”¨æ¡†æ¶çš„é€‰æ‹©å°†é™åˆ¶å¯ç”¨çš„WebæœåŠ¡å™¨çš„é€‰æ‹©ï¼Œåä¹‹äº¦ç„¶ã€‚é‚£æ—¶çš„Pythonåº”ç”¨ç¨‹åºé€šå¸¸æ˜¯ä¸ºCGIï¼ŒFastCGIï¼Œmod_pythonä¸­çš„ä¸€ä¸ªè€Œè®¾è®¡ï¼Œç”šè‡³æ˜¯ä¸ºç‰¹å®šWebæœåŠ¡å™¨çš„è‡ªå®šä¹‰çš„APIæ¥å£è€Œè®¾è®¡çš„ã€‚<br>WSGI[1] ï¼ˆæœ‰æ—¶å‘éŸ³ä½œâ€™wiz-geeâ€™ï¼‰æ˜¯ä½œä¸ºWebæœåŠ¡å™¨ä¸Webåº”ç”¨ç¨‹åºæˆ–åº”ç”¨æ¡†æ¶ä¹‹é—´çš„ä¸€ç§ä½çº§åˆ«çš„æ¥å£ï¼Œä»¥æå‡å¯ç§»æ¤Webåº”ç”¨å¼€å‘çš„å…±åŒç‚¹ã€‚WSGIæ˜¯åŸºäºç°å­˜çš„CGIæ ‡å‡†è€Œè®¾è®¡çš„ã€‚</p>
</blockquote>
<p>å› æ­¤æˆ‘ä»¬éœ€è¦ä¸ºæˆ‘ä»¬çš„Flaskåº”ç”¨é…ç½®ä¸€ä¸ª <code>WebæœåŠ¡å™¨</code> ã€‚ã€ŠFlask Webå¼€å‘ã€‹ä¸­ä»‹ç»çš„éƒ¨ç½²åˆ°Herokué€‰æ‹©çš„æ˜¯Gunicornã€‚Gunicorn  å’Œ uWSGI çš„æ¯”è¾ƒç½‘ä¸Šå¾ˆå¤šï¼Œä¸»è¦çš„é—®é¢˜å¯èƒ½å°±æ˜¯è°çš„å‘å¤šå‘å°‘ã€‚ç»è¿‡æ¯”å¯¹ï¼Œè¿™é‡Œæˆ‘é€‰æ‹©uWSGIã€‚</p>
<p>uWSGI ä¸ä»…ä»…æ˜¯ä¸€ä¸ªåè®®ï¼ŒåŒæ—¶ä¹Ÿæ˜¯ä¸€ä¸ªåº”ç”¨æœåŠ¡å™¨ï¼Œå¯ä»¥æœåŠ¡äºuWSGIã€FastCGIå’ŒHTTPåè®®ã€‚uWSGIå®˜æ–¹æ–‡æ¡£å¯å‚è€ƒ<a href="http://uwsgi-docs.readthedocs.io/en/latest/" target="_blank" rel="external">è¿™é‡Œ</a> ã€‚</p>
<p>æ”¯æŒWSGIçš„Webåº”ç”¨æ¡†æ¶å¾ˆå¤šï¼Œæ¯”å¦‚ï¼š</p>
<ul>
<li>Django</li>
<li>Flask</li>
<li>web.py</li>
<li>web2py</li>
<li>Werkzeug</li>
<li>Tornado</li>
<li>and so on</li>
</ul>
<h3 id="Nginx"><a href="/1970/01/01/[Flask]0x03æ ‘è“æ´¾ä¸Šä½¿ç”¨Nginxå’ŒuWSGIéƒ¨ç½²Flaskåº”ç”¨/#Nginx" class="headerlink" title="Nginx"></a>Nginx</h3><p>nginxåšåå‘ä»£ç† </p>
<blockquote>
<p>Nginxï¼ˆå‘éŸ³åŒengine xï¼‰æ˜¯ä¸€ä¸ªç½‘é¡µæœåŠ¡å™¨ï¼Œå®ƒèƒ½åå‘ä»£ç†HTTP, HTTPS, SMTP, POP3, IMAPçš„åè®®é“¾æ¥ï¼Œä»¥åŠä¸€ä¸ªè´Ÿè½½å‡è¡¡å™¨å’Œä¸€ä¸ªHTTPç¼“å­˜ã€‚</p>
<p>Nginxæ˜¯ä¸€æ¬¾é¢å‘æ€§èƒ½è®¾è®¡çš„HTTPæœåŠ¡å™¨ï¼Œç›¸è¾ƒäºApacheã€lighttpdå…·æœ‰å æœ‰å†…å­˜å°‘ï¼Œç¨³å®šæ€§é«˜ç­‰ä¼˜åŠ¿ã€‚ä¸æ—§ç‰ˆæœ¬ï¼ˆ&lt;=2.2ï¼‰çš„Apacheä¸åŒï¼Œnginxä¸é‡‡ç”¨æ¯å®¢æˆ·æœºä¸€çº¿ç¨‹çš„è®¾è®¡æ¨¡å‹ï¼Œè€Œæ˜¯å……åˆ†ä½¿ç”¨å¼‚æ­¥é€»è¾‘ï¼Œå‰Šå‡äº†ä¸Šä¸‹æ–‡è°ƒåº¦å¼€é”€ï¼Œæ‰€ä»¥å¹¶å‘æœåŠ¡èƒ½åŠ›æ›´å¼ºã€‚æ•´ä½“é‡‡ç”¨æ¨¡å—åŒ–è®¾è®¡ï¼Œæœ‰ä¸°å¯Œçš„æ¨¡å—åº“å’Œç¬¬ä¸‰æ–¹æ¨¡å—åº“ï¼Œé…ç½®çµæ´»ã€‚ åœ¨Linuxæ“ä½œç³»ç»Ÿä¸‹ï¼Œnginxä½¿ç”¨epolläº‹ä»¶æ¨¡å‹ï¼Œå¾—ç›Šäºæ­¤ï¼Œnginxåœ¨Linuxæ“ä½œç³»ç»Ÿä¸‹æ•ˆç‡ç›¸å½“é«˜ã€‚åŒæ—¶Nginxåœ¨OpenBSDæˆ–FreeBSDæ“ä½œç³»ç»Ÿä¸Šé‡‡ç”¨ç±»ä¼¼äºepollçš„é«˜æ•ˆäº‹ä»¶æ¨¡å‹kqueueã€‚</p>
<p>Nginxåœ¨å®˜æ–¹æµ‹è¯•çš„ç»“æœä¸­ï¼Œèƒ½å¤Ÿæ”¯æŒäº”ä¸‡ä¸ªå¹³è¡Œè¿æ¥ï¼Œè€Œåœ¨å®é™…çš„è¿ä½œä¸­ï¼Œæ˜¯å¯ä»¥æ”¯æŒäºŒä¸‡è‡³å››ä¸‡ä¸ªå¹³è¡Œé“¾æ¥ã€‚</p>
</blockquote>
<p>ä»¥ä¸Šæ¥ä¿¡æ¯è‡ª<a href="https://zh.wikipedia.org/wiki/Nginx" target="_blank" rel="external">ç»´åŸºç™¾ç§‘</a>ã€‚</p>
<p>åå‘ä»£ç†ï¼š</p>
<blockquote>
<p>ä½¿ç”¨ä»£ç†æœåŠ¡å™¨å¯ä»¥å°†è¯·æ±‚è½¬å‘ç»™å†…éƒ¨çš„WebæœåŠ¡å™¨ï¼Œä½¿ç”¨è¿™ç§åŠ é€Ÿæ¨¡å¼æ˜¾ç„¶å¯ä»¥æå‡é™æ€ç½‘é¡µçš„è®¿é—®é€Ÿåº¦ã€‚å› æ­¤ä¹Ÿå¯ä»¥è€ƒè™‘ä½¿ç”¨è¿™ç§æŠ€æœ¯ï¼Œè®©ä»£ç†æœåŠ¡å™¨å°†è¯·æ±‚ å‡åŒ€è½¬å‘ç»™å¤šå°å†…éƒ¨WebæœåŠ¡å™¨ä¹‹ä¸€ä¸Šï¼Œä»è€Œè¾¾åˆ°è´Ÿè½½å‡è¡¡çš„ç›®çš„ã€‚è¿™ç§ä»£ç†æ–¹å¼ä¸æ™®é€šçš„ä»£ç†æ–¹å¼æœ‰æ‰€ä¸åŒï¼Œæ ‡å‡†ä»£ç†æ–¹å¼æ˜¯å®¢æˆ·ä½¿ç”¨ä»£ç†è®¿é—®å¤šä¸ªå¤–éƒ¨Web æœåŠ¡å™¨ï¼Œè€Œè¿™ç§ä»£ç†æ–¹å¼æ˜¯å¤šä¸ªå®¢æˆ·ä½¿ç”¨å®ƒè®¿é—®å†…éƒ¨WebæœåŠ¡å™¨ï¼Œå› æ­¤ä¹Ÿè¢«ç§°ä¸ºåå‘ä»£ç†æ¨¡å¼ã€‚</p>
</blockquote>
<p>å‚è€ƒï¼š<a href="http://www.bing.com/knows/åå‘ä»£ç†è´Ÿè½½å‡è¡¡" target="_blank" rel="external">http://www.bing.com/knows/åå‘ä»£ç†è´Ÿè½½å‡è¡¡</a></p>
<p>è™½ç„¶ä½ å¯èƒ½ä¸çŸ¥é“Nginxæ˜¯åšä»€ä¹ˆçš„ï¼Œä½†æ˜¯ä½ åº”è¯¥å¬è¿‡ï¼Œå†æˆ–è€…ä½ è‡³å°‘å¬è¿‡Apacheï¼Œä»–ä»¬éƒ½æ˜¯HTTPæœåŠ¡å™¨ã€‚æ•æˆ‘èƒ½åŠ›æœ‰é™ï¼Œç›®å‰ä¸ºæ­¢å¹¶ä¸èƒ½å¾ˆå¥½çš„è§£é‡Šä¸ºä»€ä¹ˆéå¾—ç”¨Nginxï¼Œèƒ½å‘Šè¯‰å¤§å®¶çš„æ˜¯ï¼šNginxå¸®æˆ‘ä»¬å¤„ç†å¾ˆå¤šé™æ€èµ„æºï¼ŒåŒæ—¶å°†åŠ¨æ€è¯·æ±‚è½¬å‘ç»™ä¸åŒçš„WebæœåŠ¡å™¨ï¼ˆè´Ÿè½½å‡è¡¡ï¼‰ã€‚æ­¤å¤„ç•™å‘ï¼Œç­‰ä»¥åè¡¥ä¸Šã€‚</p>
<p>æ¥ä¸‹æ¥é€šè¿‡æœ€ç®€å•çš„é…ç½®ï¼Œå°†æˆ‘ä»¬çš„Flaskåº”ç”¨éƒ¨ç½²åˆ°æˆ‘ä»¬çš„æ ‘è“æ´¾ä¸Šï¼Œè¾¾åˆ°å¯¹éƒ¨ç½²çš„æµç¨‹æœ‰ä¸ªæ€»ä½“æŠŠæ¡çš„ç›®çš„ã€‚å¦‚æœä½ éœ€è¦æ›´å¤šçš„é…ç½®ï¼Œå¯ä»¥å‚è€ƒå„è‡ªéƒ¨åˆ†çš„å®˜æ–¹æ–‡æ¡£ã€‚</p>
<h2 id="0x01-uWSGI"><a href="/1970/01/01/[Flask]0x03æ ‘è“æ´¾ä¸Šä½¿ç”¨Nginxå’ŒuWSGIéƒ¨ç½²Flaskåº”ç”¨/#0x01-uWSGI" class="headerlink" title="0x01 uWSGI"></a>0x01 uWSGI</h2><ul>
<li><p>å®‰è£…</p>
<p>  å…ˆä»å®‰è£…è¯´èµ·ï¼š<code>pip install uwsgi</code></p>
</li>
<li><p>é…ç½®</p>
<p>  åœ¨æˆ‘ä»¬é¡¹ç›®çš„æ ¹ç›®å½•ä¸‹ï¼Œåˆ›å»º <code>uwsgi.ini</code> æ–‡ä»¶ï¼Œ å†…å®¹å¦‚ä¸‹ï¼š</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">[uwsgi]</div><div class="line">socket = 127.0.0.1:5000</div><div class="line">processes = 4</div><div class="line">threads = 2</div><div class="line">plugins = python3</div><div class="line">master = true</div><div class="line">venv = venv</div><div class="line">pythonpath = .</div><div class="line">module = manage</div><div class="line">callable = application</div></pre></td></tr></table></figure>
<p>  é…ç½®å‚æ•°è¯´æ˜ï¼š</p>
<ul>
<li>socketï¼šåº”ç”¨ç¨‹åºæ‰€åœ¨åœ°å€ï¼ŒIPåŠ ç«¯å£å·ï¼Œå½“ç„¶ï¼Œä¹Ÿå¯ä»¥æœ‰å…¶ä»–çš„å½¢å¼</li>
<li>processesï¼šå¼€å¯çš„è¿›ç¨‹æ•°é‡</li>
<li>threadsï¼šæ¯ä¸ªè¿›ç¨‹çš„çº¿ç¨‹æ•°</li>
<li>pluginsï¼šåŠ è½½çš„æ’ä»¶</li>
<li>moduleï¼šåŠ è½½æŒ‡å®šçš„python WSGIæ¨¡å—</li>
<li><p>callableï¼šåœ¨æ”¶åˆ°è¯·æ±‚æ—¶ï¼ŒuWSGIåŠ è½½çš„æ¨¡å—ä¸­å“ªä¸ªå˜é‡å°†è¢«è°ƒç”¨ï¼Œé»˜è®¤æ˜¯åå­—ä¸ºâ€œapplicationâ€çš„å˜é‡ã€‚</p>
<p>é¡ºä¾¿è´´ä¸€ä¸‹æˆ‘çš„Flaské¡¹ç›®æ–‡ä»¶ï¼šmanage.py</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#!/usr/bin/env python3</span></div><div class="line"><span class="comment"># coding:utf-8</span></div><div class="line"><span class="keyword">from</span> flask.ext.script <span class="keyword">import</span> Manager</div><div class="line">config = <span class="string">'development'</span></div><div class="line">application = create_app(config)</div><div class="line">manager = Manager(application)</div><div class="line">...</div><div class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</div><div class="line">        manager.run()</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<ul>
<li><p>æ“ä½œ</p>
<p>  å¯åŠ¨ï¼š<code>uwsgi uwsig.ini</code>ã€‚å¦‚æœå¯åŠ¨æˆåŠŸï¼Œä¼šçœ‹åˆ°ç±»ä¼¼ä¸‹é¢çš„logï¼š</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div></pre></td><td class="code"><pre><div class="line">(venv)pi@raspberrypi:~/raspi $ uwsgi uwsgi.ini</div><div class="line">[uWSGI] getting INI configuration from uwsgi.ini</div><div class="line">open(&quot;./python3_plugin.so&quot;): No such file or directory [core/utils.c line 3684]</div><div class="line">!!! UNABLE to load uWSGI plugin: ./python3_plugin.so: cannot open shared object file: No such file or directory !!!</div><div class="line">*** Starting uWSGI 2.0.13.1 (32bit) on [Sun Jul  3 22:35:08 2016] ***</div><div class="line">compiled with version: 4.9.2 on 27 May 2016 15:15:57</div><div class="line">os: Linux-4.1.19-v7+ #858 æ ‘è“æ´¾ Tue Mar 15 15:56:00 GMT 2016</div><div class="line">nodename: raspberrypi</div><div class="line">machine: armv7l</div><div class="line">clock source: unix</div><div class="line">detected number of CPU cores: 4</div><div class="line">current working directory: /home/pi/raspi</div><div class="line">detected binary path: /home/pi/raspi/venv/bin/uwsgi</div><div class="line">!!! no internal routing support, rebuild with pcre support !!!</div><div class="line">your processes number limit is 6831</div><div class="line">your memory page size is 4096 bytes</div><div class="line">detected max file descriptor number: 65536</div><div class="line">lock engine: pthread robust mutexes</div><div class="line">thunder lock: disabled (you can enable it with --thunder-lock)</div><div class="line">uwsgi socket 0 bound to TCP address 127.0.0.1:5000 fd 3</div><div class="line">Python version: 3.4.2 (default, Oct 19 2014, 14:03:53)  [GCC 4.9.1]</div><div class="line">Set PythonHome to venv</div><div class="line">Python main interpreter initialized at 0xbaf828</div><div class="line">python threads support enabled</div><div class="line">your server socket listen backlog is limited to 100 connections</div><div class="line">your mercy for graceful operations on workers is 60 seconds</div><div class="line">mapped 358400 bytes (350 KB) for 8 cores</div><div class="line">*** Operational MODE: preforking+threaded ***</div><div class="line">added ./ to pythonpath.</div><div class="line">WSGI app 0 (mountpoint=&apos;&apos;) ready in 5 seconds on interpreter 0xbaf828 pid: 3418 (default app)</div><div class="line">*** uWSGI is running in multiple interpreter mode ***</div><div class="line">spawned uWSGI master process (pid: 3418)</div><div class="line">spawned uWSGI worker 1 (pid: 3428, cores: 2)</div><div class="line">spawned uWSGI worker 2 (pid: 3429, cores: 2)</div><div class="line">spawned uWSGI worker 3 (pid: 3431, cores: 2)</div><div class="line">spawned uWSGI worker 4 (pid: 3432, cores: 2)</div></pre></td></tr></table></figure>
</li>
</ul>
<pre><code>- åœæ­¢

    - å¦‚æœè¿˜åœ¨åŒä¸€ä¸ªshellä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥æŒ‰ `Ctrl + C` 
    - å¦‚æœä¸åœ¨åŒä¸€ä¸ªshellä¸­ï¼Œå¯ä»¥è¿™æ ·ç»“æŸæ‰ `killall -9 uwsgi`

å¯åŠ¨æˆåŠŸä¹‹åå°±å¯ä»¥è®¿é—®æˆ‘ä»¬çš„Webåº”ç”¨äº†ï¼Œé»˜è®¤åœ°å€æ˜¯ï¼šhttp://127.0.0.1:5000 ï¼ˆè¿™ä¸ªåœ°å€å’Œç«¯å£å·æ˜¯åœ¨æˆ‘ä»¬çš„Flaskåº”ç”¨ä¸­é…é…ç½®çš„ï¼Œè¿™é‡Œä¸åšä»‹ç»ï¼‰ã€‚å¦‚æœå‡ºç° `invalid request block size: 21573 (max 4096)...skip`è¿™ä¸ªé”™è¯¯ï¼Œè¯·å°†é…ç½®ä¸­çš„ `socket` æ”¹ä¸º `http`ï¼Œå…·ä½“å¯ä»¥å‚è€ƒ[è¿™é‡Œ](http://stackoverflow.com/questions/15878176/uwsgi-invalid-request-block-size)ã€‚
</code></pre><h2 id="0x02-Nginx"><a href="/1970/01/01/[Flask]0x03æ ‘è“æ´¾ä¸Šä½¿ç”¨Nginxå’ŒuWSGIéƒ¨ç½²Flaskåº”ç”¨/#0x02-Nginx" class="headerlink" title="0x02 Nginx"></a>0x02 Nginx</h2><ul>
<li><p>å®‰è£…</p>
<p>  <code>sudo apt-get install ngnix</code></p>
</li>
<li><p>æ“ä½œ</p>
<ul>
<li><p>å¯åŠ¨</p>
<p>  sudo /etc/init.d/nginx start<br>  sudo service nginx start</p>
</li>
<li><p>åœæ­¢</p>
<p>  sudo /etc/init.d/nginx stop<br>  sudo service nginx stop</p>
</li>
<li><p>é‡å¯</p>
<p>  sudo /etc/init.d/nginx restart<br>  sudo service nginx restart</p>
<p>å¦‚æœæ²¡é—®é¢˜ï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬å°±å¯ä»¥æ‰“å¼€æµè§ˆå™¨è®¿é—®ï¼š127.0.0.1ï¼Œåº”è¯¥ä¼šçœ‹åˆ°ä¸€ä¸ªé™æ€é¡µé¢ã€‚</p>
</li>
</ul>
</li>
<li><p>é…ç½®</p>
<p>  nginx çš„é…ç½®æ–‡ä»¶æ—¶ä½äº <code>/etc/nginx/sites-available</code> ç›®å½•ä¸‹çš„ <code>default</code> æ–‡ä»¶ï¼Œæˆ‘ä»¬å¤åˆ¶ä¸€ä»½åšä¿®æ”¹ï¼Œè¿™é‡ŒåŒæ ·ç»™ä¸€ä»½æœ€ç®€å•çš„é…ç½®ï¼š</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">server &#123;</div><div class="line">    listen 80;</div><div class="line"></div><div class="line">    server_name ttdevs.vicp.net;</div><div class="line"></div><div class="line">    # access_log logs/access.log compression;</div><div class="line"></div><div class="line">    #é»˜è®¤è¯·æ±‚</div><div class="line">    location / &#123;</div><div class="line">            include uwsgi_params;</div><div class="line">            uwsgi_pass 127.0.0.1:5000;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ul>
<pre><code>é…ç½®å¥½è¿™äº›ä¹‹åé‡å¯æˆ‘ä»¬çš„nginxæœåŠ¡ï¼š`sudo service nginx restart`ã€‚å³å¯è®¿é—®æˆ‘ä»¬çš„webåº”ç”¨äº†ã€‚    
</code></pre><h2 id="0x03-æ€»ç»“"><a href="/1970/01/01/[Flask]0x03æ ‘è“æ´¾ä¸Šä½¿ç”¨Nginxå’ŒuWSGIéƒ¨ç½²Flaskåº”ç”¨/#0x03-æ€»ç»“" class="headerlink" title="0x03 æ€»ç»“"></a>0x03 æ€»ç»“</h2><p>å¦‚æœä¸­é—´æ²¡æœ‰å‡ºé”™ï¼Œä½ çš„Flaskåº”ç”¨å·²ç»éƒ¨ç½²æˆåŠŸã€‚åˆ°æ­¤ï¼Œæˆ‘ä»¬æ¥æ¢³ç†ä¸‹è¿™ä¸ªæµç¨‹ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬å®‰è£…Nginxï¼Œä»–ç›´æ¥å¤„ç†ç”¨æˆ·å‘é€çš„HTTPè¯·æ±‚ï¼ˆHTTPæœåŠ¡å™¨ï¼‰ï¼Œå¹¶å°†è¯·æ±‚æŒ‰ç…§æˆ‘ä»¬çš„é…ç½®ï¼ˆnginxä¸­çš„é…ç½®ï¼‰äº¤ç»™uWSGIæœåŠ¡å™¨ï¼ˆWebæœåŠ¡å™¨ï¼‰ï¼Œæœ€åuWSGIå°†è¯·æ±‚äº¤ç»™æˆ‘ä»¬çš„Flaskåº”ç”¨ï¼Œç”±Flaskåº”ç”¨è¿›è¡Œé€»è¾‘å¤„ç†ï¼Œå¤„ç†å®Œä¹‹åå†å°†ç»“æœè¿”å›ç»™ç”¨æˆ·ã€‚è¿™äº›ï¼Œå°±æ˜¯æˆ‘å¯¹è¿™ä¸ªæµç¨‹çš„ç†è§£ï¼Œç›¸ä¿¡ä¸­é—´è‚¯å®šæœ‰é”™è¯¯æˆ–è€…ä¸åˆ°ä½çš„åœ°æ–¹ï¼Œåœ¨å¯¹è¿™äº›çŸ¥è¯†æœ‰æ›´è¿›ä¸€æ­¥ç†è§£çš„æ—¶å€™æˆ‘ä¼šè¿”å›åŠæ—¶æ›´æ–°ã€‚åŒæ—¶ä¹Ÿæ¬¢è¿å„ä½æŒ‡æ­£ï½ï½</p>
<h2 id="0xFF-å‚è€ƒ"><a href="/1970/01/01/[Flask]0x03æ ‘è“æ´¾ä¸Šä½¿ç”¨Nginxå’ŒuWSGIéƒ¨ç½²Flaskåº”ç”¨/#0xFF-å‚è€ƒ" class="headerlink" title="0xFF å‚è€ƒ"></a>0xFF å‚è€ƒ</h2><ol>
<li><a href="http://docs.jinkan.org/docs/flask/deploying/uwsgi.html" target="_blank" rel="external">http://docs.jinkan.org/docs/flask/deploying/uwsgi.html</a></li>
<li><a href="http://www.cnblogs.com/zhouej/archive/2012/03/25/2379646.html" target="_blank" rel="external">http://www.cnblogs.com/zhouej/archive/2012/03/25/2379646.html</a></li>
<li><a href="http://www.cnblogs.com/Ray-liang/p/4173923.html" target="_blank" rel="external">http://www.cnblogs.com/Ray-liang/p/4173923.html</a></li>
<li><a href="https://github.com/nginx/nginx/blob/master/conf/uwsgi_params" target="_blank" rel="external">https://github.com/nginx/nginx/blob/master/conf/uwsgi_params</a></li>
<li><a href="http://docs.jinkan.org/docs/flask/deploying/wsgi-standalone.html#deploying-proxy-setups" target="_blank" rel="external">http://docs.jinkan.org/docs/flask/deploying/wsgi-standalone.html#deploying-proxy-setups</a></li>
</ol>
<p><img src="https://raw.githubusercontent.com/ttdevs/ttdevs.github.io/common/images/logo.png" alt="Create by ttdevs"></p>
]]></content>
      
        <categories>
            
            <category> æŠ€æœ¯ </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Flask </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[ã€ŒPythonã€ä½¿ç”¨requestså¤„ç†cookie]]></title>
      <url>/1970/01/01/%5BPython%5D%E4%BD%BF%E7%94%A8requests%E5%A4%84%E7%90%86cookie/</url>
      <content type="html"><![CDATA[<p><img src="https://camo.githubusercontent.com/5e4574f4d470db274e80e7cb1464e426e643e084/687474703a2f2f646f63732e707974686f6e2d72657175657374732e6f72672f656e2f6d61737465722f5f7374617469632f72657175657374732d736964656261722e706e67" alt="requests"></p>
<h2 id="0x00-éœ€æ±‚"><a href="/1970/01/01/[Python]ä½¿ç”¨requestså¤„ç†cookie/#0x00-éœ€æ±‚" class="headerlink" title="0x00 éœ€æ±‚"></a>0x00 éœ€æ±‚</h2><p>å¸¸è§çš„ <code>application/json</code> è¯·æ±‚ï¼Œå¦‚æœtokenè¿›è¡ŒéªŒè¯ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨headeræˆ–è€…bodyä¸­ç›´æ¥æ·»åŠ ï¼Œå¯¹äºä½¿ç”¨cookieè¿›è¡ŒéªŒè¯çš„è¯·æ±‚ï¼Œè™½ç„¶å¯ä»¥è‡ªå·±ç»´æŠ¤cookieï¼Œä½†æ˜¯ä¼šæ¯”tokenéº»çƒ¦å¾ˆå¤šã€‚</p>
<p>ä¹‹å‰çš„å¿˜äº†è¯·æ±‚éƒ½æ˜¯ä½¿ç”¨python3çš„urllibè¿›è¡Œï¼Œå½“å¤„ç†cookieæ—¶ï¼Œå‘ç°æ¯”è¾ƒå›°éš¾ï¼Œå› æ­¤ç€æ‰‹å¦å¯»ä»–æ³•ï¼Œè¿™æ ·å°±å‘ç°äº†requestsã€‚ç®€å•çœ‹äº†ä¸‹ï¼Œä½¿ç”¨èµ·æ¥æ¯”urllibæ–¹ä¾¿äº†å¥½å¤šï¼Œå¥½å¤šã€‚ä¸ç´§ç´§å®ç°äº†æ‰‹åŠ¨æ·»åŠ cookieçš„éœ€æ±‚ï¼Œå…¶ä»–æ¥å£ä½¿ç”¨ä¹Ÿæ˜¯ç›¸å½“å‹å¥½ã€‚æœ‰æ—¶é—´æ‰“ç®—å§ä¹‹å‰çš„ä»£ç é‡æ„ä¸€ä¸‹ã€‚</p>
<p>ä¸‹é¢ç®€å•ä»‹ç»ä¸‹requestsçš„ä½¿ç”¨ã€‚</p>
<h2 id="0x01-requests"><a href="/1970/01/01/[Python]ä½¿ç”¨requestså¤„ç†cookie/#0x01-requests" class="headerlink" title="0x01 requests"></a>0x01 requests</h2><h3 id="Request"><a href="/1970/01/01/[Python]ä½¿ç”¨requestså¤„ç†cookie/#Request" class="headerlink" title="Request"></a>Request</h3><ul>
<li><p>GET</p>
<ul>
<li><p>æ— å‚æ•°</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&gt;&gt;&gt; r = requests.get(&apos;https://api.github.com/events&apos;)`</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<pre><code>- urlå‚æ•°

    <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&gt;&gt;&gt; payload = &#123;&apos;key1&apos;: &apos;value1&apos;, &apos;key2&apos;: &apos;value2&apos;&#125;</div><div class="line">&gt;&gt;&gt; r = requests.get(&apos;http://httpbin.org/get&apos;, params=payload)</div><div class="line">&gt;&gt;&gt; print(r.url)</div><div class="line">http://httpbin.org/get?key2=value2&amp;key1=value1</div></pre></td></tr></table></figure>


    è¾“å‡ºï¼š

    <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt;&gt;&gt; print(r.url)</div><div class="line">http://httpbin.org/get?key2=value2&amp;key1=value1</div></pre></td></tr></table></figure>
</code></pre><ul>
<li>POST</li>
</ul>
<pre><code>- formå‚æ•°

    <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">r = requests.post(&apos;http://httpbin.org/post&apos;, data = &#123;&apos;key&apos;:&apos;value&apos;&#125;)</div></pre></td></tr></table></figure>


- jsonå‚æ•°

   <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line">&gt;&gt;&gt; import json</div><div class="line">&gt;&gt;&gt; url = &apos;https://api.github.com/some/endpoint&apos;</div><div class="line">&gt;&gt;&gt; payload = &#123;&apos;some&apos;: &apos;data&apos;&#125;</div><div class="line">&gt;&gt;&gt; r = requests.post(url, data=json.dumps(payload))</div><div class="line">       ``` </div><div class="line">    </div><div class="line">    - file</div><div class="line">    </div><div class="line">        `TODO`</div><div class="line"></div><div class="line">- Other: </div><div class="line"></div><div class="line">    - PUT: `r = requests.put(&apos;http://httpbin.org/put&apos;, data = &#123;&apos;key&apos;:&apos;value&apos;&#125;)`</div><div class="line">    - DELETE: `r = requests.delete(&apos;http://httpbin.org/delete&apos;)`</div><div class="line">    - HEAD: `r = requests.head(&apos;http://httpbin.org/get&apos;)`</div><div class="line">    - OPTIONS: `r = requests.options(&apos;http://httpbin.org/get&apos;)`</div><div class="line">       </div><div class="line">- HEADER</div><div class="line"></div><div class="line">	``` shell</div><div class="line">&gt;&gt;&gt; url = &apos;https://api.github.com/some/endpoint&apos;</div><div class="line">&gt;&gt;&gt; headers = &#123;&apos;user-agent&apos;: &apos;my-app/0.0.1&apos;&#125;</div><div class="line">&gt;&gt;&gt; r = requests.get(url, headers=headers)</div></pre></td></tr></table></figure>
</code></pre><ul>
<li><p>COOKIES</p>
<p>  è¯·æ±‚ï¼š</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&gt;&gt;&gt; url = &apos;http://httpbin.org/cookies&apos;</div><div class="line">&gt;&gt;&gt; cookies = dict(cookies_are=&apos;working&apos;)</div><div class="line">&gt;&gt;&gt; r = requests.get(url, cookies=cookies)</div></pre></td></tr></table></figure>
</li>
</ul>
<p>   è¯·æ±‚çš„æ•°æ®ï¼š</p>
   <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">GET /cookies HTTP/1.1</div><div class="line">Host: httpbin.org</div><div class="line">Connection: keep-alive</div><div class="line">User-Agent: python-requests/2.12.4</div><div class="line">Accept-Encoding: gzip, deflate</div><div class="line">Accept: */*</div><div class="line">Cookie: cookies_are=working</div></pre></td></tr></table></figure>
<h3 id="Response"><a href="/1970/01/01/[Python]ä½¿ç”¨requestså¤„ç†cookie/#Response" class="headerlink" title="Response"></a>Response</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt;&gt;&gt; import requests</div><div class="line">&gt;&gt;&gt; response = requests.get(&apos;https://api.github.com/events&apos;)</div></pre></td></tr></table></figure>
<ul>
<li>response.url </li>
<li>response.encoding ç¼–ç </li>
<li>response.status_code çŠ¶æ€å—</li>
<li>response.headers headers</li>
<li>response.text è¿”å›çš„æ–‡æœ¬</li>
<li>response.json() json</li>
<li>response.raw åŸå§‹æ•°æ®</li>
<li>response.raise_for_status() é”™è¯¯è¯·æ±‚ä¿¡æ¯</li>
<li>response.cookies</li>
<li>response.history</li>
</ul>
<h2 id="0x03-æ€»ç»“"><a href="/1970/01/01/[Python]ä½¿ç”¨requestså¤„ç†cookie/#0x03-æ€»ç»“" class="headerlink" title="0x03 æ€»ç»“"></a>0x03 æ€»ç»“</h2><p>ä½¿ç”¨è¿‡urllibçš„è¯ï¼Œæ¥çœ‹requestsä½ ä¼šå‘ç°ç®€å•å¥½å¤šï¼ŒåŒæ—¶æ”¯æŒpython2 å’Œ python3ã€‚</p>
<h2 id="0xFF-å‚è€ƒ"><a href="/1970/01/01/[Python]ä½¿ç”¨requestså¤„ç†cookie/#0xFF-å‚è€ƒ" class="headerlink" title="0xFF å‚è€ƒ"></a>0xFF å‚è€ƒ</h2><ul>
<li><a href="https://pypi.python.org/pypi/requests" target="_blank" rel="external">https://pypi.python.org/pypi/requests</a></li>
<li><a href="http://docs.python-requests.org/en/master/" target="_blank" rel="external">http://docs.python-requests.org/en/master/</a></li>
<li><a href="https://github.com/kennethreitz/requests" target="_blank" rel="external">https://github.com/kennethreitz/requests</a></li>
</ul>
<p><img src="https://raw.githubusercontent.com/ttdevs/ttdevs.github.io/common/images/logo.png" alt="Create by ttdevs"></p>
]]></content>
      
        <categories>
            
            <category> æŠ€æœ¯ </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Python </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[ã€ŒJavaã€Javaä¸­è·å–æœ¬åœ°IPå’ŒPort]]></title>
      <url>/1970/01/01/%5BJava%5DJava%E4%B8%AD%E8%8E%B7%E5%8F%96%E6%9C%AC%E5%9C%B0IP%E5%92%8CPort/</url>
      <content type="html"><![CDATA[<h2 id="0x00-é—®é¢˜"><a href="/1970/01/01/[Java]Javaä¸­è·å–æœ¬åœ°IPå’ŒPort/#0x00-é—®é¢˜" class="headerlink" title="0x00 é—®é¢˜"></a>0x00 é—®é¢˜</h2><p>é¡¹ç›®ä¸­è¦ç”¨åˆ°DatagramSocketï¼ŒåŒæ—¶ä¹Ÿè¦è·å–æœ¬åœ°çš„IPå’ŒPORTï¼Œç›´æ¥åˆ›å»ºå¹¶è·å–ç«¯å£è·å–çš„IPæ€»æ˜¯0.0.0.0ï¼Œä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div></pre></td><td class="code"><pre><div class="line">private static void testGetDatagramSocket() &#123;</div><div class="line">	try &#123;</div><div class="line">		DatagramSocket socket = new DatagramSocket();</div><div class="line">		System.out.println(socket.getLocalSocketAddress());</div><div class="line">		socket.close();</div><div class="line">	&#125; catch (SocketException e) &#123;</div><div class="line">		e.printStackTrace();</div><div class="line">	&#125;</div><div class="line">&#125;</div><div class="line">``` </div><div class="line"></div><div class="line">è¾“å‡ºç»“æœï¼š</div><div class="line"></div><div class="line">`0.0.0.0/0.0.0.0:55816`</div><div class="line"></div><div class="line"></div><div class="line">## 0x01 è§£å†³</div><div class="line"></div><div class="line">æŸ¥äº†äº›èµ„æ–™ï¼Œæ¯”å¦‚æŸ¥è¯¢å¯ç”¨ç«¯å£å¹¶ç»‘å®šï¼Œæ²¡æœ‰ç°æˆæ–¹æ³•ï¼Œå¥½åƒå®ç°ä¸äº†ã€‚ä¸ªä¸­åŸå› ä¹Ÿæ²¡å¤ªå¤šæ—¶é—´å»ç»†ç©¶ï¼Œå¥½åƒæ˜¯è¿˜æ²¡å’Œç½‘å¡å…³è”ï¼ˆçº¯å±ä¸ªäººYYï¼‰ã€‚ç”±äºé¡¹ç›®å¯¹æœ¬åœ°ç«¯å£æ²¡æœ‰ç‰¹åˆ«</div><div class="line">è¦æ±‚ï¼Œè‡ªå·±å†™äº†ä¸€ä¸ªæ–¹æ³•è·å–DatagramSocketï¼Œå¦‚ä¸‹ï¼š</div><div class="line"></div><div class="line">``` java</div><div class="line">/**</div><div class="line"> * ä»æœ€å¤§ç«¯å£å¼€å§‹å‘ä¸‹éå†ï¼Œæœ‰å¯èƒ½ç«¯å£å°±è¿”å›</div><div class="line"> *</div><div class="line"> * @return DatagramSocket, ä¸ºnullçš„å¯èƒ½æ€§æå°</div><div class="line"> */</div><div class="line">public static DatagramSocket getDatagramSocket() &#123;</div><div class="line">    DatagramSocket socket = null;</div><div class="line">    int port = 65535;</div><div class="line">    while (port &gt; 0) &#123;</div><div class="line">        try &#123;</div><div class="line">            socket = new DatagramSocket(new InetSocketAddress(InetAddress.getLocalHost(), --port));</div><div class="line">            System.out.println(port);</div><div class="line">            break;</div><div class="line">        &#125; catch (SocketException e) &#123;</div><div class="line">            e.printStackTrace();</div><div class="line">            continue;</div><div class="line">        &#125; catch (UnknownHostException e) &#123;</div><div class="line">            e.printStackTrace();</div><div class="line">            continue;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    return socket;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>å‡ºç°å¼‚å¸¸ç»§ç»­è¿è¡Œï¼Œä»£ä»·ä½¿ç”¨è€…è‡ªè¡Œæ–Ÿé…Œã€‚</p>
<h2 id="0x02-æµ‹è¯•"><a href="/1970/01/01/[Java]Javaä¸­è·å–æœ¬åœ°IPå’ŒPort/#0x02-æµ‹è¯•" class="headerlink" title="0x02 æµ‹è¯•"></a>0x02 æµ‹è¯•</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MainTest</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">        testGetDatagramSocket();</div><div class="line">        testGetUDPSocketInfo();</div><div class="line">        testGetLocalHost();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">testGetDatagramSocket</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">try</span> &#123;</div><div class="line">            DatagramSocket socket = <span class="keyword">new</span> DatagramSocket();</div><div class="line">            System.out.println(socket.getLocalSocketAddress());</div><div class="line">            socket.close();</div><div class="line">        &#125; <span class="keyword">catch</span> (SocketException e) &#123;</div><div class="line">            e.printStackTrace();</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">testGetUDPSocketInfo</span><span class="params">()</span> </span>&#123;</div><div class="line">        DatagramSocket socket = getDatagramSocket();</div><div class="line">        System.out.println(socket.getLocalSocketAddress());</div><div class="line">        socket.close();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * ä»æœ€å¤§ç«¯å£å¼€å§‹å‘ä¸‹éå†ï¼Œæœ‰å¯èƒ½ç«¯å£å°±è¿”å›</div><div class="line">     *</div><div class="line">     * <span class="doctag">@return</span> DatagramSocket, ä¸ºnullçš„å¯èƒ½æ€§æå°</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> DatagramSocket <span class="title">getDatagramSocket</span><span class="params">()</span> </span>&#123;</div><div class="line">        DatagramSocket socket = <span class="keyword">null</span>;</div><div class="line">        <span class="keyword">int</span> port = <span class="number">65535</span>;</div><div class="line">        <span class="keyword">while</span> (port &gt; <span class="number">0</span>) &#123;</div><div class="line">            <span class="keyword">try</span> &#123;</div><div class="line">                socket = <span class="keyword">new</span> DatagramSocket(<span class="keyword">new</span> InetSocketAddress(InetAddress.getLocalHost(), --port));</div><div class="line">                System.out.println(port);</div><div class="line">                <span class="keyword">break</span>;</div><div class="line">            &#125; <span class="keyword">catch</span> (SocketException e) &#123;</div><div class="line">                e.printStackTrace();</div><div class="line">                <span class="keyword">continue</span>;</div><div class="line">            &#125; <span class="keyword">catch</span> (UnknownHostException e) &#123;</div><div class="line">                e.printStackTrace();</div><div class="line">                <span class="keyword">continue</span>;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> socket;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">testGetLocalHost</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">try</span> &#123;</div><div class="line">            InetAddress address = InetAddress.getLocalHost();</div><div class="line">            System.out.println(address.getHostAddress());</div><div class="line">        &#125; <span class="keyword">catch</span> (UnknownHostException e) &#123;</div><div class="line">            e.printStackTrace();</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
]]></content>
      
        <categories>
            
            <category> æŠ€æœ¯ </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Java </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[ã€ŒPythonã€Pythonä¸­çš„Thread Local]]></title>
      <url>/1970/01/01/%5BPython%5DPython%E4%B8%AD%E7%9A%84Thread%20Local/</url>
      <content type="html"><![CDATA[<p>åœ¨çº¿ç¨‹å†…éƒ¨ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šç”¨åˆ°çº¿ç¨‹å†…éƒ¨çš„å…¨å±€å˜é‡ï¼Œè¿™ä¸ªä¹Ÿæ˜¯æ¯”è¾ƒå¸¸ç”¨çš„ï¼Œå› ä¸ºå¯ä»¥å…¨å±€è®¿é—®ã€‚ä½†æ˜¯ï¼Œå¦‚æœçº¿ç¨‹å†…éƒ¨çš„æ–¹æ³•æ¯”è¾ƒå¤šï¼Œè¿™ä¸ªæ—¶å€™å°±éœ€è¦æˆ‘ä»¬ä¸€å±‚å±‚çš„ä¼ é€’ï¼Œä¸€å±‚è¿˜å¥½ï¼ŒäºŒå±‚ä¸‰å±‚ç”šè‡³æ›´å¤šçš„æ—¶å€™å°±æ¯”è¾ƒéƒé—·äº†ã€‚å¦‚æœä¸ä¼ é€’ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯èƒ½å¾ˆéš¾æ‹¿åˆ°çº¿ç¨‹å†…éƒ¨çš„å…¨å±€å˜é‡ï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬å°±å¸Œæœ›æœ‰ä¸ªåº”ç”¨å†…çš„å…¨å±€å˜é‡ï¼Œä¾›æˆ‘ä»¬éšæ—¶è°ƒç”¨ï¼Œthread localå°±å¯ä»¥æ»¡è¶³æˆ‘ä»¬çš„éœ€æ±‚ã€‚çœ‹ä¸€ä¸ªdemoï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> threading</div><div class="line"></div><div class="line">local = threading.local()</div><div class="line"></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">end_learning</span><span class="params">()</span>:</span></div><div class="line">    print(<span class="string">'%s is finish.(Current Thread: %s)'</span> % (local.name, threading.current_thread().name))</div><div class="line"></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">start_learning</span><span class="params">()</span>:</span></div><div class="line">    print(<span class="string">'%s is learning.(Current Thread: %s)'</span> % (local.name, threading.current_thread().name))</div><div class="line">    end_learning()</div><div class="line"></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">learn_python</span><span class="params">(name)</span>:</span></div><div class="line">    local.name = name</div><div class="line">    start_learning()</div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</div><div class="line">    thread1 = threading.Thread(target=learn_python, args=(<span class="string">'ttdevs1'</span>,), name=<span class="string">'Thread-A'</span>)</div><div class="line">    thread1.start()</div><div class="line"></div><div class="line">    thread2 = threading.Thread(target=learn_python, args=(<span class="string">'ttdevs2'</span>,), name=<span class="string">'Thread-B'</span>)</div><div class="line">    thread2.start()</div></pre></td></tr></table></figure>
<p>æ‰§è¡Œç»“æœå¦‚ä¸‹ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">ttdevs1 is learning.(Current Thread: Thread-A)</div><div class="line">ttdevs1 is finish.(Current Thread: Thread-A)</div><div class="line">ttdevs2 is learning.(Current Thread: Thread-B)</div><div class="line">ttdevs2 is finish.(Current Thread: Thread-B)</div><div class="line"></div><div class="line">Process finished with exit code 0</div></pre></td></tr></table></figure></p>
<p>ä»ä¸Šé¢çš„demoä¸­ï¼Œæˆ‘ä»¬å¯ä»¥è¿˜å¯ä»¥çœ‹åˆ°ï¼šçº¿ç¨‹Aå’Œçº¿ç¨‹Bä¹‹é—´çš„æ•°æ®æ˜¯æ²¡æœ‰ç›¸äº’å¹²æ‰°çš„ã€‚</p>
<p>çœ‹åˆ°è¿™é‡Œä½ å¯èƒ½ä¼šæ„Ÿè§‰è¿™ä¸ªä¸æ˜¯ç‰¹åˆ«ç®€å•å˜›ã€‚æ˜¯çš„ï¼Œè¿™ä¸ªå°±æ˜¯å¾ˆç®€å•ï¼Œé€šè¿‡æŸ¥çœ‹æºç æˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œä»–çš„å®ç°å°±æ˜¯é€šè¿‡ä¸€ä¸ªå­—å…¸æ¥å­˜æ”¾æˆ‘ä»¬ä¸åŒçº¿ç¨‹çš„æ•°æ®ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥è‡ªå·±å®ç°çš„ã€‚æ—¢ç„¶ç³»ç»Ÿå®ç°äº†ï¼Œæˆ‘ä»¬å°±å¯ä»¥ç›´æ¥æ‹¿æ¥ç”¨äº†ã€‚</p>
<p>æ¯”å¦‚ï¼Œåœ¨å®é™…çš„åº”ç”¨ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä¸ºæ¯ä¸ªçº¿ç¨‹ä¿å­˜ä¸€ä¸ªæ•°æ®åº“è¿æ¥ï¼Œåœ¨çº¿ç¨‹çš„ä¸åŒæ–¹æ³•ä¸­ä½¿ç”¨å°±éå¸¸çš„æ–¹ä¾¿äº†ã€‚</p>
<p><img src="https://raw.githubusercontent.com/ttdevs/ttdevs.github.io/common/images/logo.png" alt="Create by ttdevs"></p>
]]></content>
      
        <categories>
            
            <category> æŠ€æœ¯ </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Python </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[ã€ŒFlaskã€0x02ç»™æˆ‘ä»¬çš„Flaskåº”ç”¨é…ç½®Supervisor]]></title>
      <url>/1970/01/01/%5BFlask%5D0x02%E7%BB%99%E6%88%91%E4%BB%AC%E7%9A%84Flask%E5%BA%94%E7%94%A8%E9%85%8D%E7%BD%AESupervisor/</url>
      <content type="html"><![CDATA[<h2 id="0x00-åœºæ™¯"><a href="/1970/01/01/[Flask]0x02ç»™æˆ‘ä»¬çš„Flaskåº”ç”¨é…ç½®Supervisor/#0x00-åœºæ™¯" class="headerlink" title="0x00 åœºæ™¯"></a>0x00 åœºæ™¯</h2><blockquote>
<p> Nginx ï¼‹ uWSGI ï¼‹ Flask çš„åœºæ™¯ä¸­ï¼Œå½“æˆ‘ä»¬çš„ä»£ç å‡ºç°å¼‚å¸¸æˆ–è€…å…¶ä»–ä¸€äº›åŸå› å¯¼è‡´æœåŠ¡æŒ‚æ‰ï¼Œæˆ‘ä»¬ä¼šå¸Œæœ›èƒ½è‡ªåŠ¨é‡å¯ <code>uWSGI</code></p>
</blockquote>
<p>è¿™ä¸ªæ—¶å€™æˆ‘ä»¬æˆ‘ä»¬å¯ä»¥è€ƒè™‘ä½¿ç”¨ <code>supervisor</code>æ¥è¾¾åˆ°æˆ‘ä»¬çš„ç›®çš„ã€‚æ­¤æ–‡æ¥ä¸Šä¸€ç¯‡ï¼Œå› æ­¤æˆ‘çš„ç³»ç»Ÿè¿˜æ˜¯Raspbian(Debian)ã€‚è¿™é‡Œåˆ†äº«ä¸€äº›ç®€å•çš„é…ç½®ä½¿ç”¨ã€‚å…ˆçœ‹ä¸€ä¸‹ <code>supervisor</code> çš„ä»‹ç»ï¼š</p>
<blockquote>
<p><a href="http://supervisord.org/" target="_blank" rel="external">Supervisor is a client/server system that allows its users to monitor and control a number of processes on UNIX-like operating systems.</a></p>
</blockquote>
<h2 id="0x01-å®‰è£…"><a href="/1970/01/01/[Flask]0x02ç»™æˆ‘ä»¬çš„Flaskåº”ç”¨é…ç½®Supervisor/#0x01-å®‰è£…" class="headerlink" title="0x01 å®‰è£…"></a>0x01 å®‰è£…</h2><p>è¿™ä¸ªæ¯”è¾ƒç®€å•ï¼Œæˆ‘ä»¬ç›´æ¥ä½¿ç”¨ <code>apt-get</code> å³å¯å®‰è£…ã€‚</p>
<p><code>pi@raspberrypi:~ $ sudo apt-get install supervisor</code> </p>
<p>(å¸è½½ç”¨ï¼šapt-get remove)</p>
<p>å½“ç„¶ï¼Œä½ ä¹Ÿå¯ä»¥ç”¨ <code>pip</code> è¿›è¡Œå®‰è£…ï¼š</p>
<p><code>sudo pip install supervisor</code></p>
<h2 id="0x02-é…ç½®"><a href="/1970/01/01/[Flask]0x02ç»™æˆ‘ä»¬çš„Flaskåº”ç”¨é…ç½®Supervisor/#0x02-é…ç½®" class="headerlink" title="0x02 é…ç½®"></a>0x02 é…ç½®</h2><p><code>supervisor</code> çš„é…ç½®æ–‡ä»¶ä½äº <code>/etc/supervisor/</code> ä¸‹ï¼Œå¦‚ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">pi@raspberrypi:/etc/supervisor $ ls</div><div class="line">conf.d  supervisord.conf</div></pre></td></tr></table></figure>
<p><code>supervisord.conf</code> æ˜¯é»˜è®¤çš„é…ç½®æ–‡ä»¶ï¼Œæˆ‘ä»¬æ— éœ€ä¿®æ”¹ï¼Œåœ¨ <code>conf.d</code> ç›®å½•ä¸‹ï¼Œæˆ‘ä»¬åˆ›å»ºè‡ªå·±çš„é…ç½®æ–‡ä»¶å³å¯ï¼Œè¿™é‡Œæˆ‘å»ºäº†ä¸€ä¸ª <code>uwsgi.conf</code>  æ–‡ä»¶ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">pi@raspberrypi:/etc/supervisor $ cd conf.d/</div><div class="line">pi@raspberrypi:/etc/supervisor/conf.d $ touch uwsgi.conf</div><div class="line">pi@raspberrypi:/etc/supervisor/conf.d $ sudo nano uwsgi.conf</div></pre></td></tr></table></figure>
<p><code>uwsgi.conf</code> æ–‡ä»¶å†…å®¹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">[program:raspi]</div><div class="line">command=/home/pi/raspi/venv/bin/uwsgi /home/pi/raspi/uwsgi.ini</div><div class="line">directory=/home/pi/raspi</div><div class="line">user=pi</div><div class="line">autostart=true</div><div class="line">autorestart=true</div><div class="line">stdout_logfile=/home/pi/raspi/logs/uwsgi_supervisor.log</div><div class="line">stderr_logfile=/home/pi/raspi/logs/uwsgi_supervisor_err.log</div></pre></td></tr></table></figure>
<ul>
<li>commandï¼šæ‰§è¡Œçš„å‘½ä»¤</li>
<li>directoryï¼šå·¥ä½œçš„ç›®å½•ï¼Œåœ¨æ‰§è¡Œå‰ä¼šè¿›è¡Œåˆ‡æ¢ï¼Œç”±äºä¸Šé¢æˆ‘ä½¿ç”¨çš„ç»å¯¹è·¯å¾„ï¼Œå¯ä»¥ä¸é…ç½®</li>
<li><p>stdout_logfile å’Œ stderr_logfile é…ç½®æˆ‘ä»¬æ—¥å¿—è¾“å‡ºä½ç½®</p>
<p>è¿™ä¸ªé…ç½®æ–‡ä»¶çš„æ›´å¤šå¯é€‰å‚æ•°å¯å‚è€ƒ<a href="http://supervisord.org/configuration.html#program-x-section-settings" target="_blank" rel="external">è¿™é‡Œ</a>ã€‚</p>
</li>
</ul>
<p><code>supervisor</code> è¿˜æä¾›äº†ä¸€ä¸ªwebç®¡ç†ç•Œé¢ï¼Œæˆ‘ä»¬éœ€è¦å…ˆå¯¹å…¶è¿›è¡Œé…ç½®ï¼Œä¿®æ”¹ <code>/etc/supervisor/supervisord.conf</code> æ–‡ä»¶ï¼Œå¢åŠ å¦‚ä¸‹å†…å®¹å³å¯ï¼š</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"> [supervisorctl]</div><div class="line">serverurl=unix:///var/run/supervisor.sock ; use a unix:// URL  for a unix socket</div><div class="line">serverurl=http://192.168.1.56:9000</div><div class="line">username=ttdevs            ; (default is no username (open server))</div><div class="line">password=admin             ; (default is no password (open server))</div><div class="line">; The [include] section can just contain the &quot;files&quot; setting.  This</div><div class="line">; setting can list multiple files (separated by whitespace or</div><div class="line">; newlines).  It can also contain wildcards.  The filenames are</div><div class="line">; interpreted as relative to this file.  Included files *cannot*</div><div class="line">; include files themselves.</div><div class="line"></div><div class="line">[include]</div><div class="line">files = /etc/supervisor/conf.d/*.conf</div><div class="line"></div><div class="line">[inet_http_server]         ; inet (TCP) server disabled by default</div><div class="line">port=192.168.1.56:9000 	           ; (ip_address:port specifier, *:port for all iface)</div><div class="line">username=ttdevs            ; (default is no username (open server))</div><div class="line">password=admin             ; (default is no password (open server))</div></pre></td></tr></table></figure>
<h2 id="0x03-æ“ä½œ"><a href="/1970/01/01/[Flask]0x02ç»™æˆ‘ä»¬çš„Flaskåº”ç”¨é…ç½®Supervisor/#0x03-æ“ä½œ" class="headerlink" title="0x03 æ“ä½œ"></a>0x03 æ“ä½œ</h2><p>å®‰è£…å¥½ä»¥åï¼Œæˆ‘ä»¬æœ‰ä¸¤ä¸ªå‘½ä»¤å¯ä»¥ä½¿ç”¨ï¼Œä¸€ä¸ªæ˜¯ <code>supervisord</code>ï¼Œå¦ä¸€ä¸ªæ˜¯ <code>supervisorctl</code>ï¼Œ<code>supervisord</code> è´Ÿè´£å¯åŠ¨æœåŠ¡ï¼Œ<code>supervisorctl</code> è´Ÿè´£æ“ä½œæœåŠ¡ï¼ŒC/Sæ¨¡å¼ã€‚</p>
<ul>
<li><p>å¯åŠ¨ <code>supervisor</code>ï¼š <code>sudo supervisord</code></p>
<p>  æ›´å¤šçš„å¯åŠ¨å‚æ•°å¯ä»¥å‚è€ƒ<a href="http://supervisord.org/running.html#supervisord-command-line-options" target="_blank" rel="external">è¿™é‡Œ</a>ã€‚</p>
</li>
<li><p>å¯åŠ¨/é‡å¯/åœæ­¢æŸä¸ªæˆ‘ä»¬é…ç½®çš„è¿›ç¨‹ï¼š<code>supervisorctl start/restart/stop programABC</code></p>
</li>
</ul>
<p>å¦å¤–åœ¨ä¸Šé¢çš„é…ç½®ä¸­ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨æµè§ˆå™¨è®¿é—® <code>http://192.168.1.56:9000/</code>å¯¹æˆ‘ä»¬çš„è¿›ç¨‹è¿›è¡Œç®¡ç†ã€‚</p>
<h2 id="0xFF-å‚è€ƒ"><a href="/1970/01/01/[Flask]0x02ç»™æˆ‘ä»¬çš„Flaskåº”ç”¨é…ç½®Supervisor/#0xFF-å‚è€ƒ" class="headerlink" title="0xFF å‚è€ƒ"></a>0xFF å‚è€ƒ</h2><ol>
<li><a href="http://blog.chinaunix.net/uid-26000296-id-4759916.html" target="_blank" rel="external">http://blog.chinaunix.net/uid-26000296-id-4759916.html</a></li>
<li><a href="http://liyangliang.me/posts/2015/06/using-supervisor/" target="_blank" rel="external">http://liyangliang.me/posts/2015/06/using-supervisor/</a></li>
<li><a href="http://www.restran.net/2015/10/04/supervisord-tutorial/" target="_blank" rel="external">http://www.restran.net/2015/10/04/supervisord-tutorial/</a></li>
</ol>
<p><img src="https://raw.githubusercontent.com/ttdevs/ttdevs.github.io/common/images/logo.png" alt="Create by ttdevs"></p>
]]></content>
      
        <categories>
            
            <category> æŠ€æœ¯ </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Flask </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[ã€ŒAndroidã€è®©RecyclerViewæ”¯æŒåŠ è½½æ›´å¤š(Endless RecyclerView)]]></title>
      <url>/1970/01/01/%5BAndroid%5D%E8%AE%A9RecyclerView%E6%94%AF%E6%8C%81%E5%8A%A0%E8%BD%BD%E6%9B%B4%E5%A4%9A(Endless%20RecyclerView)/</url>
      <content type="html"><![CDATA[<h2 id="0x00-é—®é¢˜"><a href="/1970/01/01/[Android]è®©RecyclerViewæ”¯æŒåŠ è½½æ›´å¤š(Endless RecyclerView)/#0x00-é—®é¢˜" class="headerlink" title="0x00 é—®é¢˜"></a>0x00 é—®é¢˜</h2><p>å¥½ä¹…æ²¡æœ‰å†™åšå®¢ï¼Œæœ€è¿‘æ­£å¥½æœ‰æ—¶é—´ï¼Œæ‰“ç®—æŠŠä¹‹å‰å¾ˆé•¿å¾ˆé•¿ä¸€æ®µæ—¶é—´è½ä¸‹çš„å‘éƒ½ç»™å¡«äº†ã€‚</p>
<p>åœ¨Androidçš„SupportåŒ…ä¸­æˆ‘ä»¬æœ‰å¾ˆå¤šæ–°çš„ç»„ä»¶å¯ä»¥ä½¿ç”¨ï¼Œæ¯”å¦‚ä»£æ›¿ListViewçš„RecyclerViewã€‚ä½¿ç”¨RecyclerViewå’ŒSwipeRefreshLayoutç»„åˆï¼Œæˆ‘ä»¬å¯ä»¥å®ç°å¾ˆé…·ç‚«çš„ä¸‹æ‹‰åˆ·æ–°çš„åŠŸèƒ½ã€‚ä½†æ˜¯ï¼Œäº‹æƒ…æ€»ä¸æ˜¯é‚£ä¹ˆç¾å¥½ï¼Œæœ‰äº†ä¸‹æ‹‰åˆ·æ–°ï¼Œå´æ‰¾ä¸åˆ°ä¸Šæ‹‰åŠ è½½æ›´å¤šï¼ˆæˆ‘ä»¬å·²ç»ä¹ æƒ¯äº†PullToRefreshï¼‰ï¼Œæœ€ç»ˆè¿˜æ˜¯æ”¾å¼ƒäº†ä½¿ç”¨RecyclerViewã€‚ç°åœ¨çœ‹æ¥ï¼Œè‡ªå·±å®åœ¨æ˜¯å¤ªæ‡’äº†ã€‚å¥½äº†ï¼Œä»Šå¤©å°±è®©æˆ‘ä»¬çš„RecyclerViewæ”¯æŒåŠ è½½æ›´å¤šã€‚</p>
<h2 id="0x01-Endless-RecyclerView"><a href="/1970/01/01/[Android]è®©RecyclerViewæ”¯æŒåŠ è½½æ›´å¤š(Endless RecyclerView)/#0x01-Endless-RecyclerView" class="headerlink" title="0x01 Endless RecyclerView"></a>0x01 Endless RecyclerView</h2><p>RecyclerViewçš„çš„ä½¿ç”¨å¤šæ•°æ˜¯ä¸SwipeRefreshLayoutè¿›è¡Œç»„åˆï¼Œå½“ç„¶ï¼Œä½ ä¹Ÿå¯ä»¥ç®—ä¸ŠCardViewã€‚ä½¿ç”¨SwipeRefreshLayoutæ—¶ï¼Œå—PullToRefreshçš„å½±å“ï¼Œå¾ˆè‡ªç„¶çš„ä¼šæƒ³åˆ°ç»™SwipeRefreshLayoutåŠ ä¸ªä¸Šæ‹‰åŠ è½½æ›´å¤šçš„åŠŸèƒ½ã€‚å¦‚æœä½ ä¹Ÿè¿™ä¹ˆæƒ³ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±ä¸€èµ·æ¥YYä¸‹googleä¸ºä»€ä¹ˆæ²¡æœ‰å®˜æ–¹æ”¯æŒè¿™ä¹ˆåšã€‚</p>
<ul>
<li>ç»™SwipeRefreshLayoutæ·»åŠ åŠ è½½æ›´å¤šåŠŸèƒ½ï¼šæˆ‘ä»¬æœŸæœ›çš„(æ¯”å¦‚ï¼šSwipeRefreshLayout + RecyclerViewï¼Œä½†æ˜¯googleæ²¡è¿™ä¹ˆåš)ã€‚å¦‚æœSwipeRefreshLayoutä¸­æ˜¯TextViewæˆ–è€…è‡ªå®šä¹‰çš„Viewï¼Œå¾ˆæ˜¾ç„¶ï¼Œæˆ‘ä»¬å¹¶ä¸èƒ½ä¿è¯è¿™ä¸ªåŠ è½½æ›´å¤šæ˜¯å¯ä»¥å®ç°çš„ï¼ˆå³ä½¿å®ç°äº†ï¼Œä»–ä»¬è€¦åˆä¹Ÿä¼šå¾ˆé«˜ï¼‰ã€‚</li>
<li>ç»™RecyclerViewæ·»åŠ åŠ è½½æ›´å¤šåŠŸèƒ½ï¼šè¿™ä¸ªæ–¹æ¡ˆæ˜¯å¯è¡Œçš„</li>
<li>ç»™å…¶ä»–æ›´å¤šSwipeRefreshLayoutåŒ…å«çš„viewæ·»åŠ åŠ è½½æ›´å¤šåŠŸèƒ½ï¼šç¬¬äºŒç§æƒ…å†µçš„æ‰©å±•ï¼Œè¿™ä¸ªæ ¹æ®å…·ä½“çš„viewæ¥è®¨è®º</li>
</ul>
<p>å› æ­¤ï¼Œæˆ‘ä»¬åº”è¯¥æŠŠåŠ è½½æ›´å¤šæ”¾åˆ°å…·ä½“çš„viewä¸­ã€‚</p>
<h2 id="0x02-å®ç°"><a href="/1970/01/01/[Android]è®©RecyclerViewæ”¯æŒåŠ è½½æ›´å¤š(Endless RecyclerView)/#0x02-å®ç°" class="headerlink" title="0x02 å®ç°"></a>0x02 å®ç°</h2><p>ä¸‹é¢æ˜¯æˆ‘ä»¬æ”¯æŒåŠ è½½æ›´å¤šçš„ä»£ç ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/*</span></div><div class="line">     * Created by ttdevs 9/3/15 1:31 PM. https://github.com/ttdevs</div><div class="line">     * Copyright (c) 2015 ttdevs, Inc. All rights reserved.</div><div class="line">     */</div><div class="line"></div><div class="line"><span class="keyword">package</span> com.ttdevs.support.recycler;</div><div class="line"></div><div class="line"><span class="keyword">import</span> android.support.v7.widget.LinearLayoutManager;</div><div class="line"><span class="keyword">import</span> android.support.v7.widget.RecyclerView;</div><div class="line"></div><div class="line"><span class="keyword">import</span> com.ttdevs.utils.LogUtils;</div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line"> * RecyclerViewåŠ è½½æ›´å¤šçš„ç±»,æ”¯æŒLinearLayoutManagerå’ŒGridLayoutManager</div><div class="line"> * ä½¿ç”¨:</div><div class="line"> * RecyclerView.addOnScrollListener(new OnRecyclerLoadMoreListener()&#123;</div><div class="line"> * public void onLoadMore()&#123;...&#125;</div><div class="line"> * &#125;);</div><div class="line"> */</div><div class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">OnRecyclerLoadMoreListener</span> <span class="keyword">extends</span> <span class="title">RecyclerView</span>.<span class="title">OnScrollListener</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="keyword">private</span> LinearLayoutManager mLayoutManager;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">int</span> mItemCount, mLastCompletely, mLastLoad;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * load more</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">onLoadMore</span><span class="params">()</span></span>;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onScrolled</span><span class="params">(RecyclerView recyclerView, <span class="keyword">int</span> dx, <span class="keyword">int</span> dy)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (recyclerView.getLayoutManager() <span class="keyword">instanceof</span> LinearLayoutManager) &#123;</div><div class="line">            mLayoutManager = (LinearLayoutManager) recyclerView.getLayoutManager();</div><div class="line"></div><div class="line">            mItemCount = mLayoutManager.getItemCount();</div><div class="line">            mLastCompletely = mLayoutManager.findLastCompletelyVisibleItemPosition();</div><div class="line">        &#125; <span class="keyword">else</span> &#123;</div><div class="line">            <span class="keyword">return</span>;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="keyword">if</span> (mLastLoad != mItemCount &amp;&amp; mItemCount == mLastCompletely + <span class="number">1</span>) &#123;</div><div class="line">            LogUtils.debug(String.format(<span class="string">"****************load more****************"</span>));</div><div class="line">            LogUtils.debug(String.format(<span class="string">"mItemCount:%d \t mLastCompletely:%d"</span>, mItemCount, mLastCompletely));</div><div class="line">            LogUtils.debug(String.format(<span class="string">"****************load more****************"</span>));</div><div class="line"></div><div class="line">            mLastLoad = mItemCount;</div><div class="line">            onLoadMore();</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><img src="https://raw.githubusercontent.com/ttdevs/ttdevs.github.io/common/images/logo.png" alt="Create by ttdevs"></p>
]]></content>
      
        <categories>
            
            <category> æŠ€æœ¯ </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Android </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[ã€ŒPythonã€æ–‡ä»¶æ‹·è´å·¥å…·Shutilä»‹ç»]]></title>
      <url>/1970/01/01/%5BPython%5D%E6%96%87%E4%BB%B6%E6%8B%B7%E8%B4%9D%E5%B7%A5%E5%85%B7Shutil%E4%BB%8B%E7%BB%8D/</url>
      <content type="html"><![CDATA[<p>ä¸€å“¥ä»¬è®©å¸®å†™ä¸ªè„šæœ¬ï¼šä»ä¸€ä¸ªæ–‡ä»¶å¤¹ä¸­æŒ‰ç…§æŒ‡å®šçš„è§„åˆ™æ‹·è´éƒ¨åˆ†æ–‡ä»¶ã€‚ç»™åŠå°æ—¶æ—¶é—´ï¼Œè™½ç„¶æ°´å¹³å¾ˆèœæ²¡æœ‰ä¿¡å¿ƒï¼Œä½†è¿˜æ˜¯åº”ä¸‹äº†è¿™ä¸ªéœ€æ±‚ã€‚</p>
<h2 id="0x01-åˆ†æ"><a href="/1970/01/01/[Python]æ–‡ä»¶æ‹·è´å·¥å…·Shutilä»‹ç»/#0x01-åˆ†æ" class="headerlink" title="0x01 åˆ†æ"></a>0x01 åˆ†æ</h2><p>é¦–å…ˆæƒ³åˆ°çš„å°±æ˜¯osï¼Œsysè¿™äº›ç³»ç»Ÿåº“å®Œæˆè¿™äº›æ“ä½œï¼Œç”±äºä¸ç†Ÿæ‚‰è¿™å‡ ä¸ªåº“ï¼Œè¿˜æ˜¯googleä¸€ä¸‹ã€‚ä¸è¿‡åœ¨æœç´¢çš„æ—¶å€™å‘ç°äº†è¿™ä¸ªåº“ï¼š <code>shutil</code>ã€‚æŸ¥çœ‹äº†ä¸‹ç®€ç›´å¤ªç®€å•ï¼Œä¸€è¡Œä»£ç å®Œæˆæ‹·è´ã€‚è‡ªå·±ä¹‹å‰è¿˜æƒ³ç€åˆ›å»ºç›®å½•ï¼Œæ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨ï¼Œæ–‡ä»¶è¯»å†™ï¼Œå„ç§é—®é¢˜â€¦â€¦</p>
<h2 id="0x02-shutil"><a href="/1970/01/01/[Python]æ–‡ä»¶æ‹·è´å·¥å…·Shutilä»‹ç»/#0x02-shutil" class="headerlink" title="0x02 shutil"></a>0x02 shutil</h2><p>shutilæ˜¯ä¸€ä¸ªpythonæä¾›çš„é«˜çº§æ–‡ä»¶æ“ä½œå·¥å…·ï¼Œä»–å¯ä»¥å¸®åŠ©æˆ‘ä»¬å¿«é€Ÿçš„è¿›è¡Œå¸¸è§„æ–‡ä»¶æ“ä½œã€‚æ–‡ä»¶æ‹·è´æ“ä½œå¦‚ä¸‹ï¼š</p>
<p><code>shutil.copyfile(src, dst, *, follow_symlinks=True)</code></p>
<p>ç¬¬ä¸€ä¸ªå‚æ•°åŸæ–‡ä»¶ï¼Œç¬¬äºŒä¸ªå‚æ•°ç›®æ ‡æ–‡ä»¶ä½ç½®ã€‚ç®€å•å§ï¼Œæƒ³æƒ³å¦‚æœjavaå†™çš„è¯ï¼Œå„ç§åˆ¤æ–­ï¼Œå„ç§iostreamï¼Œå„ç§è›‹ç–¼å•Šï¼Œpythonå°±ä¸€è¡Œå•Šå•Šå•Šå•Šâ€¦â€¦</p>
<h3 id="æ–¹æ³•è¯´æ˜"><a href="/1970/01/01/[Python]æ–‡ä»¶æ‹·è´å·¥å…·Shutilä»‹ç»/#æ–¹æ³•è¯´æ˜" class="headerlink" title="æ–¹æ³•è¯´æ˜"></a>æ–¹æ³•è¯´æ˜</h3><ul>
<li><p>copy(src, dst)</p>
<p>  å°†æ–‡ä»¶srcå¤åˆ¶åˆ°æ–‡ä»¶dstï¼ŒåŒ…å«æƒé™</p>
</li>
<li><p>copy2(src, dst)</p>
<p>  åŒcopyï¼ŒåŒæ—¶å¤åˆ¶æ–‡ä»¶å…ƒæ•°æ®</p>
</li>
<li><p>copyfile(src, dst)</p>
<p>  å°†æ–‡ä»¶srcå¤åˆ¶åˆ°æ–‡ä»¶dstï¼Œä½†ä¸åŒ…å«å…ƒæ•°æ®</p>
</li>
<li><p>copymode(src, dst)</p>
<p>  å¤åˆ¶æ–‡ä»¶æƒé™</p>
</li>
<li><p>copystat(src, dst)</p>
<p>  å°†æƒé™ä½ã€ æœ€åå­˜å–æ—¶é—´ã€ æœ€åä¿®æ”¹æ—¶é—´å’Œæ ‡å¿—ä»srcå¤åˆ¶åˆ°dst</p>
</li>
<li><p>copytree(src, dst, symlinks=False, ignore=None)</p>
<p>  é€’å½’å¤åˆ¶ç›®å½•</p>
</li>
<li><p>rmtree(path[, ignore_errors[, onerror]])</p>
<p>  åˆ é™¤ç›®å½•</p>
</li>
<li><p>move(src, dst)</p>
<p>  é€’å½’ç§»åŠ¨ç›®å½•</p>
</li>
</ul>
<h3 id="Demo"><a href="/1970/01/01/[Python]æ–‡ä»¶æ‹·è´å·¥å…·Shutilä»‹ç»/#Demo" class="headerlink" title="Demo"></a>Demo</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> shutil</div><div class="line">    </div><div class="line">SOURCE = &#123;</div><div class="line">   <span class="string">"1f604"</span>,</div><div class="line">   ...</div><div class="line">   <span class="string">"1f349"</span>&#125;</div><div class="line">    </div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">replace</span><span class="params">()</span>:</span></div><div class="line">   base_path = <span class="string">"drawable/"</span></div><div class="line">   dest_path = <span class="string">"drawable_dest/"</span></div><div class="line">   <span class="keyword">for</span> name <span class="keyword">in</span> SOURCE:</div><div class="line">       file_name = base_path + <span class="string">"emoji_"</span> + name + <span class="string">".png"</span></div><div class="line">       dest_name = dest_path + <span class="string">"emoji_"</span> + name + <span class="string">".png"</span></div><div class="line">       shutil.copy(file_name, dest_name)</div><div class="line">    </div><div class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</div><div class="line">   replace()</div></pre></td></tr></table></figure>
<p><img src="https://raw.githubusercontent.com/ttdevs/ttdevs.github.io/common/images/logo.png" alt="Create by ttdevs"></p>
]]></content>
      
        <categories>
            
            <category> æŠ€æœ¯ </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Python </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[ã€ŒRetrofitã€0x01è¯·æ±‚å‚æ•°]]></title>
      <url>/1970/01/01/%5BRetrofit%5D0x01%E8%AF%B7%E6%B1%82%E5%8F%82%E6%95%B0/</url>
      <content type="html"><![CDATA[<h2 id="0x00-è¯·æ±‚å‚æ•°"><a href="/1970/01/01/[Retrofit]0x01è¯·æ±‚å‚æ•°/#0x00-è¯·æ±‚å‚æ•°" class="headerlink" title="0x00 è¯·æ±‚å‚æ•°"></a>0x00 è¯·æ±‚å‚æ•°</h2><p>å¸¸è§çš„Httpè¯·æ±‚ï¼Œé™¤äº†æŒ‡å®šçš„è¯·æ±‚åœ°å€ï¼Œå¾ˆå¤šæ—¶å€™æˆ‘ä»¬è¿˜éœ€è¦åŠ ä¸Šä¸€äº›è¯·æ±‚å‚æ•°ï¼Œè¿™äº›å‚æ•°å¯èƒ½æ˜¯å›ºå®šçš„ï¼Œä¹Ÿå¯èƒ½æ˜¯åŠ¨æ€æ·»åŠ çš„ã€‚åœ¨Retrofitä¸­ï¼Œæˆ‘ä»¬è¯¥å¦‚ä½•å¤„ç†å‘¢ï¼Ÿè¿™é‡Œä»¥GETæ–¹å¼ä¸­æ·»åŠ è¯·æ±‚å‚æ•°ä¸ºä¾‹ã€‚</p>
<h2 id="0x01-å›ºå®šè¯·æ±‚å‚æ•°"><a href="/1970/01/01/[Retrofit]0x01è¯·æ±‚å‚æ•°/#0x01-å›ºå®šè¯·æ±‚å‚æ•°" class="headerlink" title="0x01 å›ºå®šè¯·æ±‚å‚æ•°"></a>0x01 å›ºå®šè¯·æ±‚å‚æ•°</h2><p>è¿™é‡Œè¯´çš„å›ºå®šè¯·æ±‚å‚æ•°æ˜¯æŒ‡æ¯æ¬¡è¯·æ±‚æˆ‘ä»¬éƒ½åœ¨Urlä¸­æ·»åŠ ç›¸åŒçš„è¯·æ±‚çš„å‚æ•°ã€‚è¿™ç§åœºæ™¯å¤šå‡ºç°åœ¨éœ€è¦è®¤è¯çš„æƒ…å†µï¼Œæ¯”å¦‚æ·»åŠ  Token å­—æ®µç­‰ã€‚</p>
<p>åœ¨ä¹‹å‰çš„æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬æœ‰æåˆ°åœ¨æ„å»ºOkHttpClientå¯¹è±¡çš„æ—¶å€™ä½¿ç”¨è¿‡ <code>Interceptor</code> ï¼Œåœ¨ <code>Interceptor</code> çš„é€»è¾‘ä¸­ï¼Œæˆ‘ä»¬ä¼šé‡æ–°åˆ›å»ºä¸€ä¸ª <code>Request</code> å¯¹è±¡ï¼Œåœ¨è¿™ä¸ªå¯¹è±¡ä¸­æˆ‘ä»¬å¯ä»¥ä¼ å…¥ä¸€ä¸ª <code>HttpUrl</code> ï¼Œåœ¨è¿™ä¸ªå¯¹è±¡ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä¼ å…¥ä¸€äº›éœ€è¦çš„è¯·æ±‚å‚æ•°ã€‚é€šè¿‡ä¹‹å‰å¯¹ <code>Interceptor</code> äº†è§£ï¼Œæˆ‘ä»¬åº”è¯¥çŸ¥é“ï¼Œè¿™é‡Œåšçš„æ“ä½œæ˜¯å¯¹æ‰€æœ‰çš„è¯·æ±‚éƒ½æœ‰æ•ˆçš„ã€‚è¿™æ ·å°±å¯ä»¥å®Œæˆæˆ‘ä»¬ä¸ºæ¯ä¸ªè¯·æ±‚æ·»åŠ å›ºå®šè¯·æ±‚å‚æ•°çš„ç›®çš„ã€‚ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line">OkHttpClient client = <span class="keyword">new</span> OkHttpClient.Builder()</div><div class="line">                .addInterceptor(<span class="keyword">new</span> Interceptor() &#123;</div><div class="line">                    <span class="meta">@Override</span></div><div class="line">                    <span class="keyword">public</span> okhttp3.<span class="function">Response <span class="title">intercept</span><span class="params">(Chain chain)</span> <span class="keyword">throws</span> IOException </span>&#123;</div><div class="line">                        Request original = chain.request();</div><div class="line"></div><div class="line">                        HttpUrl originalHttpUrl = original.url();</div><div class="line"></div><div class="line">                        HttpUrl url = originalHttpUrl</div><div class="line">                                .newBuilder()</div><div class="line">                                .addQueryParameter(<span class="string">"token"</span>, <span class="string">"I_am_user_token"</span>)</div><div class="line">                                .addQueryParameter(<span class="string">"user_key"</span>, <span class="string">"I_am_user_user_key"</span>)</div><div class="line">                                .build();</div><div class="line"></div><div class="line">                        Request request = original</div><div class="line">                                .newBuilder()</div><div class="line">                                .url(url)</div><div class="line">                                .build();</div><div class="line"></div><div class="line">                        okhttp3.Response response = chain.proceed(request);</div><div class="line">                        <span class="keyword">return</span> response;</div><div class="line">                    &#125;</div><div class="line">                &#125;)</div><div class="line">                .build();</div></pre></td></tr></table></figure>
<h2 id="0x02-åŠ¨æ€è¯·æ±‚å‚æ•°"><a href="/1970/01/01/[Retrofit]0x01è¯·æ±‚å‚æ•°/#0x02-åŠ¨æ€è¯·æ±‚å‚æ•°" class="headerlink" title="0x02 åŠ¨æ€è¯·æ±‚å‚æ•°"></a>0x02 åŠ¨æ€è¯·æ±‚å‚æ•°</h2><p>è¿™ä¸ªæŒ‡æˆ‘ä»¬åœ¨ä¸åŒçš„è¯·æ±‚ä¸­æ·»åŠ ä¸åŒè¿‡çš„è¯·æ±‚å‚æ•°ã€‚æ¯”å¦‚ï¼Œåœ¨è¯·æ±‚ç”¨æˆ·ä¿¡æ¯çš„æ¥å£ä¸­æˆ‘ä»¬å¯èƒ½éœ€è¦ä¼ å…¥ç”¨æˆ·IDï¼Œåœ¨è¯·æ±‚è®°å½•çš„æ¥å£ä¸­æˆ‘ä»¬éœ€è¦ä¼ å…¥èµ·æ­¢æ—¶é—´ç­‰ã€‚ç”±äºè¿™æ ·çš„å‚æ•°æ˜¯é’ˆå¯¹æ¥å£çš„ï¼Œå› æ­¤æˆ‘ä»¬å°±éœ€è¦åœ¨æ¯ä¸€ä¸ªæ¥å£åšä¸­å¤„ç†ã€‚</p>
<ul>
<li><p>@Query æ·»åŠ ä¸€ä¸ªè¯·æ±‚å‚æ•°</p>
  <figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// http://119.29.29.29/d?dn=ttdevs.vicp.com</span></div><div class="line"><span class="meta">@GET</span>(<span class="string">"/d"</span>)</div><div class="line"><span class="function"><span class="keyword">public</span> Call&lt;ResponseBody&gt; <span class="title">singleParams</span><span class="params">(@Query(<span class="string">"dn"</span>)</span> String domain)</span>;</div></pre></td></tr></table></figure>
</li>
</ul>
<pre><code>é€šè¿‡ä¸Šé¢çš„æ–¹å¼ï¼Œæˆ‘ä»¬å‘å‡ºçš„è¯·æ±‚å°±æ˜¯ï¼š

`http://119.29.29.29/d?dn={domain}`
</code></pre><ul>
<li><p>@QueryMap æ·»åŠ ä¸€ç»„è¯·æ±‚å‚æ•°</p>
  <figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@GET</span>(<span class="string">"/record"</span>)</div><div class="line">	<span class="function"><span class="keyword">public</span> Call&lt;ResponseBody&gt; <span class="title">multiParams</span><span class="params">(@QueryMap(encoded = <span class="keyword">true</span>)</span> Map&lt;String, String&gt; options)</span>;</div></pre></td></tr></table></figure>
<p>  ä¸Šé¢æˆ‘ä»¬å‘å‡ºçš„è¯·æ±‚æ˜¯ï¼š</p>
<p>  <code>http://ttdevs.vicp.net/record?p1=v1&amp;p2=v2</code></p>
<p>  è¿™ä¸ªè¿™ä¸ªä¾‹å­ä¸­è¿˜å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†ä¸€ä¸ªå‚æ•°ï¼š<code>encoded = true</code>ï¼Œè¿™ä¸ªå‚æ•°çš„æ„æ€æ˜¯ï¼Œå¯¹æˆ‘ä»¬çš„å‚æ•°è¿›è¡ŒURL<br>  Encodeã€‚</p>
</li>
</ul>
<h2 id="0x03-æ€»ç»“"><a href="/1970/01/01/[Retrofit]0x01è¯·æ±‚å‚æ•°/#0x03-æ€»ç»“" class="headerlink" title="0x03 æ€»ç»“"></a>0x03 æ€»ç»“</h2><p>é€šè¿‡ä¸Šé¢çš„ä»‹ç»ï¼Œæˆ‘ä»¬å¯ä»¥äº†è§£ï¼Œå¦‚æœæ·»åŠ æˆ‘ä»¬çš„è¯·æ±‚å‚æ•°ã€‚å½“éœ€è¦ç»™æ¯ä¸€ä¸ªè¯·æ±‚éƒ½æ·»åŠ ç›¸åŒå‚æ•°æ—¶è¯¥å¦‚ä½•å°è£…ï¼ŒæŠŠRetrofitæ‰“é€ æˆæ›´é€‚åˆæˆ‘ä»¬ä½¿ç”¨çš„å·¥å…·ã€‚</p>
<p><img src="https://raw.githubusercontent.com/ttdevs/ttdevs.github.io/common/images/logo.png" alt="Create by ttdevs"></p>
]]></content>
      
        <categories>
            
            <category> æŠ€æœ¯ </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Retrofit </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[ã€ŒRetrofitã€0x02Headeré—®é¢˜è¡¥å……]]></title>
      <url>/1970/01/01/%5BRetrofit%5D0x02Header%E9%97%AE%E9%A2%98%E8%A1%A5%E5%85%85/</url>
      <content type="html"><![CDATA[<h2 id="0x00-Retrofit-Header"><a href="/1970/01/01/[Retrofit]0x02Headeré—®é¢˜è¡¥å……/#0x00-Retrofit-Header" class="headerlink" title="0x00 Retrofit Header"></a>0x00 Retrofit Header</h2><p>ä¸Šä¸€ç¯‡ä¸­æˆ‘ä»¬ä»‹ç»Retrofitçš„ä¸€ä¸ªç®€å•çš„Demoå’Œæ·»åŠ Headeræ–¹æ³•ï¼Œè¿™ä¸€ç¯‡åœ¨è¡¥å……ä¸€ä¸‹Headerçš„å¦å¤–å‡ ç§å¤„ç†æ–¹æ³•ã€‚</p>
<h2 id="0x01-Header"><a href="/1970/01/01/[Retrofit]0x02Headeré—®é¢˜è¡¥å……/#0x01-Header" class="headerlink" title="0x01 Header"></a>0x01 Header</h2><p>  ä½¿ç”¨OkHTTPçš„Interceptoræ¥å¤„ç†Headerä¿¡æ¯ï¼Œè¿™ç§æ–¹æ³•æ˜¯éœ€è¦æˆ‘ä»¬åœ¨å°è£…Retrofitçš„æ—¶å€™è€ƒè™‘çš„ã€‚ä½†æ˜¯æœ‰æ—¶å€™æˆ‘ä»¬è¿˜å¸Œæœ›èƒ½çµæ´»çš„æ§åˆ¶æ¯ä¸€ä¸ªè¯·æ±‚çš„Headerä¿¡æ¯ï¼Œæ¥ä¸‹æ¥çš„å‡ ç§æ–¹æ³•æ»¡è¶³æˆ‘ä»¬è¿™æ ·çš„è¦æ±‚ã€‚ä»–ä»¬éƒ½æ˜¯åœ¨å„è‡ªçš„Serviceæ–¹æ³•ä¸Šæ·»åŠ æ³¨è§£æ¥è¾¾åˆ°æ·»åŠ Headerçš„ç›®çš„ã€‚</p>
<h3 id="æ·»åŠ å•ä¸ªHeaderå­—æ®µ"><a href="/1970/01/01/[Retrofit]0x02Headeré—®é¢˜è¡¥å……/#æ·»åŠ å•ä¸ªHeaderå­—æ®µ" class="headerlink" title="æ·»åŠ å•ä¸ªHeaderå­—æ®µ"></a>æ·»åŠ å•ä¸ªHeaderå­—æ®µ</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@Headers</span>(<span class="string">"User-Agent: Your-App-Name"</span>)</div><div class="line"><span class="meta">@GET</span></div><div class="line"><span class="function"><span class="keyword">public</span> Call&lt;ResponseBody&gt; <span class="title">weatherReport</span><span class="params">(String cityCode)</span></span>;</div></pre></td></tr></table></figure>
<h3 id="æ·»åŠ å¤šä¸ªHeaderå­—æ®µ"><a href="/1970/01/01/[Retrofit]0x02Headeré—®é¢˜è¡¥å……/#æ·»åŠ å¤šä¸ªHeaderå­—æ®µ" class="headerlink" title="æ·»åŠ å¤šä¸ªHeaderå­—æ®µ"></a>æ·»åŠ å¤šä¸ªHeaderå­—æ®µ</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@Headers</span>(&#123;</div><div class="line">       <span class="string">"Accept: application/json"</span>,</div><div class="line">       <span class="string">"User-Agent: ttdevs"</span></div><div class="line">&#125;)</div><div class="line"><span class="meta">@GET</span></div><div class="line"><span class="function"><span class="keyword">public</span> Call&lt;ResponseBody&gt; <span class="title">weatherReport</span><span class="params">(String cityCode)</span></span>;</div></pre></td></tr></table></figure>
<h3 id="ä½¿ç”¨Mapæ·»åŠ å•ä¸ªHeaderå­—æ®µ"><a href="/1970/01/01/[Retrofit]0x02Headeré—®é¢˜è¡¥å……/#ä½¿ç”¨Mapæ·»åŠ å•ä¸ªHeaderå­—æ®µ" class="headerlink" title="ä½¿ç”¨Mapæ·»åŠ å•ä¸ªHeaderå­—æ®µ"></a>ä½¿ç”¨Mapæ·»åŠ å•ä¸ªHeaderå­—æ®µ</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@GET</span></div><div class="line"><span class="function"><span class="keyword">public</span> Call&lt;ResponseBody&gt; <span class="title">requestWithHeaderMap</span><span class="params">(@HeaderMap Map&lt;String, String&gt; header)</span></span>;</div></pre></td></tr></table></figure>
<p>æºç å‚è€ƒï¼š<a href="https://github.com/ttdevs/android/tree/master/modules/retrofit" target="_blank" rel="external">ttdevs</a></p>
<h2 id="0xFF-å‚è€ƒ"><a href="/1970/01/01/[Retrofit]0x02Headeré—®é¢˜è¡¥å……/#0xFF-å‚è€ƒ" class="headerlink" title="0xFF å‚è€ƒ"></a>0xFF å‚è€ƒ</h2><ol>
<li><a href="https://github.com/square/retrofit" target="_blank" rel="external">https://github.com/square/retrofit</a></li>
<li><a href="http://square.github.io/retrofit/" target="_blank" rel="external">http://square.github.io/retrofit/</a></li>
<li><a href="https://futurestud.io/" target="_blank" rel="external">https://futurestud.io/</a></li>
</ol>
<p><img src="https://raw.githubusercontent.com/ttdevs/ttdevs.github.io/common/images/logo.png" alt="Create by ttdevs"></p>
]]></content>
      
        <categories>
            
            <category> æŠ€æœ¯ </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Retrofit </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[ã€ŒRetrofitã€0x03åŒæ­¥ä¸å¼‚æ­¥è¯·æ±‚]]></title>
      <url>/1970/01/01/%5BRetrofit%5D0x03%E5%90%8C%E6%AD%A5%E4%B8%8E%E5%BC%82%E6%AD%A5%E8%AF%B7%E6%B1%82/</url>
      <content type="html"><![CDATA[<h2 id="0x00-è¯·æ±‚çš„å½¢å¼"><a href="/1970/01/01/[Retrofit]0x03åŒæ­¥ä¸å¼‚æ­¥è¯·æ±‚/#0x00-è¯·æ±‚çš„å½¢å¼" class="headerlink" title="0x00 è¯·æ±‚çš„å½¢å¼"></a>0x00 è¯·æ±‚çš„å½¢å¼</h2><p>æˆ‘ä»¬æ­£å¸¸çš„ç½‘ç»œè¯·æ±‚æœ‰ä¸¤ç§å½¢å¼ï¼šåŒæ­¥æ–¹å¼å’Œå¼‚æ­¥æ–¹å¼ã€‚æ‰€è°“åŒæ­¥æ–¹å¼ï¼Œæ˜¯æŒ‡æˆ‘ä»¬åœ¨åœ¨å‘å‡ºç½‘ç»œè¯·æ±‚ä¹‹åå½“å‰çº¿ç¨‹å‘—é˜»å¡ï¼Œç›´åˆ°è¯·æ±‚çš„ç»“æœï¼ˆæˆåŠŸæˆ–è€…å¤±è´¥ï¼‰åˆ°æ¥ï¼Œæ‰ç»§ç»­å‘ä¸‹æ‰§è¡Œã€‚æ‰€è°“å¼‚æ­¥ï¼Œæ˜¯æŒ‡æˆ‘ä»¬çš„ç½‘ç»œè¯·æ±‚å‘å‡ºä¹‹åï¼Œä¸å¿…ç­‰å¾…è¯·æ±‚ç»“æœçš„åˆ°æ¥ï¼Œå°±å¯ä»¥å»åšå…¶ä»–çš„äº‹æƒ…ï¼Œå½“è¯·æ±‚ç»“æœåˆ°æ¥æ—¶ï¼Œæˆ‘ä»¬åœ¨åšå¤„ç†ç»“æœçš„åŠ¨ä½œã€‚å½“æ—¶æ— è®ºæ˜¯åŒæ­¥è¿˜æ˜¯å¼‚æ­¥ï¼Œæœ€ç»ˆéƒ½æ˜¯åŒæ­¥è¯·æ±‚ã€‚</p>
<h2 id="0x01-åŒæ­¥è¯·æ±‚"><a href="/1970/01/01/[Retrofit]0x03åŒæ­¥ä¸å¼‚æ­¥è¯·æ±‚/#0x01-åŒæ­¥è¯·æ±‚" class="headerlink" title="0x01 åŒæ­¥è¯·æ±‚"></a>0x01 åŒæ­¥è¯·æ±‚</h2><p>Retrofitçš„åŒæ­¥è¯·æ±‚æ¯”è¾ƒç®€å•ï¼Œç›´æ¥è°ƒç”¨ <code>Call</code> çš„executeæ–¹æ³•å³å¯ã€‚è¿™ä¸ªæ—¶å€™æˆ‘ä»¬ä¼šæ‹¿åˆ°è¯·æ±‚çš„ç»“æœã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@Test</span></div><div class="line"> <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">synchronousRequest</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</div><div class="line">     Retrofit retrofit = RetrofitManager.getRetrofit();</div><div class="line">     GitHubService service = retrofit.create(GitHubService.class);</div><div class="line">     Call&lt;User&gt; example = service.userInfo(<span class="string">"ttdevs"</span>);</div><div class="line">     Response&lt;User&gt; response = example.execute();</div><div class="line">     print(response.body().getName());</div><div class="line"> &#125;</div></pre></td></tr></table></figure>
<h2 id="0x02-å¼‚æ­¥è¯·æ±‚"><a href="/1970/01/01/[Retrofit]0x03åŒæ­¥ä¸å¼‚æ­¥è¯·æ±‚/#0x02-å¼‚æ­¥è¯·æ±‚" class="headerlink" title="0x02 å¼‚æ­¥è¯·æ±‚"></a>0x02 å¼‚æ­¥è¯·æ±‚</h2><p>ä¹‹å‰æ–‡ç« çš„è¯·æ±‚éƒ½æ˜¯å¼‚æ­¥æ–¹å¼ï¼Œåœ¨è¯·æ±‚çš„å›è°ƒä¸­æˆ‘ä»¬ä¼šæ‹¿åˆ°è¯·æ±‚ç»“æœï¼Œæ¥ä¸‹æ¥ å¤„ç†è¿™ä¸ªç»“æœå³å¯ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@Test</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">requestHeader</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</div><div class="line">        OkHttpClient client = RetrofitManager.getClient(<span class="keyword">new</span> Interceptor() &#123;</div><div class="line">            <span class="meta">@Override</span></div><div class="line">            <span class="keyword">public</span> okhttp3.<span class="function">Response <span class="title">intercept</span><span class="params">(Chain chain)</span> <span class="keyword">throws</span> IOException </span>&#123;</div><div class="line">                Request original = chain.request();</div><div class="line">                Request request = original.newBuilder()</div><div class="line">                        .header(<span class="string">"Time-Zone"</span>, <span class="string">"Asia/Shanghai"</span>) <span class="comment">//https://developer.github.com/v3/#timezones</span></div><div class="line">                        .header(<span class="string">"user_key"</span>, <span class="string">"I_am_user_key"</span>)</div><div class="line">                        .method(original.method(), original.body())</div><div class="line">                        .build();</div><div class="line">                okhttp3.Response response = chain.proceed(request);</div><div class="line">                <span class="keyword">return</span> response;</div><div class="line">            &#125;</div><div class="line">        &#125;);</div><div class="line">        Retrofit retrofit = RetrofitManager.getRetrofit(client);</div><div class="line">        ExampleService service = retrofit.create(ExampleService.class);</div><div class="line"></div><div class="line">        String url = <span class="string">"http://www.weather.com.cn/adat/sk/101020100.html"</span>;</div><div class="line">        Call&lt;ResponseBody&gt; example = service.requestWithHeader(url);</div><div class="line"></div><div class="line">        <span class="keyword">final</span> CountDownLatch countDownLatch = <span class="keyword">new</span> CountDownLatch(<span class="number">1</span>);</div><div class="line">        example.enqueue(<span class="keyword">new</span> Callback&lt;ResponseBody&gt;() &#123;</div><div class="line">            <span class="meta">@Override</span></div><div class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onResponse</span><span class="params">(Call&lt;ResponseBody&gt; call, Response&lt;ResponseBody&gt; response)</span> </span>&#123;</div><div class="line">                <span class="keyword">try</span> &#123;</div><div class="line">                    print(response.body().string());</div><div class="line">                &#125; <span class="keyword">catch</span> (IOException e) &#123;</div><div class="line">                    e.printStackTrace();</div><div class="line">                &#125;</div><div class="line"></div><div class="line">                countDownLatch.countDown();</div><div class="line">            &#125;</div><div class="line"></div><div class="line">            <span class="meta">@Override</span></div><div class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onFailure</span><span class="params">(Call&lt;ResponseBody&gt; call, Throwable t)</span> </span>&#123;</div><div class="line">                countDownLatch.countDown();</div><div class="line">            &#125;</div><div class="line">        &#125;);</div><div class="line">        countDownLatch.await();</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<h2 id="æ€»ç»“"><a href="/1970/01/01/[Retrofit]0x03åŒæ­¥ä¸å¼‚æ­¥è¯·æ±‚/#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>ç”±äºåŒæ­¥è¯·æ±‚ä¼šé˜»å¡å½“å‰çº¿ç¨‹ï¼Œandroidçš„è®¾è®¡é€»è¾‘ä¸èƒ½åœ¨ä¸»çº¿ç¨‹ä¸­å‘èµ·ç½‘ç»œè¯·æ±‚ï¼ˆå¯èƒ½ä¼šå¯¼è‡´ANRï¼‰ï¼Œæ‰€ä»¥æˆ‘ä»¬æ¯”è¾ƒå¸¸è§çš„éƒ½æ˜¯å¼‚æ­¥å½¢å¼çš„ç½‘ç»œè¯·æ±‚ã€‚ä½†æ˜¯ï¼Œæœ‰æ—¶å€™æˆ‘ä»¬åœ¨å·¥ä½œçº¿ç¨‹ä¸­å¤„ç†ä¸€äº›ç½‘ç»œè¯·æ±‚çš„æ—¶å€™ï¼Œå¯ä»¥æ¥å—é˜»å¡çš„æƒ…å†µï¼ˆè¿™ä¸ªæ—¶å€™ä½¿ç”¨å›è°ƒå¾€å¾€ä¼šä½¿é—®é¢˜å¤æ‚åŒ–ï¼‰ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨åŒæ­¥çš„æ–¹å¼æ¥å‘èµ·ç½‘ç»œè¯·æ±‚ï¼Œæ¯”å¦‚ï¼Œåœ¨ä½¿ç”¨Rxjavaå°è£…æŸä¸ªç½‘ç»œåŠŸèƒ½çš„é€»è¾‘æ˜¯ï¼ˆå¦‚å›¾ç‰‡ä¸Šä¼ ï¼‰æˆ‘ä»¬å°±å¯ä»¥åŒæ­¥å½¢å¼çš„ç½‘ç»œè¯·æ±‚ã€‚</p>
<p><img src="https://raw.githubusercontent.com/ttdevs/ttdevs.github.io/common/images/logo.png" alt="Create by ttdevs"></p>
]]></content>
      
        <categories>
            
            <category> æŠ€æœ¯ </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Retrofit </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[ã€ŒRetrofitã€0x04POSTæ–¹å¼æäº¤JSONæ•°æ®]]></title>
      <url>/1970/01/01/%5BRetrofit%5D0x04POST%E6%96%B9%E5%BC%8F%E6%8F%90%E4%BA%A4JSON%E6%95%B0%E6%8D%AE/</url>
      <content type="html"><![CDATA[<h2 id="0x00-HTTP-Methodï¼šPOST"><a href="/1970/01/01/[Retrofit]0x04POSTæ–¹å¼æäº¤JSONæ•°æ®/#0x00-HTTP-Methodï¼šPOST" class="headerlink" title="0x00 HTTP Methodï¼šPOST"></a>0x00 HTTP Methodï¼šPOST</h2><p>POSTè¯·æ±‚å†æ—¥å¸¸çš„ä½¿ç”¨ä¸­å¾ˆå¸¸è§ï¼Œæ¯”å¦‚ç™»å½•ï¼Œä¸Šä¼ æ•°æ®ä¸­ä½¿ç”¨ã€‚ä¹‹å‰ä»‹ç»äº†GETæ–¹å¼ï¼Œä»Šå¤©ç®€å•ä»‹ç»ä¸‹å¦‚ä½•ä½¿ç”¨POSTæ¥æäº¤æ•°æ®ã€‚</p>
<h2 id="0x01-å¸¸ç”¨çš„POSTæ–¹å¼"><a href="/1970/01/01/[Retrofit]0x04POSTæ–¹å¼æäº¤JSONæ•°æ®/#0x01-å¸¸ç”¨çš„POSTæ–¹å¼" class="headerlink" title="0x01 å¸¸ç”¨çš„POSTæ–¹å¼"></a>0x01 å¸¸ç”¨çš„POSTæ–¹å¼</h2><p>POSTæ–¹å¼æäº¤æ•°æ®å†æµè§ˆå™¨ä¸­çš„è¡¨ç°ä¸»è¦æ˜¯ä½¿ç”¨Formï¼Œåœ¨å®¢æˆ·ç«¯ä¸­å›½ä¸­çš„ä¸»è¦è¡¨ç°æ˜¯æäº¤JSONæ•°æ®ã€‚å½“ç„¶ï¼Œå…·ä½“æ˜¯ä»€ä¹ˆæ•°æ®æ ¼å¼å¹¶ä¸é‡è¦ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡æŠ“åŒ…æ¥åˆ†æï¼šæœ€ç»ˆæ•°æ®éƒ½æ˜¯ä¸€æ ·çš„ã€‚</p>
<h3 id="ä½¿ç”¨Modelå¯¹è±¡"><a href="/1970/01/01/[Retrofit]0x04POSTæ–¹å¼æäº¤JSONæ•°æ®/#ä½¿ç”¨Modelå¯¹è±¡" class="headerlink" title="ä½¿ç”¨Modelå¯¹è±¡"></a>ä½¿ç”¨Modelå¯¹è±¡</h3><p>é¦–å…ˆæ–°å»ºä¸€ä¸ªmodelå¯¹è±¡ï¼Œæ¯”å¦‚ï¼šUserï¼Œæ·»åŠ å¸¸ç”¨çš„ç†Ÿæ‚‰å’Œgetï¼setæ–¹æ³•ã€‚æ–°å»ºæˆ‘ä»¬çš„Serviceï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@POST</span>(<span class="string">"/send"</span>)</div><div class="line"><span class="function"><span class="keyword">public</span> Call&lt;ResponseBody&gt; <span class="title">modelPost</span><span class="params">(@Url String url, @Body User user)</span></span>;</div></pre></td></tr></table></figure>
<p>æµ‹è¯•ä»£ç ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@Test</span></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">modelPost</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</div><div class="line">   HttpLoggingInterceptor logging = <span class="keyword">new</span> HttpLoggingInterceptor();</div><div class="line">   logging.setLevel(HttpLoggingInterceptor.Level.BASIC);</div><div class="line"></div><div class="line">   OkHttpClient client = RetrofitManager.getClient(logging);</div><div class="line"></div><div class="line">   Retrofit retrofit = RetrofitManager.getRetrofit(client);</div><div class="line">   ExampleService service = retrofit.create(ExampleService.class);</div><div class="line"></div><div class="line">   String url = <span class="string">"http://www.remoteurl.com"</span>;</div><div class="line">   User user = <span class="keyword">new</span> User();</div><div class="line">   user.setName(<span class="string">"ttdevs"</span>);</div><div class="line">   Call&lt;ResponseBody&gt; example = service.modelPost(url, user);</div><div class="line"></div><div class="line">   <span class="keyword">final</span> CountDownLatch countDownLatch = <span class="keyword">new</span> CountDownLatch(<span class="number">1</span>);</div><div class="line">   example.enqueue(<span class="keyword">new</span> Callback&lt;ResponseBody&gt;() &#123;</div><div class="line">       <span class="meta">@Override</span></div><div class="line">       <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onResponse</span><span class="params">(Call&lt;ResponseBody&gt; call, Response&lt;ResponseBody&gt; response)</span> </span>&#123;</div><div class="line">           <span class="keyword">try</span> &#123;</div><div class="line">               print(response.body().string());</div><div class="line">           &#125; <span class="keyword">catch</span> (IOException e) &#123;</div><div class="line">               e.printStackTrace();</div><div class="line">           &#125;</div><div class="line"></div><div class="line">           countDownLatch.countDown();</div><div class="line">       &#125;</div><div class="line"></div><div class="line">       <span class="meta">@Override</span></div><div class="line">       <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onFailure</span><span class="params">(Call&lt;ResponseBody&gt; call, Throwable t)</span> </span>&#123;</div><div class="line">           countDownLatch.countDown();</div><div class="line">       &#125;</div><div class="line">   &#125;);</div><div class="line">   countDownLatch.await();</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="ä½¿ç”¨RequestBodyå¯¹è±¡"><a href="/1970/01/01/[Retrofit]0x04POSTæ–¹å¼æäº¤JSONæ•°æ®/#ä½¿ç”¨RequestBodyå¯¹è±¡" class="headerlink" title="ä½¿ç”¨RequestBodyå¯¹è±¡"></a>ä½¿ç”¨RequestBodyå¯¹è±¡</h3><p>è¿™é‡Œæˆ‘ä»¬æ¥æäº¤ä¸€ä»½JSONæ•°æ®ï¼Œé¦–å…ˆè¿˜æ˜¯å†Serviceä¸­åˆ›å»ºä¸€ä¸ªæ–¹æ³•ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@POST</span>(<span class="string">"/send"</span>)</div><div class="line"><span class="function"><span class="keyword">public</span> Call&lt;ResponseBody&gt; <span class="title">withRequestBody</span><span class="params">(@Url String url, @Body RequestBody body)</span></span>;</div></pre></td></tr></table></figure>
<p>å†æ¥ç€åˆ›å»ºæˆ‘ä»¬çš„è¯·æ±‚ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@Test</span></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">withRequestBody</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</div><div class="line">    HttpLoggingInterceptor logging = <span class="keyword">new</span> HttpLoggingInterceptor();</div><div class="line">    logging.setLevel(HttpLoggingInterceptor.Level.BASIC);</div><div class="line"></div><div class="line">    OkHttpClient client = RetrofitManager.getClient(logging);</div><div class="line"></div><div class="line">    Retrofit retrofit = RetrofitManager.getRetrofit(client);</div><div class="line">    ExampleService service = retrofit.create(ExampleService.class);</div><div class="line"></div><div class="line">    String url = <span class="string">"http://www.remoteurl.com"</span>;</div><div class="line"></div><div class="line">    JSONObject result = <span class="keyword">new</span> JSONObject();</div><div class="line">    <span class="keyword">try</span> &#123;</div><div class="line">        result.put(<span class="string">"record"</span>, <span class="string">"hello"</span>);</div><div class="line">    &#125; <span class="keyword">catch</span> (JSONException e) &#123;</div><div class="line">        e.printStackTrace();</div><div class="line">    &#125;</div><div class="line">    RequestBody body = RequestBody.create(MediaType.parse(<span class="string">"application/json"</span>), result.toString());</div><div class="line">    Call&lt;ResponseBody&gt; example = service.withRequestBody(url, body);</div><div class="line"></div><div class="line">    <span class="keyword">final</span> CountDownLatch countDownLatch = <span class="keyword">new</span> CountDownLatch(<span class="number">1</span>);</div><div class="line">    example.enqueue(<span class="keyword">new</span> Callback&lt;ResponseBody&gt;() &#123;</div><div class="line">        <span class="meta">@Override</span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onResponse</span><span class="params">(Call&lt;ResponseBody&gt; call, Response&lt;ResponseBody&gt; response)</span> </span>&#123;</div><div class="line">            <span class="keyword">try</span> &#123;</div><div class="line">                print(response.body().string());</div><div class="line">            &#125; <span class="keyword">catch</span> (IOException e) &#123;</div><div class="line">                e.printStackTrace();</div><div class="line">            &#125;</div><div class="line"></div><div class="line">            countDownLatch.countDown();</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="meta">@Override</span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onFailure</span><span class="params">(Call&lt;ResponseBody&gt; call, Throwable t)</span> </span>&#123;</div><div class="line">            countDownLatch.countDown();</div><div class="line">        &#125;</div><div class="line">    &#125;);</div><div class="line">    countDownLatch.await();</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="0x02-æ€»ç»“"><a href="/1970/01/01/[Retrofit]0x04POSTæ–¹å¼æäº¤JSONæ•°æ®/#0x02-æ€»ç»“" class="headerlink" title="0x02 æ€»ç»“"></a>0x02 æ€»ç»“</h2><p>ç¬¬ä¸€ç§æ–¹æ³•ï¼Œæˆ‘ä»¬éœ€è¦ä¸ºæ¯ä¸€ä¸ªè¯·æ±‚çš„å¯¹è±¡åˆ›å»ºä¸€ä¸ªModelï¼Œå¦‚æœä½ ä¸æƒ³åˆ›å»ºmodelåˆ™å¯ä»¥é€‰æ‹©ç¬¬äºŒç§æ–¹å¼ï¼Œç›´æ¥åˆ›å»ºä¸€ä¸ªJSONå­—ç¬¦ä¸²ï¼Œç„¶åæäº¤å³å¯ã€‚è¿˜æ˜¯ç›¸å½“ç®€ç­”çš„ã€‚</p>
<p><img src="https://raw.githubusercontent.com/ttdevs/ttdevs.github.io/common/images/logo.png" alt="Create by ttdevs"></p>
]]></content>
      
        <categories>
            
            <category> æŠ€æœ¯ </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Retrofit </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[ã€ŒJavaã€(==)ä¸(equals)]]></title>
      <url>/1970/01/01/%5BJava%5D(==)%E4%B8%8E(equals)/</url>
      <content type="html"><![CDATA[<h2 id="0x01-ä¸¤ç§æ¯”è¾ƒæ–¹æ³•"><a href="/1970/01/01/[Java](==)ä¸(equals)/#0x01-ä¸¤ç§æ¯”è¾ƒæ–¹æ³•" class="headerlink" title="0x01 ä¸¤ç§æ¯”è¾ƒæ–¹æ³•"></a>0x01 ä¸¤ç§æ¯”è¾ƒæ–¹æ³•</h2><ul>
<li><p><code>==</code></p>
<ul>
<li><p>åŸºæœ¬ç±»å‹</p>
<p>  å¯¹äºåŸºæœ¬ç±»å‹ï¼Œ<code>==</code> çš„åŠŸèƒ½æ˜¯æ¯”è¾ƒå€¼ã€‚</p>
</li>
<li><p><code>Object</code></p>
<p>  æ¯”è¾ƒå¯¹è±¡åœ¨å†…å­˜ä¸­çš„åœ°å€ã€‚</p>
</li>
</ul>
</li>
<li><p><code>equals</code></p>
<p>  åŸºæœ¬ç±»å‹æ— equalsæ–¹æ³•ã€‚Objectå¯¹è±¡é»˜è®¤equalsçš„å®ç°å¦‚ä¸‹ï¼š</p>
  <figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"> * ...</div><div class="line"> * <span class="doctag">@param</span>   obj   the reference object with which to compare.</div><div class="line"> * <span class="doctag">@return</span>  &#123;<span class="doctag">@code</span> true&#125; if this object is the same as the obj</div><div class="line"> *          argument; &#123;<span class="doctag">@code</span> false&#125; otherwise.</div><div class="line"> * <span class="doctag">@see</span>     #hashCode()</div><div class="line"> * <span class="doctag">@see</span>     java.util.HashMap</div><div class="line"> */</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">equals</span><span class="params">(Object obj)</span> </span>&#123;</div><div class="line">    <span class="keyword">return</span> (<span class="keyword">this</span> == obj);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ul>
<pre><code>æœ‰å¾ˆé•¿ä¸€æ®µæ³¨é‡Šï¼Œæœ€ç»ˆçš„å®ç°æˆ‘ä»¬å¯ä»¥çœ‹åˆ°è¿˜æ˜¯ç”¨çš„ `==` æ¥æ¯”è¾ƒä¸¤ä¸ªå¯¹è±¡åœ¨å†…å­˜ä¸­çš„åœ°å€ã€‚
</code></pre><h2 id="0x02-equals-amp-hashCode"><a href="/1970/01/01/[Java](==)ä¸(equals)/#0x02-equals-amp-hashCode" class="headerlink" title="0x02 equals() &amp; hashCode()"></a>0x02 equals() &amp; hashCode()</h2><p>å¯¹äºequalsçš„é»˜è®¤å®ç°â€”â€”æ¯”è¾ƒå¯¹è±¡åœ¨å†…å­˜ä¸­çš„åœ°å€â€”â€”æœ‰æ—¶å€™å¯èƒ½å¹¶ä¸æ˜¯æˆ‘ä»¬æœŸæœ›çš„ï¼Œæ¯”å¦‚æœ‰ä¸€ä¸ªStudentç±»ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span></span>&#123;</div><div class="line">   <span class="keyword">private</span> <span class="keyword">int</span> id;</div><div class="line">   <span class="keyword">private</span> String name;</div><div class="line"></div><div class="line">   <span class="function"><span class="keyword">public</span> <span class="title">Student</span><span class="params">(<span class="keyword">int</span> id)</span></span>&#123;</div><div class="line">       <span class="keyword">this</span>.id = id;</div><div class="line">   &#125;</div><div class="line"></div><div class="line">   <span class="comment">// ... getter and setter</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>å½“ Student.id ç›¸åŒæ—¶ï¼Œæˆ‘ä»¬æ›´æ„¿æ„è®¤ä¸ºè¿™æ˜¯åŒä¸€ä¸ªå­¦ç”Ÿï¼Œè€Œä¸‹é¢è¿™ä¸ªæµ‹è¯•æ˜¯æ— æ³•é€šè¿‡çš„ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@Test</span></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">equalsStudent</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</div><div class="line">   Student st1 = <span class="keyword">new</span> Student(<span class="number">2333</span>);</div><div class="line">   Student st2 = <span class="keyword">new</span> Student(<span class="number">2333</span>);</div><div class="line">   assertEquals(st1, st2);</div><div class="line">   <span class="comment">// assertNotEquals(st1, st2);</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸ºäº†è¾¾åˆ°æˆ‘ä»¬çš„ç›®çš„â€”â€”ç›¸åŒçš„å­¦å·å°±è®¤ä¸ºæ˜¯åŒä¸€ä¸ªäººâ€”â€”æˆ‘ä»¬å¯ä»¥é‡å†™Studentç±»çš„ equals æ–¹æ³•ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span> </span>&#123;</div><div class="line">   <span class="keyword">private</span> <span class="keyword">int</span> id;</div><div class="line">   <span class="keyword">private</span> String name;</div><div class="line"></div><div class="line">   <span class="function"><span class="keyword">public</span> <span class="title">Student</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123;</div><div class="line">       <span class="keyword">this</span>.id = id;</div><div class="line">   &#125;</div><div class="line"></div><div class="line">   <span class="meta">@Override</span></div><div class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">equals</span><span class="params">(Object o)</span> </span>&#123;</div><div class="line">       <span class="keyword">if</span> (<span class="keyword">null</span> == o) &#123;</div><div class="line">           <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">       &#125;</div><div class="line">       Student std = (Student) o;</div><div class="line">       <span class="keyword">if</span> (<span class="keyword">this</span>.id == std.id) &#123;</div><div class="line">           <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">       &#125;</div><div class="line">       <span class="keyword">return</span> <span class="keyword">super</span>.equals(o);</div><div class="line">   &#125;</div><div class="line"></div><div class="line">   <span class="comment">// ... getter and setter</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¿®æ”¹ä¹‹åä¸Šé¢çš„æµ‹è¯•å°±å¯ä»¥é€šè¿‡äº†ã€‚Demoæ¯•ç«Ÿæ˜¯ç®€å•çš„ï¼Œå½“æˆ‘ä»¬åœ¨å®é™…çš„ä½¿ç”¨ä¸­éœ€è¦é‡å†™equalsæ–¹æ³•æ—¶è¿˜æ˜¯éœ€è¦éµå®ˆå®ƒçš„ç”Ÿæˆè§„åˆ™ï¼Œè¿™é‡Œè´´å‡ºæ¥ä¾›å‚è€ƒï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div></pre></td><td class="code"><pre><div class="line">public boolean equals(Object obj)</div><div class="line"></div><div class="line">    æŒ‡ç¤ºå…¶ä»–æŸä¸ªå¯¹è±¡æ˜¯å¦ä¸æ­¤å¯¹è±¡â€œç›¸ç­‰â€ã€‚</div><div class="line"></div><div class="line">    equals æ–¹æ³•åœ¨éç©ºå¯¹è±¡å¼•ç”¨ä¸Šå®ç°ç›¸ç­‰å…³ç³»ï¼š</div><div class="line"></div><div class="line">        è‡ªåæ€§ï¼šå¯¹äºä»»ä½•éç©ºå¼•ç”¨å€¼ xï¼Œx.equals(x) éƒ½åº”è¿”å› trueã€‚</div><div class="line">        å¯¹ç§°æ€§ï¼šå¯¹äºä»»ä½•éç©ºå¼•ç”¨å€¼ x å’Œ yï¼Œå½“ä¸”ä»…å½“ y.equals(x) è¿”å› true æ—¶ï¼Œx.equals(y) æ‰åº”è¿”å› trueã€‚</div><div class="line">        ä¼ é€’æ€§ï¼šå¯¹äºä»»ä½•éç©ºå¼•ç”¨å€¼ xã€y å’Œ zï¼Œå¦‚æœ x.equals(y) è¿”å› trueï¼Œå¹¶ä¸” y.equals(z) è¿”å› trueï¼Œé‚£ä¹ˆ x.equals(z) åº”è¿”å› trueã€‚</div><div class="line">        ä¸€è‡´æ€§ï¼šå¯¹äºä»»ä½•éç©ºå¼•ç”¨å€¼ x å’Œ yï¼Œå¤šæ¬¡è°ƒç”¨ x.equals(y) å§‹ç»ˆè¿”å› true æˆ–å§‹ç»ˆè¿”å› falseï¼Œå‰ææ˜¯å¯¹è±¡ä¸Š equals æ¯”è¾ƒä¸­æ‰€ç”¨çš„ä¿¡æ¯æ²¡æœ‰è¢«ä¿®æ”¹ã€‚</div><div class="line">        å¯¹äºä»»ä½•éç©ºå¼•ç”¨å€¼ xï¼Œx.equals(null) éƒ½åº”è¿”å› falseã€‚ </div><div class="line"></div><div class="line">    Object ç±»çš„ equals æ–¹æ³•å®ç°å¯¹è±¡ä¸Šå·®åˆ«å¯èƒ½æ€§æœ€å¤§çš„ç›¸ç­‰å…³ç³»ï¼›å³ï¼Œå¯¹äºä»»ä½•éç©ºå¼•ç”¨å€¼ x å’Œ yï¼Œå½“ä¸”ä»…å½“ x å’Œ y å¼•ç”¨åŒä¸€ä¸ªå¯¹è±¡æ—¶ï¼Œæ­¤æ–¹æ³•æ‰è¿”å› trueï¼ˆx == y å…·æœ‰å€¼ trueï¼‰ã€‚</div><div class="line"></div><div class="line">    æ³¨æ„ï¼šå½“æ­¤æ–¹æ³•è¢«é‡å†™æ—¶ï¼Œé€šå¸¸æœ‰å¿…è¦é‡å†™ hashCode æ–¹æ³•ï¼Œä»¥ç»´æŠ¤ hashCode æ–¹æ³•çš„å¸¸è§„åå®šï¼Œè¯¥åå®šå£°æ˜ç›¸ç­‰å¯¹è±¡å¿…é¡»å…·æœ‰ç›¸ç­‰çš„å“ˆå¸Œç ã€‚</div><div class="line"></div><div class="line">    å‚æ•°ï¼š</div><div class="line">        obj - è¦ä¸ä¹‹æ¯”è¾ƒçš„å¼•ç”¨å¯¹è±¡ã€‚ </div><div class="line">    è¿”å›ï¼š</div><div class="line">        å¦‚æœæ­¤å¯¹è±¡ä¸ obj å‚æ•°ç›¸åŒï¼Œåˆ™è¿”å› trueï¼›å¦åˆ™è¿”å› falseã€‚</div><div class="line">    å¦è¯·å‚è§ï¼š</div><div class="line">        hashCode(), Hashtable</div><div class="line">``` </div><div class="line"></div><div class="line">äº‹æƒ…è¿˜æ²¡æœ‰ç»“æŸã€‚çœ‹ä¸‹é¢ä»£ç ï¼š</div><div class="line"></div><div class="line">``` java</div><div class="line">@Test</div><div class="line">public void studentSet() throws Exception &#123;</div><div class="line">   Student st1 = new Student(2333);</div><div class="line">   Student st2 = new Student(2333);</div><div class="line"></div><div class="line">   Set&lt;Student&gt; stds = new HashSet&lt;&gt;();</div><div class="line">   stds.add(st1);</div><div class="line">   stds.add(st2);</div><div class="line">   assertEquals(1, stds.size());</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä½ ä¼šå‘ç°è¿™æ®µä»£ç æµ‹è¯•ä¸é€šè¿‡ã€‚setä¸æ˜¯é‡å¤å¯¹è±¡åªä¼šä¿ç•™ä¸€ä»½å—ï¼Œä¸ºä»€ä¹ˆä¸æ˜¯ 1 å‘¢ï¼Ÿ</p>
<p>è¿™é‡Œå°±è¦ä»‹ç» hashCode() æ–¹æ³•ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">public int hashCode()</div><div class="line"></div><div class="line">    è¿”å›è¯¥å¯¹è±¡çš„å“ˆå¸Œç å€¼ã€‚æ”¯æŒæ­¤æ–¹æ³•æ˜¯ä¸ºäº†æé«˜å“ˆå¸Œè¡¨ï¼ˆä¾‹å¦‚ java.util.Hashtable æä¾›çš„å“ˆå¸Œè¡¨ï¼‰çš„æ€§èƒ½ã€‚</div><div class="line"></div><div class="line">    hashCode çš„å¸¸è§„åå®šæ˜¯ï¼š</div><div class="line"></div><div class="line">        åœ¨ Java åº”ç”¨ç¨‹åºæ‰§è¡ŒæœŸé—´ï¼Œåœ¨å¯¹åŒä¸€å¯¹è±¡å¤šæ¬¡è°ƒç”¨ hashCode æ–¹æ³•æ—¶ï¼Œå¿…é¡»ä¸€è‡´åœ°è¿”å›ç›¸åŒçš„æ•´æ•°ï¼Œå‰ææ˜¯å°†å¯¹è±¡è¿›è¡Œ equals æ¯”è¾ƒæ—¶æ‰€ç”¨çš„ä¿¡æ¯æ²¡æœ‰è¢«ä¿®æ”¹ã€‚ä»æŸä¸€åº”ç”¨ç¨‹åºçš„ä¸€æ¬¡æ‰§è¡Œåˆ°åŒä¸€åº”ç”¨ç¨‹åºçš„å¦ä¸€æ¬¡æ‰§è¡Œï¼Œè¯¥æ•´æ•°æ— éœ€ä¿æŒä¸€è‡´ã€‚</div><div class="line">        å¦‚æœæ ¹æ® equals(Object) æ–¹æ³•ï¼Œä¸¤ä¸ªå¯¹è±¡æ˜¯ç›¸ç­‰çš„ï¼Œé‚£ä¹ˆå¯¹è¿™ä¸¤ä¸ªå¯¹è±¡ä¸­çš„æ¯ä¸ªå¯¹è±¡è°ƒç”¨ hashCode æ–¹æ³•éƒ½å¿…é¡»ç”Ÿæˆç›¸åŒçš„æ•´æ•°ç»“æœã€‚</div><div class="line">        å¦‚æœæ ¹æ® equals(java.lang.Object) æ–¹æ³•ï¼Œä¸¤ä¸ªå¯¹è±¡ä¸ç›¸ç­‰ï¼Œé‚£ä¹ˆå¯¹è¿™ä¸¤ä¸ªå¯¹è±¡ä¸­çš„ä»»ä¸€å¯¹è±¡ä¸Šè°ƒç”¨ hashCode æ–¹æ³•ä¸ è¦æ±‚ä¸€å®šç”Ÿæˆä¸åŒçš„æ•´æ•°ç»“æœã€‚ä½†æ˜¯ï¼Œç¨‹åºå‘˜åº”è¯¥æ„è¯†åˆ°ï¼Œä¸ºä¸ç›¸ç­‰çš„å¯¹è±¡ç”Ÿæˆä¸åŒæ•´æ•°ç»“æœå¯ä»¥æé«˜å“ˆå¸Œè¡¨çš„æ€§èƒ½ã€‚ </div><div class="line"></div><div class="line">    å®é™…ä¸Šï¼Œç”± Object ç±»å®šä¹‰çš„ hashCode æ–¹æ³•ç¡®å®ä¼šé’ˆå¯¹ä¸åŒçš„å¯¹è±¡è¿”å›ä¸åŒçš„æ•´æ•°ã€‚ï¼ˆè¿™ä¸€èˆ¬æ˜¯é€šè¿‡å°†è¯¥å¯¹è±¡çš„å†…éƒ¨åœ°å€è½¬æ¢æˆä¸€ä¸ªæ•´æ•°æ¥å®ç°çš„ï¼Œä½†æ˜¯ JavaTM ç¼–ç¨‹è¯­è¨€ä¸éœ€è¦è¿™ç§å®ç°æŠ€å·§ã€‚ï¼‰</div><div class="line"></div><div class="line">    è¿”å›ï¼š</div><div class="line">        æ­¤å¯¹è±¡çš„ä¸€ä¸ªå“ˆå¸Œç å€¼ã€‚</div><div class="line">    å¦è¯·å‚è§ï¼š</div><div class="line">        equals(java.lang.Object), Hashtable</div></pre></td></tr></table></figure>
<p>å½“æˆ‘ä»¬ä½¿ç”¨ç”¨å“ˆå¸Œè¡¨å®ç°çš„å·¥å…·ç±»æ—¶ï¼Œè¿™ä¸ªæ–¹æ³•çš„ä»·å€¼å°±ä½“ç°äº†ã€‚ç”±äºä¹‹å‰æˆ‘ä»¬æ²¡æœ‰é‡å†™è¿™ä¸ªæ–¹æ³•ï¼ŒæŠŠStudentå¯¹è±¡å­˜å…¥HashSetæ—¶è¿˜æ˜¯æŒ‰ç…§ä¹‹å‰ç³»ç»Ÿé»˜è®¤çš„æ–¹å¼è®¡ç®—ä»–ä»¬çš„hashå€¼ï¼Œå¯¼è‡´Setä¸­å­˜åœ¨ä¸¤ä¸ªStudentå¯¹è±¡ã€‚</p>
<p>ä¸‹é¢åšä¸€ä¸ªç®€å•ä¿®æ”¹ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span> </span>&#123;</div><div class="line">   <span class="keyword">private</span> <span class="keyword">int</span> id;</div><div class="line">   <span class="keyword">private</span> String name;</div><div class="line"></div><div class="line">   <span class="function"><span class="keyword">public</span> <span class="title">Student</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123;</div><div class="line">       <span class="keyword">this</span>.id = id;</div><div class="line">   &#125;</div><div class="line"></div><div class="line">   <span class="meta">@Override</span></div><div class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">equals</span><span class="params">(Object o)</span> </span>&#123;</div><div class="line">       <span class="keyword">if</span> (<span class="keyword">null</span> == o) &#123;</div><div class="line">           <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">       &#125;</div><div class="line"></div><div class="line">       <span class="comment">// æœ‰æ—¶å€™instanceofä¸åˆé€‚çš„æ—¶å€™å¯ä»¥è€ƒè™‘ç”¨getClass()æ–¹æ³•</span></div><div class="line">       <span class="keyword">if</span> (getClass() != o.getClass()) &#123;</div><div class="line">           <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">       &#125;</div><div class="line"></div><div class="line">       <span class="keyword">if</span> (o <span class="keyword">instanceof</span> Student) &#123;</div><div class="line">           Student std = (Student) o;</div><div class="line">           <span class="keyword">if</span> (<span class="keyword">this</span>.id == std.id) &#123;</div><div class="line">               <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">           &#125;</div><div class="line">       &#125;</div><div class="line"></div><div class="line">       <span class="keyword">return</span> <span class="keyword">super</span>.equals(o);</div><div class="line">   &#125;</div><div class="line"></div><div class="line">   <span class="meta">@Override</span></div><div class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">hashCode</span><span class="params">()</span> </span>&#123;</div><div class="line">       <span class="keyword">return</span> <span class="keyword">this</span>.id; </div><div class="line">       <span class="comment">// return super.hashCode();</span></div><div class="line">   &#125;</div><div class="line"></div><div class="line">   <span class="comment">// ... getter and setter</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>å†è¿è¡Œä¸‹é¢çš„æµ‹è¯•ï¼Œä½ ä¼šå‘ç°å’Œæˆ‘ä»¬æœŸå¾…çš„ä¸€è‡´äº†ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@Test</span></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">studentSet</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</div><div class="line">   Student st1 = <span class="keyword">new</span> Student(<span class="number">2333</span>);</div><div class="line">   Student st2 = <span class="keyword">new</span> Student(<span class="number">2333</span>);</div><div class="line"></div><div class="line">   Set&lt;Student&gt; stds = <span class="keyword">new</span> HashSet&lt;&gt;();</div><div class="line">   stds.add(st1);</div><div class="line">   stds.add(st2);</div><div class="line">   assertEquals(<span class="number">1</span>, stds.size());</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>Demoä¸­ç›´æ¥å°†idä½œä¸ºhashcodeè¿”å›ä¸æ˜¯ä¸€ç§å¥½çš„ç”Ÿæˆæ–¹å¼ï¼Œå…·ä½“çš„ç”Ÿæˆè§„åˆ™è¯·å‚è€ƒä¸Šé¢çš„æ³¨é‡Šã€‚</p>
<h2 id="0x03-Demo"><a href="/1970/01/01/[Java](==)ä¸(equals)/#0x03-Demo" class="headerlink" title="0x03 Demo"></a>0x03 Demo</h2><p>å†æ¥çœ‹ä¸€ä¸ªdemoï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@Test</span></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">stringTest</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</div><div class="line">   String str1 = <span class="string">"abc"</span>;</div><div class="line">   String str2 = <span class="string">"abc"</span>;</div><div class="line">   String str3 = <span class="keyword">new</span> String(<span class="string">"abc"</span>);</div><div class="line"></div><div class="line">   System.out.println(str1 == str2);</div><div class="line">   System.out.println(str1 == str3);</div><div class="line"></div><div class="line">   assertEquals(str1, str2);</div><div class="line">   assertEquals(str1, str3);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ç»“æœä¼šæ€æ ·ï¼Ÿæ²¡é”™ï¼Œæµ‹è¯•é€šè¿‡ï¼Œè¾“å‡ºï¼štrueï¼Œfalseã€‚</p>
<p>é¦–å…ˆæˆ‘ä»¬æ¥çœ‹ä¸‹Stringç±»é‡å†™çš„equals()å’ŒhashCOde():</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@Override</span> </div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">equals</span><span class="params">(Object other)</span> </span>&#123;</div><div class="line">   <span class="keyword">if</span> (other == <span class="keyword">this</span>) &#123;</div><div class="line">     <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">   &#125;</div><div class="line">   <span class="keyword">if</span> (other <span class="keyword">instanceof</span> String) &#123;</div><div class="line">       String s = (String)other;</div><div class="line">       <span class="keyword">int</span> count = <span class="keyword">this</span>.count;</div><div class="line">       <span class="keyword">if</span> (s.count != count) &#123;</div><div class="line">           <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">       &#125;</div><div class="line">       <span class="keyword">if</span> (hashCode() != s.hashCode()) &#123;</div><div class="line">           <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">       &#125;</div><div class="line">       <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; count; ++i) &#123;</div><div class="line">           <span class="keyword">if</span> (charAt(i) != s.charAt(i)) &#123;</div><div class="line">               <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">           &#125;</div><div class="line">       &#125;</div><div class="line">       <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">   &#125; <span class="keyword">else</span> &#123;</div><div class="line">       <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">   &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="meta">@Override</span> </div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">hashCode</span><span class="params">()</span> </span>&#123;</div><div class="line">   <span class="keyword">int</span> hash = hashCode;</div><div class="line">   <span class="keyword">if</span> (hash == <span class="number">0</span>) &#123;</div><div class="line">       <span class="keyword">if</span> (count == <span class="number">0</span>) &#123;</div><div class="line">           <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">       &#125;</div><div class="line">       <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; count; ++i) &#123;</div><div class="line">           hash = <span class="number">31</span> * hash + charAt(i);</div><div class="line">       &#125;</div><div class="line">       hashCode = hash;</div><div class="line">   &#125;</div><div class="line">   <span class="keyword">return</span> hash;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä»ä¸Šé¢å¯ä»¥çœ‹å‡ºï¼ŒStringç±»é‡å†™äº†è¿™ä¸¤ä¸ªæ–¹æ³•ï¼Œequals()ä¸­çš„é€»è¾‘æ˜¯æ¯”è¾ƒå­—ç¬¦ä¸²ä¸­æ¯ä¸ªå­—ç¬¦æ˜¯å¦ç›¸åŒã€‚å› æ­¤ str1, str2, str3ç›¸åŒå°±å¯ä»¥ç†è§£äº†ã€‚<br>å¯¹äº <code>str1 == str2</code> å’Œ <code>str1 != str3</code> è¿™æ¶‰åŠåˆ°ä¸åŒå­—ç¬¦ä¸²åˆ›å»ºæ–¹æ³•ã€‚</p>
<blockquote>
<p><a href="https://github.com/GeniusVJR/LearningNotes/blob/master/Part2/JavaSE/Java%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86.md" target="_blank" rel="external">åœ¨å¼€å§‹è¿™ä¸ªä¾‹å­ä¹‹å‰ï¼ŒåŒå­¦ä»¬éœ€è¦çŸ¥é“JVMå¤„ç†Stringçš„ä¸€äº›ç‰¹æ€§ã€‚Javaçš„è™šæ‹Ÿæœºåœ¨å†…å­˜ä¸­å¼€è¾Ÿå‡ºä¸€å—å•ç‹¬çš„åŒºåŸŸï¼Œç”¨æ¥å­˜å‚¨å­—ç¬¦ä¸²å¯¹è±¡ï¼Œè¿™å—å†…å­˜åŒºåŸŸè¢«ç§°ä¸ºå­—ç¬¦ä¸²ç¼“å†²æ± ã€‚å½“ä½¿ç”¨ String a = â€œabcâ€è¿™æ ·çš„è¯­å¥è¿›è¡Œå®šä¹‰ä¸€ä¸ªå¼•ç”¨çš„æ—¶å€™ï¼Œé¦–å…ˆä¼šåœ¨å­—ç¬¦ä¸²ç¼“å†²æ± ä¸­æŸ¥æ‰¾æ˜¯å¦å·²ç»ç›¸åŒçš„å¯¹è±¡ï¼Œå¦‚æœå­˜åœ¨ï¼Œé‚£ä¹ˆå°±ç›´æ¥å°†è¿™ä¸ªå¯¹è±¡çš„å¼•ç”¨è¿”å›ç»™aï¼Œå¦‚æœä¸å­˜åœ¨ï¼Œåˆ™éœ€è¦æ–°å»ºä¸€ä¸ªå€¼ä¸ºâ€abcâ€çš„å¯¹è±¡ï¼Œå†å°†æ–°çš„å¼•ç”¨è¿”å›aã€‚String a = new String(â€œabcâ€);è¿™æ ·çš„è¯­å¥æ˜ç¡®å‘Šè¯‰JVMæƒ³è¦äº§ç”Ÿä¸€ä¸ªæ–°çš„Stringå¯¹è±¡ï¼Œå¹¶ä¸”å€¼ä¸ºâ€abcâ€ï¼Œäºæ˜¯å°±åœ¨å †å†…å­˜ä¸­çš„æŸä¸€ä¸ªå°è§’è½å¼€è¾Ÿäº†ä¸€ä¸ªæ–°çš„Stringå¯¹è±¡ã€‚</a> </p>
</blockquote>
<p><img src="https://raw.githubusercontent.com/ttdevs/ttdevs.github.io/common/images/logo.png" alt="Create by ttdevs"></p>
]]></content>
      
        <categories>
            
            <category> æŠ€æœ¯ </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Java </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[ã€ŒJavaã€NumberFormatExceptionä¹‹InvalidFloatåˆ†æ]]></title>
      <url>/1970/01/01/%5BJava%5DNumberFormatException%E4%B9%8BInvalidFloat%E5%88%86%E6%9E%90/</url>
      <content type="html"><![CDATA[<h2 id="0x00-é—®é¢˜"><a href="/1970/01/01/[Java]NumberFormatExceptionä¹‹InvalidFloatåˆ†æ/#0x00-é—®é¢˜" class="headerlink" title="0x00 é—®é¢˜"></a>0x00 é—®é¢˜</h2><p>æ–°ç‰ˆæœ¬ä¸Šçº¿ï¼Œ4å¤©æ—¶é—´ä¸€ä¸ªé”™è¯¯å‡ºç°ä¸€ç™¾å¤šæ¬¡ï¼Œå¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">java.lang.NumberFormatException: Invalid <span class="keyword">float</span>: <span class="string">"55,4"</span></div><div class="line">	at java.lang.StringToReal.invalidReal(StringToReal.java:<span class="number">63</span>)</div><div class="line">	at java.lang.StringToReal.initialParse(StringToReal.java:<span class="number">164</span>)</div><div class="line">	at java.lang.StringToReal.parseFloat(StringToReal.java:<span class="number">323</span>)</div><div class="line">	at java.lang.Float.parseFloat(Float.java:<span class="number">306</span>)</div></pre></td></tr></table></figure>
<h2 id="0x01-åˆ†æ"><a href="/1970/01/01/[Java]NumberFormatExceptionä¹‹InvalidFloatåˆ†æ/#0x01-åˆ†æ" class="headerlink" title="0x01 åˆ†æ"></a>0x01 åˆ†æ</h2><p>å‘ç°æ­¤é—®é¢˜åæ„Ÿè§‰å¾ˆç†Ÿæ‚‰ï¼Œä»¥å‰åº”è¯¥æ˜¯è§è¿‡ï¼Œä½†æ˜¯å¿˜è®°æ€ä¹ˆè§£å†³çš„äº†ï¼Œæ²¡åŠæ³•ï¼Œè¸©è¿‡çš„å‘å†è¸©ä¸€éã€‚æ¶‰åŠçš„ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">OnePreference</span></span>&#123;</div><div class="line">    ...</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">setLatestWeight</span><span class="params">(<span class="keyword">float</span> weight)</span> </span>&#123;</div><div class="line">       getInstance(MyApplication.getContext()).putFloat(PREFS_LATEST_WEIGHT, Float.parseFloat(NumberUtils.formatFloatWithOneDot(weight)));</div><div class="line">    &#125;</div><div class="line">    ...</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">NumberUtils</span> </span>&#123;</div><div class="line">    ...</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">formatFloatWithOneDot</span><span class="params">(<span class="keyword">float</span> number)</span> </span>&#123;</div><div class="line">        number = Math.round(number * <span class="number">10</span>) / <span class="number">10f</span>;</div><div class="line">        <span class="keyword">return</span> String.format(<span class="string">"%.1f"</span>, number);</div><div class="line">    &#125;</div><div class="line">    ...</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li><p>ç¡®è®¤é—®é¢˜</p>
<p>  androidæ— æ³•å¤ç°ï¼ŒiOSåå°æœªæŠ¥æ­¤é”™è¯¯</p>
</li>
<li><p>æ€€ç–‘æ˜¯æ•°æ®çš„é—®é¢˜</p>
<p>  è¿™æ˜¯ä¸€ä¸ªè®°å½•ä½“é‡çš„åŠŸèƒ½ï¼Œæ–°ç‰ˆä½“é‡è¾“å…¥å·²ç»åšäº†é™åˆ¶ï¼Œæ‰€ä»¥æ€€ç–‘å¯èƒ½æ˜¯è€æ•°æ®çš„é—®é¢˜ã€‚å› æ­¤æ‰¾åç«¯çš„åŒäº‹é™æ­¤æ•°æ®åšå¤„ç†ï¼šå¦‚æœæ­¤å­—æ®µæ— æ³•è§£æä¸ºæ•°å­—åˆ™è¿‡æ»¤æ‰ã€‚<br>  ä½†æ˜¯é—æ†¾çš„ï¼Œåç«¯å‘å¸ƒä¹‹åé—®é¢˜ä¾ç„¶å­˜åœ¨ã€‚</p>
</li>
<li><p>åˆ†æä»£ç </p>
<p>  <code>setLatestWeight(float weight)</code> è¿™ä¸ªä¼ å…¥çš„æ˜¯floatï¼Œæ‰€ä»¥ä¹‹å‰çš„å‡è®¾æ˜¯é”™è¯¯çš„ â€”â€” å¦‚æœæ˜¯æ•°æ®çš„é—®é¢˜ï¼Œé‚£æ ¹æœ¬èµ°ä¸åˆ°æ–¹æ³•é‡Œã€‚<br>  è¿™æ ·çš„è¯é‚£å°±æ˜¯ <code>formatFloatWithOneDot(float number)</code> è¿™ä¸ªæ–¹æ³•çš„é—®é¢˜ï¼Œä½†æ˜¯æƒ³äº†ä¸‹ä¹‹å‰éƒ½æœ‰è¿™ä¹ˆå†™è¿‡ â€”â€” å°†floatç±»å‹æ ¼å¼åŒ–ä¸ºä¸€ä½å°æ•°çš„å­—ç¬¦ä¸²ï¼Œåº”è¯¥æ²¡é—®é¢˜å•Šã€‚é‚£ä¼šæ˜¯æ€æ ·å‘¢ï¼Ÿå¯èƒ½å¾ˆè‡ªç„¶ä¼šæƒ³åˆ°å›½é™…åŒ–çš„é—®é¢˜ã€‚é‚ä½œäº†ä¸€ä¸ªç®€å•çš„æµ‹è¯•ï¼š</p>
  <figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ExampleUnitTest</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="meta">@Test</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testStringLocale</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</div><div class="line">        Locale[] locales = <span class="keyword">new</span> Locale[]&#123;</div><div class="line">                Locale.CANADA,</div><div class="line">                Locale.CANADA_FRENCH,</div><div class="line">                Locale.CHINESE,</div><div class="line">                Locale.ENGLISH,</div><div class="line">                Locale.FRANCE,</div><div class="line">                Locale.GERMAN,</div><div class="line">                Locale.GERMANY,</div><div class="line">                Locale.ITALIAN,</div><div class="line">                Locale.ITALY,</div><div class="line">                Locale.JAPAN,</div><div class="line">                Locale.JAPANESE,</div><div class="line">                Locale.KOREA,</div><div class="line">                Locale.KOREAN,</div><div class="line">                Locale.PRC,</div><div class="line">                Locale.ROOT,</div><div class="line">                Locale.SIMPLIFIED_CHINESE,</div><div class="line">                Locale.TAIWAN,</div><div class="line">                Locale.TRADITIONAL_CHINESE,</div><div class="line">                Locale.UK,</div><div class="line">                Locale.US</div><div class="line">        &#125;;</div><div class="line"></div><div class="line">        String weightString = <span class="keyword">null</span>;</div><div class="line">        <span class="keyword">for</span> (Locale locale : locales) &#123;</div><div class="line">            <span class="keyword">try</span> &#123;</div><div class="line">                weightString = formatFloatWithOneDot(locale, <span class="number">55.4f</span>);</div><div class="line">                <span class="keyword">float</span> weight = Float.parseFloat(weightString);</div><div class="line">            &#125; <span class="keyword">catch</span> (NumberFormatException e) &#123;</div><div class="line">                System.out.println(locale + <span class="string">"&gt;&gt;&gt;&gt;&gt;"</span> + weightString + <span class="string">"&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; error"</span>);</div><div class="line">                <span class="keyword">continue</span>;</div><div class="line">            &#125;</div><div class="line">            System.out.println(locale + <span class="string">"&gt;&gt;&gt;&gt;&gt;"</span> + weightString);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">formatFloatWithOneDot</span><span class="params">(Locale locale, <span class="keyword">float</span> number)</span> </span>&#123;</div><div class="line">        number = Math.round(number * <span class="number">10</span>) / <span class="number">10f</span>;</div><div class="line">        <span class="keyword">return</span> String.format(locale, <span class="string">"%.1f"</span>, number);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ul>
<pre><code>è¾“å‡ºç»“æœå¦‚ä¸‹ï¼š

<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">en_CA&gt;&gt;&gt;&gt;&gt;55.4</div><div class="line">fr_CA&gt;&gt;&gt;&gt;&gt;55,4&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; error</div><div class="line">zh&gt;&gt;&gt;&gt;&gt;55.4</div><div class="line">en&gt;&gt;&gt;&gt;&gt;55.4</div><div class="line">fr_FR&gt;&gt;&gt;&gt;&gt;55,4&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; error</div><div class="line">de&gt;&gt;&gt;&gt;&gt;55,4&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; error</div><div class="line">de_DE&gt;&gt;&gt;&gt;&gt;55,4&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; error</div><div class="line">it&gt;&gt;&gt;&gt;&gt;55,4&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; error</div><div class="line">it_IT&gt;&gt;&gt;&gt;&gt;55,4&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; error</div><div class="line">ja_JP&gt;&gt;&gt;&gt;&gt;55.4</div><div class="line">ja&gt;&gt;&gt;&gt;&gt;55.4</div><div class="line">ko_KR&gt;&gt;&gt;&gt;&gt;55.4</div><div class="line">ko&gt;&gt;&gt;&gt;&gt;55.4</div><div class="line">zh_CN&gt;&gt;&gt;&gt;&gt;55.4</div><div class="line">&gt;&gt;&gt;&gt;&gt;55.4</div><div class="line">zh_CN&gt;&gt;&gt;&gt;&gt;55.4</div><div class="line">zh_TW&gt;&gt;&gt;&gt;&gt;55.4</div><div class="line">zh_TW&gt;&gt;&gt;&gt;&gt;55.4</div><div class="line">en_GB&gt;&gt;&gt;&gt;&gt;55.4</div><div class="line">en_US&gt;&gt;&gt;&gt;&gt;55.4</div><div class="line"></div><div class="line">Process finished with exit code 0</div></pre></td></tr></table></figure>


æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œåœ¨ä¸åŒçš„è¯­è¨€ä¸‹ `String.format(locale, &quot;%.1f&quot;, number)` æ ¼å¼åŒ–çš„ç»“æœæ˜¯ä¸ä¸€æ ·çš„ï¼Œ55.4å¯èƒ½ä¼šè¢«æ ¼å¼åŒ–ä¸º55,4ï¼Œç„¶åå°±å‡ºç°äº†ä¸Šé¢çš„é”™è¯¯ã€‚å°†æˆ‘ä»¬çš„æµ‹è¯•æœºè¯­è¨€è®¾ç½®æˆå‡ºé”™çš„è¯­è¨€ï¼Œé—®é¢˜å¯ä»¥å¤ç°ã€‚

å†æ¥çœ‹ä¸‹åå°çš„é”™è¯¯ï¼š

![é”™è¯¯ä¿¡æ¯]()

- å¤§éƒ¨åˆ†æ˜¯åä¸ºçš„è®¾å¤‡ï¼Œç„¶åæ˜¯ä¸‰æ˜Ÿï¼Œç´¢å°¼
- å„ä¸ªç‰ˆæœ¬éƒ½æœ‰ï¼Œä»4.4åˆ°æœ€æ–°çš„7.0
- ä¸åŒçš„æ¸ é“éƒ½æœ‰ï¼Œä¸»è¦çš„æ¸ é“æ¥è‡ªåä¸º

è¿™äº›ä¿¡æ¯ä¹Ÿä»ä¾§é¢åæ˜ äº†é—®é¢˜çš„åŸå› ã€‚çœ‹æ¥åä¸ºçš„å›½é™…åŒ–ä¹‹è·¯è¿˜æ˜¯å¾ˆå±Œçš„ã€‚
</code></pre><h2 id="0x02-è§£å†³"><a href="/1970/01/01/[Java]NumberFormatExceptionä¹‹InvalidFloatåˆ†æ/#0x02-è§£å†³" class="headerlink" title="0x02 è§£å†³"></a>0x02 è§£å†³</h2><ul>
<li><p>ç”±äºæˆ‘ä»¬å¹¶æ²¡æœ‰åšå›½é™…åŒ–çš„é€‚é…ï¼Œå› æ­¤è¿™é‡Œæ”¹èµ·æ¥è¿˜æ˜¯å¾ˆæ–¹ä¾¿çš„ï¼Œç›´æ¥ç»™ <code>String.format()</code> æ–¹æ³•æŒ‡å®šLocaleä¿¡æ¯ï¼š</p>
<p>  <code>String.format(Locale.ENGLISH, &quot;%.1f&quot;, number);</code></p>
<p>  or</p>
<p>  <code>String.format(Locale.CHINA, &quot;%.1f&quot;, number);</code>        </p>
</li>
<li><p>NumberFormat(DecimalFormat)</p>
</li>
</ul>
<p><img src="https://raw.githubusercontent.com/ttdevs/ttdevs.github.io/common/images/logo.png" alt="Create by ttdevs"></p>
]]></content>
      
        <categories>
            
            <category> æŠ€æœ¯ </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Java </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[ã€ŒRetrofitã€0x00åˆæ¢]]></title>
      <url>/1970/01/01/%5BRetrofit%5D0x00%E5%88%9D%E6%8E%A2/</url>
      <content type="html"><![CDATA[<h2 id="0x00-Retrofit"><a href="/1970/01/01/[Retrofit]0x00åˆæ¢/#0x00-Retrofit" class="headerlink" title="0x00 Retrofit"></a>0x00 Retrofit</h2><p>å¾ˆä¹…ä»¥å‰å°±è®¡åˆ’è¦ç ”ç©¶ä¸€ä¸‹ï¼Œä½†æ˜¯ä¸€ç›´æ‹–åˆ°ç°åœ¨ï¼Œä¸çŸ¥é“æ˜¯å› ä¸ºä¼˜å…ˆçº§æ”¾çš„æ¯”è¾ƒä½è¿˜æ˜¯å› ä¸ºæ‹–å»¶ç—‡ã€‚æ€»åªï¼Œç°åœ¨è¦å®Œæ•´çš„çœ‹ä¸€éã€‚</p>
<p>ç”±äºè¿™ä¸ªå·²ç»å‡ºæ¥å¾ˆä¹…äº†ï¼Œæ‰€ä»¥æˆ‘å°±ç›´æ¥é€‰æ‹©äº†Refrofit2ï¼Œæ²¡æœ‰å»å…³æ³¨Refrofit1ï¼Œç­‰çœ‹å®ŒRefrofit2æœ‰æ—¶é—´çš„è¯å†å»çœ‹çœ‹Refrofit1ï¼Œçœ‹çœ‹å®ƒä»¬çš„å˜è¿ã€‚å¥½äº†ï¼Œå…ˆä»Refrofit2å¼€å§‹å§ã€‚</p>
<h2 id="0x01-ç®€ä»‹"><a href="/1970/01/01/[Retrofit]0x00åˆæ¢/#0x01-ç®€ä»‹" class="headerlink" title="0x01 ç®€ä»‹"></a>0x01 ç®€ä»‹</h2><h3 id="ç®€ä»‹"><a href="/1970/01/01/[Retrofit]0x00åˆæ¢/#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h3><p>å¦‚æœä½ æ¥è§¦Androidæ—¶é—´æ¯”è¾ƒé•¿ï¼Œä»æœ€åˆçš„è‡ªå·±å°è£…çº¿ç¨‹ï¼Œåˆ°ä½¿ç”¨å¼‚æ­¥ä»»åŠ¡ï¼Œåˆ°å¼€æºçš„å„ç§ç¬¬ä¸‰æ–¹ç½‘ç»œè¯·æ±‚æ¡†æ¶å¦‚xUtilsï¼Œåˆ°è°·æ­Œçš„Volleyï¼Œandroideræ€»åœ¨æ¢ç´¢ä¸€ç§æ›´å¥½çš„ç½‘ç»œè¯·æ±‚å½¢å¼ã€‚Retrofitå°±æ˜¯è¿™æ ·çš„ä¸€æ¬¾äº§å“ã€‚</p>
<p>PSï¼šä»ä¸Šé¢ä¸€å¥è¯ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥çœ‹åˆ°ï¼Œandroidç”Ÿæ€åœ¨ä¸æ–­çš„è¿›æ­¥å’Œå®Œå–„ï½ï½</p>
<h3 id="å¼•å…¥"><a href="/1970/01/01/[Retrofit]0x00åˆæ¢/#å¼•å…¥" class="headerlink" title="å¼•å…¥"></a>å¼•å…¥</h3><p>ä¸¤ä¸ªé—®é¢˜ï¼Œgradleå’Œæ··æ·†ï¼š</p>
<ul>
<li><p>Gradleï¼š</p>
<ul>
<li>Retrofitï¼š <code>compile &#39;com.squareup.retrofit2:retrofit:2.1.0&#39;</code></li>
<li>JSONè§£æå™¨ï¼š <code>compile &#39;com.squareup.retrofit2:converter-gson:2.1.0&#39;</code></li>
</ul>
</li>
<li><p>Proguardï¼š</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div></pre></td><td class="code"><pre><div class="line">-dontwarn retrofit2.**</div><div class="line">-keep class retrofit2.** &#123; *; &#125;</div><div class="line">-keepattributes Signature</div><div class="line">-keepattributes Exceptions</div><div class="line">	``` </div><div class="line"></div><div class="line"></div><div class="line">## 0x02 ä»ä¸€ä¸ªdemoå¼€å§‹</div><div class="line"></div><div class="line">``` java </div><div class="line">public class ExampleUnitTest &#123;</div><div class="line">    @Test</div><div class="line">    public void test_retrofit() throws Exception&#123;</div><div class="line">        String url = &quot;http://api.github.com/&quot;;</div><div class="line">        OkHttpClient client = new OkHttpClient.Builder()</div><div class="line">                .build();</div><div class="line">        Retrofit.Builder builder = new Retrofit.Builder()</div><div class="line">                .client(client)</div><div class="line">                .baseUrl(url)</div><div class="line">                .addConverterFactory(GsonConverterFactory.create());</div><div class="line">        Retrofit retrofit = builder.build();</div><div class="line">        GitHubService github = retrofit.create(GitHubService.class);</div><div class="line">        Call&lt;User&gt; ttdevs = github.userInfo(&quot;ttdevs&quot;);</div><div class="line"></div><div class="line">        final CountDownLatch countDownLatch = new CountDownLatch(1);</div><div class="line">        ttdevs.enqueue(new Callback&lt;User&gt;() &#123;</div><div class="line">            @Override</div><div class="line">            public void onResponse(Call&lt;User&gt; call, Response&lt;User&gt; response) &#123;</div><div class="line">                User ttdevs = response.body();</div><div class="line">                </div><div class="line">                String message = String.format(</div><div class="line">                        &quot;I&apos;m %s.\n%s&quot;, </div><div class="line">                        ttdevs.getName(), </div><div class="line">                        ttdevs.getHtml_url());</div><div class="line">                System.out.println(message);</div><div class="line"></div><div class="line">                countDownLatch.countDown();</div><div class="line">            &#125;</div><div class="line"></div><div class="line">            @Override</div><div class="line">            public void onFailure(Call&lt;User&gt; call, Throwable t) &#123;</div><div class="line">                countDownLatch.countDown();</div><div class="line">            &#125;</div><div class="line">        &#125;);</div><div class="line">        countDownLatch.await();</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="0x03-ç¬¬ä¸€ä¸ªé—®é¢˜ï¼šHeader"><a href="/1970/01/01/[Retrofit]0x00åˆæ¢/#0x03-ç¬¬ä¸€ä¸ªé—®é¢˜ï¼šHeader" class="headerlink" title="0x03 ç¬¬ä¸€ä¸ªé—®é¢˜ï¼šHeader"></a>0x03 ç¬¬ä¸€ä¸ªé—®é¢˜ï¼šHeader</h2><p>æ‰§è¡Œä¸Šé¢çš„å°demoï¼Œæˆ‘ä»¬é€šè¿‡æŠ“åŒ…å‘ç°å®ƒçš„headerä¿¡æ¯å¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">Host: api.github.com:443</div><div class="line">Proxy-Connection: Keep-Alive</div><div class="line">User-Agent: okhttp/3.3.0</div></pre></td></tr></table></figure>
<p>è¿™ä¸ªheaderä¿¡æ¯æ˜¯ä¸æ˜¯å¾ˆç®€å•ï¼Œå¦‚æœä½ ç”¨è¿™æ ·çš„è¯·æ±‚å»å†™çˆ¬è™«çš„è¯ï¼Œå¤šæ•°æƒ…å†µä¸‹æ˜¯å¾—ä¸åˆ°ç»“æœçš„ã€‚è€Œå®é™…æƒ…å†µä¹Ÿæ˜¯ï¼šæˆ‘ä»¬éœ€è¦åœ¨headerä¸­ä½¿ç”¨æ ‡å‡†httpå¤´ä¿¡æ¯ï¼Œä¹Ÿå¯èƒ½éœ€è¦åŠ å…¥è‡ªå®šä¹‰çš„å¤´ä¿¡æ¯ï¼Œæ¯”å¦‚tokenç­‰ã€‚Retrofit2æ²¡æœ‰ç›´æ¥ç»™ä»–ä»¬æä¾›è¿™æ ·çš„æ–¹æ³•ï¼Œä½†æ˜¯æˆ‘ä»¬çŸ¥é“ï¼ŒRetrofit2ç”¨çš„æ˜¯Okhttp3ï¼Œå› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥ä»Okhttp3ä¸­ä¸‹æ‰‹ï¼Œä»£ç å¦‚ä¸‹ï¼š</p>
<ul>
<li><p>åˆ›å»º <code>HeadersInterceptor</code> ç±»ï¼Œä»£ç å¦‚ä¸‹ï¼š</p>
  <figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HeadersInterceptor</span> <span class="keyword">implements</span> <span class="title">Interceptor</span> </span>&#123;</div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> Response <span class="title">intercept</span><span class="params">(Chain chain)</span> <span class="keyword">throws</span> IOException </span>&#123;</div><div class="line">        Request original = chain.request();</div><div class="line"></div><div class="line">        Request request = original.newBuilder()</div><div class="line">                .header(<span class="string">"User-Agent"</span>, <span class="string">"ttdevs"</span>)</div><div class="line">                .header(<span class="string">"Content-Type"</span>, <span class="string">"application/json; charset=utf-8"</span>)</div><div class="line">                .header(<span class="string">"Accept"</span>, <span class="string">"application/json"</span>)</div><div class="line">                .header(<span class="string">"token"</span>, <span class="string">"abcdefg_ttdevs_hijklmn"</span>)</div><div class="line">                .header(<span class="string">"user_key"</span>, <span class="string">"ttdevs"</span>)</div><div class="line">                .method(original.method(), original.body())</div><div class="line">                .build();</div><div class="line"></div><div class="line"></div><div class="line">        <span class="keyword">long</span> t1 = System.nanoTime();</div><div class="line">        String requestHeader = String.format(<span class="string">"&gt;&gt;&gt;&gt;&gt;Sending request %s on %s%n%s"</span>,</div><div class="line">                request.url(), chain.connection(), request.headers())</div><div class="line">        System.out.println(requestHeader);</div><div class="line"></div><div class="line">        Response response = chain.proceed(request);</div><div class="line"></div><div class="line">        <span class="keyword">long</span> t2 = System.nanoTime();</div><div class="line">        System.out.println(String.format(<span class="string">"&gt;&gt;&gt;&gt;&gt;Received response for %s in %.1fms%n%s"</span>,</div><div class="line">                response.request().url(), (t2 - t1) / <span class="number">1e6</span>d, response.headers()));</div><div class="line"></div><div class="line">        System.out.println(<span class="string">"====================================================="</span>);</div><div class="line">        <span class="keyword">return</span> response;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>åœ¨ <code>Okhttp</code> ä¸­åŠ å…¥ <code>HeadersInterceptor</code></p>
  <figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">String url = <span class="string">"http://api.github.com/"</span>;</div><div class="line">OkHttpClient client = <span class="keyword">new</span> OkHttpClient.Builder()</div><div class="line">        .addInterceptor(<span class="keyword">new</span> HeadersInterceptor())</div><div class="line">        .build();</div><div class="line">Retrofit.Builder builder = <span class="keyword">new</span> Retrofit.Builder()</div><div class="line">        .client(client)</div><div class="line">        .baseUrl(url)</div><div class="line">        .addConverterFactory(GsonConverterFactory.create());</div><div class="line">Retrofit retrofit = builder.build();</div><div class="line">GitHubService github = retrofit.create(GitHubService.class);</div><div class="line">Call&lt;User&gt; ttdevs = github.userInfo(<span class="string">"ttdevs"</span>);</div></pre></td></tr></table></figure>
</li>
</ul>
<p>è¿™æ ·åœ¨è¿è¡Œä¸Šé¢çš„ä»£ç ï¼Œæˆ‘ä»¬å°±å¯ä»¥åœ¨ Http è¯·æ±‚çš„ Header ä¸­çœ‹åˆ°æˆ‘ä»¬åŠ å…¥çš„ä¿¡æ¯äº†ã€‚</p>
<p>æºç å‚è€ƒï¼š<a href="https://github.com/ttdevs/android/tree/master/modules/retrofit" target="_blank" rel="external">ttdevs</a></p>
<h2 id="0xFF-å‚è€ƒ"><a href="/1970/01/01/[Retrofit]0x00åˆæ¢/#0xFF-å‚è€ƒ" class="headerlink" title="0xFF å‚è€ƒ"></a>0xFF å‚è€ƒ</h2><ol>
<li><a href="https://github.com/square/retrofit" target="_blank" rel="external">https://github.com/square/retrofit</a></li>
<li><a href="http://square.github.io/retrofit/" target="_blank" rel="external">http://square.github.io/retrofit/</a></li>
<li><a href="https://futurestud.io/blog/retrofit-add-custom-request-header" target="_blank" rel="external">https://futurestud.io/blog/retrofit-add-custom-request-header</a></li>
</ol>
<p><img src="https://raw.githubusercontent.com/ttdevs/ttdevs.github.io/common/images/logo.png" alt="Create by ttdevs"></p>
]]></content>
      
        <categories>
            
            <category> æŠ€æœ¯ </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Retrofit </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[ã€ŒVolleyã€0x04ä¸€äº›ç»†èŠ‚]]></title>
      <url>/1970/01/01/%5BVolley%5D0x04%E4%B8%80%E4%BA%9B%E7%BB%86%E8%8A%82/</url>
      <content type="html"><![CDATA[<p>æœ€è¿‘åˆæŠŠvolleyæ‹¿å‡ºæ¥æ•´ç†äº†ä¸‹ã€‚ä¹‹å‰æ²¡æœ‰é‡åˆ°è¿‡çš„ä¸€äº›å°é—®é¢˜åˆæ¥äº†ï¼Œåœ¨æ­¤è®°å½•ä¸‹ï¼š</p>
<h2 id="1ã€HttpUrlConnection-DELETE-æ–¹å¼æ— æ³•æ·»åŠ bodyçš„é—®é¢˜ï¼šjava-net-ProtocolException"><a href="/1970/01/01/[Volley]0x04ä¸€äº›ç»†èŠ‚/#1ã€HttpUrlConnection-DELETE-æ–¹å¼æ— æ³•æ·»åŠ bodyçš„é—®é¢˜ï¼šjava-net-ProtocolException" class="headerlink" title="1ã€HttpUrlConnection DELETE æ–¹å¼æ— æ³•æ·»åŠ bodyçš„é—®é¢˜ï¼šjava.net.ProtocolException:"></a>1ã€HttpUrlConnection DELETE æ–¹å¼æ— æ³•æ·»åŠ bodyçš„é—®é¢˜ï¼šjava.net.ProtocolException:</h2><p>DELETE does not support writing</p>
<p>è¿™ä¸ªå¯ä»¥ç®—æ˜¯ä¸€ä¸ªç³»ç»Ÿçº§çš„bugï¼Œä¸ºä»€ä¹ˆè¿™ä¹ˆè¯´ï¼Œè¯·çœ‹è¿™é‡Œï¼Œè¿™ä¸ªé—®é¢˜åœ¨java8ä¸­æ‰å¾—ä»¥è§£å†³ã€‚æ²¡åŠæ³•ç›´æ¥è¿‡å»ï¼Œå’±å°±ç»•è¿‡å»ã€‚æŸ¥çœ‹HttpUrlConnection<br>ï¼Œæˆ‘ä»¬å‘ç°ä»–æ˜¯ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œå› æ­¤å¯ä»¥è¯•è¯•èƒ½ä¸èƒ½é€šè¿‡å®ƒçš„å…¶ä»–å®ç°æ¥è¾¾åˆ°æˆ‘ä»¬çš„ç›®çš„ã€‚æœ€ç»ˆæˆ‘ä»¬å†³å®šä½¿ç”¨ <a href="https://github.com/square/okhttp" target="_blank" rel="external"> okhttp
</a> è¿™ä¸ªå®ç°ã€‚åœ°å€ä¸ºï¼š <a href="https://github.com/square/okhttp" target="_blank" rel="external"><br>https://github.com/square/okhttp </a> ã€‚</p>
<p>æ¥ç€æˆ‘ä»¬è¿˜å¾—å»çœ‹çœ‹volleyçš„æºç ï¼Œç”±äºæˆ‘ä»¬çš„appå…¼å®¹çš„æœ€ä½ç‰ˆæœ¬æ˜¯4.0ï¼Œå› æ­¤æˆ‘ä»¬çŸ¥é“æœ€ç»ˆè°ƒç”¨çš„æ˜¯HurlStackï¼š</p>
<pre><code>    public static RequestQueue newRequestQueue(Context context, HttpStack stack) {
...
        if (stack == null) {
            if (Build.VERSION.SDK_INT &gt;= 9) {
                stack = new HurlStack();
            } else {
                // Prior to Gingerbread, HttpUrlConnection was unreliable.
                // See: http://android-developers.blogspot.com/2011/09/androids-http-clients.html
                stack = new HttpClientStack(AndroidHttpClient.newInstance(userAgent));
            }
        }
...
    }
</code></pre><p>å› æ­¤æˆ‘ä»¬åªéœ€è¦å°†HurlStackçš„ç›¸å…³ä»£ç ä¿®æ”¹å³å¯ï¼Œå¦‚ä¸‹ï¼š</p>
<p>volley.java</p>
<pre><code>public static RequestQueue newRequestQueue(Context context, HttpStack stack) {
...
        if (stack == null) {
            if (Build.VERSION.SDK_INT &gt;= 9) {
                // old way: stack = new HurlStack();
                    // http://square.github.io/okhttp/
                stack = new HurlStack(null, null, new OkUrlFactory(new OkHttpClient()));
            } else {
                // Prior to Gingerbread, HttpUrlConnection was unreliable.
                // See: http://android-developers.blogspot.com/2011/09/androids-http-clients.html
                stack = new HttpClientStack(AndroidHttpClient.newInstance(userAgent));
            }
        }
...
    }
</code></pre><p>HurlStack.java</p>
<pre><code>/**
 * An {@link HttpStack} based on {@link HttpURLConnection}.
 */
public class HurlStack implements HttpStack {

    private final OkUrlFactory mOkUrlFactory; 

    /**
     * @param urlRewriter Rewriter to use for request URLs
     * @param sslSocketFactory SSL factory to use for HTTPS connections
     * @param okUrlFactory solution delete body(https://github.com/square/okhttp)
     */
    public HurlStack(UrlRewriter urlRewriter, SSLSocketFactory sslSocketFactory, OkUrlFactory okUrlFactory) {
        mUrlRewriter = urlRewriter;
        mSslSocketFactory = sslSocketFactory;
        mOkUrlFactory = okUrlFactory;
    }
    /**
     * Create an {@link HttpURLConnection} for the specified {@code url}.
     */
    protected HttpURLConnection createConnection(URL url) throws IOException {
        if(null != mOkUrlFactory){
            return mOkUrlFactory.open(url);
        }
        return (HttpURLConnection) url.openConnection();
    }


    @SuppressWarnings(&quot;deprecation&quot;)
    /* package */ 
    static void setConnectionParametersForRequest(HttpURLConnection connection,
            Request&lt;?&gt; request) throws IOException, AuthFailureError {
        switch (request.getMethod()) {
            ...
            case Method.DELETE:
                connection.setRequestMethod(&quot;DELETE&quot;);
                addBodyIfExists(connection, request);
                break;
            ...
            default:
                throw new IllegalStateException(&quot;Unknown method type.&quot;);
        }
    }

...
}
</code></pre><p>2015-04-26æ›´æ–°ï¼š</p>
<p>å†æ¬¡ä½¿ç”¨åˆ°éœ€è¦ä½¿ç”¨åˆ°okhttpï¼Œå›å¤´çœ‹ä¸‹ä¸Šé¢çš„ä»£ç ï¼Œä¸çŸ¥é“å½“æ—¶æ€ä¹ˆæƒ³çš„ï¼Œä½¿ç”¨è¿™ä¹ˆå¤æ‚çš„æ–¹æ³•å¼•å…¥Okhttpï¼Œä¼°è®¡æ˜¯è„‘è¢‹è¿›æ°´äº†ã€‚å†æ¥çœ‹ä¸‹è¿™ä¸ªæ–¹æ³•ï¼šnewRe<br>questQueue(Context context, HttpStack<br>stack)ï¼Œæœ‰ä¸¤ä¸ªå‚æ•°ï¼šcontextå’ŒHttpStackï¼Œè¿™é‡Œæ˜¯è¦ä¼ å…¥è‡ªå·±çš„HttpStackå°±å¥½äº†ã€‚é‚£ä¹ˆæˆ‘ä»¬ç”¨OKhttpçš„å®ç°ï¼š</p>
<pre><code>/**
 * An {@link com.android.volley.toolbox.HttpStack HttpStack} implementation which
 * uses OkHttp as its transport.
 */
public class OkHttpStack extends HurlStack {
  private final OkHttpClient client;

  public OkHttpStack() {
    this(new OkHttpClient());
  }

  public OkHttpStack(OkHttpClient client) {
    if (client == null) {
      throw new NullPointerException(&quot;Client must not be null.&quot;);
    }
    this.client = client;
  }

  @Override protected HttpURLConnection createConnection(URL url) throws IOException {
    return client.open(url);
  }   
}
</code></pre><p>å‚è€ƒï¼š <a href="https://gist.github.com/JakeWharton/5616899" target="_blank" rel="external"> https://gist.github.com/JakeWharton/5616899
</a></p>
<h2 id="2ã€å…³äºï¼ˆä¿®æ”¹ï¼‰volleyçš„ç¼“å­˜"><a href="/1970/01/01/[Volley]0x04ä¸€äº›ç»†èŠ‚/#2ã€å…³äºï¼ˆä¿®æ”¹ï¼‰volleyçš„ç¼“å­˜" class="headerlink" title="2ã€å…³äºï¼ˆä¿®æ”¹ï¼‰volleyçš„ç¼“å­˜"></a>2ã€å…³äºï¼ˆä¿®æ”¹ï¼‰volleyçš„ç¼“å­˜</h2><p>volleyæœ‰å®Œæ•´çš„ä¸€å¥—ç¼“å­˜æœºåˆ¶ã€‚è€Œç›®å‰æˆ‘ä»¬æƒ³åšä¸ªç®€å•çš„éœ€æ±‚ï¼šéƒ¨åˆ†ç•Œé¢ï¼ˆå‡ ä¹ä¸ä¼šæ”¹åŠ¨çš„ï¼‰ç®€å•çš„åšä¸€å®šæ—¶é—´çš„ç¼“å­˜ï¼Œç ”ç©¶äº†ä¸‹ä»£ç å‘ç°å¾ˆå®¹æ˜“ä¿®æ”¹è¾¾åˆ°è‡ªå·±çš„ç›®çš„ï¼ˆæœ‰<br>æ—¶é—´åœ¨åˆ†æä¸‹volleyçš„ç¼“å­˜æœºåˆ¶ï¼Œè¿™ä¸ªä¸€å®šè¦åšï¼‰ã€‚ç®€å•æ¥è¯´ä¿®æ”¹ä¸€ä¸ªåœ°æ–¹ï¼šrequest.  parseNetworkResponseä¸­çš„</p>
<p>HttpHeaderParserï¼ˆæ­¤å¤„çªç„¶æ„Ÿæ…¨volleyçš„è®¾è®¡TMDçµæ´»äº†ï¼Œæƒ³æ€ä¹ˆæ”¹å°±æ€ä¹ˆæ”¹ï¼‰ã€‚  HttpHeaderParserä¿®æ”¹åçš„ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code>/**
 * ä¿®æ”¹åçš„ï¼Œç”¨æˆ·å¤„ç†ç¼“å­˜
 */
public class BHHttpHeaderParser {

    /**
     * Extracts a {@link Cache.Entry} from a {@link NetworkResponse}.
     *
     * @param response The network response to parse headers from
     * @return a cache entry for the given response, or null if the response is not cacheable.
     */
    public static Cache.Entry parseCacheHeaders(NetworkResponse response, boolean isCustomCache) {
...
        if(isCustomCache){
                softExpire = now + Config.HTTP_CACHE_TTL;
        } else {
                if (hasCacheControl) {
                softExpire = now + maxAge * 1000;
            } else if (serverDate &gt; 0 &amp;&amp; serverExpires &gt;= serverDate) {
                // Default semantic for Expire header in HTTP specification is softExpire.
                softExpire = now + (serverExpires - serverDate);
            }
        }

        Cache.Entry entry = new Cache.Entry();
        entry.data = response.data;
        entry.etag = serverEtag;
        entry.softTtl = softExpire;
        entry.ttl = entry.softTtl;
        entry.serverDate = serverDate;
        entry.responseHeaders = headers;

        return entry;
    }
...
}
</code></pre><p>æ­¤å¤„å¤§å®¶å¯ä»¥å‘ç°ï¼Œæˆ‘ä»¬ä¸»è¦æ˜¯æ ¹æ®è‡ªå®šä¹‰çš„å˜é‡å†³å®šå¦‚ä½•ä¿®æ”¹cacheçš„TTLæ¥è¾¾åˆ°è‡ªå·±çš„ç›®çš„ã€‚</p>
<h1 id="3ã€HttpUrlConnectionä¸PATCHï¼ˆ2015-04-26ï¼‰"><a href="/1970/01/01/[Volley]0x04ä¸€äº›ç»†èŠ‚/#3ã€HttpUrlConnectionä¸PATCHï¼ˆ2015-04-26ï¼‰" class="headerlink" title="3ã€HttpUrlConnectionä¸PATCHï¼ˆ2015-04-26ï¼‰"></a>3ã€HttpUrlConnectionä¸PATCHï¼ˆ2015-04-26ï¼‰</h1><p>åœ¨ä½¿ç”¨Volleyå‘é€PATCHè¯·æ±‚çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šé‡åˆ°è¿™æ ·çš„é—®é¢˜ï¼šUnknown method â€˜PATCHâ€™; must be one of<br>[OPTIONS, GET, HEAD, POST, PUT, DELETE, TRACE]ã€‚è¿™ä¸ªæ—¶å€™ä½ çš„ç¬¬ä¸€ååº”æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿæ˜¯Volleyä¸æ”¯æŒPATCHè¯·<br>æ±‚å—ï¼Ÿæ¢æˆOkHttpæ˜¯ä¸æ˜¯å¯ä»¥å‘¢ï¼ŸæŸ¥çœ‹äº†ä¸‹Volleyçš„æºç ï¼Œåœ¨HurlHttp.javaä¸­å‘ç°å¦‚ä¸‹ä¸€æ®µï¼š</p>
<pre><code>/* package */ 
static void setConnectionParametersForRequest(HttpURLConnection connection,
            Request&lt;?&gt; request) throws IOException, AuthFailureError {
        switch (request.getMethod()) {
            case Method.DEPRECATED_GET_OR_POST:
                // This is the deprecated way that needs to be handled for backwards compatibility.
                // If the request&apos;s post body is null, then the assumption is that the request is
                // GET.  Otherwise, it is assumed that the request is a POST.
                byte[] postBody = request.getPostBody();
                if (postBody != null) {
                    // Prepare output. There is no need to set Content-Length explicitly,
                    // since this is handled by HttpURLConnection using the size of the prepared
                    // output stream.
                    connection.setDoOutput(true);
                    connection.setRequestMethod(&quot;POST&quot;);
                    connection.addRequestProperty(HEADER_CONTENT_TYPE,
                            request.getPostBodyContentType());
                    DataOutputStream out = new DataOutputStream(connection.getOutputStream());
                    out.write(postBody);
                    out.close();
                }
                break;
            case Method.GET:
                // Not necessary to set the request method because connection defaults to GET but
                // being explicit here.
                connection.setRequestMethod(&quot;GET&quot;);
                break;
            case Method.DELETE:
                connection.setRequestMethod(&quot;DELETE&quot;);
                break;
            case Method.POST:
                connection.setRequestMethod(&quot;POST&quot;);
                addBodyIfExists(connection, request);
                break;
            case Method.PUT:
                connection.setRequestMethod(&quot;PUT&quot;);
                addBodyIfExists(connection, request);
                break;
            case Method.HEAD:
                connection.setRequestMethod(&quot;HEAD&quot;);
                break;
            case Method.OPTIONS:
                connection.setRequestMethod(&quot;OPTIONS&quot;);
                break;
            case Method.TRACE:
                connection.setRequestMethod(&quot;TRACE&quot;);
                break;
            case Method.PATCH:
                connection.setRequestMethod(&quot;PATCH&quot;);
                addBodyIfExists(connection, request);
                break;
            default:
                throw new IllegalStateException(&quot;Unknown method type.&quot;);
        }
    }
</code></pre><p>é€šè¿‡è¿™æ®µä»£ç ï¼Œæˆ‘ä»¬çŸ¥é“ï¼ŒVolleyå¯¹PATCHè¿˜æ˜¯æ”¯æŒçš„ã€‚åœ¨ç»†çœ‹ä¸‹é”™è¯¯è¿™ä¸ªæ˜¯æœ‰HttpUrlConnectionæŠ›å‡ºçš„ã€‚å› æ­¤æˆ‘ä»¬éœ€è¦åœ¨è¿™æ–¹é¢ä¸‹æ‰‹ã€‚è¿™é‡Œæœ‰ä¸€<br>ä¸ªå‚è€ƒï¼š</p>
<p><a href="https://github.com/adriancole/retrofit/commit/e704b800878b2e37f5a
c98b0139cb4994618ace0" target="_blank" rel="external"> https://github.com/adriancole/retrofit/commit/e704b800878b2e37f5ac98b0139cb4<br>994618ace0 </a>  </p>
<p>ä»¥åæœ‰å…¶ä»–å…³äºvolleyçš„æ€»ç»“éƒ½è®°å½•åœ¨æ­¤ã€‚  </p>
]]></content>
      
        <categories>
            
            <category> æŠ€æœ¯ </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Volley </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[ã€ŒWechatã€å¾®ä¿¡å…¬ä¼—å·å¼€å‘æµç¨‹]]></title>
      <url>/1970/01/01/%5BWechat%5D%E5%BE%AE%E4%BF%A1%E5%85%AC%E4%BC%97%E5%8F%B7%E5%BC%80%E5%8F%91%E6%B5%81%E7%A8%8B/</url>
      <content type="html"><![CDATA[<h2 id="0x01ç”³è¯·è®¢é˜…å·æˆ–è€…æœåŠ¡å·"><a href="/1970/01/01/[Wechat]å¾®ä¿¡å…¬ä¼—å·å¼€å‘æµç¨‹/#0x01ç”³è¯·è®¢é˜…å·æˆ–è€…æœåŠ¡å·" class="headerlink" title="0x01ç”³è¯·è®¢é˜…å·æˆ–è€…æœåŠ¡å·"></a>0x01ç”³è¯·è®¢é˜…å·æˆ–è€…æœåŠ¡å·</h2><p>å¾®ä¿¡æœ‰ä¸‰ç§å·ï¼šè®¢é˜…å·ï¼Œå…¬ä¼—å·ï¼ŒæœåŠ¡å·ï¼Œæ‰€æœ‰äººéƒ½å¯ä»¥æ³¨å†Œè®¢é˜…å·ï¼Œä¸ªäººå¾ˆéš¾æ³¨å†Œå…¬ä¼—å·å’ŒæœåŠ¡å·ï¼›è®¢é˜…å·ä¸èƒ½è®¤è¯ï¼Œå¼€æ”¾çš„æ¥å£ä¹Ÿæ˜¯æœ€å°‘çš„ã€‚æ—¢ç„¶åšå¼€å‘ï¼Œè¿™ç§è‚¯å®šä¸å¥½ä½¿ã€‚å› æ­¤æˆ‘ä»¬éœ€è¦é€‰æ‹©è®¢é˜…å·æˆ–è€…æœåŠ¡å·æ¥åšå¼€å‘ã€‚è‡ªå·±æ²¡åŠæ³•æ³¨å†Œï¼Œå¯ä»¥è€ƒè™‘ä¸‡èƒ½çš„æ·˜å®ã€‚æˆ–è€…æˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨<a href="http://mp.weixin.qq.com/debug/cgi-bin/sandbox?t=sandbox/login" target="_blank" rel="external">æµ‹è¯•è´¦å·</a></p>
<h2 id="0x02-æœåŠ¡å™¨åŠŸèƒ½å¼€å‘"><a href="/1970/01/01/[Wechat]å¾®ä¿¡å…¬ä¼—å·å¼€å‘æµç¨‹/#0x02-æœåŠ¡å™¨åŠŸèƒ½å¼€å‘" class="headerlink" title="0x02 æœåŠ¡å™¨åŠŸèƒ½å¼€å‘"></a>0x02 æœåŠ¡å™¨åŠŸèƒ½å¼€å‘</h2><h3 id="é…ç½®è‡ªå·±çš„æœåŠ¡å™¨"><a href="/1970/01/01/[Wechat]å¾®ä¿¡å…¬ä¼—å·å¼€å‘æµç¨‹/#é…ç½®è‡ªå·±çš„æœåŠ¡å™¨" class="headerlink" title="é…ç½®è‡ªå·±çš„æœåŠ¡å™¨"></a>é…ç½®è‡ªå·±çš„æœåŠ¡å™¨</h3><p>åœ¨å¼€å‘ä¹‹å‰æˆ‘ä»¬éœ€è¦è¿›è¡ŒæœåŠ¡å™¨çš„é…ç½®ï¼Œè¿™ä¸ªä¸æ¶‰åŠå…·ä½“çš„è¯­è¨€ã€‚ç™»å½•å¾®ä¿¡åå°ï¼Œåœ¨ å¼€å‘ &gt; åŸºæœ¬é…ç½® &gt; æœåŠ¡å™¨é…ç½® ä¸­è¿›è¡Œé…ç½®ã€‚è¿™é‡Œéœ€è¦é…ç½®å››ä¸ªå‚æ•°ï¼š</p>
<ul>
<li><p>URL</p>
<p>  è¿™ä¸ªæ˜¯æˆ‘ä»¬æœåŠ¡å™¨çš„åœ°å€ï¼Œå¿…é¡»æ˜¯80ç«¯å£ã€‚å¾®ä¿¡ä¼šæŠŠæ‰€æœ‰çš„äº‹ä»¶å’Œæ¶ˆæ¯ç­‰éƒ½æ¨é€åˆ°è¿™ä¸ªåœ°å€ä¸Šã€‚</p>
</li>
<li><p>Token</p>
<p>  è¿™ä¸ªTokenæ˜¯æˆ‘ä»¬åˆ†é…ç»™å¾®ä¿¡çš„</p>
</li>
<li><p>EncodingAESKey</p>
<p>  å¾®ä¿¡æ¶ˆæ¯çš„åŠ å¯†ç§˜é’¥</p>
</li>
<li><p>æ¶ˆæ¯åŠ è§£å¯†æ–¹å¼</p>
<p>  æ²¡æœ‰ç‰¹æ®Šè¦æ±‚æˆ‘ä»¬å¯ä»¥é€‰æ‹©æ˜æ–‡æ¨¡å¼</p>
</li>
</ul>
<p>æ›´å¤šä¿¡æ¯å¯ä»¥å‚è€ƒ<a href="https://mp.weixin.qq.com/wiki?t=resource/res_main&amp;id=mp1421135319&amp;token=&amp;lang=zh_CN" target="_blank" rel="external">è¿™é‡Œ</a>ã€‚</p>
<h3 id="å¾®ä¿¡æœåŠ¡å™¨éªŒè¯"><a href="/1970/01/01/[Wechat]å¾®ä¿¡å…¬ä¼—å·å¼€å‘æµç¨‹/#å¾®ä¿¡æœåŠ¡å™¨éªŒè¯" class="headerlink" title="å¾®ä¿¡æœåŠ¡å™¨éªŒè¯"></a>å¾®ä¿¡æœåŠ¡å™¨éªŒè¯</h3><p>å¦‚æœæˆ‘ä»¬ç›´æ¥é…ç½®äº†ä¸Šé¢çš„å‚æ•°ï¼Œæ˜¯æ— æ³•ä¿å­˜çš„ï¼Œåªæœ‰åœ¨æˆ‘ä»¬é…ç½®çš„åœ°å€æ­£ç¡®å¤„ç†äº†å¾®ä¿¡çš„éªŒè¯è¯·æ±‚ä¹‹åæ‰å¯ä»¥ä¿å­˜æˆåŠŸã€‚è¿‡ç¨‹æ˜¯è¿™æ ·çš„ï¼Œå¾®ä¿¡ä¼šä»¥getæ–¹å¼å‘æˆ‘ä»¬é…ç½®çš„åœ°å€å‘ä¸€ä¸ªè¯·æ±‚ï¼Œè¿™ä¸ªè¯·æ±‚å¸¦äº†éªŒè¯ä¿¡æ¯ï¼Œå’Œè¿”å›çš„å­—ç¬¦ä¸²ï¼Œä»–ä»¬åˆ†åˆ«æ˜¯ <code>signature</code>ã€ <code>timestamp</code>ã€ <code>nonce</code>ã€ <code>echostr</code>ï¼Œå‰ä¸‰ä¸ªå‚æ•°ç”¨äºéªŒè¯ï¼Œåä¸€ä¸ªç”¨äºè¿”å›å¾®ä¿¡ã€‚å¦‚æœæˆ‘ä»¬æŒ‰ç…§è§„åˆ™éªŒè¯å‚æ•°æ˜¯æ­£ç¡®çš„ï¼ˆè¿™é‡Œä¼šç”¨åˆ°æˆ‘ä»¬é…ç½®çš„Tokenï¼‰ï¼Œå°†echostrå­—æ®µçš„ä¿¡æ¯è¿”å›ï¼Œè¿™æ ·å°±å¯ä»¥ä¿å­˜äº†ã€‚å½“ç„¶ï¼Œä½ ä¹Ÿå¯ä»¥ä¸åšéªŒè¯ç›´æ¥è¿”å›echostrå‚æ•°å†…å®¹ä¹Ÿæ˜¯å¯ä»¥ï¼Œä½†æ˜¯ä¸æ¨èè¿™æ ·åšã€‚æ›´å¤šä¿¡æ¯å¯ä»¥å‚è€ƒ<a href="https://mp.weixin.qq.com/wiki?t=resource/res_main&amp;id=mp1421135319&amp;token=&amp;lang=zh_CN" target="_blank" rel="external">è¿™é‡Œ</a>ã€‚</p>
<h3 id="å¾®ä¿¡äº‹ä»¶å¤„ç†"><a href="/1970/01/01/[Wechat]å¾®ä¿¡å…¬ä¼—å·å¼€å‘æµç¨‹/#å¾®ä¿¡äº‹ä»¶å¤„ç†" class="headerlink" title="å¾®ä¿¡äº‹ä»¶å¤„ç†"></a>å¾®ä¿¡äº‹ä»¶å¤„ç†</h3><p>é…ç½®äº†ä¸Šé¢çš„å‚æ•°æˆ‘ä»¬å°±å¯ä»¥å¤„ç†å¾®ä¿¡å‘ç»™æˆ‘ä»¬çš„å„ç§ä¿¡æ¯äº†ã€‚å¾®ä¿¡æ‰€æœ‰ä¿¡æ¯éƒ½æ˜¯ä»¥POSTçš„æ–¹å¼å‘é€åˆ°æˆ‘ä»¬ä¹‹å‰é…ç½®çš„åœ°å€ä¸Šã€‚åœ¨URLå‚æ•°ä¸­ä¼šæºå¸¦å››ä¸ªå‚æ•°<code>signature</code>ã€ <code>timestamp</code>ã€ <code>nonce</code>å’Œ<code>openid</code>ï¼Œæ•°æ®éƒ¨åˆ†åœ¨bodyä¸­ã€‚æŒ‰ç…§å¾®ä¿¡çš„æ¥å£åè®®ï¼Œæˆ‘ä»¬å°±å¯ä»¥å¼€å§‹å¾®ä¿¡åŠŸèƒ½å¼€å‘äº†ã€‚</p>
<p>æœ€åï¼Œæ— è®ºæ˜¯å®ç”¨çš„æ˜¯ä»€ä¹ˆè¯­è¨€ï¼Œéƒ½å»ºè®®ä½ å»æ‰¾ä¸€ä»½å°è£…çš„SDKæ¥ä½¿ç”¨ã€‚è¿™æ ·å¯ä»¥å¤§å¤§çš„å¢åŠ ä½ çš„å¼€å‘æ•ˆç‡ï¼Œå½“ç„¶ï¼Œå¦‚æœä½ æ˜¯åƒæˆ‘ä¸€æ ·ä¸ºäº†å­¦ä¹ ï¼Œå¯ä»¥è‡ªå·±å»è§£æè¿™äº›xmlæ ¼å¼çš„æ¶ˆæ¯ï½ï½</p>
<p><img src="https://raw.githubusercontent.com/ttdevs/ttdevs.github.io/common/images/logo.png" alt="Create by ttdevs"></p>
]]></content>
      
        <categories>
            
            <category> æŠ€æœ¯ </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Wechat </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[ã€ŒmacOSã€Crontabå®šæ—¶ä»»åŠ¡]]></title>
      <url>/1970/01/01/%5BmacOS%5DCrontab%E5%AE%9A%E6%97%B6%E4%BB%BB%E5%8A%A1/</url>
      <content type="html"><![CDATA[<p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨crontabæ‰§è¡Œä¸€äº›å‘¨æœŸä»»åŠ¡</p>
<h2 id="0x01-crontabå‘½ä»¤"><a href="/1970/01/01/[macOS]Crontabå®šæ—¶ä»»åŠ¡/#0x01-crontabå‘½ä»¤" class="headerlink" title="0x01 crontabå‘½ä»¤"></a>0x01 crontabå‘½ä»¤</h2><p>crontab [-u user] file</p>
<p>crontab [-u user] { -e | -l | -r }</p>
<ul>
<li><code>crontab file_name</code></li>
</ul>
<p>å°†fileåšä¸ºcrontabçš„ä»»åŠ¡åˆ—è¡¨æ–‡ä»¶å¹¶è½½å…¥crontab</p>
<ul>
<li><code>crontab -e</code></li>
</ul>
<p>ç¼–è¾‘crontabæ–‡ä»¶å†…å®¹</p>
<ul>
<li><code>crontab -l</code></li>
</ul>
<p>æ˜¾ç¤ºcrontabæ–‡ä»¶å†…å®¹</p>
<ul>
<li><code>crontab -r</code></li>
</ul>
<p>åˆ é™¤è½½å…¥åçš„crontabæ–‡ä»¶å†…å®¹</p>
<h2 id="0x02-crontabæ–‡ä»¶"><a href="/1970/01/01/[macOS]Crontabå®šæ—¶ä»»åŠ¡/#0x02-crontabæ–‡ä»¶" class="headerlink" title="0x02 crontabæ–‡ä»¶"></a>0x02 crontabæ–‡ä»¶</h2><ul>
<li><p><code>åˆ†</code> <code>æ—¶</code> <code>æ—¥</code> <code>æœˆ</code> <code>æ˜ŸæœŸ</code> <code>è¦è¿è¡Œçš„å‘½ä»¤</code></p>
<ul>
<li>ç¬¬1åˆ— åˆ†é’Ÿ1ï½59</li>
<li>ç¬¬2åˆ— å°æ—¶1ï½23ï¼ˆ0è¡¨ç¤ºå­å¤œï¼‰</li>
<li>ç¬¬3åˆ— æ—¥1ï½31</li>
<li>ç¬¬4åˆ— æœˆ1ï½12</li>
<li>ç¬¬5åˆ— æ˜ŸæœŸ0ï½7ï¼ˆ0,7è¡¨ç¤ºæ˜ŸæœŸå¤©ï¼‰</li>
<li>ç¬¬6åˆ— è¦è¿è¡Œçš„å‘½ä»¤</li>
</ul>
</li>
<li><p>å‡ ä¸ªç‰¹æ®Šç¬¦å·ï¼š<code>/</code> <code>-</code> <code>,</code></p>
<ul>
<li><code>/</code> æ¯(per): <code>*/2</code> æ¯ä¸¤ä¸ªå•ä½</li>
<li><code>-</code> è¿ç»­: <code>1-5</code> 1,2,3,4,5</li>
<li><code>,</code> éè¿ç»­: <code>1,2,5</code> 1å’Œ2å’Œ5</li>
</ul>
</li>
</ul>
<h2 id="0x03-Demo"><a href="/1970/01/01/[macOS]Crontabå®šæ—¶ä»»åŠ¡/#0x03-Demo" class="headerlink" title="0x03 Demo"></a>0x03 Demo</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"># æ¯åˆ†é’Ÿå‘ç”¨æˆ·ç›®å½•ä¸‹çš„log.txtå†™å…¥å½“æ—¶æ—¥æœŸ</div><div class="line">* * * * * /bin/date &gt;&gt; ~/log.txt </div><div class="line"></div><div class="line"># æ¯åˆ†é’Ÿ</div><div class="line">* * * * * /bin/date &gt;&gt; ~/log.txt</div><div class="line"></div><div class="line"># æ¯5åˆ†é’Ÿ</div><div class="line">*/5 * * * * /bin/date &gt;&gt; ~/log.txt</div><div class="line"></div><div class="line"># æ¯å°æ—¶çš„ç¬¬äº”åˆ†é’Ÿ</div><div class="line">5 * * * * /bin/date &gt;&gt; ~/log.txt </div><div class="line"></div><div class="line"># 4æœˆ1æ—¥æ—©ä¸Š8ç‚¹</div><div class="line">0 8 1 4 * /bin/date &gt;&gt; ~/log.txt </div><div class="line"></div><div class="line"># 4å’Œ5æœˆ 1æ—¥æ—©ä¸Š8ç‚¹</div><div class="line">0 8 1 4,5 * /bin/date &gt;&gt; ~/log.txt </div><div class="line"></div><div class="line"># 12306</div><div class="line">23-7 * * * * /bin/date &gt;&gt; ~/log.txt</div></pre></td></tr></table></figure>
<h1 id="æ›´æ–°-2015-03-26"><a href="/1970/01/01/[macOS]Crontabå®šæ—¶ä»»åŠ¡/#æ›´æ–°-2015-03-26" class="headerlink" title="æ›´æ–°(2015-03-26)"></a>æ›´æ–°(2015-03-26)</h1><h2 id="0x01-crontabè¾…åŠ©å·¥å…·"><a href="/1970/01/01/[macOS]Crontabå®šæ—¶ä»»åŠ¡/#0x01-crontabè¾…åŠ©å·¥å…·" class="headerlink" title="0x01 crontabè¾…åŠ©å·¥å…·"></a>0x01 crontabè¾…åŠ©å·¥å…·</h2><p>è¿™ä¸ªå·¥å…·å¯ä»¥ç”Ÿæˆcrontabæ–‡ä»¶ã€‚æ¯”å¦‚æˆ‘ä»¬æŒ‰ç…§è‡ªå·±çš„æƒ³æ³•é€‰æ‹©äº†ä»»åŠ¡çš„æ—¶é—´ï¼Œå¯ä»¥ä½¿ç”¨å®ƒå¸®åŠ©æˆ‘ä»¬ç”Ÿæˆå¯¹åº”çš„crontabæ–‡ä»¶ã€‚</p>
<p>åœ°å€ï¼š<a href="http://www.crontab-generator.org/" target="_blank" rel="external">http://www.crontab-generator.org/</a></p>
<h2 id="0x02-crontabçš„è°ƒè¯•"><a href="/1970/01/01/[macOS]Crontabå®šæ—¶ä»»åŠ¡/#0x02-crontabçš„è°ƒè¯•" class="headerlink" title="0x02 crontabçš„è°ƒè¯•"></a>0x02 crontabçš„è°ƒè¯•</h2><p>è¿™ä¸ªå»ºè®®åœ¨å‘½ä»¤çš„åé¢åŠ ä¸Š <code>... &gt;&gt; ~/log.txt 2&gt;&amp;1</code>ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥åœ¨ç”¨æˆ·ç›®å½•ä¸‹çœ‹åˆ°crontabæ‰§è¡Œçš„æ—¥å¿—äº†ã€‚å¦‚ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">* * * * * /bin/date &gt;&gt; ~/log.txt &gt;&gt; ~/log.txt 2&gt;&amp;1</div></pre></td></tr></table></figure>
<h2 id="0x03-ç¯å¢ƒå˜é‡"><a href="/1970/01/01/[macOS]Crontabå®šæ—¶ä»»åŠ¡/#0x03-ç¯å¢ƒå˜é‡" class="headerlink" title="0x03 ç¯å¢ƒå˜é‡"></a>0x03 ç¯å¢ƒå˜é‡</h2><p>è™½ç„¶æˆ‘ä»¬çŸ¥é“crontabæ‰§è¡Œæ—¶æ˜¯æ²¡æœ‰ç¯å¢ƒå˜é‡çš„ï¼Œä½†æ˜¯è¿™ä¸ªç¡®æ˜¯ä¸ªè®¨åŒçš„ä¸œè¥¿ã€‚æˆ‘ä»¬åœ¨æœ¬åœ°è°ƒè¯•å¥½äº†ç›¸å…³çš„ä»£ç ï¼Œç”¨crontabå´æ€ä¹ˆæ‰§è¡Œä¹Ÿä¸æ­£ç¡®ï¼Œæ¯”å¦‚æ‰§è¡Œä¸‹é¢çš„shellï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">#!/bin/bash</div><div class="line">py3=$(which python3)</div><div class="line">echo py3</div><div class="line">...</div></pre></td></tr></table></figure>
<p>é»˜è®¤æƒ…å†µä»€ä¹ˆä¹Ÿä¸ä¼šè¾“å‡ºã€‚ä¸‹é¢çš„é€»è¾‘è‡ªç„¶å°±æ˜¯é”™çš„äº†ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨æœ€å¼€å§‹åŠ ä¸Šè¿™ä¹ˆä¸€è¡Œ <code>source /etc/profile</code> ï¼Œç„¶ååœ¨æ‰§è¡Œå°±å¯ä»¥é¡ºåˆ©æ‹¿åˆ°æˆ‘ä»¬çš„å€¼äº†ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">#!/bin/bash</div><div class="line">source /etc/profile</div><div class="line">py3=$(which python3)</div><div class="line">echo py3</div><div class="line">...</div></pre></td></tr></table></figure>
<p><img src="https://raw.githubusercontent.com/ttdevs/ttdevs.github.io/common/images/logo.png" alt="Create by ttdevs"></p>
]]></content>
      
        <categories>
            
            <category> æŠ€æœ¯ </category>
            
        </categories>
        
        
        <tags>
            
            <tag> macOS </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[ã€ŒmacOSã€Macä¸€å¥è¯åˆ†äº«]]></title>
      <url>/1970/01/01/%5BmacOS%5DMac%E4%B8%80%E5%8F%A5%E8%AF%9D%E5%88%86%E4%BA%AB/</url>
      <content type="html"><![CDATA[<p>windowä¸‹ç›´æ¥è¾“å…¥msconfigæ‰“å¼€ç³»ç»Ÿé…ç½®å³å¯ï¼Œåœ¨è¿™é‡Œå¯ä»¥é…ç½®æ˜¯å¦å…è®¸å¼€æœºè‡ªå¯åŠ¨ã€‚MACä¸‹æœ€è¿‘è£…äº†å‡ ä¸ªè½¯ä»¶ï¼Œå‘ç°æ¯æ¬¡å¼€æœºéƒ½ä¼šè‡ªåŠ¨è¿è¡Œï¼Œæ¯”è¾ƒçƒ¦èºï¼Œé‚å¹²æ‰ä¹‹ï¼š</p>
<p>æ‰“å¼€ç³»ç»Ÿåå¥½è®¾ç½®&gt;é€‰æ‹©ç”¨æˆ·ä¸ç¾¤ç»„&gt;åœ¨å½“å‰ç”¨æˆ·çš„å³ä¾§é€‰æ‹©ç™»å½•é¡¹ï¼Œåœ¨è¿™é‡Œå³å¯æ·»åŠ åˆ é™¤æˆ‘ä»¬è¦çš„ç¨‹åºã€‚</p>
<p><img src="http://img.blog.csdn.net/20150308114522999?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvdHRkZXZz/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="">  </p>
]]></content>
      
        <categories>
            
            <category> æŠ€æœ¯ </category>
            
        </categories>
        
        
        <tags>
            
            <tag> macOS </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[ã€ŒWebSocketã€ä½¿ç”¨Websocketå®ç°æ¶ˆæ¯æ¨é€(ä¸‹)]]></title>
      <url>/1970/01/01/%5BWebSocket%5D%E4%BD%BF%E7%94%A8Websocket%E5%AE%9E%E7%8E%B0%E6%B6%88%E6%81%AF%E6%8E%A8%E9%80%81(%E4%B8%8B)/</url>
      <content type="html"><![CDATA[<h2 id="0x00-WebSocket"><a href="/1970/01/01/[WebSocket]ä½¿ç”¨Websocketå®ç°æ¶ˆæ¯æ¨é€(ä¸‹)/#0x00-WebSocket" class="headerlink" title="0x00 WebSocket"></a>0x00 WebSocket</h2><p>ä¸Šä¸€ç¯‡ä½¿ç”¨ <a href="https://github.com/TooTallNate/Java-WebSocket" target="_blank" rel="external">Java-WebSocket</a> å†™äº†ä¸€å¥— <code>WebSocket</code> çš„Demoï¼Œè¿™ä¸€ç¯‡ç€é‡åˆ†æä¸‹<code>WebSocket</code> çš„ä¸€äº›å®ç°ç»†èŠ‚ï¼Œæ›´åŠ è¯¦ç»†çš„åè®®ç»†èŠ‚å¯å‚è€ƒ <a href="https://datatracker.ietf.org/doc/rfc6455/" target="_blank" rel="external">RFC6455</a>ã€‚</p>
<h2 id="0x01-WebSocketåè®®"><a href="/1970/01/01/[WebSocket]ä½¿ç”¨Websocketå®ç°æ¶ˆæ¯æ¨é€(ä¸‹)/#0x01-WebSocketåè®®" class="headerlink" title="0x01 WebSocketåè®®"></a>0x01 WebSocketåè®®</h2><ul>
<li><code>WebSocket</code> åè®®:  å¯å‚è€ƒ<a href="https://datatracker.ietf.org/doc/rfc6455/" target="_blank" rel="external">RFC6455</a></li>
<li>æŠ“åŒ…å·¥å…·ï¼š<code>Charles</code> å’Œ <code>WireShark</code></li>
<li>æµ‹è¯•ä»£ç ï¼šå‚è€ƒä¸Šä¸€ç¯‡Demo</li>
</ul>
<h2 id="0x02-æ•°æ®ä¼ è¾“"><a href="/1970/01/01/[WebSocket]ä½¿ç”¨Websocketå®ç°æ¶ˆæ¯æ¨é€(ä¸‹)/#0x02-æ•°æ®ä¼ è¾“" class="headerlink" title="0x02 æ•°æ®ä¼ è¾“"></a>0x02 æ•°æ®ä¼ è¾“</h2><ul>
<li><p>è¿æ¥å’Œæ–­å¼€</p>
<p>  å½“ Client å‘ Server å‘èµ· ws è¿æ¥è¯·æ±‚åï¼Œä¼šå…ˆä½¿ç”¨ HTTP åè®®å»ºç«‹ TCP é•¿é“¾æ¥ï¼Œé€šè¿‡æŠ“åŒ…ï¼Œæˆ‘ä»¬ä¼šçœ‹åˆ°ç±»ä¼¼è¿™æ ·çš„ä¿¡æ¯ï¼š</p>
<p>  Requestï¼š</p>
<p>  <img src="http://img.blog.csdn.net/20160910174128237" alt="Charles Request"></p>
<p>  Responseï¼š</p>
<p>  <img src="http://img.blog.csdn.net/20160910175927683" alt="Charles Response"></p>
<p>  è¿™é‡Œç®€å•ä»‹ç»å‡ ä¸ªå…³é”®çš„Headerå­—æ®µï¼š</p>
<ul>
<li>upgrade:websocket</li>
<li>connection:Upgrade</li>
<li>sec-websocket-version:13</li>
<li>sec-websocket-key:xxxxxx</li>
<li><p>sec-websocket-accept:</p>
<p>è¿™äº›å­—æ®µçš„ä¿¡æ¯å¯å‚è€ƒ<a href="http://www.jianshu.com/p/867274a5e054" target="_blank" rel="external">è¿™é‡Œ</a>ã€‚</p>
</li>
</ul>
</li>
<li><p>æ•°æ®ä¼ è¾“</p>
<p>  å½“ HTTP è¿æ¥å»ºç«‹ä¹‹åï¼Œå°±å¯ä»¥é€šè¿‡è¿™ä¸ªé•¿é“¾æ¥è¿›è¡Œæ•°æ®ä¼ è¾“äº†ã€‚å¦‚æœä½ ä½¿ç”¨ Charles è¿›è¡Œæ•°æ®æŠ“åŒ…çš„è¯ï¼Œå¯ä»¥çœ‹åˆ°ç±»ä¼¼ä¸‹å›¾ä¸­è¿™æ ·çš„èŠå¤©å†…å®¹ï¼š</p>
<p>  <img src="http://img.blog.csdn.net/20160910180038193" alt="Charles websocket Chat"></p>
<p>   åœ¨åŒä¸€ä¸ª HTTP è¯·æ±‚ä¸­ï¼Œæˆ‘ä»¬çœ‹åˆ°ä¸æ–­æœ‰æ•°æ®äº¤äº’ï¼Œè€Œä¸æ˜¯åƒä¹‹å‰çš„ HTTP è¯·æ±‚é‚£æ ·ï¼Œæ¯å‘é€ä¸€æ¡æ•°æ®ï¼Œéƒ½éœ€è¦å‘èµ·ä¸€æ¬¡æ–°çš„è¯·æ±‚ã€‚</p>
<p>  ä¸‹é¢æˆ‘ä»¬æ¥å°è¯•åˆ†æä¸€ä¸‹ã€‚è¿™é‡Œè¦ç”¨åˆ°Wiresharkã€‚å¯èƒ½ä½ ä¼šä¸ºä»€ä¹ˆæ¢äº†Wiresharkè€Œä¸ç”¨Charlesäº†ï¼ŸåŸå› å¾ˆç®€å•ï¼ŒCharlesç»™æˆ‘ä»¬å‘ˆç°çš„æ˜¯åº”ç”¨å±‚æœ€ç»ˆçš„ç»“æœï¼Œè€Œä¼ è¾“å±‚çš„å…·ä½“çš„æ•°æ®åŒ…å‘é€æ¥æ”¶å´ä¸èƒ½å±•ç¤ºï¼Œè¿™ä¸ªæ—¶å€™å°±éœ€è¦å€ŸåŠ©Wiresharkæ¥å¯¹TCPæ•°æ®åŒ…è¿›è¡Œåˆ†æäº†ã€‚</p>
<p>  é¦–å…ˆï¼ŒæŸ¥è¯¢ <a href="https://datatracker.ietf.org/doc/rfc6455/" target="_blank" rel="external">RFC6455</a>æ–‡æ¡£ï¼Œæˆ‘ä»¬å¾—çŸ¥ ws åè®®çš„æ•°æ®åŒ…æ ¼å¼å¦‚ä¸‹ï¼š</p>
<p>  <img src="http://img.blog.csdn.net/20160910181202338" alt="RFC6455 Frame"></p>
<p>  æœ‰äº†è¿™ä¸ªå‚è€ƒï¼Œæˆ‘ä»¬å°±å¯ä»¥è¿›è¡Œæ•°æ®åˆ†æäº†ã€‚ä¸‹é¢æ˜¯æˆ‘çš„ä¸€æ¬¡æ•°æ®æ”¶å‘è¿‡ç¨‹ï¼šå®¢æˆ·ç«¯å‘æœåŠ¡ç«¯å‘é€æ•°æ®ï¼š123456789ï¼Œç„¶åæœåŠ¡ç«¯åŸæ ·å‘å›ï¼ŒæŠ“åŒ…å¦‚ä¸‹ï¼š</p>
<p>  Senderï¼š</p>
<p>  <img src="http://img.blog.csdn.net/20160911195743125" alt="WireShark sender">    </p>
<p>  Receiverï¼š</p>
<p>  <img src="http://img.blog.csdn.net/20160911195848240" alt="WireShark receiver"></p>
<p>  ä¸‹é¢æˆ‘ä»¬ç€é‡å¯¹è¿™ä¸¤ä¸ªæ•°æ®åŒ…è¿›è¡Œåˆ†æã€‚ç»†å¿ƒçš„ä½ å¯èƒ½ä¼šå‘ç°ï¼Œæˆªå›¾ä¸­æœ‰å››æ¡æ•°æ®ï¼Œå¦‚æœä½ å¯¹TCPçš„ä¼ è¾“æœ‰æ‰€äº†è§£ï¼Œç¬¬äºŒæ¡å’Œç¬¬ä¸‰æ¡æ˜¯ç¡®è®¤æŠ¥æ–‡ã€‚</p>
<p>  æˆ‘ä»¬å…ˆçœ‹ä¸‹æ¥æ”¶åˆ°æ•°æ®ã€‚ç‚¹å‡»æ•°æ®ä¸­çš„ Data(11bytes) éƒ¨åˆ†ï¼Œä¸‹æ–¹æ˜¯è‡ªåŠ¨é€‰æ‹©äº†æ•°æ®éƒ¨åˆ†ï¼š8109313233343536373839ã€‚ï¼ˆåœ¨æ­¤ä¹‹å‰æ˜¯TCPæŠ¥æ–‡çš„Headeréƒ¨åˆ†ï¼Œæˆ‘ä»¬å¯ä»¥å¿½ç•¥ï¼‰æ ¹æ® ws åè®®ï¼Œæˆ‘ä»¬å°†å…¶å±•å¼€ï¼š</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line">81 09:  10000001 00001001 </div><div class="line">31 32:  00110001 00110010</div><div class="line">33 34:  00110011 00110100</div><div class="line">35 36:  00110101 00110110</div><div class="line">37 38:  00110111 00111000</div><div class="line">39   :  00111001</div><div class="line">``` 	</div><div class="line">0ï¼š1ï¼Œè¿™æ˜¯æœ€åä¸€å¸§</div><div class="line">1ï½3ï¼šå…¨ä¸º0</div><div class="line">4ï½7ï¼š001ï¼Œé™„åŠ æ•°æ®å¸§</div><div class="line">8ï¼š0ï¼ŒPlayloadDataæœªç»è¿‡æ©ç </div><div class="line"> 9ï½15ï¼š0001001 = 9 &lt; 125ï¼Œå› æ­¤æ•°æ®é•¿åº¦ä½9</div><div class="line"> å‰©ä¸‹çš„ï¼š313233343536373839å³ä¸ºæ•°æ® 123456789</div><div class="line"></div><div class="line">å†æ¥çœ‹çœ‹å‘é€çš„æ•°æ®ã€‚ç‚¹å‡» Data(15bytes) éƒ¨åˆ†ï¼Œä¸‹æ–¹çš„æ•°æ®éƒ¨åˆ†ï¼š818911eb9db220d9ae8624ddaa8a28ï¼Œå±•å¼€ï¼š</div><div class="line"></div><div class="line">``` shell</div><div class="line">81 89 : 10000001 10001001 </div><div class="line">11 eb : 00010001 11101011</div><div class="line">9d b2 : 10011101 10110010</div><div class="line">20 d9 : 00100000 11011001</div><div class="line">ae 86 : 10101110 10000110</div><div class="line">24 dd : 00100100 11011101</div><div class="line">aa 8a : 10101010 10001010</div><div class="line">28    : 00101000</div></pre></td></tr></table></figure>
<p>  0ï¼š1ï¼Œè¿™æ˜¯æœ€åä¸€å¸§<br>  1ï½3ï¼šå…¨ä¸º0<br>  4ï½7ï¼š001ï¼Œé™„åŠ æ•°æ®å¸§<br>  8ï¼š1ï¼ŒPlayloadDataç»è¿‡æ©ç ï¼Œï¼ˆæ‰€æœ‰çš„ç”±å®¢æˆ·ç«¯å‘å¾€æœåŠ¡ç«¯çš„å¸§æ­¤æ•°ä½éƒ½è¢«è®¾ç½®æˆ 1ã€‚ï¼‰<br>   9ï½15ï¼š0001001 = 9 &lt; 125ï¼Œå› æ­¤æ•°æ®é•¿åº¦ä½9<br>   11 eb 9d b2ï¼šæ©ç <br>   20 d9 ae 86 24 dd aa 8a 28ï¼šæ•°æ®<br>  å…³äºæ©ç çš„è®¡ç®—ï¼š<br>  <img src="http://img.blog.csdn.net/20160911203233422" alt="æ©ç çš„è®¡ç®—"></p>
</li>
<li><p>è¿æ¥ä¿æŒ</p>
<p>  é™¤äº†æ­£å¸¸çš„æ•°æ®ä¼ è¾“ä¹‹å¤–ï¼ŒSocketç¼–ç¨‹è¿˜æœ‰ä¸€ä¸ªé‡è¦çš„ç»„æˆéƒ¨åˆ†ï¼šå¿ƒè·³ä¿æŒã€‚wsåè®®ä¸­å®šä¹‰äº†ä¸“é—¨çš„æ•°æ®åŒ…ï¼š</p>
<blockquote>
<p>  Control frames are identified by opcodes where the most significant bit of the opcode is 1.  Currently defined opcodes for control frames include 0x8 (Close), 0x9 (Ping), and 0xA (Pong).  Opcodes 0xB-0xF are reserved for further control frames yet to be defined.<br>Control frames are used to communicate state about the WebSocket. Control frames can be interjected in the middle of a fragmented message.<br>All control frames MUST have a payload length of 125 bytes or less and MUST NOT be fragmented.</p>
</blockquote>
</li>
<li><p>å…¶ä»–</p>
<p>  ä¸€ä¸ªåè®®ä¸å¯èƒ½å°±è¿™ä¹ˆç®€å•ï¼Œå¦‚æœä½ è¿˜æƒ³äº†è§£æ›´å¤šï¼Œå¯å‚è€ƒ<a href="https://datatracker.ietf.org/doc/rfc6455/" target="_blank" rel="external">RFC6455</a>ã€‚</p>
</li>
</ul>
<h2 id="0xFF-å‚è€ƒ"><a href="/1970/01/01/[WebSocket]ä½¿ç”¨Websocketå®ç°æ¶ˆæ¯æ¨é€(ä¸‹)/#0xFF-å‚è€ƒ" class="headerlink" title="0xFF å‚è€ƒ"></a>0xFF å‚è€ƒ</h2><ol>
<li><a href="http://www.jianshu.com/p/867274a5e054" target="_blank" rel="external">http://www.jianshu.com/p/867274a5e054</a></li>
<li><a href="http://www.jianshu.com/p/fc09b0899141" target="_blank" rel="external">http://www.jianshu.com/p/fc09b0899141</a></li>
<li><a href="https://datatracker.ietf.org/doc/rfc6455/" target="_blank" rel="external">https://datatracker.ietf.org/doc/rfc6455/</a></li>
<li><a href="https://developer.mozilla.org/zh-CN/docs/WebSockets/Writing_WebSocket_servers" target="_blank" rel="external">https://developer.mozilla.org/zh-CN/docs/WebSockets/Writing_WebSocket_servers</a></li>
</ol>
<hr>
<p><img src="https://raw.githubusercontent.com/ttdevs/ttdevs.github.io/common/images/logo.png" alt="Create by ttdevs"></p>
]]></content>
      
        <categories>
            
            <category> æŠ€æœ¯ </category>
            
        </categories>
        
        
        <tags>
            
            <tag> WebSocket </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[ã€ŒWebSocketã€ä½¿ç”¨Websocketå®ç°æ¶ˆæ¯æ¨é€(å¿ƒè·³)]]></title>
      <url>/1970/01/01/%5BWebSocket%5D%E4%BD%BF%E7%94%A8Websocket%E5%AE%9E%E7%8E%B0%E6%B6%88%E6%81%AF%E6%8E%A8%E9%80%81(%E5%BF%83%E8%B7%B3)/</url>
      <content type="html"><![CDATA[<h2 id="0x00-å¿ƒè·³"><a href="/1970/01/01/[WebSocket]ä½¿ç”¨Websocketå®ç°æ¶ˆæ¯æ¨é€(å¿ƒè·³)/#0x00-å¿ƒè·³" class="headerlink" title="0x00 å¿ƒè·³"></a>0x00 å¿ƒè·³</h2><p>æœ¬æ¥ä»¥ä¸ºå†™å®Œäº†ï¼Œç»“æœæœ€è¿‘å’Œä¸€ä¸ªåŒäº‹åœ¨è®¨è®ºå¿ƒè·³çš„äº‹æƒ…ï¼Œè¿™é‡Œå†åšä¸€ä¸ªè¡¥å……ã€‚å…ˆè¯´æˆ‘çš„ç»“è®ºï¼š</p>
<ul>
<li>WebSocketåè®®å·²ç»è®¾è®¡äº†å¿ƒè·³ï¼Œè¿™ä¸ªåŠŸèƒ½å¯ä»¥åˆ°è¾¾æ£€æµ‹é“¾æ¥æ˜¯å¦å¯ç”¨</li>
<li>å¿ƒè·³æ˜¯ç”¨æ¥æ£€æµ‹é“¾æ¥æ˜¯å¦å¯ç”¨çš„ï¼Œä¸ä¸€å®šæ”¯æŒæºå¸¦æ•°æ®ï¼Œå¯è¦çœ‹å…·ä½“å®ç°</li>
<li>å¦‚æœéè¦å¿ƒè·³ä¸­å¸¦ä¸Šå¤æ‚æ•°æ®ï¼Œé‚£è¿™ä¸ªå¯ä½œä¸ºåº”ç”¨å±‚çš„ä¸€ä¸ªåŠŸèƒ½è‡ªå·±å»å®ç°ã€‚</li>
</ul>
<p><img src="http://img.blog.csdn.net/20170317140005670?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvdHRkZXZz/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="å¿ƒè·³é€»è¾‘"></p>
<h2 id="0x01-WebSocketåè®®çš„æ§åˆ¶å¸§"><a href="/1970/01/01/[WebSocket]ä½¿ç”¨Websocketå®ç°æ¶ˆæ¯æ¨é€(å¿ƒè·³)/#0x01-WebSocketåè®®çš„æ§åˆ¶å¸§" class="headerlink" title="0x01 WebSocketåè®®çš„æ§åˆ¶å¸§"></a>0x01 WebSocketåè®®çš„æ§åˆ¶å¸§</h2><p>ä¸Šä¸€ç¯‡çš„æœ€åç®€å•æåˆ°äº†å¿ƒè·³ï¼Œä¸‹é¢æ˜¯å¯¹websocketåè®®æ§åˆ¶å¸§çš„æè¿°ï¼š</p>
<pre><code>5.5.  Control Frames

   Control frames are identified by opcodes where the most significant
   bit of the opcode is 1.  Currently defined opcodes for control frames
   include 0x8 (Close), 0x9 (Ping), and 0xA (Pong).  Opcodes 0xB-0xF are
   reserved for further control frames yet to be defined.

   Control frames are used to communicate state about the WebSocket.
   Control frames can be interjected in the middle of a fragmented
   message.

   All control frames MUST have a payload length of 125 bytes or less
   and MUST NOT be fragmented.
</code></pre><ul>
<li>Pingçš„åè®®å¤´æ˜¯0x9ï¼ŒPongçš„åè®®å¤´æ˜¯0xA</li>
<li>æ§åˆ¶å¸§æœ€å¤§è½½è·ä¸º125bytesä¸”ä¸èƒ½æ‹†åˆ†</li>
</ul>
<h2 id="0x02-WebSocketåè®®çš„å¿ƒè·³"><a href="/1970/01/01/[WebSocket]ä½¿ç”¨Websocketå®ç°æ¶ˆæ¯æ¨é€(å¿ƒè·³)/#0x02-WebSocketåè®®çš„å¿ƒè·³" class="headerlink" title="0x02 WebSocketåè®®çš„å¿ƒè·³"></a>0x02 WebSocketåè®®çš„å¿ƒè·³</h2><p>ä¸‹é¢å†æ¥çœ‹çœ‹å¯¹å¿ƒè·³çš„è§„å®šï¼š</p>
<pre><code>5.5.2.  Ping

   The Ping frame contains an opcode of 0x9.

   A Ping frame MAY include &quot;Application data&quot;.
   // æ³¨ï¼šPingå¸§ä¸­å¯èƒ½ä¼šæºå¸¦æ•°æ®

   Upon receipt of a Ping frame, an endpoint MUST send a Pong frame in
   response, unless it already received a Close frame.  It SHOULD
   respond with Pong frame as soon as is practical.  Pong frames are
   discussed in Section 5.5.3.
   // æ³¨ï¼šåœ¨æ”¶åˆ°Pingå¸§åï¼Œç«¯ç‚¹å¿…é¡»å‘é€Pongå¸§å“åº”ï¼Œé™¤éå·²ç»æ”¶åˆ°äº†Closeå¸§ã€‚åœ¨å®é™…ä¸­åº”å°½å¯èƒ½å¿«çš„å“åº”ã€‚

   An endpoint MAY send a Ping frame any time after the connection is
   established and before the connection is closed.

   NOTE: A Ping frame may serve either as a keepalive or as a means to
   verify that the remote endpoint is still responsive.

5.5.3.  Pong

   The Pong frame contains an opcode of 0xA.

   Section 5.5.2 details requirements that apply to both Ping and Pong
   frames.

   A Pong frame sent in response to a Ping frame must have identical
   &quot;Application data&quot; as found in the message body of the Ping frame
   being replied to.
   // æ³¨ï¼šåœ¨å“åº”Pingå¸§çš„çš„Pongå¸§ä¸­ï¼Œå¿…é¡»æºå’Œè¢«å“åº”çš„Pingå¸§ä¸­ç›¸åŒçš„æ•°æ®ã€‚

   If an endpoint receives a Ping frame and has not yet sent Pong
   frame(s) in response to previous Ping frame(s), the endpoint MAY
   elect to send a Pong frame for only the most recently processed Ping
   frame.
</code></pre><p>ä»ä¸Šé¢çš„æè¿°æˆ‘ä»¬å¯ä»¥å¾—åˆ°å¦‚ä¸‹ç»“è®ºï¼š</p>
<ul>
<li>å¿ƒè·³åŒ…ä¸­å¯èƒ½ä¼šæºå¸¦æ•°æ®</li>
<li>å½“æ”¶åˆ°Pingå¸§çš„æ—¶å€™éœ€è¦ç«‹å³è¿”å›ä¸€ä¸ªPongå¸§</li>
<li>åœ¨è¿æ¥å»ºç«‹ä¹‹åï¼Œéšæ—¶éƒ½å¯ä»¥å‘é€Pingå¸§</li>
<li>å¿ƒè·³æ˜¯ç”¨æ¥æµ‹è¯•é“¾æ¥æ˜¯å¦å­˜åœ¨å’Œå¯¹æ–¹æ˜¯å¦åœ¨çº¿</li>
<li>åœ¨å“åº”Pingå¸§çš„çš„Pongå¸§ä¸­ï¼Œå¿…é¡»æºå’Œè¢«å“åº”çš„Pingå¸§ä¸­ç›¸åŒçš„æ•°æ®</li>
</ul>
<h2 id="0x03-æµ‹è¯•"><a href="/1970/01/01/[WebSocket]ä½¿ç”¨Websocketå®ç°æ¶ˆæ¯æ¨é€(å¿ƒè·³)/#0x03-æµ‹è¯•" class="headerlink" title="0x03 æµ‹è¯•"></a>0x03 æµ‹è¯•</h2><p>å’Œä¹‹å‰ä¸€æ ·ï¼Œè‡ªå·±æœ¬åœ°æ­å»ºçš„æœåŠ¡å™¨ï¼Œç”¨çš„åº“æ˜¯ <code>org.java_websocket</code>ã€‚<br>åœ¨å…¶æºç ä¸­æˆ‘ä»¬å¯ä»¥æ‰¾åˆ°è¿™æ ·ä¸€æ®µï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> org.java_websocket;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">WebSocketAdapter</span> <span class="keyword">implements</span> <span class="title">WebSocketListener</span> </span>&#123;</div><div class="line">    ...</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onWebsocketPing</span><span class="params">(WebSocket conn, Framedata f)</span> </span>&#123;</div><div class="line">        FramedataImpl1 resp = <span class="keyword">new</span> FramedataImpl1(f);</div><div class="line">        resp.setOptcode(Opcode.PONG);</div><div class="line">        conn.sendFrame(resp);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onWebsocketPong</span><span class="params">(WebSocket conn, Framedata f)</span> </span>&#123;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    ...</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>å®¢æˆ·ç«¯ä¹Ÿå¯ä»¥ä½¿ç”¨è¿™ä¸ªåº“ï¼Œç›¸åŒçš„é€»è¾‘ï¼Œä»£ç ä¹Ÿæ˜¯è¿™ä¸€ä»½ã€‚</p>
<p>ç„¶åæˆ‘ä»¬å†æ¢ä¸€ä¸ªåº“ï¼Œ<code>com.squareup.okhttp3:okhttp-ws:3.4.2</code>ï¼Œä»–çš„å®ç°å¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="keyword">package</span> okhttp3.internal.ws;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">RealWebSocket</span> <span class="keyword">implements</span> <span class="title">WebSocket</span> </span>&#123;</div><div class="line">  ...</div><div class="line">  <span class="function"><span class="keyword">public</span> <span class="title">RealWebSocket</span><span class="params">(<span class="keyword">boolean</span> isClient, BufferedSource source, BufferedSink sink, Random random,</span></span></div><div class="line">      <span class="keyword">final</span> Executor replyExecutor, <span class="keyword">final</span> WebSocketListener listener, <span class="keyword">final</span> String url) &#123;</div><div class="line">    <span class="keyword">this</span>.listener = listener;</div><div class="line"></div><div class="line">    writer = <span class="keyword">new</span> WebSocketWriter(isClient, sink, random);</div><div class="line">    reader = <span class="keyword">new</span> WebSocketReader(isClient, source, <span class="keyword">new</span> FrameCallback() &#123;</div><div class="line">      <span class="meta">@Override</span> <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onMessage</span><span class="params">(ResponseBody message)</span> <span class="keyword">throws</span> IOException </span>&#123;</div><div class="line">        listener.onMessage(message);</div><div class="line">      &#125;</div><div class="line"></div><div class="line">      <span class="meta">@Override</span> <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onPing</span><span class="params">(<span class="keyword">final</span> Buffer buffer)</span> </span>&#123;</div><div class="line">        replyExecutor.execute(<span class="keyword">new</span> NamedRunnable(<span class="string">"OkHttp %s WebSocket Pong Reply"</span>, url) &#123;</div><div class="line">          <span class="meta">@Override</span> <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">execute</span><span class="params">()</span> </span>&#123;</div><div class="line">            <span class="keyword">try</span> &#123;</div><div class="line">              writer.writePong(buffer);</div><div class="line">            &#125; <span class="keyword">catch</span> (IOException ignored) &#123;</div><div class="line">            &#125;</div><div class="line">          &#125;</div><div class="line">        &#125;);</div><div class="line">      &#125;</div><div class="line"></div><div class="line">      <span class="meta">@Override</span> <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onPong</span><span class="params">(Buffer buffer)</span> </span>&#123;</div><div class="line">        listener.onPong(buffer);</div><div class="line">      &#125;</div><div class="line"></div><div class="line">      <span class="meta">@Override</span> <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClose</span><span class="params">(<span class="keyword">final</span> <span class="keyword">int</span> code, <span class="keyword">final</span> String reason)</span> </span>&#123;</div><div class="line">        readerSentClose = <span class="keyword">true</span>;</div><div class="line">        replyExecutor.execute(<span class="keyword">new</span> NamedRunnable(<span class="string">"OkHttp %s WebSocket Close Reply"</span>, url) &#123;</div><div class="line">          <span class="meta">@Override</span> <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">execute</span><span class="params">()</span> </span>&#123;</div><div class="line">            peerClose(code, reason);</div><div class="line">          &#125;</div><div class="line">        &#125;);</div><div class="line">      &#125;</div><div class="line">    &#125;);</div><div class="line">  &#125;</div><div class="line">...</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>åœ¨å¤„ç†Pingå¸§çš„æ—¶å€™ï¼Œä¹Ÿæ˜¯å°†åè®®å­—æ®µæ”¹ä¸ºPongç„¶åè¿”å›ã€‚</p>
<p>å¯¹å¿ƒè·³çš„æµ‹è¯•ä»£ç å·²ç»ä¸Šä¼ åˆ°Githubï¼š<a href="https://github.com/ttdevs" target="_blank" rel="external">ttdevs</a><br><a href="https://github.com/ttdevs/android/blob/master/app/src/main/java/com/ttdevs/android/WebSocketActivity.java" target="_blank" rel="external">WebSocketActivity.java</a><br><a href="https://github.com/ttdevs/android/blob/master/app/src/main/java/com/ttdevs/android/WebSocketOKActivity.java" target="_blank" rel="external">WebSocketOKActivity.java</a><br><a href="https://github.com/ttdevs/android/blob/master/modules/webscoket/src/main/java/com/ttdevs/webscoket/SocketServer.java" target="_blank" rel="external">SocketServer.java</a></p>
<p>åœ¨å®é™…çš„æµ‹è¯•ä¸­ï¼Œå¯èƒ½ä¼šé‡åˆ°ä¸€äº›å¼‚å¸¸ï¼Œæ¯”å¦‚åœ¨æˆ‘ä»¬è‡ªå·±çš„ç”Ÿäº§ç¯å¢ƒï¼šå½“å®¢æˆ·ç«¯å‘é€å¸¦äº†ç®€å•æ•°æ®çš„Pingå¸§åï¼ŒæœåŠ¡å™¨ç«‹é©¬è¿”å›Pongå¸§ï¼Œä½†æ˜¯å®ƒä¼šå°†æºå¸¦çš„æ•°æ®ä¸¢å¼ƒã€‚è¿™ä¸ªå°±æ˜¯æœåŠ¡ç«¯çš„é—®é¢˜äº†ã€‚</p>
<h2 id="0xFF-å‚è€ƒ"><a href="/1970/01/01/[WebSocket]ä½¿ç”¨Websocketå®ç°æ¶ˆæ¯æ¨é€(å¿ƒè·³)/#0xFF-å‚è€ƒ" class="headerlink" title="0xFF å‚è€ƒ"></a>0xFF å‚è€ƒ</h2><ol>
<li>RFC6455: <a href="https://datatracker.ietf.org/doc/rfc6455/" target="_blank" rel="external">https://datatracker.ietf.org/doc/rfc6455/</a></li>
</ol>
<p><img src="https://raw.githubusercontent.com/ttdevs/ttdevs.github.io/common/images/logo.png" alt="Create by ttdevs"></p>
]]></content>
      
        <categories>
            
            <category> æŠ€æœ¯ </category>
            
        </categories>
        
        
        <tags>
            
            <tag> WebSocket </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[ã€ŒmacOSã€ç”¨Homebrewå®‰è£…Mysql]]></title>
      <url>/1970/01/01/%5BmacOS%5D%E7%94%A8Homebrew%E5%AE%89%E8%A3%85Mysql/</url>
      <content type="html"><![CDATA[<h2 id="0x00-éœ€æ±‚"><a href="/1970/01/01/[macOS]ç”¨Homebrewå®‰è£…Mysql/#0x00-éœ€æ±‚" class="headerlink" title="0x00 éœ€æ±‚"></a>0x00 éœ€æ±‚</h2><p>ç®€å•è®°å½•macä¸‹mysqlå®‰è£…ã€‚è¿™é‡Œéœ€è¦ä¸€ä¸ªå‰æâ€”â€”å…ˆå®‰è£… <a href="http://brew.sh/index_zh-cn.html" target="_blank" rel="external"><code>homebrew</code></a>ï¼Œå…·ä½“å¯ä»¥å‚è€ƒ<a href="http://brew.sh/index_zh-cn.html" target="_blank" rel="external">è¿™é‡Œ</a>ã€‚</p>
<h2 id="0x01-å®‰è£…"><a href="/1970/01/01/[macOS]ç”¨Homebrewå®‰è£…Mysql/#0x01-å®‰è£…" class="headerlink" title="0x01 å®‰è£…"></a>0x01 å®‰è£…</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">âœ  ~ brew install mysql</div><div class="line">ï¼ƒ ä»¥ä¸‹ä¸ºåˆ é™¤ä¸Šä¸ªç‰ˆæœ¬çš„é—ç•™</div><div class="line">âœ  ~ cd /usr/local/var/mysql</div><div class="line">âœ  mysql git:(master) ls</div><div class="line">auto.cnf           ib_buffer_pool     mysql              server-cert.pem</div><div class="line">ca-key.pem         ib_logfile0        mysqld_safe.pid    server-key.pem</div><div class="line">ca.pem             ib_logfile1        performance_schema sys</div><div class="line">client-cert.pem    ibdata1            private_key.pem    ttdevs.local.err</div><div class="line">client-key.pem     ibtmp1             public_key.pem     ttdevs.local.pid</div><div class="line">âœ  mysql git:(master) rm -rf ttdevs.local.err</div><div class="line">âœ  mysql git:(master) cd ~</div><div class="line">ï¼ƒ ä»¥ä¸Šä¸ºåˆ é™¤ä¸Šä¸ªç‰ˆæœ¬çš„é—ç•™</div></pre></td></tr></table></figure>
<blockquote>
<p>å¸è½½ï¼š <code>brew uninstall mysql</code></p>
</blockquote>
<h2 id="0x02-é…ç½®"><a href="/1970/01/01/[macOS]ç”¨Homebrewå®‰è£…Mysql/#0x02-é…ç½®" class="headerlink" title="0x02 é…ç½®"></a>0x02 é…ç½®</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div></pre></td><td class="code"><pre><div class="line">âœ  ~ /usr/local/opt/mysql/bin/mysql_secure_installation</div><div class="line"></div><div class="line">Securing the MySQL server deployment.</div><div class="line"></div><div class="line">Connecting to MySQL using a blank password.</div><div class="line"></div><div class="line">VALIDATE PASSWORD PLUGIN can be used to test passwords</div><div class="line">and improve security. It checks the strength of password</div><div class="line">and allows the users to set only those passwords which are</div><div class="line">secure enough. Would you like to setup VALIDATE PASSWORD plugin?</div><div class="line"></div><div class="line">Press y|Y for Yes, any other key for No:</div><div class="line">Please set the password for root here.</div><div class="line"></div><div class="line">New password:</div><div class="line"></div><div class="line">Re-enter new password:</div><div class="line">By default, a MySQL installation has an anonymous user,</div><div class="line">allowing anyone to log into MySQL without having to have</div><div class="line">a user account created for them. This is intended only for</div><div class="line">testing, and to make the installation go a bit smoother.</div><div class="line">You should remove them before moving into a production</div><div class="line">environment.</div><div class="line"></div><div class="line">Remove anonymous users? (Press y|Y for Yes, any other key for No) : y</div><div class="line">Success.</div><div class="line"></div><div class="line"></div><div class="line">Normally, root should only be allowed to connect from</div><div class="line">&apos;localhost&apos;. This ensures that someone cannot guess at</div><div class="line">the root password from the network.</div><div class="line"></div><div class="line">Disallow root login remotely? (Press y|Y for Yes, any other key for No) : y</div><div class="line">Success.</div><div class="line"></div><div class="line">By default, MySQL comes with a database named &apos;test&apos; that</div><div class="line">anyone can access. This is also intended only for testing,</div><div class="line">and should be removed before moving into a production</div><div class="line">environment.</div><div class="line"></div><div class="line"></div><div class="line">Remove test database and access to it? (Press y|Y for Yes, any other key for No) : y</div><div class="line"> - Dropping test database...</div><div class="line">Success.</div><div class="line"></div><div class="line"> - Removing privileges on test database...</div><div class="line">Success.</div><div class="line"></div><div class="line">Reloading the privilege tables will ensure that all changes</div><div class="line">made so far will take effect immediately.</div><div class="line"></div><div class="line">Reload privilege tables now? (Press y|Y for Yes, any other key for No) : y</div><div class="line">Success.</div><div class="line"></div><div class="line">All done!</div><div class="line">âœ  ~ mysql.server start</div><div class="line">Starting MySQL</div><div class="line"> SUCCESS!</div></pre></td></tr></table></figure>
<h2 id="0x03-å¯åŠ¨åœæ­¢"><a href="/1970/01/01/[macOS]ç”¨Homebrewå®‰è£…Mysql/#0x03-å¯åŠ¨åœæ­¢" class="headerlink" title="0x03 å¯åŠ¨åœæ­¢"></a>0x03 å¯åŠ¨åœæ­¢</h2><ul>
<li><code>brew services start/stop mysql</code> </li>
<li><code>mysql.server start/stop</code></li>
</ul>
<p>ä¸¤ç§æ–¹å¼éƒ½å¯ä»¥ï¼Œä½†æ˜¯ä¸å¯ä»¥äº¤å‰ä½¿ç”¨ï¼Œæ¯”å¦‚ç”¨ <code>brew services start mysql</code> å¯åŠ¨ å´ä¸èƒ½ç”¨ <code>mysql.server stop</code> åœæ­¢ã€‚</p>
<h2 id="0x04-GUIå®¢æˆ·ç«¯"><a href="/1970/01/01/[macOS]ç”¨Homebrewå®‰è£…Mysql/#0x04-GUIå®¢æˆ·ç«¯" class="headerlink" title="0x04 GUIå®¢æˆ·ç«¯"></a>0x04 GUIå®¢æˆ·ç«¯</h2><ul>
<li><p><a href="http://www.sequelpro.com" target="_blank" rel="external">Sequel Pro</a></p>
<p>  å…è´¹</p>
</li>
<li><p><a href="https://www.navicat.com.cn/" target="_blank" rel="external">Navicat For Mysql</a></p>
<p>  æ”¶è´¹</p>
</li>
</ul>
<h2 id="0x05-ç®€å•å‘½ä»¤çºªå½•"><a href="/1970/01/01/[macOS]ç”¨Homebrewå®‰è£…Mysql/#0x05-ç®€å•å‘½ä»¤çºªå½•" class="headerlink" title="0x05 ç®€å•å‘½ä»¤çºªå½•"></a>0x05 ç®€å•å‘½ä»¤çºªå½•</h2><ul>
<li>ç™»å½•ï¼š<code>mysql -u username -p</code></li>
<li>æ¨å‡ºï¼š<code>exit;</code></li>
<li>é»˜è®¤ <code>data</code> ç›®å½•ï¼š<code>/usr/local/var/mysql</code></li>
<li>Emojiè¡¨æƒ…çš„æ”¯æŒè¯·ä½¿ç”¨ç¼–ç ï¼š<code>utf8mb4</code></li>
<li>TODO 2016-09-07</li>
</ul>
<h2 id="0xFF-å‚è€ƒ"><a href="/1970/01/01/[macOS]ç”¨Homebrewå®‰è£…Mysql/#0xFF-å‚è€ƒ" class="headerlink" title="0xFF å‚è€ƒ"></a>0xFF å‚è€ƒ</h2><ol>
<li><a href="https://segmentfault.com/q/1010000000475470" target="_blank" rel="external">https://segmentfault.com/q/1010000000475470</a></li>
<li><a href="http://pein0119.github.io/2015/03/25/MySQL%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%90%AF%E5%8A%A8%E9%94%99%E8%AF%AF-The-server-quit-without-updating-PID-file/" target="_blank" rel="external">http://pein0119.github.io/2015/03/25/MySQL%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%90%AF%E5%8A%A8%E9%94%99%E8%AF%AF-The-server-quit-without-updating-PID-file/</a></li>
</ol>
<p><img src="https://raw.githubusercontent.com/ttdevs/ttdevs.github.io/common/images/logo.png" alt="Create by ttdevs"></p>
]]></content>
      
        <categories>
            
            <category> æŠ€æœ¯ </category>
            
        </categories>
        
        
        <tags>
            
            <tag> macOS </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[ã€ŒmacOSã€macOSå®‰è£…]]></title>
      <url>/1970/01/01/%5BmacOS%5DmacOS%E5%AE%89%E8%A3%85/</url>
      <content type="html"><![CDATA[<h2 id="0x00-è¦ä¸è¦é‡è£…ï¼Ÿ"><a href="/1970/01/01/[macOS]macOSå®‰è£…/#0x00-è¦ä¸è¦é‡è£…ï¼Ÿ" class="headerlink" title="0x00 è¦ä¸è¦é‡è£…ï¼Ÿ"></a>0x00 è¦ä¸è¦é‡è£…ï¼Ÿ</h2><p>å¯¹äºé‡è£…ç³»ç»Ÿï¼Œæˆ‘æ˜¯æ‹’ç»çš„ã€‚</p>
<p>æƒ³èµ·åˆšä¹°Macé‚£ä¼šï¼Œæ€»æ˜¯ç”¨Windowçš„æ€ç»´æ¥ç†è§£Macï¼Œè´¹äº†è€å¤§çš„åŠ²æ¥å¯¹ç£ç›˜è¿›è¡Œåˆ†åŒºï¼Œæœ€ååˆ†äº†ä¸¤ä¸ªåŒºï¼šç”¨æˆ·ç›®å½•æ”¾åœ¨ä¸€ä¸ªåŒºï¼Œå…¶ä»–æ–‡ä»¶æ”¾åœ¨å¦ä¸€åŒºã€‚æ„Ÿè§‰è‡ªå·±å¥½å±Œï¼Œä½†æ˜¯æ²¡è¿‡å¤šä¹…å‘ç°ä¸‹é¢ä¸¤ä¸ªé—®é¢˜ï¼š</p>
<ul>
<li><p>é‡è£…ç³»ç»Ÿï¼Œä¹‹å‰ç”¨æˆ·ç›®å½•çš„æ–‡ä»¶è¯»å–æƒé™å¯èƒ½ä¼šæœ‰é—®é¢˜</p>
<p>  åˆ«é—®æˆ‘ä¸ºä»€ä¹ˆï¼ŒçŸ¥é“é‡è£…å¯ä»¥è§£å†³å¤§éƒ¨åˆ†é—®é¢˜å°±å¥½äº†</p>
</li>
<li><p>éšç€æ—¶é—´çš„æµé€ï¼Œå¼€å§‹é¢„ç•™ç»™ ç³»ç»Ÿæ–‡ä»¶å’ŒAppæ‰€åœ¨åˆ†åŒº è¶Šæ¥è¶Šä¸å¤Ÿç”¨</p>
</li>
</ul>
<p>æœ€åæ€»ç»“ï¼šMac å¾ˆå°‘åï¼Œæ‰€ä»¥ï¼Œåˆ†åŒºå¹¶æ²¡ä»€ä¹ˆåµç”¨ï¼Œåªä¼šç»™æ‚¨çš„ä½¿ç”¨å¸¦æ¥éº»çƒ¦ã€‚</p>
<p>å¥½äº†ï¼Œè¨€å½’æ­£ä¼ ï¼Œè‡ªä»å‡çº§äº†macOS å°±å‡ºç°å„ç§å°é—®é¢˜ï¼Œpythonç”¨ä¸äº†äº†ï¼Œadbç»å¸¸æ–­ï¼Œç³»ç»Ÿå˜å¡äº†ï¼Œæ¯ä¸ªå°é—®é¢˜éƒ½è¦å»æ•´ä¸€ä¸‹ã€‚æƒ³æƒ³è¿˜æ˜¯ç®—äº†ï¼ŒèŠ±ç‚¹æ—¶é—´ï¼Œåœ¨å¦ä¸€å° Mac Mini ä¸Šé‡æ–°å®‰è£…ï¼Œç„¶åç”¨ Time Machine è¿˜åŸåˆ° Mac Bookä¸Šã€‚</p>
<h2 id="0x01-ç³»ç»Ÿå®‰è£…"><a href="/1970/01/01/[macOS]macOSå®‰è£…/#0x01-ç³»ç»Ÿå®‰è£…" class="headerlink" title="0x01 ç³»ç»Ÿå®‰è£…"></a>0x01 ç³»ç»Ÿå®‰è£…</h2><p>ç”µè„‘ä¸Šæœ‰ä¸€ä»½æœ€æ–°çš„macOSå®‰è£…æ–‡ä»¶ï¼Œæ‰“ç®—å»åšå®‰è£…Uç›˜ã€‚ä¸‹ç­å›å»å‡†å¤‡æ“ä½œçš„æ—¶å€™ï¼Œå‘ç°åšUç›˜å®‰è£…ç›˜çš„é€Ÿåº¦å¥½æ…¢æ…¢å¥½æ…¢å•Šã€‚æƒ³ï¼Œè¿˜æ˜¯ç®—äº†å§ï¼Œç¡è§‰ä¹‹å‰ä½¿ç”¨ç½‘ç»œå®‰è£…ï¼Œç¬¬äºŒå¤©é†’æ¥åº”è¯¥å¯ä»¥è£…å¥½ã€‚</p>
<p>è¿™é‡Œé™„ä¸€ä¸ª macOS å®‰è£…æ–‡ä»¶ä¸‹è½½åœ°å€ï¼š<a href="http://183.134.9.47/osxapps.itunes.apple.com/apple-assets-us-std-000001/Purple62/v4/af/5f/9d/af5f9d8e-cf9c-8147-c51c-c3c1fececb99/jze1425880974225146329.pkg?wsiphost=local" target="_blank" rel="external">Install macOS Sierra.app</a>ã€‚</p>
<h3 id="ç½‘ç»œå®‰è£…"><a href="/1970/01/01/[macOS]macOSå®‰è£…/#ç½‘ç»œå®‰è£…" class="headerlink" title="ç½‘ç»œå®‰è£…"></a>ç½‘ç»œå®‰è£…</h3><p>å¼€æœºæŒ‰ä½ Option(Alt) é”®ï¼Œè¿›å…¥å¯åŠ¨å¼•å¯¼ï¼Œé€‰æ‹©é‚£ä¸ªè™šæ‹Ÿç›˜ï¼ˆå¯èƒ½éœ€è¦è¾“å…¥WIFIå¯†ç ï¼Œæˆ‘ç”¨çš„ç½‘çº¿ï¼‰ï¼Œå…ˆå°†ä¸»ç¡¬ç›˜æ ¼å¼åŒ–ï¼ˆè¿™å°†ä¸¢å¤±æ‰€æœ‰æ•°æ®ï¼Œè¯·æå‰åšå¥½å¤‡ä»½ï¼‰ï¼Œç„¶åé€‰æ‹©ç¬¬äºŒé¡¹å®‰è£…ç³»ç»Ÿï¼ŒæŒ‰ç…§æç¤ºç‚¹å‡»å„ç§ ç»§ç»­ã€åŒæ„ ä¹‹ç±»ï¼Œå°±å¯ä»¥å»ç¡è§‰äº†ã€‚</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1801981-56d692d40f4d4edc.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Setup"></p>
<p>ç¬¬äºŒå¤©èµ·åºŠï¼Œå‘ç°å·²ç»å®‰è£…å¥½äº†ã€‚æŒ‰ç…§æç¤ºï¼Œè¿›è¡Œåˆå§‹åŒ–æ“ä½œï¼Œæ¯”å¦‚ç™»å½•icloudè´¦å·ï¼Œè®¾ç½®ç”¨æˆ·åç­‰ç­‰ã€‚ç„¶åæ–°çš„ç³»ç»Ÿå°±å¯ä»¥ç”¨äº†ã€‚</p>
<h3 id="æ—¥å¸¸ä½¿ç”¨å·¥å…·å®‰è£…"><a href="/1970/01/01/[macOS]macOSå®‰è£…/#æ—¥å¸¸ä½¿ç”¨å·¥å…·å®‰è£…" class="headerlink" title="æ—¥å¸¸ä½¿ç”¨å·¥å…·å®‰è£…"></a>æ—¥å¸¸ä½¿ç”¨å·¥å…·å®‰è£…</h3><p>è¿™é‡ŒåªæŒ‰ç…§ä¸ªäººéœ€è¦ï¼Œæµæ°´è´¦ä¸€æ ·çš„è®°å½•ä¸‹ã€‚</p>
<ul>
<li><p>iTerm2 </p>
<p>  è¿™ä¸ªæ˜¯ç”¨æ¥æ›¿ä»£Terminalï¼Œå¯ä»¥åšå¾ˆå¤šä¸ªæ€§åŒ–çš„è®¾ç½®ï¼Œç”¨èµ·æ¥æ›´é¡ºæ‰‹ã€‚ITå¿…å¤‡å§ã€‚<br>  ä¸‹è½½åœ°å€ï¼š<a href="http://www.iterm2.com/index.html" target="_blank" rel="external">http://www.iterm2.com/index.html</a></p>
</li>
<li><p>oh-my-zsh</p>
<p>  é»˜è®¤æƒ…å†µiTerm2å’ŒTerminalä¸€æ ·ï¼Œç•Œé¢éƒ½æ˜¯æ¯”è¾ƒä¸‘çš„ã€‚è¿™ä¸ªå¯ä»¥æ›´æ”¹iTerm2çš„ä¸»é¢˜ã€‚åŒæ—¶è¿˜é›†æˆäº†å„ç§å‘½ä»¤çš„ç®€å†™ã€‚</p>
<p>  ä¸‹è½½åœ°å€ï¼š<a href="http://ohmyz.sh" target="_blank" rel="external">http://ohmyz.sh</a></p>
</li>
<li><p>go2shell</p>
<p>  æœ‰æœ‹å‹æ¨èä¸€äº›å·¥å…·æ¥æ›¿ä»£Finderï¼Œè£…ä¸ªè¿™ä¸ªå°å·¥å…·ä¹‹åï¼ŒåŸºæœ¬ä¸Šå°±æ‡’å¾—å†å»å­¦ä¸€ä¸ª ç±»Finder äº†ã€‚å®ƒçš„åŠŸèƒ½è¶…çº§ç®€å•ï¼Œç‚¹å‡»ä¸€ä¸ªæŒ‰é’®ï¼Œåœ¨å½“å‰ä½ç½®æ‰“å¼€ä¸€ä¸ªTerminalçª—å£ã€‚</p>
<p>  ä¸‹è½½åœ°å€ï¼š<a href="http://zipzapmac.com/Go2Shell" target="_blank" rel="external">http://zipzapmac.com/Go2Shell</a><br>  ï¼ˆä¸å»ºè®®ä»App Storeä¸‹è½½ï¼‰</p>
</li>
<li><p>homebrew</p>
<p>  è¿™ä¸ªç”¨æ¥ç®¡ç†è½¯ä»¶çš„ï¼Œç±»ä¼¼wgetç­‰ã€‚ä¹‹å‰å®‰è£…è½¯ä»¶ï¼Œéƒ½æ˜¯åˆ°å„å®¶å®˜ç½‘å»æ‰¾å®‰è£…åŒ…ï¼Œè‡ªä»æœ‰äº†è¿™ä¸ªï¼Œå¾ˆå¤šè½¯ä»¶å†ä¹Ÿä¸ç”¨åˆ°å¤„å»æ‰¾äº†ã€‚</p>
<p>  ä¸‹è½½åœ°å€ï¼š<a href="http://brew.sh" target="_blank" rel="external">http://brew.sh</a></p>
</li>
<li><p>alfred</p>
<p>  å¦‚æœä½ ä½¿ç”¨ Spotlight ï¼Œalfredå¯èƒ½æ˜¯ä¸€ä¸ªæ›´å¥½çš„é€‰æ‹©ã€‚</p>
<p>  ä¸‹è½½åœ°å€ï¼šå¯ä»¥ç›´æ¥åœ¨App Storeä¸‹è½½ã€‚</p>
</li>
<li><p>Firefoxï¼ˆè¿™é‡Œä»…ä»…è®°å½•å‡ ä¸ªå¸¸ç”¨çš„æ’ä»¶ï¼‰</p>
<ul>
<li>Adblock Plus å¹¿å‘Šå·²æˆå¾€äº‹</li>
<li>BingDcit æ²¡æ‰¾åˆ°æ›´å¥½çš„ç¿»è¯‘æ›¿ä»£å·¥å…·</li>
<li>JSONView ç½‘é¡µæŸ¥çœ‹jsonæ•°æ®æ›´å‹å¥½</li>
<li>Octotree è®¿é—®Githubæ—¶ï¼Œä¼šåœ¨å·¦ä¾§åˆ—å‡ºæ–‡ä»¶åˆ—è¡¨ï¼Œä¸‹è½½æµè§ˆæ›´æ–¹ä¾¿</li>
<li>User-Agent Switcher è®¿é—®ä¸€ä¸‹æ‰‹æœºç½‘é¡µä¼šæ›´æ–¹ä¾¿</li>
<li>TabTrekker ä¸€ä¸ªé…·ç‚«çš„æ¡Œé¢æ’ä»¶ï¼Œæ¯å¤©ç»™ä½ ä¸åŒçš„å£çº¸</li>
</ul>
</li>
<li><p>Chromeï¼ˆè¿™é‡Œä»…ä»…è®°å½•å‡ ä¸ªå¸¸ç”¨çš„æ’ä»¶ï¼‰</p>
<ul>
<li>Adblock Plus</li>
<li>JSONView ç½‘é¡µæŸ¥çœ‹jsonæ•°æ®æ›´å‹å¥½</li>
<li>Octotree è®¿é—®Githubæ—¶ï¼Œä¼šåœ¨å·¦ä¾§åˆ—å‡ºæ–‡ä»¶åˆ—è¡¨ï¼Œä¸‹è½½æµè§ˆæ›´æ–¹ä¾¿</li>
<li>OneTab</li>
<li>Pocket</li>
<li>Translt ä¸€ä¸ªç¿»è¯‘æ’ä»¶ï¼ŒåŒå‡»å³å¯ç¿»è¯‘ï¼Œä½“éªŒå¾ˆæ£’</li>
<li><p>Unsplash Instant å’ŒTabTrekkerå¾ˆåƒ</p>
<p>PSï¼šChromeæ’ä»¶è™½å¥½ï¼Œä½†è¯·æŒ‰éœ€é€‰æ‹©ï¼Œé™¤éä½ çš„å†…å­˜å¤§å¤§çš„ã€‚</p>
</li>
</ul>
</li>
<li><p>python å’Œ python3</p>
<p>  macç³»ç»Ÿè‡ªå¸¦äº†python2.7ï¼Œè¿™é‡Œæˆ‘è¿˜æ˜¯é€‰æ‹©äº†ä½¿ç”¨brewå®‰è£…äº†pythonå’Œpython3ã€‚</p>
</li>
<li><p>IntelliJ IDEA (Plugins)</p>
<ul>
<li>GsonFormat</li>
<li>Android ButterKnife Zelezny</li>
<li>CodeGlance</li>
</ul>
</li>
<li><p>å…¶ä»–å¼€å‘å·¥å…·</p>
<p>  è¿™ä¸ªå°±çœ‹å„ä½éœ€è¦äº†ï¼Œæˆ‘è£…äº†ä¸€å †ã€‚</p>
</li>
</ul>
<h3 id="æ”¶è´¹App"><a href="/1970/01/01/[macOS]macOSå®‰è£…/#æ”¶è´¹App" class="headerlink" title="æ”¶è´¹App"></a>æ”¶è´¹App</h3><ul>
<li>mweb</li>
<li>Inboard</li>
<li>Day One</li>
<li>1Password</li>
<li>Affinity Designer</li>
<li>macOS Server</li>
<li>Apple Remote Desktop</li>
<li>Polarr</li>
<li>PCalc</li>
<li>å°å†</li>
<li>Inbox for Gmail</li>
<li>Paste</li>
<li>å¯æ„è§†é¢‘</li>
<li>TODO è¿˜æœ‰å¾ˆå¤šæ²¡åˆ—å‡ºæ¥</li>
</ul>
<p>åˆ«é—®æˆ‘æ˜¯ä¸æ˜¯è£…äº†è¿™é‡Œæ‰€æœ‰è½¯ä»¶ï¼Œå‘Šè¯‰ä½ æˆ‘è£…äº†ï¼Œä½†ä¸è¦å´‡æ‹œå“¥ï¼Œä¸‡èƒ½çš„æ·˜å®å¯ä»¥å®ç°ä½ çš„æ¢¦æƒ³ğŸ™ˆ</p>
<h3 id="ç¯å¢ƒé…ç½®"><a href="/1970/01/01/[macOS]macOSå®‰è£…/#ç¯å¢ƒé…ç½®" class="headerlink" title="ç¯å¢ƒé…ç½®"></a>ç¯å¢ƒé…ç½®</h3><ul>
<li><p>ç¯å¢ƒå˜é‡</p>
<p>  å®‰è£…å¥½oh-my-shä¹‹åï¼Œå°±å¯ä»¥æ·»åŠ è‡ªå·±çš„ç¯å¢ƒå˜é‡é…ç½®äº†ï¼Œè¿™é‡Œç®€å•è¯´äº›æˆ‘çš„é…ç½®ã€‚é¦–å…ˆæˆ‘é€‰æ‹©åœ¨ä¸€ä¸ªå•ç‹¬çš„æ–‡ä»¶ä¸­<code>~/.bash_profile</code> å†™è‡ªå·±çš„é…ç½®ï¼Œç„¶åå°†æ­¤æ–‡ä»¶æ·»åŠ åˆ° <code>~/.zshrc</code> çš„æœ€å <code>source ~/.bash_profile</code>ã€‚<code>.bash_profile</code>çš„å†…å®¹å¦‚ä¸‹ï¼š</p>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">export JAVA_HOME=/Library/Java/JavaVirtualMachines/jdk1.8.0_101.jdk/Contents/Home</div><div class="line">export GRADLE_HOME=$HOME/android/gradle/gradle-2.14.1</div><div class="line">export ANDROID_HOME=$HOME/android/android-sdk-macosx</div><div class="line">export NDK_HOME=$ANDROID_HOME/ndk-bundle</div><div class="line">export PATH=$&#123;PATH&#125;:$&#123;ANDROID_HOME&#125;/platform-tools:$&#123;ANDROID_HOME&#125;/tools:$&#123;NDK_HOME&#125;/:$&#123;GRADLE_HOME&#125;/bin:$&#123;JAVA_HOME&#125;/bin:$&#123;JAVA_HOME&#125;/lib:</div><div class="line"></div><div class="line">#</div><div class="line"># Aliases</div><div class="line"># Create by ttdevs 2016-03-31</div><div class="line">#</div><div class="line"></div><div class="line">alias oi=&apos;open -a iterm .&apos;</div><div class="line">alias of=&apos;open -a Finder .&apos;</div><div class="line">alias vv=&apos;virtualenv&apos;</div><div class="line">alias weather=&apos;curl http://wttr.in/shanghai&apos;</div></pre></td></tr></table></figure>
<h2 id="0x02-ç»§ç»­è£…é€¼"><a href="/1970/01/01/[macOS]macOSå®‰è£…/#0x02-ç»§ç»­è£…é€¼" class="headerlink" title="0x02 ç»§ç»­è£…é€¼"></a>0x02 ç»§ç»­è£…é€¼</h2><p>é‡è£…ç³»ç»Ÿï¼Œæˆ‘ä»æ˜¯æ‹’ç»çš„ã€‚</p>
<p>æ­¤æ–‡ä¸å®šæœŸæ›´æ–°ã€‚</p>
<p>æœ€åï¼ŒApp Storeçš„è½¯ä»¶è¿˜æ˜¯æ¯”è¾ƒè´µçš„ï¼Œå…¥å‘éœ€è°¨æ… å•Š å•Š å•Š</p>
<hr>
<p><img src="https://raw.githubusercontent.com/ttdevs/ttdevs.github.io/common/images/logo.png" alt="Create by ttdevs"></p>
]]></content>
      
        <categories>
            
            <category> æŠ€æœ¯ </category>
            
        </categories>
        
        
        <tags>
            
            <tag> macOS </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[ã€ŒWebSocketã€ä½¿ç”¨Websocketå®ç°æ¶ˆæ¯æ¨é€(ä¸Š)]]></title>
      <url>/1970/01/01/%5BWebSocket%5D%E4%BD%BF%E7%94%A8Websocket%E5%AE%9E%E7%8E%B0%E6%B6%88%E6%81%AF%E6%8E%A8%E9%80%81(%E4%B8%8A)/</url>
      <content type="html"><![CDATA[<h2 id="0x00-Websocket"><a href="/1970/01/01/[WebSocket]ä½¿ç”¨Websocketå®ç°æ¶ˆæ¯æ¨é€(ä¸Š)/#0x00-Websocket" class="headerlink" title="0x00 Websocket"></a>0x00 Websocket</h2><p>è”ç³»å®¢æœåŠŸèƒ½åœ¨é¡¹ç›®ä¸­å¾ˆéš¾é¿å…ï¼Œä¸€èˆ¬æœ‰ä¸‹é¢ä¸‰ç§å®ç°æ–¹å¼ï¼š</p>
<ul>
<li>ä½¿ç”¨httpçš„getæ–¹å¼è½®è¯¢</li>
<li>æ¥å…¥ç¬¬ä¸‰æ–¹IMç³»ç»Ÿ</li>
<li>è‡ªå·±çš„IMç³»ç»Ÿ<ul>
<li>åŸºäºsocket</li>
<li>åŸºäºwebsocket</li>
</ul>
</li>
</ul>
<p>ç¬¬ä¸€ç§æ–¹å¼ï¼Œæœ€lowçš„ï¼Œå®ç°ç®€å•ï¼Œä½†æ˜¯æµªè´¹ç”¨æˆ·æµé‡ï¼›ç¬¬äºŒç§æ–¹å¼ï¼Œæ¥å…¥ç®€å•ï¼ŒåŠŸèƒ½å¼ºå¤§ï¼Œä½†æ˜¯å¯èƒ½éœ€è¦ä¸€å®šçš„æˆæœ¬ï¼ˆæ¯”å¦‚ä»˜è´¹ï¼‰ï¼›ç¬¬ä¸‰ç§æ–¹å¼ï¼Œéœ€è¦ä¸€å®šçš„å¼€å‘æˆæœ¬ï¼ˆæœåŠ¡å™¨æ‰˜ç®¡è´¹ç”¨å¿½ç•¥ï¼‰ã€‚å¯¹äºç¬¬ä¸‰ç§æƒ…å†µçš„ socketï¼Œå®ç°IMçš„æ–‡å­—åŠ éŸ³è§†é¢‘èŠå¤©ï¼Œåšè¿‡çš„è¯ä½ å¯ä»¥ä¹Ÿä¼šç›´æ¥æ‡µé€¼ã€‚ä½†æ˜¯ï¼Œç®€å•çš„æ–‡å­—èŠå¤©è¿˜å¥½ï¼Œä¸è¿‡ä½ è¿˜æ˜¯éœ€è¦å»å®šä¹‰ä¸€äº›åè®®æ¥å®ç°è¿™æ ·ä¸€ä¸ªåŠŸèƒ½ã€‚å¦‚æœæˆ‘ä»¬ä½¿ç”¨websocketï¼Œé‚£äº‹æƒ…å°±å˜çš„ç®€å•å¾ˆå¤šã€‚</p>
<blockquote>
<p>WebSocketä¸€ç§åœ¨å•ä¸ª TCP è¿æ¥ä¸Šè¿›è¡Œå…¨åŒå·¥é€šè®¯çš„åè®®ã€‚WebSocketé€šä¿¡åè®®äº2011å¹´è¢«IETFå®šä¸ºæ ‡å‡†RFC 6455ï¼Œå¹¶è¢«RFC7936æ‰€è¡¥å……è§„èŒƒï¼ŒWebSocketAPIè¢«W3Cå®šä¸ºæ ‡å‡†ã€‚</p>
<p>WebSocket æ˜¯ç‹¬ç«‹çš„ã€åˆ›å»ºåœ¨ TCP ä¸Šçš„åè®®ï¼Œå’Œ HTTP çš„å”¯ä¸€å…³è”æ˜¯ä½¿ç”¨ HTTP åè®®çš„101çŠ¶æ€ç è¿›è¡Œåè®®åˆ‡æ¢ï¼Œä½¿ç”¨çš„ TCP ç«¯å£æ˜¯80ï¼Œå¯ä»¥ç”¨äºç»•è¿‡å¤§å¤šæ•°é˜²ç«å¢™çš„é™åˆ¶ã€‚</p>
<p>WebSocket ä½¿å¾—å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´çš„æ•°æ®äº¤æ¢å˜å¾—æ›´åŠ ç®€å•ï¼Œå…è®¸æœåŠ¡ç«¯ç›´æ¥å‘å®¢æˆ·ç«¯æ¨é€æ•°æ®è€Œä¸éœ€è¦å®¢æˆ·ç«¯è¿›è¡Œè¯·æ±‚ï¼Œåœ¨ WebSocket API ä¸­ï¼Œæµè§ˆå™¨å’ŒæœåŠ¡å™¨åªéœ€è¦å®Œæˆä¸€æ¬¡æ¡æ‰‹ï¼Œä¸¤è€…ä¹‹é—´å°±ç›´æ¥å¯ä»¥åˆ›å»ºæŒä¹…æ€§çš„è¿æ¥ï¼Œå¹¶å…è®¸æ•°æ®è¿›è¡ŒåŒå‘ä¼ é€ã€‚</p>
<p>ç›®å‰å¸¸è§çš„æµè§ˆå™¨å¦‚ Chromeã€IEã€Firefoxã€Safariã€Opera ç­‰éƒ½æ”¯æŒ WebSocketï¼ŒåŒæ—¶éœ€è¦æœåŠ¡ç«¯ç¨‹åºæ”¯æŒ WebSocketã€‚</p>
</blockquote>
<p><a href="https://zh.wikipedia.org/wiki/WebSocket" target="_blank" rel="external">æ¥è‡ªç»´åŸºç™¾ç§‘ https://zh.wikipedia.org/wiki/WebSocket</a></p>
<p>websocketåªæ˜¯ä¸€ç§åè®®ï¼Œç±»ä¼¼httpï¼Œå› æ­¤ä¸è¯­è¨€æ— å…³ã€‚è¿™é‡Œæˆ‘ä½¿ç”¨javaæ¥åšæœåŠ¡ç«¯ï¼ŒåŒæ—¶æä¾›androidå’Œhtmlçš„å®¢æˆ·ç«¯ï¼Œé€šè¿‡ä¸€ä¸ªç®€å•çš„demoæ¥ä»‹ç»websocketçš„ä½¿ç”¨ï¼Œæ¥ä¸‹æ¥çš„ä¸€ç¯‡ä¼šå¯¹websocketè¿›è¡Œåˆ†æã€‚</p>
<h2 id="0x01-æœåŠ¡ç«¯"><a href="/1970/01/01/[WebSocket]ä½¿ç”¨Websocketå®ç°æ¶ˆæ¯æ¨é€(ä¸Š)/#0x01-æœåŠ¡ç«¯" class="headerlink" title="0x01 æœåŠ¡ç«¯"></a>0x01 æœåŠ¡ç«¯</h2><p>è¿™é‡Œæˆ‘ä½¿ç”¨ <a href="https://github.com/TooTallNate/Java-WebSocket" target="_blank" rel="external">Java-WebSocket</a> è¿™ä¸ªåº“æ¥å®ç° websocket serverã€‚éœ€è¦çš„jaråŒ…ä½äºé¡¹ç›®çš„ <code>/Java-WebSocket/dist/java-websocket.jar</code> ä½ç½®ã€‚æ•ˆæœå¦‚ä¸‹ï¼š</p>
<p><img src="http://img.blog.csdn.net/20160826172546089" alt="server"></p>
<p>ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SocketServer</span> <span class="keyword">extends</span> <span class="title">WebSocketServer</span> </span>&#123;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> PORT = <span class="number">2333</span>;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">        SocketServer server = <span class="keyword">new</span> SocketServer(PORT);</div><div class="line">        server.start();</div><div class="line"></div><div class="line">        <span class="keyword">try</span> &#123;</div><div class="line">            String ip = InetAddress.getLocalHost().getHostAddress();</div><div class="line">            <span class="keyword">int</span> port = server.getPort();</div><div class="line">            print(String.format(<span class="string">"æœåŠ¡å·²å¯åŠ¨: %s:%d"</span>, ip, port));</div><div class="line">        &#125; <span class="keyword">catch</span> (UnknownHostException e) &#123;</div><div class="line">            e.printStackTrace();</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        InputStreamReader in = <span class="keyword">new</span> InputStreamReader(System.in);</div><div class="line">        BufferedReader reader = <span class="keyword">new</span> BufferedReader(in);</div><div class="line"></div><div class="line">        <span class="keyword">while</span> (<span class="keyword">true</span>) &#123;</div><div class="line">            <span class="keyword">try</span> &#123;</div><div class="line">                String msg = reader.readLine();</div><div class="line">                server.broadcastMessage(msg);</div><div class="line">            &#125; <span class="keyword">catch</span> (Exception e) &#123;</div><div class="line">                e.printStackTrace();</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">SocketServer</span><span class="params">(<span class="keyword">int</span> port)</span> </span>&#123;</div><div class="line">        <span class="keyword">super</span>(<span class="keyword">new</span> InetSocketAddress(port));</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">SocketServer</span><span class="params">(InetSocketAddress address)</span> </span>&#123;</div><div class="line">        <span class="keyword">super</span>(address);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onOpen</span><span class="params">(WebSocket webSocket, ClientHandshake clientHandshake)</span> </span>&#123;</div><div class="line">        String address = webSocket.getRemoteSocketAddress().getAddress().getHostAddress();</div><div class="line">        String message = String.format(<span class="string">"(%s) &lt;åŠ å…¥&gt;"</span>, address);</div><div class="line">        broadcastMessage(message);</div><div class="line">        print(message);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClose</span><span class="params">(WebSocket webSocket, <span class="keyword">int</span> code, String reason, <span class="keyword">boolean</span> remote)</span> </span>&#123;</div><div class="line">        String address = webSocket.getRemoteSocketAddress().getAddress().getHostAddress();</div><div class="line">        String message = String.format(<span class="string">"(%s) &lt;ç¦»å¼€&gt;"</span>, address);</div><div class="line">        broadcastMessage(message);</div><div class="line">        print(message);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onMessage</span><span class="params">(WebSocket webSocket, String msg)</span> </span>&#123;</div><div class="line">        String address = webSocket.getRemoteSocketAddress().getAddress().getHostAddress();</div><div class="line">        String message = String.format(<span class="string">"(%s) %s"</span>, address, msg);</div><div class="line">        broadcastMessage(message);</div><div class="line">        print(message);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onError</span><span class="params">(WebSocket webSocket, Exception e)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (<span class="keyword">null</span> != webSocket) &#123;</div><div class="line">            <span class="keyword">if</span> (!webSocket.isClosed()) &#123;</div><div class="line">                webSocket.close(<span class="number">0</span>);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        e.printStackTrace();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * å¹¿æ’­æ”¶åˆ°æ¶ˆæ¯</div><div class="line">     *</div><div class="line">     * <span class="doctag">@param</span> msg</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">broadcastMessage</span><span class="params">(String msg)</span> </span>&#123;</div><div class="line">        Collection&lt;WebSocket&gt; connections = connections();</div><div class="line">        <span class="keyword">synchronized</span> (connections) &#123;</div><div class="line">            <span class="keyword">for</span> (WebSocket client : connections) &#123;</div><div class="line">                client.send(msg);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">print</span><span class="params">(String msg)</span> </span>&#123;</div><div class="line">        System.out.println(String.format(<span class="string">"[%d] %s"</span>, System.currentTimeMillis(), msg));</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="0x02-å®¢æˆ·ç«¯"><a href="/1970/01/01/[WebSocket]ä½¿ç”¨Websocketå®ç°æ¶ˆæ¯æ¨é€(ä¸Š)/#0x02-å®¢æˆ·ç«¯" class="headerlink" title="0x02 å®¢æˆ·ç«¯"></a>0x02 å®¢æˆ·ç«¯</h2><ul>
<li><p>Android</p>
<p>  è¿™é‡Œä¹Ÿæ˜¯ç”¨java-websocketè¿™ä¸ªåº“ï¼Œæ•ˆæœå¦‚ä¸‹ï¼š</p>
<p>  <img src="http://img.blog.csdn.net/20160826172640594" alt="android"></p>
<p>  æ ¸å¿ƒä»£ç ï¼š</p>
  <figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div></pre></td><td class="code"><pre><div class="line">	<span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">WebSocketActivity</span> <span class="keyword">extends</span> <span class="title">BaseActivity</span> </span>&#123;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> STATUS_CLOSE = <span class="number">0</span>;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> STATUS_CONNECT = <span class="number">1</span>;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> STATUS_MESSAGE = <span class="number">2</span>;</div><div class="line"></div><div class="line">    <span class="meta">@Bind</span>(R.id.etIP)</div><div class="line">    EditText etIP;</div><div class="line">    <span class="meta">@Bind</span>(R.id.etPort)</div><div class="line">    EditText etPort;</div><div class="line">    <span class="meta">@Bind</span>(R.id.tvStatus)</div><div class="line">    TextView tvStatus;</div><div class="line">    <span class="meta">@Bind</span>(R.id.tvMsg)</div><div class="line">    TextView tvMsg;</div><div class="line">    <span class="meta">@Bind</span>(R.id.rgVersion)</div><div class="line">    RadioGroup rgVersion;</div><div class="line">    <span class="meta">@Bind</span>(R.id.etMessage)</div><div class="line">    EditText etMessage;</div><div class="line">    <span class="meta">@Bind</span>(R.id.svContent)</div><div class="line">    ScrollView svContent;</div><div class="line">    <span class="meta">@Bind</span>(R.id.viewMain)</div><div class="line">    View viewMain;</div><div class="line"></div><div class="line">    <span class="meta">@Bind</span>(R.id.btConnect)</div><div class="line">    Button btConnect;</div><div class="line">    <span class="meta">@Bind</span>(R.id.btDisconnect)</div><div class="line">    Button btDisconnect;</div><div class="line">    <span class="meta">@Bind</span>(R.id.btSend)</div><div class="line">    Button btSend;</div><div class="line"></div><div class="line">    <span class="meta">@OnClick</span>(&#123;R.id.btConnect, R.id.btDisconnect, R.id.btSend&#125;)</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span><span class="params">(View view)</span> </span>&#123;</div><div class="line">        <span class="keyword">switch</span> (view.getId()) &#123;</div><div class="line">            <span class="keyword">case</span> R.id.btConnect:</div><div class="line">                connectToServer();</div><div class="line">                <span class="keyword">break</span>;</div><div class="line">            <span class="keyword">case</span> R.id.btDisconnect:</div><div class="line">                <span class="keyword">if</span> (<span class="keyword">null</span> != mClient) &#123;</div><div class="line">                    mClient.close();</div><div class="line">                &#125;</div><div class="line">                <span class="keyword">break</span>;</div><div class="line">            <span class="keyword">case</span> R.id.btSend:</div><div class="line">                <span class="keyword">if</span> (<span class="keyword">null</span> != mClient) &#123;</div><div class="line">                    String msg = etMessage.getText().toString();</div><div class="line">                    <span class="keyword">if</span> (!TextUtils.isEmpty(msg)) &#123;</div><div class="line">                        <span class="keyword">try</span> &#123;</div><div class="line">                            mClient.send(msg);</div><div class="line">                        &#125; <span class="keyword">catch</span> (NotYetConnectedException e) &#123;</div><div class="line">                            e.printStackTrace();</div><div class="line">                            <span class="keyword">return</span>;</div><div class="line">                        &#125;</div><div class="line">                        etMessage.setText(<span class="string">""</span>);</div><div class="line">                    &#125;</div><div class="line">                &#125;</div><div class="line">                <span class="keyword">break</span>;</div><div class="line"></div><div class="line">            <span class="keyword">default</span>:</div><div class="line">                <span class="keyword">break</span>;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">private</span> Client mClient;</div><div class="line">    <span class="keyword">private</span> Handler mHandle = <span class="keyword">new</span> Handler() &#123;</div><div class="line">        <span class="meta">@Override</span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">handleMessage</span><span class="params">(Message msg)</span> </span>&#123;</div><div class="line">            String message = String.format(<span class="string">"[%d] %s\n"</span>, System.currentTimeMillis(), msg.obj.toString());</div><div class="line">            tvMsg.append(message);</div><div class="line"></div><div class="line">            <span class="keyword">switch</span> (msg.what) &#123;</div><div class="line">                <span class="keyword">case</span> STATUS_CONNECT:</div><div class="line">                    btConnect.setEnabled(<span class="keyword">false</span>);</div><div class="line">                    btDisconnect.setEnabled(<span class="keyword">true</span>);</div><div class="line">                    btSend.setEnabled(<span class="keyword">true</span>);</div><div class="line">                    <span class="keyword">break</span>;</div><div class="line">                <span class="keyword">case</span> STATUS_CLOSE:</div><div class="line">                    btConnect.setEnabled(<span class="keyword">true</span>);</div><div class="line">                    btDisconnect.setEnabled(<span class="keyword">false</span>);</div><div class="line">                    btSend.setEnabled(<span class="keyword">false</span>);</div><div class="line">                    <span class="keyword">break</span>;</div><div class="line">                <span class="keyword">case</span> STATUS_MESSAGE:</div><div class="line">                    <span class="comment">// <span class="doctag">TODO:</span> 16/8/24</span></div><div class="line">                    <span class="keyword">break</span>;</div><div class="line">                <span class="keyword">default</span>:</div><div class="line">                    <span class="keyword">break</span>;</div><div class="line">            &#125;</div><div class="line">            svContent.postDelayed(<span class="keyword">new</span> Runnable() &#123;</div><div class="line">                <span class="meta">@Override</span></div><div class="line">                <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</div><div class="line">                    svContent.fullScroll(View.FOCUS_DOWN);</div><div class="line">                &#125;</div><div class="line">            &#125;, <span class="number">100</span>);</div><div class="line">        &#125;</div><div class="line">    &#125;;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</div><div class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState);</div><div class="line">        setContentView(R.layout.activity_web_socket);</div><div class="line">        ButterKnife.bind(<span class="keyword">this</span>);</div><div class="line"></div><div class="line"></div><div class="line">        System.setProperty(<span class="string">"java.net.preferIPv6Addresses"</span>, <span class="string">"false"</span>);</div><div class="line">        System.setProperty(<span class="string">"java.net.preferIPv4Stack"</span>, <span class="string">"true"</span>);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">connectToServer</span><span class="params">()</span> </span>&#123;</div><div class="line">        String ip = etIP.getText().toString();</div><div class="line">        String port = etPort.getText().toString();</div><div class="line">        <span class="keyword">if</span> (TextUtils.isEmpty(ip) || TextUtils.isEmpty(port)) &#123;</div><div class="line">            Snackbar.make(viewMain, <span class="string">"IP and Port ä¸èƒ½ä¸ºç©º"</span>, Snackbar.LENGTH_LONG).show();</div><div class="line">            <span class="keyword">return</span>;</div><div class="line">        &#125;</div><div class="line">        String address = String.format(<span class="string">"ws://%s:%s"</span>, ip, port);</div><div class="line">        Draft draft = <span class="keyword">null</span>;</div><div class="line">        <span class="keyword">switch</span> (rgVersion.getCheckedRadioButtonId()) &#123;</div><div class="line">            <span class="keyword">case</span> R.id.rbDraft10:</div><div class="line">                draft = <span class="keyword">new</span> Draft_10();</div><div class="line">                <span class="keyword">break</span>;</div><div class="line">            <span class="keyword">case</span> R.id.rbDraft17:</div><div class="line">                draft = <span class="keyword">new</span> Draft_17();</div><div class="line">                <span class="keyword">break</span>;</div><div class="line">            <span class="keyword">case</span> R.id.rbDraft75:</div><div class="line">                draft = <span class="keyword">new</span> Draft_75();</div><div class="line">                <span class="keyword">break</span>;</div><div class="line">            <span class="keyword">case</span> R.id.rbDraft76:</div><div class="line">                draft = <span class="keyword">new</span> Draft_76();</div><div class="line">                <span class="keyword">break</span>;</div><div class="line"></div><div class="line">            <span class="keyword">default</span>:</div><div class="line">                draft = <span class="keyword">new</span> Draft_17();</div><div class="line">                <span class="keyword">break</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">try</span> &#123;</div><div class="line">            URI uri = <span class="keyword">new</span> URI(address);</div><div class="line">            mClient = <span class="keyword">new</span> Client(uri, draft);</div><div class="line">            mClient.connect();</div><div class="line">        &#125; <span class="keyword">catch</span> (URISyntaxException e) &#123;</div><div class="line">            e.printStackTrace();</div><div class="line">            <span class="keyword">return</span>;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        tvStatus.setText(address);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">private</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> <span class="keyword">extends</span> <span class="title">WebSocketClient</span> </span>&#123;</div><div class="line"></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="title">Client</span><span class="params">(URI serverURI)</span> </span>&#123;</div><div class="line">            <span class="keyword">super</span>(serverURI);</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="title">Client</span><span class="params">(URI serverUri, Draft draft)</span> </span>&#123;</div><div class="line">            <span class="keyword">super</span>(serverUri, draft);</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="meta">@Override</span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onOpen</span><span class="params">(ServerHandshake handShakeData)</span> </span>&#123;</div><div class="line">            Message msg = <span class="keyword">new</span> Message();</div><div class="line">            msg.what = STATUS_CONNECT;</div><div class="line">            msg.obj = String.format(<span class="string">"[Welcomeï¼š%s]"</span>, getURI());</div><div class="line">            mHandle.sendMessage(msg);</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="meta">@Override</span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onMessage</span><span class="params">(String message)</span> </span>&#123;</div><div class="line">            Message msg = <span class="keyword">new</span> Message();</div><div class="line">            msg.what = STATUS_MESSAGE;</div><div class="line">            msg.obj = message;</div><div class="line">            mHandle.sendMessage(msg);</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="meta">@Override</span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClose</span><span class="params">(<span class="keyword">int</span> code, String reason, <span class="keyword">boolean</span> remote)</span> </span>&#123;</div><div class="line">            Message msg = <span class="keyword">new</span> Message();</div><div class="line">            msg.what = STATUS_CLOSE;</div><div class="line">            msg.obj = String.format(<span class="string">"[Byeï¼š%s]"</span>, getURI());</div><div class="line">            mHandle.sendMessage(msg);</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="meta">@Override</span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onError</span><span class="params">(Exception ex)</span> </span>&#123;</div><div class="line">            ex.printStackTrace();</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ul>
<ul>
<li><p>Html</p>
<p>  H5ä½¿ç”¨äº†è¿™ä¸ªåº“ï¼š<a href="https://github.com/sstephenson/prototype" target="_blank" rel="external">sstephenson/prototype</a>ï¼Œæ•ˆæœå¦‚ä¸‹ï¼š</p>
<p>  <img src="http://img.blog.csdn.net/20160826172728638" alt="html5"></p>
<p>  æ ¸å¿ƒä»£ç å¦‚ä¸‹ï¼š</p>
  <figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span><span class="undefined"></span></div><div class="line">    document.observe("dom:loaded", function () &#123;</div><div class="line">        function log(text) &#123;</div><div class="line">            var value = (new Date).getTime();</div><div class="line">            value += ": ";</div><div class="line">            value += text.escapeHTML();</div><div class="line">            value += $("log").innerHTML;</div><div class="line">            $("log").innerHTML = value;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        if (!window.WebSocket) &#123;</div><div class="line">            alert("æµè§ˆå™¨ä¸æ”¯æŒ,æ¢ä¸€ä¸ªå§");</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        var ws;</div><div class="line"></div><div class="line">        $("connectForm").observe("submit", function (e) &#123;</div><div class="line">            e.stop();</div><div class="line">            ws = new WebSocket($F("uri"));</div><div class="line">            ws.onopen = function () &#123;</div><div class="line">                log("è¿æ¥åˆ°æœåŠ¡å™¨\n");</div><div class="line">            &#125;</div><div class="line">            ws.onmessage = function (e) &#123;</div><div class="line">                log("æœåŠ¡å™¨ä¿¡æ¯: " + e.data + "\n");</div><div class="line">            &#125;</div><div class="line">            ws.onclose = function () &#123;</div><div class="line">                log("æ–­å¼€æœåŠ¡å™¨è¿æ¥\n");</div><div class="line"></div><div class="line">                $("uri", "connect").invoke("enable");</div><div class="line">                $("close").disable();</div><div class="line">                ws = null;</div><div class="line">            &#125;</div><div class="line"></div><div class="line">            $("uri", "connect").invoke("disable");</div><div class="line">            $("close").enable();</div><div class="line">        &#125;);</div><div class="line">        $("close").observe("click", function (e) &#123;</div><div class="line">            e.stop();</div><div class="line">            if (ws) &#123;</div><div class="line">                ws.close();</div><div class="line">                ws = null;</div><div class="line">            &#125;</div><div class="line">        &#125;);</div><div class="line">        $("sendForm").observe("submit", function (e) &#123;</div><div class="line">            e.stop();</div><div class="line">            if (ws) &#123;</div><div class="line">                var message = $("message");</div><div class="line">                ws.send(message.value);</div><div class="line">                message.value = "";</div><div class="line">                message.focus();</div><div class="line">            &#125;</div><div class="line">        &#125;);</div><div class="line"></div><div class="line">    &#125;);</div><div class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div></pre></td></tr></table></figure>
</li>
</ul>
<p>æ‰€æœ‰çš„ä»£ç éƒ½å¯ä»¥åˆ°githubæŸ¥çœ‹ï¼š<a href="https://github.com/ttdevs/android/tree/master/modules/webscoket" target="_blank" rel="external">ttdevs</a>ã€‚</p>
<p>ä¸‹ä¸€ç¯‡å°†é€šè¿‡å¯¹websocketåè®®çš„åˆ†æï¼Œæ¥å¯¹å…¶åšè¿›ä¸€æ­¥çš„äº†è§£ã€‚</p>
<h2 id="0xFF-å‚è€ƒ"><a href="/1970/01/01/[WebSocket]ä½¿ç”¨Websocketå®ç°æ¶ˆæ¯æ¨é€(ä¸Š)/#0xFF-å‚è€ƒ" class="headerlink" title="0xFF å‚è€ƒ"></a>0xFF å‚è€ƒ</h2><ol>
<li><a href="https://github.com/sstephenson/prototype" target="_blank" rel="external">https://github.com/sstephenson/prototype</a></li>
<li><a href="https://github.com/TooTallNate/Java-WebSocket/" target="_blank" rel="external">https://github.com/TooTallNate/Java-WebSocket/</a></li>
<li><a href="http://www.cnblogs.com/wlfcolin/p/5193583.html" target="_blank" rel="external">http://www.cnblogs.com/wlfcolin/p/5193583.html</a></li>
</ol>
<p><img src="https://raw.githubusercontent.com/ttdevs/ttdevs.github.io/common/images/logo.png" alt="Create by ttdevs"></p>
]]></content>
      
        <categories>
            
            <category> æŠ€æœ¯ </category>
            
        </categories>
        
        
        <tags>
            
            <tag> WebSocket </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[ã€ŒmacOSã€macOSå®‰è£…Python]]></title>
      <url>/1970/01/01/%5BmacOS%5DmacOS%E5%AE%89%E8%A3%85Python/</url>
      <content type="html"><![CDATA[<h2 id="0x00-ä¸ºä»€ä¹ˆè¦è£…-Bi"><a href="/1970/01/01/[macOS]macOSå®‰è£…Python/#0x00-ä¸ºä»€ä¹ˆè¦è£…-Bi" class="headerlink" title="0x00 ä¸ºä»€ä¹ˆè¦è£…(Bi)"></a>0x00 ä¸ºä»€ä¹ˆè¦è£…(Bi)</h2><p>è£…é€¼é­é›·åŠˆã€‚</p>
<p>ä¸Šä¸€ç¯‡ä»‹ç»äº†é‡è£…macOSçš„æ–¹æ³•ã€‚ä¸ºä»€ä¹ˆä¼šæœ‰ä¸Šä¸€ç¯‡ï¼Ÿè¯´åˆ°åº•å°±ä¸€ä¸ªå­—ï¼šè·‘ python web åº”ç”¨å‡ºé—®é¢˜äº†ã€‚æŠŠmacOSä»æ—§ç‰ˆæœ¬å‡çº§åˆ°æ–°ç‰ˆæœ¬ 10.12ï¼Œä¹‹å‰è·‘çš„å¥½å¥½çš„webåº”ç”¨ç°åœ¨å„ç§é—®é¢˜ï¼Œæ‰€ä»¥ï¼Œé‡è£…å§ã€‚ç„¶å¹¶åµï¼Œé‡è£…åé—®é¢˜ä¾æ—§ ğŸ˜¢ï¼Œæ¯”å¦‚ï¼š</p>
<p><code>ImportError: No module named &#39;_sqlite3&#39;</code><br><code>ImportError: No module named &#39;pysqlite2&#39;</code></p>
<p>ç­‰ç­‰ä¸€å †é—®é¢˜ã€‚å¥½å§ï¼ŒåºŸè¯è¯´å¤šäº†ï¼Œè¿™é‡Œä»‹ç»ä¸‹è¯¥æ€ä¹ˆåŠã€‚</p>
<h2 id="0x01-å®‰è£…"><a href="/1970/01/01/[macOS]macOSå®‰è£…Python/#0x01-å®‰è£…" class="headerlink" title="0x01 å®‰è£…"></a>0x01 å®‰è£…</h2><p>æƒ…å†µæ˜¯è¿™æ ·çš„ï¼Œå…¨æ–°å®‰è£…macOSï¼ŒåŒæ—¶å‡çº§ xcode åˆ°æœ€æ–°ç‰ˆ8 (8A218a)ï¼Œä½¿ç”¨ homebrew å®‰è£… python3 ï¼š</p>
<p><code>brew install python3</code></p>
<p>è£…å¥½ä¹‹åè¿˜æ˜¯å„ç§modelæ‰¾ä¸åˆ°ï¼Œç¼ºå°‘å¾ˆå¤šä¸œè¥¿ï¼Œå°è¯•äº†å„ç§æ–¹æ³•ï¼Œä¾ç„¶æ— æ³•è§£å†³ã€‚</p>
<p>åœ¨åå¤é‡è£… python3 çš„æ—¶å€™ï¼Œçœ‹åˆ°è¿™æ ·ä¸€ä¸ªæç¤ºï¼š<code>xcode-select --install</code>ã€‚è™½ç„¶ä¸çŸ¥é“è¿™ä¸ªé¬¼ä¸œè¥¿æ˜¯å¹²å˜›ï¼Œä½†æ˜¯ç¡®å®šä¸€ç‚¹ï¼Œä¹‹å‰æˆ‘æœ‰å®‰è£…è¿‡ã€‚æ‰€ä»¥ï¼Œå°±åœ¨å‘½ä»¤è¡Œæ‰§è¡Œäº†ä¸€ä¸‹ï¼Œç„¶åå†é‡æ–°å®‰è£… python3ï¼Œä»– å°±ï¼Œå°±ï¼Œå°± å¯ä»¥äº†â€¦â€¦</p>
<h2 id="0x02-Command-Line-Tools"><a href="/1970/01/01/[macOS]macOSå®‰è£…Python/#0x02-Command-Line-Tools" class="headerlink" title="0x02 Command Line Tools"></a>0x02 Command Line Tools</h2><p><code>xcode-select --install</code> è¿™æ¡å‘½ä»¤æ˜¯çš„ä½œç”¨æ˜¯å®‰è£… <code>Command Line Tools</code>ã€‚æ‰¾äº†åŠå¤©ï¼Œæ²¡çœ‹åˆ°å“ªæœ‰è¯¦ç»†çš„ä»‹ç»ï¼Œåœ¨<a href="https://developer.apple.com/library/prerelease/content/technotes/tn2339/_index.html#//apple_ref/doc/uid/DTS40014588-CH1-WHAT_IS_THE_COMMAND_LINE_TOOLS_PACKAGE_" target="_blank" rel="external">è¿™é‡Œ</a>çœ‹åˆ°ä¸€ä¸ªç®€çŸ­çš„ä»‹ç»ï¼š</p>
<blockquote>
<p>The Command Line Tools Package is a small self-contained package available for download separately from Xcode and that allows you to do command line development in OS X. It consists of two components: OS X SDK and command-line tools such as Clang, which are installed in /usr/bin.</p>
</blockquote>
<p>ç®€å•æ¥è¯´ï¼Œåº”è¯¥å°±æ˜¯ä¸€å¥—å·¥å…·é›†åˆã€‚ä»–ä¼šè¢«å®‰è£…åœ¨ä¸‹é¢ä¸¤ä¸ªä½ç½®ï¼š</p>
<p><code>/Library/Developer/CommandLineTools/usr/bin</code><br><code>/usr/bin</code></p>
<p>åœ¨è¿™é‡Œä½ ä¼šçœ‹åˆ°ä¸€å †å¸¸è§çš„å‘½ä»¤ã€‚çœ‹åˆ°è¿™äº›ä¹‹åï¼Œæç„¶å¤§æ‚Ÿï¼Œhomebrewå¥½åƒæ˜¯ä¸‹çš„python3çš„æºç ï¼Œç„¶åæœ¬åœ°ç¼–è¯‘å®‰è£…çš„ã€‚å¦‚æœç¼ºå°‘äº†è¿™äº›å‘½ä»¤ï¼Œå¯èƒ½å°±ä¼šå‡ºé”™ã€‚</p>
<p>å¥½äº†ï¼Œç»ˆäºå¯ä»¥æ„‰å¿«çš„ä½¿ç”¨ python äº†ã€‚</p>
<hr>
<p><img src="https://raw.githubusercontent.com/ttdevs/ttdevs.github.io/common/images/logo.png" alt="Create by ttdevs"></p>
]]></content>
      
        <categories>
            
            <category> æŠ€æœ¯ </category>
            
        </categories>
        
        
        <tags>
            
            <tag> macOS </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[ã€Œç©è½¬æ ‘è“æ´¾ã€0x00æ¬¢è¿æ¥åˆ°æ ‘è“æ´¾çš„ä¸–ç•Œ]]></title>
      <url>/1970/01/01/%5B%E7%8E%A9%E8%BD%AC%E6%A0%91%E8%8E%93%E6%B4%BE%5D0x00%E6%AC%A2%E8%BF%8E%E6%9D%A5%E5%88%B0%E6%A0%91%E8%8E%93%E6%B4%BE%E7%9A%84%E4%B8%96%E7%95%8C/</url>
      <content type="html"><![CDATA[<h2 id="0x00-åˆè¡·"><a href="/1970/01/01/[ç©è½¬æ ‘è“æ´¾]0x00æ¬¢è¿æ¥åˆ°æ ‘è“æ´¾çš„ä¸–ç•Œ/#0x00-åˆè¡·" class="headerlink" title="0x00 åˆè¡·"></a>0x00 åˆè¡·</h2><p>Welcome to Raspberry Pi world</p>
<p>ä¹‹å‰åŠ å…¥çš„ä¸€ä¸ªæ ‘è“æ´¾ç¾¤æœ€è¿‘çªç„¶æ´»è·ƒèµ·æ¥ï¼Œç»è¿‡è§‚å¯Ÿå‘ç°æ˜¯æ–°ç‰ˆçš„æ ‘è“æ´¾å‘å¸ƒäº† â€”â€” Raspberry Pi 3ã€‚å¾ˆé«˜å…´çš„æ˜¯ï¼Œå„ä½å°ä¼™ä¼´çš„æ´»è·ƒæœ‰äº›è¶…å‡ºæˆ‘çš„æ„æ–™ã€‚</p>
<p>è§‚å¯Ÿä¸€æ®µæ—¶é—´ä¹‹åå‘ç°ï¼Œå¾ˆå¤šå°ä¼™ä¼´åœ¨é—®ä¸€äº›å¾ˆåŸºç¡€çš„é—®é¢˜ï¼Œå¼€å§‹å°è¯•å»å¸®ä»–ä»¬è§£ç­”ï¼Œåæ¥å‘ç°æ ¹æœ¬å›ç­”ä¸è¿‡æ¥ï¼Œåˆšå›ç­”å®Œåˆæœ‰å°ä¼™ä¼´æ¥é—®ï¼Œå› æ­¤å†³å®šå°è¯•ç€åšä¸€äº›åŸºç¡€æ€»ç»“ï¼Œç»™å„ä½åˆšå…¥é—¨çš„å°ä¼™ä¼´æä¾›ä¸€äº›å‚è€ƒã€‚</p>
<p>ä¸ºä»€ä¹ˆä¹°æ ‘è“æ´¾å‘¢ï¼Ÿå¾ˆæ—©å°±å¬è¯´è¿‡æ ‘è“æ´¾ï¼ŒArduinoè¿™äº›å°æ¿å­ï¼Œä½†æ˜¯å†³å®šå…¥æ‰‹æ ‘è“æ´¾è¿˜æ˜¯å› ä¸ºçŸ¥ä¹çš„ä¸€ä¸ªå›ç­”ï¼š<a href="https://www.zhihu.com/question/20859055" target="_blank" rel="external">æ ‘è“æ´¾ (Raspberry Pi) æ˜¯ä»€ä¹ˆï¼Ÿæ™®é€šäººæ€ä¹ˆç©ï¼Ÿ</a> çœ‹å®Œåå¾ˆå…´å¥‹ï¼Œè¿™ä¸ªå°æ¿è¿˜å¯ä»¥è¿™æ ·ç©ï¼Œé‚å…¥æ‰‹ã€‚ç®—èµ·æ¥ä»å…¥æ‰‹åˆ°ç°åœ¨å·²ç»åŠå¹´å·¦å³ã€‚ç®€å•çš„å…¥é—¨æ“ä½œéƒ½æŠ˜è…¾äº†ä¸€éï¼Œè¿˜ä¹°äº†ä¸€å¤§å †ç¡¬ä»¶ï¼Œä½†æ˜¯å¾ˆé—æ†¾ï¼Œä¸å°‘ç¡¬ä»¶æ²¡æœ‰æŠ˜è…¾æˆåŠŸã€‚æœŸé—´å­¦äº†ä¸€äº›pythonåŸºç¡€çŸ¥è¯†ï¼Œåšäº†ä¸€äº›ç®€å•çš„æœåŠ¡åœ¨ä¸Šé¢è·‘ï¼Œç„¶åå°±è®©ä»–é™é™çš„èººåœ¨äº†è§’è½é‡Œï¼Œæ²¡æœ‰å†æŠ˜è…¾ã€‚ä½†æœ‰ä¸€ä»¶äº‹è®©æˆ‘éå¸¸çš„å…´å¥‹ï¼Œè¿™ä¸ªå°æ¿å­æœ€é•¿ä¸€æ¬¡50å¤šå¤©æ²¡å…³æœºï¼ï¼ï¼è¿™å¤§å¤§çš„å‡ºä¹æˆ‘çš„æ„æ–™</p>
<blockquote>
<p>ä¸ºä»€ä¹ˆä¼šè¯´éå¸¸å…´å¥‹å‘¢ï¼Ÿè·‘äº†50å¤šå¤©åæ˜¯æˆ‘ä¸»åŠ¨å…³æœºçš„ã€‚ä¸€ä¸ªæ™®é€šçš„ç”¨æˆ·ï¼Œæ— è®ºä½ æ˜¯Windowsï¼ŒLinuxè¿˜æ˜¯Macï¼Œä½œä¸ºæ—¥å¸¸ä½¿ç”¨çš„è®¾å¤‡ï¼Œè¿˜æ˜¯ä¼šç»å¸¸é‡å¯çš„ï¼Œç‰¹åˆ«æ˜¯Windowsç³»ç»Ÿã€‚ä¸€å—æ”¾åœ¨åºŠå¤´çš„å°æ¿å­ï¼Œå¯ä»¥ç¨³å®šçš„è·‘ä¸Šå‡ å¤©ï¼Œå‡ å‘¨ï¼Œå‡ ä¸ªæœˆï¼Œæœ‰è¿™ä¹ˆç¨³å®šçš„ä¸€ä¸ªç³»ç»Ÿï¼Œè¿˜æœ‰é‚£äº›GPIOï¼Œæ˜¯ä¸æ˜¯ç»™æˆ‘ä»¬æ›´å¤šçš„æŠ˜è…¾æä¾›äº†éå¸¸å¥½çš„åŸºç¡€!</p>
</blockquote>
<p>å†³å®šå†™è¿™äº›å…¥é—¨æ–‡ç« ï¼Œæˆ‘ä¼šæœ¬ç€<code>ç›´æ¥å‘Šè¯‰ä½ ä¸€ä¸ªç»“æœ</code>çš„åŸåˆ™ï¼Œå¾ªåºæ¸è¿›çš„æŠŠä½ æ­£é¢å¯¹æˆ–è€…å°†ä¼šé‡åˆ°çš„é—®é¢˜å±•ç°å‡ºæ¥ã€‚å¦‚æœè®²çš„å¤ªç²—ï¼Œå„ä½å¯ä»¥ç›´æ¥æé—®ï¼Œæˆ‘å†è¡¥å……ã€‚æœ€åå¸Œæœ›æˆ‘ä¼šåšæŒæŠŠè¿™äº›ä¸œè¥¿å†™ä¸‹å»ã€‚</p>
<h2 id="0x01-ä»€ä¹ˆæ˜¯æ ‘è“æ´¾"><a href="/1970/01/01/[ç©è½¬æ ‘è“æ´¾]0x00æ¬¢è¿æ¥åˆ°æ ‘è“æ´¾çš„ä¸–ç•Œ/#0x01-ä»€ä¹ˆæ˜¯æ ‘è“æ´¾" class="headerlink" title="0x01 ä»€ä¹ˆæ˜¯æ ‘è“æ´¾"></a>0x01 ä»€ä¹ˆæ˜¯æ ‘è“æ´¾</h2><p><a href="https://www.raspberrypi.org/" target="_blank" rel="external">æ ‘è“æ´¾(Raspberry Pi)</a> æ˜¯ä»€ä¹ˆï¼Œæ¥çœ‹çœ‹<a href="https://zh.wikipedia.org/wiki/%E6%A0%91%E8%8E%93%E6%B4%BE" target="_blank" rel="external">ç»´åŸºç™¾ç§‘</a>çš„ä»‹ç»ï¼š</p>
<blockquote>
<p>æ ‘è“æ´¾ï¼ˆè‹±è¯­ï¼šRaspberry Piï¼‰ï¼Œæ˜¯ä¸€æ¬¾åŸºäºLinuxçš„å•æ¿æœºç”µè„‘ã€‚å®ƒç”±è‹±å›½çš„æ ‘è“æ´¾åŸºé‡‘ä¼šæ‰€å¼€å‘ï¼Œç›®çš„æ˜¯ä»¥ä½ä»·ç¡¬ä»¶åŠè‡ªç”±è½¯ä»¶åˆºæ¿€åœ¨å­¦æ ¡çš„åŸºæœ¬è®¡ç®—æœºç§‘å­¦æ•™è‚²ã€‚<br>æ ‘è“æ´¾çš„ç”Ÿäº§æ˜¯é€šè¿‡æœ‰ç”Ÿäº§è®¸å¯çš„ä¸¤å®¶å…¬å¸ï¼šElement 14/Premier Farnellå’ŒRS Componentsã€‚è¿™ä¸¤å®¶å…¬å¸éƒ½åœ¨ç½‘ä¸Šå‡ºå”®æ ‘è“æ´¾ã€‚<br>æ ‘è“æ´¾é…å¤‡ä¸€æšåšé€šï¼ˆBroadcomï¼‰å‡ºäº§çš„ARMæ¶æ„700MHz BCM2835å¤„ç†å™¨ï¼Œ256MBå…§å­˜ï¼ˆBå‹å·²å‡çº§åˆ°512MBå†…å­˜ï¼‰ï¼Œä½¿ç”¨SDå¡å½“ä½œå­˜å‚¨åª’ä½“ï¼Œä¸”æ‹¥æœ‰ä¸€ä¸ªEthernetã€ä¸¤ä¸ªUSBæ¥å£ã€ä»¥åŠHDMIï¼ˆæ”¯æŒå£°éŸ³è¾“å‡ºï¼‰å’ŒRCAç«¯å­è¾“å‡ºæ”¯æŒã€‚æ ‘è“æ´¾åªæœ‰ä¸€å¼ ä¿¡ç”¨å¡å¤§å°ï¼Œä½“ç§¯å¤§æ¦‚æ˜¯ä¸€ä¸ªç«æŸ´ç›’å¤§å°ï¼Œå¯ä»¥è¿è¡Œåƒã€Šé›·ç¥ä¹‹é”¤IIIç«æŠ€åœºã€‹çš„æ¸¸æˆå’Œè¿›è¡Œ1080pè§†é¢‘çš„æ’­æ”¾ã€‚æ“ä½œç³»ç»Ÿé‡‡ç”¨å¼€æºçš„Linuxç³»ç»Ÿå¦‚Debianã€ArchLinuxï¼Œè‡ªå¸¦çš„Iceweaselã€KOfficeç­‰è½¯ä»¶ï¼Œèƒ½å¤Ÿæ»¡è¶³åŸºæœ¬çš„ç½‘ç»œæµè§ˆã€æ–‡å­—å¤„ç†ä»¥åŠç”µè„‘å­¦ä¹ çš„éœ€è¦ã€‚åˆ†Aã€Bä¸¤ç§å‹å·ï¼Œå”®ä»·åˆ†åˆ«æ˜¯Aå‹25ç¾å…ƒã€Bå‹35ç¾å…ƒã€‚æ ‘è“æ´¾åŸºé‡‘ä¼šä»2012å¹´2æœˆ29æ—¥å¼€å§‹æ¥å—Bå‹çš„è®¢è´§ã€‚<br>æ ‘è“æ´¾åŸºé‡‘ä¼šæä¾›äº†åŸºäºARMæ¶æ„çš„Debianã€Arch Linuxå’ŒFedoraç­‰çš„å‘è¡Œç‰ˆä¾›å¤§ä¼—ä¸‹è½½ï¼Œè¿˜è®¡åˆ’æä¾›æ”¯æŒPythonä½œä¸ºä¸»è¦ç¼–ç¨‹è¯­è¨€ï¼Œæ”¯æŒBBC BASIC(é€šè¿‡RISC OSæ˜ åƒæˆ–è€…Linuxçš„â€Brandy Basicâ€å…‹éš†)ã€Cè¯­è¨€å’ŒPerlç­‰ç¼–ç¨‹è¯­è¨€ã€‚<br>æ ‘è“æ´¾åŸºé‡‘ä¼šäº2016å¹´2æœˆå‘å¸ƒäº†æ ‘è“æ´¾3,è¾ƒå‰ä¸€ä»£æ ‘è“æ´¾2ï¼Œæ ‘è“æ´¾3çš„å¤„ç†å™¨å‡çº§ä¸ºäº†64ä½çš„åšé€šBCM2837ï¼Œå¹¶é¦–æ¬¡åŠ å…¥äº†Wi-Fiæ— çº¿ç½‘ç»œåŠè“ç‰™åŠŸèƒ½ï¼Œè€Œå”®ä»·ä»ç„¶æ˜¯35ç¾å…ƒã€‚</p>
</blockquote>
<p>ç®€å•æ¥è¯´ï¼Œä»–å°±æ˜¯ä¸€å°ARMæ¶æ„çš„ç”µè„‘ï¼Œä¿¡ç”¨å¡å¤§å°ï¼Œä»–æœ‰usbæ¥å£ï¼Œæœ‰hdmiæ¥å£ï¼Œæœ‰éŸ³é¢‘æ¥å£ï¼Œæœ‰ä»¥å¤ªç½‘æ¥å£ç­‰ç­‰ã€‚æˆ‘ä»¬å†æ¥çœ‹çœ‹ä»–çš„é…ç½®ï¼ˆFrom:ç»´åŸºç™¾ç§‘ï¼‰ï¼š</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1801981-198d59fc407ab60e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Raspberry Pi ç‰ˆæœ¬"></p>
<p>æœ€æ–°çš„Raspberry Pi 3 Bå‹CPUæœ‰æå‡ï¼Œå¢åŠ äº†æ¿è½½WIFIå’Œè“ç‰™ã€‚ä½†æ˜¯ï¼Œè¿™æ ·çš„é…ç½®ï¼Œå’Œæˆ‘ä»¬æ™®é€šçš„PCæœºæ¯”çš„è¯è¿˜æ˜¯å·®çš„å¾ˆè¿œã€‚é‚£ä¹ˆï¼Œæˆ‘ä»¬ä¸ºä»€ä¹ˆè¿˜è¦ä½¿ç”¨æ ‘è“æ´¾å‘¢ï¼Ÿè¿™é‡Œç®€å•è¯´è¯´æˆ‘çš„çœ‹æ³•ï¼š</p>
<ul>
<li>ä½“ç§¯å°ï¼šå°åˆ°å®Œå…¨å¯ä»¥éšèº«æºå¸¦</li>
<li>çœç”µï¼šæˆ‘çš„æ˜¯2ä»£Bå‹ï¼Œé…ç½®çš„ç”µæº5V 2Aï¼Œæœ€å¤§åŠŸç‡ä¹Ÿæ‰10W</li>
<li><code>GPIO</code>ï¼šè¿™ä¸ªæ˜¯æœ€å¸å¼•æˆ‘çš„ï¼Œé€šè¿‡å®ƒå¯ä»¥æ§åˆ¶ä¸€äº›å¼€å…³ç­‰</li>
<li>ä¾¿å®œï¼š200å¤šå—é’±çš„ä»·æ ¼ï¼Œå°‘åƒä¸€é¡¿é¥­å°‘çœ‹ä¸¤åœºç”µå½±å°±å‰©ä¸‹æ¥äº†</li>
<li>â€¦</li>
</ul>
<p>å…¶å®æ—¢ç„¶ä½ å·²ç»å†³å®šæˆ–è€…å·²ç»å…¥æ‰‹æ ‘è“æ´¾ï¼Œæˆ‘ä»¬å°±ä¸è¿‡å¤šçš„ä»‹ç»ä»–çš„ä¼˜ç¼ºç‚¹äº†ã€‚åæ­£å°±æ˜¯ä½ ä¹°äº†<code>ç”¨èµ·æ¥</code>ï¼Œä¸ä¼šåæ‚”çš„ã€‚æ¥ä¸‹æ¥æˆ‘ä¼šæŠŠæ›´å¤šçš„ç²¾åŠ›æ”¾åœ¨æˆ‘ä»¬è¦åšçš„äº‹æƒ…ä¸Šï¼Œè€Œä¸æ˜¯çº ç»“å…·ä½“åœ¨æŸä¸ªç‰ˆæœ¬ä¸Šï¼Œå› ä¸ºç›¸åŒçš„OSä»–ä»¬å·®åˆ«ä¸æ˜¯å¾ˆå¤§ã€‚æˆ‘ç”¨çš„æ˜¯æ ‘è“æ´¾2ä»£Bå‹ï¼Œå’Œæœ€æ–°çš„3ä»£æ¯”å°‘äº†WIFIå’ŒBluetoothï¼Œä¸è¿‡æˆ‘è‡ªå·±å‡†å¤‡äº†ä¸€ä¸ªusbæ¥å£çš„WIFIå’ŒBluetoothï¼Œæœ€åæˆ‘çš„åŸºæœ¬é…ç½®å¦‚ä¸‹ï¼š</p>
<ul>
<li>æ ‘è“æ´¾ä¸»æœºï¼š2ä»£Bå‹</li>
<li>ç”µæºé€‚é…å™¨ï¼š2Aï¼Œçœ‹æŒ‚çš„è´Ÿè½½é€‰æ‹©</li>
<li>å­˜å‚¨å¡ï¼š32G Sandiskï¼Œæ¨èè¿™ä¸ªç‰Œå­</li>
<li>æ— çº¿ç½‘å¡ï¼šRTL8192CUï¼Œå¯é€‰</li>
<li>USBè“ç‰™ï¼šå¯é€‰</li>
<li>æ‘„åƒå¤´ï¼šç½‘ä¸Š50å¿«é’±ä¹°çš„ï¼Œå¯é€‰</li>
<li>å…¶ä»–ä¸€å †ç¡¬ä»¶ï¼Œå¦‚HC-SR501ã€LCD12864ã€LCD1602ã€MQ-135ã€MQ-2ã€DHT11ç­‰ç­‰ï¼Œç›®å‰å·²çŸ¥åœ¨ç”¨çš„æ˜¯DHT11ï¼Œæ£€æŸ¥æˆ¿é—´æ¸©æ¹¿åº¦ã€‚</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">~ $ lsusb</div><div class="line">Bus 001 Device 005: ID 0a12:0001 Cambridge Silicon Radio, Ltd Bluetooth Dongle (HCI mode)</div><div class="line">Bus 001 Device 004: ID 0bda:8178 Realtek Semiconductor Corp. RTL8192CU 802.11n WLAN Adapter</div><div class="line">Bus 001 Device 003: ID 0424:ec00 Standard Microsystems Corp. SMSC9512/9514 Fast Ethernet Adapter</div><div class="line">Bus 001 Device 002: ID 0424:9514 Standard Microsystems Corp.</div><div class="line">Bus 001 Device 001: ID 1d6b:0002 Linux Foundation 2.0 root hub</div></pre></td></tr></table></figure>
<h2 id="0x02-ç½‘ç»œç¯å¢ƒ"><a href="/1970/01/01/[ç©è½¬æ ‘è“æ´¾]0x00æ¬¢è¿æ¥åˆ°æ ‘è“æ´¾çš„ä¸–ç•Œ/#0x02-ç½‘ç»œç¯å¢ƒ" class="headerlink" title="0x02 ç½‘ç»œç¯å¢ƒ"></a>0x02 ç½‘ç»œç¯å¢ƒ</h2><p>æˆ‘ç”¨çš„æ˜¯ä¸Šæµ·ç”µä¿¡çš„30MBå®½å¸¦ï¼Œç”µä¿¡å…‰çŒ«ä¸‹é¢æ¥ä¸€ä¸ªTP-Linkè·¯ç”±å™¨ï¼Œè·¯ç”±å™¨ä¸‹é¢æ¥ä¸Šç½‘è®¾å¤‡ã€‚å¦‚ä¸‹å›¾ï¼š</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1801981-1b30d3ad741b6ea0.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="æˆ‘çš„ç½‘ç»œæ‹“æ‰‘"></p>
<p>èµ·åˆï¼Œå¾ˆå¤šäººä¼šé‡åˆ°å’Œæˆ‘ä¸€æ ·çš„é—®é¢˜ï¼šå…‰çŒ«åŠ ç”µåå°±å¯ä»¥ä¸Šç½‘äº†ï¼Œä½†æ˜¯æˆ‘ä»¬æ²¡åŠæ³•é€šè¿‡å…¬ç½‘è®¿é—®æˆ‘è·¯ç”±å™¨ä¸‹çš„è®¾å¤‡ã€‚è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬ä¼šå¾ˆè‡ªç„¶çš„æƒ³åˆ°å¯¹å…‰çŒ«è¿›è¡Œè®¾ç½®ã€‚ç»è¿‡å„ç§googleä¹‹åï¼Œç¡®å®šäº†ä¸€ä¸ªæœ€ç®€å•çš„æ€è·¯ï¼šç ´è§£å…‰çŒ«ï¼Œä»ä¸­è·å–æˆ‘ä»¬æ‹¨å·ç”¨çš„ç”¨æˆ·åå’Œå¯†ç ï¼Œç„¶åæŠŠå…‰çŒ«è®¾ç½®æˆä»…ä»…ä½œä¸ºçŒ«ä½¿ç”¨ï¼Œç”¨æ‹¿åˆ°çš„ç”¨æˆ·åå¯†ç åˆ°æˆ‘ä»¬çš„è·¯ç”±å™¨ä¸­è¿›è¡Œæ‹¨å·ã€‚å¬èµ·æ¥æ˜¯ä¸æ˜¯è¿˜æŒºå¤æ‚çš„ï¼Œé‚£è¿™é‡Œå‘Šè¯‰ä½ ä¸€ä¸ªç®€å•åŠæ³•ï¼šéšä¾¿æ‰¾ä¸€ä¸ªç†ç”±æŠ¥ä¿®å®½å¸¦ï¼Œæ¯”å¦‚ç½‘é€Ÿæ¯”è¾ƒæ…¢ï¼Œç­‰ç»´ä¿®çš„å¸ˆå‚…ä¸Šé—¨åå‘Šè¯‰ä»–ä½ æƒ³ç”¨è‡ªå·±çš„è·¯ç”±å™¨æ‹¨å·ä¸Šç½‘ï¼Œä»–å°±ä¼šå¸®ä½ è®¾ç½®çš„ã€‚è®¾ç½®å¥½è¿™äº›ä¹‹åæˆ‘ä»¬å°±æœ‰äº†ä¸€ä¸ªæœ‰å…¬ç½‘IPçš„è·¯ç”±å™¨ã€‚</p>
<h2 id="0x03-èŠ±ç”Ÿå£³"><a href="/1970/01/01/[ç©è½¬æ ‘è“æ´¾]0x00æ¬¢è¿æ¥åˆ°æ ‘è“æ´¾çš„ä¸–ç•Œ/#0x03-èŠ±ç”Ÿå£³" class="headerlink" title="0x03 èŠ±ç”Ÿå£³"></a>0x03 èŠ±ç”Ÿå£³</h2><p>è™½ç„¶å®Œç¾æœ‰äº†å…¬ç½‘çš„IPï¼Œä½†æ˜¯é—æ†¾çš„æ˜¯ï¼Œè¿™ä¸ªå…¬ç½‘IPåœ¨æ¯æ¬¡æ‹¨å·æ—¶éƒ½ä¼šå˜ã€‚è¿™ä¸ªé—®é¢˜æˆ‘ä»¬å¯ä»¥ç”¨èŠ±ç”Ÿå£³æ¥è§£å†³ã€‚<a href="http://www.oray.com/" target="_blank" rel="external">èŠ±ç”Ÿå£³</a>å¯ä»¥å…è´¹ç»™æˆ‘ä»¬æä¾›DDNSæœåŠ¡ï¼Œå°†æˆ‘ä»¬åŠ¨æ€çš„IPæ˜ å°„åˆ°ä¸€ä¸ªåŸŸåä¸Šã€‚è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥åœ¨å…¬ç½‘é€šè¿‡è¿™ä¸ªåŸŸåæ¥è®¿é—®å®¶é‡Œçš„æ ‘è“æ´¾ï¼Œè€Œä¸ç”¨æ‹…å¿ƒè‡ªå·±çš„å…¬ç½‘IPå˜æ¥å˜å»æ‰¾ä¸åˆ°äº†ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬éœ€è¦å…ˆæ³¨å†Œä¸€ä¸ªèŠ±ç”Ÿå£³çš„è´¦å·ï¼Œå†èŠ±5å—é’±æ³¨å†Œä¸€ä¸ªèŠ±ç”Ÿå£³åŸŸåï¼Œæ‹¿ç€è¿™ä¸ªè´¦å·åˆ°æˆ‘ä»¬çš„å®½å¸¦è·¯ç”±å™¨ä¸Šç™»å½•å³å¯:</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1801981-3cb4638cbd890aef.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="èŠ±ç”Ÿå£³DDNS"></p>
<p>å¾ˆå¤šæ—¶å€™äº‹æƒ…å¹¶æ²¡æœ‰é‚£ä¹ˆå®Œç¾ï¼Œæ¯”å¦‚æŸå¤©ä½ ä¼šå‘ç°æˆ‘ä»¬å®½å¸¦çš„æŸäº›ç«¯å£ï¼ˆæ¯”å¦‚80ç«¯å£ï¼‰æ— æ³•ä½¿ç”¨ï¼ˆè¢«ç”µä¿¡è¿è¥å•†å°æ‰ï¼‰ï¼Œè¿™æ—¶å€™æˆ‘ä»¬å°±éœ€è¦ä½¿ç”¨èŠ±ç”Ÿå£³çš„å¦ä¸€ä¸ªæœåŠ¡ï¼š<a href="http://hsk.oray.com/download/#type=http|shumeipai" target="_blank" rel="external">èŠ±ç”Ÿå£³å†…ç½‘ç‰ˆ</a> æ¥è§£å†³ã€‚è¿™ä¸ªæˆ‘ä¼šåœ¨æ¥ä¸‹æ¥çš„æ–‡ç« ä¸­è®²åˆ°ã€‚</p>
<h2 id="0x04-å·¥å…·"><a href="/1970/01/01/[ç©è½¬æ ‘è“æ´¾]0x00æ¬¢è¿æ¥åˆ°æ ‘è“æ´¾çš„ä¸–ç•Œ/#0x04-å·¥å…·" class="headerlink" title="0x04 å·¥å…·"></a>0x04 å·¥å…·</h2><p>ä¿—è¯è¯´å·¥æ¬²å–„å…¶äº‹å¿…å…ˆåˆ©å…¶å™¨ï¼Œåœ¨æ­£å¼å¼€å§‹ä¹‹å‰ï¼Œç»™å¤§å®¶æ¨èå‡ ä¸ªå·¥å…·ï¼š</p>
<ul>
<li><p><a href="https://play.google.com/store/apps/details?id=com.sonelli.juicessh" target="_blank" rel="external">JuiceSSH</a></p>
<p>  ä¸€ä¸ªandroidç³»ç»Ÿçš„SSHå®¢æˆ·ç«¯å·¥å…·ï¼Œå¯ä»¥é€šè¿‡å®ƒç›´æ¥ä¸æ ‘è“æ´¾ç›¸è¿ã€‚</p>
</li>
<li><p><a href="https://play.google.com/store/apps/details?id=nz.org.winters.android.gpiotoolforraspberrypi" target="_blank" rel="external">GPIO tool for Raspberry Pi</a></p>
<p>  ä¸€ä¸ªå®¢æˆ·ç«¯å·¥å…·ï¼Œæ”¯æŒandroidç³»ç»Ÿï¼Œè¿æ¥æ ‘è“æ´¾åç›´æ¥å¯ä»¥å¯¹æ ‘è“æ´¾çš„GPIOè¿›è¡Œæ“ä½œã€‚</p>
</li>
<li><p><a href="http://fritzing.org/" target="_blank" rel="external">Fritizing</a></p>
<p>  è¿™ä¸ªæ˜¯ç”¨æ¥ç”»ç”µè·¯åŸç†å›¾çš„ï¼Œå¾ˆCoolï¼Œéå¸¸å¥½ç”¨ã€‚</p>
</li>
</ul>
<p><img src="http://upload-images.jianshu.io/upload_images/1801981-f4d2719f15cb6eed.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Fritizing"></p>
<ul>
<li><p><a href="https://itunes.apple.com/cn/app/serverauditor-ssh-shell-console/id549039908?l=en&amp;mt=8" target="_blank" rel="external">Serverauditor</a></p>
<p>  iOSç³»ç»Ÿçš„SSHå®¢æˆ·ç«¯å·¥å…·ã€‚</p>
</li>
</ul>
<p><code>å¦‚æœä½ æœ‰æ›´å¥½çš„å·¥å…·ï¼Œæ¬¢è¿åˆ†äº«ã€‚</code></p>
<p>è¯´äº†è¿™ä¹ˆå¤šï¼Œæ¥ä¸‹æ¥æ­£å¼è¿›å…¥æ ‘è“æ´¾çš„ä¸–ç•Œï¼Œæå‰ç¥å¤§å®¶ç©çš„å¼€å¿ƒ~~</p>
<hr>
<p><img src="https://raw.githubusercontent.com/ttdevs/ttdevs.github.io/common/images/logo.png" alt="Create by ttdevs"></p>
]]></content>
      
        <categories>
            
            <category> æŠ€æœ¯ </category>
            
        </categories>
        
        
        <tags>
            
            <tag> ç©è½¬æ ‘è“æ´¾ </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[ã€Œç©è½¬æ ‘è“æ´¾ã€0x01é€‰ä¸ªç³»ç»Ÿå…ˆ]]></title>
      <url>/1970/01/01/%5B%E7%8E%A9%E8%BD%AC%E6%A0%91%E8%8E%93%E6%B4%BE%5D0x01%E9%80%89%E4%B8%AA%E7%B3%BB%E7%BB%9F%E5%85%88/</url>
      <content type="html"><![CDATA[<h2 id="0x00-æ ‘è“æ´¾çš„å®‰è£…é…ç½®ï¼ˆæ— æ˜¾ç¤ºå™¨ï¼‰"><a href="/1970/01/01/[ç©è½¬æ ‘è“æ´¾]0x01é€‰ä¸ªç³»ç»Ÿå…ˆ/#0x00-æ ‘è“æ´¾çš„å®‰è£…é…ç½®ï¼ˆæ— æ˜¾ç¤ºå™¨ï¼‰" class="headerlink" title="0x00 æ ‘è“æ´¾çš„å®‰è£…é…ç½®ï¼ˆæ— æ˜¾ç¤ºå™¨ï¼‰"></a>0x00 æ ‘è“æ´¾çš„å®‰è£…é…ç½®ï¼ˆæ— æ˜¾ç¤ºå™¨ï¼‰</h2><p>æ ‘è“æ´¾æ²¡æœ‰ç¡¬ç›˜ï¼Œæˆ‘ä»¬æ‹¿åˆ°è®¾å¤‡ä¹‹åæ˜¯ä¸èƒ½ç›´æ¥ç”¨çš„ï¼Œå› æ­¤éœ€è¦å…ˆç»™å®ƒé…ç½®ä¸€ä¸ªè£…å¥½ç³»ç»Ÿçš„å­˜å‚¨å¡ã€‚è¿™ç¯‡æ–‡å­—ï¼Œç»™å¤§å®¶ä»‹ç»å¦‚ä½•å®‰è£…å¹¶åˆå§‹åŒ–æ ‘è“æ´¾ç³»ç»Ÿã€‚</p>
<p><a href="https://www.raspberrypi.org/downloads/raspbian/" target="_blank" rel="external">Raspbian</a> æ˜¯æ ‘è“æ´¾åŸºé‡‘ä¼šå®˜æ–¹æ”¯æŒçš„ç³»ç»Ÿï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥ä¸‹è½½ä»–çš„å®‰è£…æ–‡ä»¶æˆ–è€…ä½¿ç”¨å®˜ç½‘æ¨èçš„ <a href="https://www.raspberrypi.org/downloads/noobs/" target="_blank" rel="external">NOOBS</a> æ¥å®Œæˆå®‰è£…æ“ä½œã€‚é™¤äº†å®˜æ–¹æ”¯æŒçš„ç³»ç»Ÿï¼Œæ ‘è“æ´¾è¿˜æœ‰å¾ˆå¤šç¬¬ä¸‰æ–¹æ”¯æŒçš„ç³»ç»Ÿï¼Œå¦‚ï¼š<code>UBUNTU MATE</code>ã€<code>SN
![Uploading win32diskimager_914364.png . . .]APPY UBUNTU CORE</code>ã€<code>WINDOWS 10 IOT CORE</code>ã€<code>OSMC</code>ã€<code>OPENELEC</code>ã€<code>PINET</code>ã€<code>RISC OS</code>ã€<code>WEATHER STATION</code>ç­‰ï¼Œè¿™é‡Œæœ‰æˆ‘ä»¬æ¯”è¾ƒç†Ÿæ‚‰çš„<code>WINDOWS 10 IOT</code>ã€<code>UBUNTU</code>ã€<code>OSMC</code>ç­‰ã€‚<code>UBUNTU</code>ç³»ç»Ÿæ˜¯éå¸¸ç«çš„ä¸€ä¸ªLinuxå‘è¡Œç‰ˆæœ¬ï¼Œ<code>WINDOWS 10 IOT</code>æ˜¯å¾®è½¯å¼€å‘çš„ç‰©è”ç½‘ç³»ç»Ÿï¼Œ<code>OSMC</code>å¯ä»¥ä½œä¸ºå®¶åº­åª’ä½“ä¸­å¿ƒä½¿ç”¨ï¼Œå…¶ä»–ç³»ç»Ÿå¤§å®¶å¯ä»¥è‡ªè¡Œäº†è§£ã€‚</p>
<blockquote>
<p>å‰ä¸€ç¯‡æ–‡ç« ç®€å•ä»‹ç»äº†æˆ‘çš„ç¡¬ä»¶ç¯å¢ƒï¼Œæ˜¯æ²¡æœ‰æ˜¾ç¤ºå™¨å’Œå¤–æ¥é”®ç›˜é¼ æ ‡çš„ï¼Œå› æ­¤æˆ‘ä¼šåŸºäºè¿™ä¸ªå‰æç»™å¤§å®¶ä»‹ç»å¦‚ä½•ç©è½¬æ ‘è“æ´¾ã€‚</p>
</blockquote>
<p>è¿™ä¹ˆå¤šç³»ç»Ÿï¼Œåˆå­¦è€…å¯èƒ½ä¼šå¾ˆçº ç»“å¦‚ä½•é€‰æ‹©ã€‚è¿™é‡Œç»™å¤§å®¶æ¨èå®˜æ–¹æ”¯æŒçš„Raspbianï¼ˆåŸºäºDebian Jessieï¼‰ç³»ç»Ÿï¼Œä»–é¢„è£…äº†å¾ˆå¤šå¸¸ç”¨ã€ç¼–ç¨‹ã€æ•™è‚²è½¯ä»¶ï¼Œå¦‚Python(python3)ã€Scratchã€Sonic Piã€Javaã€Mathematicaç­‰ç­‰ã€‚RaspbianåŒ…å«RASPBIAN JESSIE(Full desktop image based on Debian Jessie)å’ŒRASPBIAN JESSIE LITE(Minimal image based on Debian Jessie)ä¸¤ä¸ªç‰ˆæœ¬ï¼Œç”±äºä¹‹åæˆ‘ä»¬ä¼šç”¨åˆ°æ¡Œé¢ç¯å¢ƒï¼Œå› æ­¤æˆ‘ä»¬æœ€ç»ˆé€‰æ‹©RASPBIAN JESSIEï¼Œå¸¦æ¡Œé¢ç¯å¢ƒçš„ç‰ˆæœ¬ã€‚</p>
<h2 id="0x01-ä¸‹è½½"><a href="/1970/01/01/[ç©è½¬æ ‘è“æ´¾]0x01é€‰ä¸ªç³»ç»Ÿå…ˆ/#0x01-ä¸‹è½½" class="headerlink" title="0x01 ä¸‹è½½"></a>0x01 ä¸‹è½½</h2><p>å†³å®šäº†ä½¿ç”¨RASPBIAN JESSIEï¼ˆéRASPBIAN JESSIE LITEï¼‰ï¼Œæˆ‘ä»¬åªéœ€è¦åˆ°æ ‘è“æ´¾çš„å®˜ç½‘ä¸‹è½½ç³»ç»Ÿæ–‡ä»¶å³å¯ã€‚ä»–çš„æœ€æ–°ç‰ˆæœ¬æ˜¯ <a href="http://downloads.raspberrypi.org/raspbian/release_notes.txt" target="_blank" rel="external">March 2016</a>ï¼š</p>
<ul>
<li>å‘å¸ƒï¼š<code>2016-3-18</code></li>
<li>Linuxå†…æ ¸ï¼š<code>4.1</code></li>
<li>æ–‡ä»¶åï¼š<a href="http://vx2-downloads.raspberrypi.org/raspbian/images/raspbian-2016-03-18/2016-03-18-raspbian-jessie.zip" target="_blank" rel="external">2016-02-26-raspbian-jessie.zip</a></li>
<li>MD5:  <code>db41f2a8c6236c0ca9150fe4db2017c09e7871fb</code></li>
<li>å¤§å°ï¼š<code>1.3G</code></li>
</ul>
<p>å¯¹ä¸‹è½½çš„æ–‡ä»¶è¿›è¡ŒåŠ å‹ï¼Œå¾—åˆ°<code>2016-02-26-raspbian-jessie.img</code>ï¼Œå¤§å°<code>4.03G</code>ï¼Œè¿™ä¸ªå°±æ˜¯æˆ‘ä»¬å®‰è£…è¦ç”¨åˆ°çš„ç³»ç»Ÿé•œåƒæ–‡ä»¶ã€‚</p>
<h2 id="0x02-å®‰è£…"><a href="/1970/01/01/[ç©è½¬æ ‘è“æ´¾]0x01é€‰ä¸ªç³»ç»Ÿå…ˆ/#0x02-å®‰è£…" class="headerlink" title="0x02 å®‰è£…"></a>0x02 å®‰è£…</h2><p>ç³»ç»Ÿçš„å®‰è£…æ¯”è¾ƒç®€å•ï¼Œå°±æ˜¯å°†æˆ‘ä»¬åˆšä¸‹è½½çš„å®‰è£…é•œåƒæ–‡ä»¶å†™å…¥åˆ°TFå¡ä¸­ã€‚å®˜æ–¹çš„ <a href="https://www.raspberrypi.org/documentation/installation/installing-images/README.md" target="_blank" rel="external">å®‰è£…å¸®åŠ©æ–‡æ¡£</a> å¯¹ç³»ç»Ÿçš„å®‰è£…è¿›è¡Œäº†è¯¦ç»†çš„ä»‹ç»ã€‚æœ¬ç€ç®€åŒ–æ“ä½œçš„åŸåˆ™ï¼Œè¿™é‡Œå†åšç®€å•æ¦‚è¿°ã€‚</p>
<ul>
<li><p>Windowsç³»ç»Ÿ</p>
<p>  <a href="https://www.raspberrypi.org/documentation/installation/installing-images/windows.md" target="_blank" rel="external">Windowsç³»ç»Ÿå®‰è£…</a>æ¨èä½¿ç”¨<a href="https://sourceforge.net/projects/win32diskimager/" target="_blank" rel="external">win32diskimager</a>ï¼Œè¿™æ˜¯ä¸€ä¸ªå›¾å½¢åŒ–å·¥å…·ï¼Œæ“ä½œéå¸¸ç®€å•ï¼šä»¥ç®¡ç†å‘˜æ–¹å¼æ‰“å¼€ï¼ŒImageFileé€‰æ‹©åˆšä¸‹è½½çš„imgé•œåƒï¼ŒDeviceé€‰æ‹©æˆ‘ä»¬çš„TFå¡æ‰€åœ¨é©±åŠ¨å™¨ï¼Œç‚¹å‡»Writeå³å¯ã€‚</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1801981-f0f5f96ef21aa61d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="win32diskimager"></p>
</li>
<li><p>Macç³»ç»Ÿ</p>
<p>  è·ŸWindowsç³»ç»Ÿä¸€æ ·ï¼Œæˆ‘ä»¬æ¨èå›¾å½¢ç•Œé¢çš„<a href="http://www.tweaking4all.com/hardware/raspberry-pi/macosx-apple-pi-baker/" target="_blank" rel="external">ApplePi-Baker</a>ï¼Œæ“ä½œç•Œé¢å¦‚ä¸‹ï¼š</p>
</li>
</ul>
<p>  <img src="http://upload-images.jianshu.io/upload_images/1801981-3dc88fbb747a3390.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="ApplePi-Baker"></p>
<pre><code>å·¦ä¾§é€‰æ‹©SDCardï¼Œå³ä¾§é€‰æ‹©æˆ‘ä»¬çš„é•œåƒæ–‡ä»¶ï¼Œç‚¹å‡»Restore BackupæŒ‰é’®å³å¯ã€‚
</code></pre><ul>
<li><p>Macç³»ç»Ÿå‘½ä»¤è¡Œæ–¹å¼</p>
<p>  ç”±äºæˆ‘ç”¨çš„Macç³»ç»Ÿï¼Œæ‰€ä»¥ç®€å•ä»‹ç»ä¸‹è¿™ç§ç¨å¾®å¤æ‚ç‚¹çš„æ–¹å¼ä½†ä¹Ÿå°±æ˜¯ç®€å•å‡ æ­¥æ“ä½œï¼š</p>
<ol>
<li>æ’å…¥SDCardå¡ï¼Œä½¿ç”¨ç£ç›˜ç®¡ç†å·¥å…·å¯¹å…¶è¿›è¡Œæ“¦é™¤ï¼Œæ ¼å¼é€‰æ‹©MS-DOS(FAT)ï¼Œå®Œæˆåæ¨å‡ºSDCardï¼ˆæ¨å‡ºå¹¶ä¸æ˜¯æ‹”å‡ºï¼‰</li>
<li><p>ä½¿ç”¨<code>df -h</code>æŸ¥çœ‹SDCardçš„è·¯å¾„ï¼Œå¦‚ä¸‹çš„ <code>/dev/disk2s1</code>ï¼Œæˆ‘ä»¬è®°ä¸‹ <code>disk2</code>ï¼š</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">âœ  ~ df -h</div><div class="line">Filesystem      Size   Used  Avail Capacity  iused    ifree %iused  Mounted on</div><div class="line">devfs          185Ki  185Ki    0Bi   100%      640        0  100%   /dev</div><div class="line">map -hosts       0Bi    0Bi    0Bi   100%        0        0  100%   /net</div><div class="line">map auto_home    0Bi    0Bi    0Bi   100%        0        0  100%   /home</div><div class="line">/dev/disk2s1    60Mi   20Mi   40Mi    34%      512        0  100%   /Volumes/raspi</div><div class="line">âœ  ~</div></pre></td></tr></table></figure>
</li>
<li><p>æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼Œå°†é•œåƒæ–‡ä»¶çƒ§å½•è¿›SDCardï¼Œè¿™ä¸ªè¿‡ç¨‹ä¼šå› ä¸ºä½ çš„SDCardå¡çš„é€Ÿåº¦çš„ä¸åŒè€Œä¸åŒï¼ŒæœŸé—´ä½ å¯ä»¥é€šè¿‡<code>Ctrl+T</code>æ¥æŸ¥çœ‹è¿›åº¦ï¼š</p>
<p> <code>sudo dd bs=1m if=2016-02-26-raspbian-jessie.img of=/dev/rdisk2</code></p>
<p>å¦‚æœå‘½ä»¤è¡Œæ–¹å¼æœ‰é—®é¢˜ï¼Œè¯·å‚è€ƒ<a href="https://www.raspberrypi.org/documentation/installation/installing-images/mac.md" target="_blank" rel="external">å®˜æ–¹è¯´æ˜</a>è§£å†³ã€‚</p>
</li>
</ol>
</li>
</ul>
<p>çƒ§å½•å®Œæˆä¹‹åSDCardå†…å®¹å¦‚ä¸‹ï¼š</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1801981-388688f6e1ca534c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="raspbian jessie"></p>
<h2 id="0x03-ç™»å½•æ ‘è“æ´¾"><a href="/1970/01/01/[ç©è½¬æ ‘è“æ´¾]0x01é€‰ä¸ªç³»ç»Ÿå…ˆ/#0x03-ç™»å½•æ ‘è“æ´¾" class="headerlink" title="0x03 ç™»å½•æ ‘è“æ´¾"></a>0x03 ç™»å½•æ ‘è“æ´¾</h2><p>å®Œæˆä»¥ä¸Šæ“ä½œï¼Œå°†SDCardæ’å…¥æ ‘è“æ´¾åŠ ç”µå°±å¯ä»¥é¡ºåˆ©è·‘èµ·æ¥äº†ã€‚æˆ‘ä»¬å†å¼ºè°ƒä¸€éï¼Œå³ä½¿<code>æ²¡æœ‰é”®ç›˜é¼ æ ‡æ˜¾ç¤ºå™¨ï¼Œä¹Ÿæ˜¯å¯ä»¥æ“ä½œæ ‘è“æ´¾çš„ï¼ŒåŒ…æ‹¬å®‰è£…æ—¶</code>ã€‚ç®€å•çš„æ‹“æ‰‘å¦‚ä¸‹å›¾ï¼š</p>
<p><img src="https://pihw.files.wordpress.com/2013/04/directconnect1.png" alt="ç®€å•æ‹“æ‰‘"></p>
<p>å¯åŠ¨æ ‘è“æ´¾å¯ä»¥æœ‰ä¸¤ç§æ–¹å¼ï¼š<code>æ— å¤–æ¥é”®ç›˜é¼ æ ‡æ˜¾ç¤ºå™¨</code>å’Œ<code>æœ‰å¤–æ¥é”®ç›˜é¼ æ ‡æ˜¾ç¤ºå™¨</code>ï¼ˆè™½ç„¶æˆ‘å‡è®¾è‡ªå·±æ²¡æœ‰å¤šä½™çš„é”®ç›˜æ˜¾ç¤ºå™¨ï¼Œä½†æ˜¯æˆ‘è¿˜æ˜¯ä¼šåœ¨æ­¤ä»‹ç»è¿™ç§æ–¹å¼~~ï¼‰ã€‚</p>
<p>è¿™ä¸¤ç§æ–¹å¼æ— è®ºé€‰æ‹©å“ªç§ï¼Œæˆ‘ä»¬éƒ½éœ€è¦å…ˆå°†æ ‘è“æ´¾é€šè¿‡RJ45æ¥å£ä¸æˆ‘ä»¬çš„è·¯ç”±å™¨ç›¸è¿ï¼ˆè¯´äººè¯å°±æ˜¯æ‹¿ç½‘çº¿è¿æ¥æ ‘è“æ´¾å’Œè·¯ç”±å™¨ï¼‰ã€‚åˆ«é—®æˆ‘ä¸ºä»€ä¹ˆè¿™ä¹ˆåšï¼Œå› ä¸ºè¿™æ ·æœ€ç®€å•ï¼Œè·Ÿç€åšå°±å¥½ï¼ˆå½“ç„¶ï¼Œæˆ‘çŸ¥é“ä½ ä¹Ÿå¯ä»¥ç›´æ¥æ‹¿æ ¹ç½‘çº¿ç›´æ¥è¿æ¥ç”µè„‘å’Œæ ‘è“æ´¾ï¼Œä½†æ˜¯éå¸¸ä¸å»ºè®®è¿™ä¹ˆåšï¼Œå› ä¸ºè¿™ä¹ˆå±Œçš„ä½ å·²ç»å¯ä»¥ä¸ç”¨æ¥çœ‹è¿™ç¯‡æ–‡ç« äº†ï¼‰ï¼Œæˆ–è€…ä½ ä¼šè¯´æ²¡æœ‰è·¯ç”±å™¨ï¼Œä½ çœŸçš„æ²¡è·¯ç”±å™¨ï¼Ÿé‚£èµ¶ç´§ä¹°ä¸€ä¸ªå§ã€‚</p>
<blockquote>
<p>è¿™é‡Œå¼ºçƒˆå»ºè®®é€šè¿‡è·¯ç”±å™¨çš„è®¾ç½®ç»™æ ‘è“æ´¾åˆ†é…é™æ€IPï¼Œå¦åˆ™ä¼šéå¸¸éº»çƒ¦ã€‚æ›´å¤šè·å–æ ‘è“æ´¾çš„IPçš„æ–¹æ³•å¯å‚è€ƒ<a href="https://www.raspberrypi.org/documentation/remote-access/ip-address.md" target="_blank" rel="external">è¿™é‡Œ</a>ã€‚</p>
</blockquote>
<ul>
<li><p>æ— å¤–æ¥é”®ç›˜é¼ æ ‡æ˜¾ç¤ºå™¨</p>
<p>  è¿™ç§æ–¹å¼æœ€ç®€å•ã€‚æ ‘è“æ´¾æ¥å…¥ç½‘ç»œï¼Œæˆ‘ä»¬åªéœ€è¦ç™»å½•è·¯ç”±å™¨ï¼Œåˆ°DHCPæœåŠ¡å™¨ä¸­çš„å®¢æˆ·ç«¯åˆ—è¡¨ä¸­æŸ¥çœ‹æˆ‘ä»¬çš„æ ‘è“æ´¾çš„IPï¼Œç„¶åé€šè¿‡sshå‘½ä»¤ç™»å½•æ ‘è“æ´¾å°±å¯ä»¥æ“ä½œäº†ã€‚[é»˜è®¤çš„ç”¨æˆ·åå¯†ç ][c2]ï¼š<code>pi</code>ï¼š<code>raspberry</code>ï¼Œ<code>ssh</code> å‘½ä»¤å¦‚ä¸‹ï¼š</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ssh pi@&lt;you ip address&gt;</div></pre></td></tr></table></figure>
</li>
</ul>
<blockquote>
<p>å¯†ç è¾“å…¥æ— å›æ˜¾</p>
</blockquote>
<ul>
<li><p>å¤–æ¥é”®ç›˜é¼ æ ‡æ˜¾ç¤ºå™¨</p>
<p>  å¦‚æœä½ æœ‰å¤šä½™çš„é”®ç›˜é¼ æ ‡æ˜¾ç¤ºå™¨ä¾›ç»™æ ‘è“æ´¾ä½¿ç”¨ï¼Œé‚£ä¹ˆç¬¬ä¸€æ¬¡å¯åŠ¨çš„æ—¶å€™ï¼Œæˆ‘ä»¬éœ€è¦ç®€å•é…ç½®ä¸‹æ ‘è“æ´¾ä½¿å…¶æ”¯æŒHDMIè¾“å‡ºã€‚æ‰“å¼€æˆ‘ä»¬çš„SDCardï¼Œåœ¨æ ¹ç›®å½•ä¸‹ï¼Œçœ‹åˆ°æœ‰è¿™ä¹ˆä¸€ä¸ªæ–‡ä»¶ï¼š<a href="https://www.raspberrypi.org/documentation/configuration/config-txt.md" target="_blank" rel="external"><code>config.txt</code></a>ã€‚æˆ‘ä»¬éœ€è¦ä¿®æ”¹ä»–æ”¯æŒHDMIçš„æ˜¾ç¤ºï¼ˆ1080Pçš„è¾“å‡ºï¼‰ï¼Œä¸‹é¢æ˜¯æˆ‘é…ç½®çš„Demoï¼š</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div></pre></td><td class="code"><pre><div class="line">pi@raspi:/boot $ cat config.txt</div><div class="line"># For more options and information see</div><div class="line"># http://www.raspberrypi.org/documentation/configuration/config-txt.md</div><div class="line"># Some settings may impact device functionality. See link above for details</div><div class="line"></div><div class="line"># uncomment if you get no picture on HDMI for a default &quot;safe&quot; mode</div><div class="line">#hdmi_safe=1</div><div class="line"></div><div class="line"># uncomment this if your display has a black border of unused pixels visible</div><div class="line"># and your display can output without overscan</div><div class="line">disable_overscan=1</div><div class="line"></div><div class="line"># uncomment the following to adjust overscan. Use positive numbers if console</div><div class="line"># goes off screen, and negative if there is too much border</div><div class="line">#overscan_left=16</div><div class="line">#overscan_right=16</div><div class="line">#overscan_top=16</div><div class="line">#overscan_bottom=16</div><div class="line"></div><div class="line"># uncomment to force a console size. By default it will be display&apos;s size minus</div><div class="line"># overscan.</div><div class="line">#framebuffer_width=1280</div><div class="line">#framebuffer_height=720</div><div class="line"></div><div class="line"># uncomment if hdmi display is not detected and composite is being output</div><div class="line">hdmi_force_hotplug=1</div><div class="line"></div><div class="line"># uncomment to force a specific HDMI mode (this will force VGA)</div><div class="line">hdmi_group=2</div><div class="line">hdmi_mode=82</div><div class="line"></div><div class="line"># uncomment to force a HDMI mode rather than DVI. This can make audio work in</div><div class="line"># DMT (computer monitor) modes</div><div class="line">#hdmi_drive=2</div><div class="line"></div><div class="line"># uncomment to increase signal to HDMI, if you have interference, blanking, or</div><div class="line"># no display</div><div class="line">config_hdmi_boost=4</div><div class="line"></div><div class="line"># uncomment for composite PAL</div><div class="line">#sdtv_mode=2</div><div class="line"></div><div class="line">#uncomment to overclock the arm. 700 MHz is the default.</div><div class="line">#arm_freq=800</div><div class="line"></div><div class="line"># Uncomment some or all of these to enable the optional hardware interfaces</div><div class="line">#dtparam=i2c_arm=on</div><div class="line">#dtparam=i2s=on</div><div class="line">#dtparam=spi=on</div><div class="line"></div><div class="line"># Uncomment this to enable the lirc-rpi module</div><div class="line">#dtoverlay=lirc-rpi</div><div class="line"></div><div class="line"># Additional overlays and parameters are documented /boot/overlays/README</div><div class="line"></div><div class="line"># Enable audio (loads snd_bcm2835)</div><div class="line">dtparam=audio=on</div><div class="line">device_tree=</div></pre></td></tr></table></figure>
<p>  å‚è€ƒï¼š</p>
<ol>
<li><a href="http://www.roboby.com/raspberry-pi-640x480.html" target="_blank" rel="external">è§£å†³Raspberry Piåªèƒ½åœ¨é»˜è®¤640Ã—480æ¨¡å¼ä¸‹æ˜¾ç¤ºçš„é—®é¢˜</a></li>
<li><a href="http://elinux.org/RPiconfig" target="_blank" rel="external">http://elinux.org/RPiconfig</a></li>
</ol>
</li>
</ul>
<h2 id="0x04-é…ç½®WIFI"><a href="/1970/01/01/[ç©è½¬æ ‘è“æ´¾]0x01é€‰ä¸ªç³»ç»Ÿå…ˆ/#0x04-é…ç½®WIFI" class="headerlink" title="0x04 é…ç½®WIFI"></a>0x04 é…ç½®WIFI</h2><p>å¦‚æœä½ æƒ³æ‘†è„±ç½‘çº¿çš„æŸç¼šï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨WIFIæ¥æ¥å…¥ç½‘ç»œã€‚æœ€æ–°çš„æ ‘è“æ´¾3æ¿è½½äº†WIFIï¼Œæ ‘è“æ´¾2ä»£éœ€è¦æˆ‘ä»¬è‡ªå·±é…ç½®æ— çº¿ç½‘å¡ã€‚<a href="https://www.raspberrypi.org/documentation/configuration/wireless/wireless-cli.md" target="_blank" rel="external">å®˜æ–¹çš„é…ç½®å‚è€ƒè¿™é‡Œ</a>ã€‚å¦‚ä½•æŸ¥çœ‹æˆ‘ä»¬çš„æ— çº¿ç½‘å¡æ˜¯å¦æ­£ç¡®è¯†åˆ«ï¼Œå¯ä»¥ä½¿ç”¨<code>lsusb</code>å‘½ä»¤ï¼Œå¦‚ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">pi@raspi:~ $ lsusb</div><div class="line">Bus 001 Device 005: ID 0a12:0001 Cambridge Silicon Radio, Ltd Bluetooth Dongle (HCI mode)</div><div class="line">Bus 001 Device 004: ID 0bda:8178 Realtek Semiconductor Corp. RTL8192CU 802.11n WLAN Adapter</div><div class="line">Bus 001 Device 003: ID 0424:ec00 Standard Microsystems Corp. SMSC9512/9514 Fast Ethernet Adapter</div><div class="line">Bus 001 Device 002: ID 0424:9514 Standard Microsystems Corp.</div><div class="line">Bus 001 Device 001: ID 1d6b:0002 Linux Foundation 2.0 root hub</div></pre></td></tr></table></figure>
<p>ç¬¬äºŒè¡Œçš„Devices 004 <code>RTL8192CU</code>å°±æ˜¯æˆ‘çš„æ— çº¿ç½‘å¡ã€‚RASPBIAN JESSIEç³»ç»Ÿé»˜è®¤é›†æˆäº†<code>RTL8192CU</code>çš„é©±åŠ¨ï¼Œæ‰€ä»¥æˆ‘æ’ä¸Šå»ä¹‹åå°±èƒ½ç”¨äº†ã€‚å¦‚æœä½ çš„æ— çº¿ç½‘å¡æ— æ³•æ£€æµ‹åˆ°ï¼Œè¯·æ£€æŸ¥é©±åŠ¨é…ç½®ï¼Œç”±äºæ— çº¿ç½‘å¡å‹å·å¤ªå¤šï¼Œé©±åŠ¨å®‰è£…å°±ä¸å±•å¼€è®²äº†ï¼Œå¯ä»¥å‚è€ƒ<a href="https://wiki.debian.org/WiFi/" target="_blank" rel="external">è¿™é‡Œ</a>ã€‚</p>
<ul>
<li><p>ç›´æ¥ä¿®æ”¹é…ç½®æ–‡ä»¶</p>
<p>  æ ‘è“æ´¾çš„ç½‘ç»œé…ç½®æ–‡ä»¶ä½äº <code>/etc/network/interfaces</code> å’Œ <code>/etc/wpa_supplicant/wpa_supplicant.conf</code>æ–‡ä»¶ä¸­ï¼Œæˆ‘ä»¬å°†é€šè¿‡å¯¹å…¶ä¿®æ”¹æ¥ä½¿ç”¨æˆ‘ä»¬çš„WIFIã€‚ä¿®æ”¹ä¹‹å‰å»ºè®®å…ˆåšå¤‡ä»½ï¼š</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">sudo cp /etc/network/interfaces /etc/network/interfaces.bak</div><div class="line">sudo cp /etc/wpa_supplicant/wpa_supplicant.conf /etc/wpa_supplicant/wpa_supplicant.conf.bak</div></pre></td></tr></table></figure>
</li>
</ul>
<pre><code>ä¸‹é¢æ˜¯é»˜è®¤çš„ `interfaces` é…ç½®æ–‡ä»¶ï¼š

<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">$ cat interfaces</div><div class="line"># interfaces(5) file used by ifup(8) and ifdown(8)</div><div class="line"></div><div class="line"># Please note that this file is written to be used with dhcpcd</div><div class="line"># For static IP, consult /etc/dhcpcd.conf and &apos;man dhcpcd.conf&apos;</div><div class="line"></div><div class="line"># Include files from /etc/network/interfaces.d:</div><div class="line">source-directory /etc/network/interfaces.d</div><div class="line"></div><div class="line">auto lo</div><div class="line">iface lo inet loopback</div><div class="line"></div><div class="line">iface eth0 inet manual</div><div class="line"></div><div class="line">allow-hotplug wlan0</div><div class="line">iface wlan0 inet manual</div><div class="line">    wpa-conf /etc/wpa_supplicant/wpa_supplicant.conf</div><div class="line"></div><div class="line">allow-hotplug wlan1</div><div class="line">iface wlan1 inet manual</div><div class="line">    wpa-conf /etc/wpa_supplicant/wpa_supplicant.conf</div></pre></td></tr></table></figure>
</code></pre><p>åœ¨é»˜è®¤çš„ <code>interfaces</code> é…ç½®ä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥ä»…ä»…ä¿®æ”¹ <code>/etc/wpa_supplicant/wpa_supplicant.conf</code>æ¥å®ŒæˆWIFIé…ç½®ï¼Œæ¯”å¦‚æˆ‘çš„ <code>wpa_supplicant.conf</code>æ–‡ä»¶å¦‚ä¸‹ï¼š</p>
<pre><code><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div></pre></td><td class="code"><pre><div class="line">$ sudo cat /etc/wpa_supplicant/wpa_supplicant.conf</div><div class="line">country=CN</div><div class="line">ctrl_interface=DIR=/var/run/wpa_supplicant GROUP=netdev</div><div class="line">update_config=1</div><div class="line"></div><div class="line">network=&#123;</div><div class="line">	ssid=&quot;my wifi ssid&quot;</div><div class="line">	psk=&quot;my password&quot;</div><div class="line">	key_mgmt=WPA-PSK</div><div class="line">&#125;</div><div class="line">``` </div><div class="line">æˆ‘çš„WIFIåŠ å¯†æ–¹å¼æ˜¯ `WPA-PSK/WPA2-PSK` å› æ­¤é…ç½® `key_mgmt=WPA-PSK` åŠ å¯†æ–¹å¼å¯ä»¥åœ¨è·¯ç”±å™¨çš„æ— çº¿å®‰å…¨è®¾ç½®ä¸­æŸ¥çœ‹ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬è¿˜éœ€è¦é‡å¯æˆ‘ä»¬çš„WIFIï¼š</div><div class="line"></div><div class="line"> ``` shell</div><div class="line">sudo ifdown wlan0</div><div class="line">sudo ifup wlan0</div><div class="line"> ``` </div><div class="line">æˆ–è€…ç›´æ¥é‡å¯ç³»ç»Ÿ `sudo reboot` ã€‚é€šè¿‡ä¸Šé¢çš„è®¾ç½®ï¼Œå°±å¯ä»¥è¿æ¥æˆ‘ä»¬çš„WIFIäº†ã€‚</div><div class="line"></div><div class="line">å½“ç„¶ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ä¸ä½¿ç”¨ `/etc/wpa_supplicant/wpa_supplicant.conf` æ–‡ä»¶ï¼Œä»…ä»…ä¿®æ”¹ `interfaces` æ¥å®Œæˆé…ç½®ï¼Œå¦‚æˆ‘çš„å¦ä¸€ä¸ªé…ç½®ï¼š</div><div class="line"></div><div class="line">``` shell</div><div class="line"># interfaces(5) file used by ifup(8) and ifdown(8)</div><div class="line"></div><div class="line"># Please note that this file is written to be used with dhcpcd</div><div class="line"># For static IP, consult /etc/dhcpcd.conf and &apos;man dhcpcd.conf&apos;</div><div class="line"></div><div class="line"># Include files from /etc/network/interfaces.d:</div><div class="line">source-directory /etc/network/interfaces.d</div><div class="line"></div><div class="line">auto lo</div><div class="line"></div><div class="line">iface lo inet loopback</div><div class="line">iface eth0 inet dhcp</div><div class="line"></div><div class="line"># auto wlan0</div><div class="line">allow-hotplug wlan0</div><div class="line">iface wlan0 inet static</div><div class="line">address 192.168.1.56</div><div class="line">netmask 255.255.255.0</div><div class="line">gateway 192.168.1.1</div><div class="line">wpa-ssid &lt;my ssid&gt;</div><div class="line">wpa-psk &lt;my password&gt;</div></pre></td></tr></table></figure>

æ›´å¤šçš„é…ç½®å‚æ•°ï¼Œå¯ä»¥å‚è€ƒ[è¿™é‡Œ](TODO)ã€‚

&gt;è¿™é‡Œé…ç½®ä½¿ç”¨äº†é™æ€IP
</code></pre><ul>
<li><p>é€šè¿‡GUIæ¡Œé¢ç¯å¢ƒè¿›è¡Œé…ç½®</p>
<p>  è¿™ä¸ªå°±éå¸¸ç®€å•äº†ï¼Œè¿æ¥æ˜¾ç¤ºå™¨é”®ç›˜é¼ æ ‡ï¼Œç™»å½•æ¡Œé¢ç¯å¢ƒï¼Œç‚¹å‡»å³ä¸Šè§’çš„WIFIå›¾æ ‡ï¼Œé€‰æ‹©è‡ªå·±çš„WIFIï¼Œç„¶åè¾“å…¥å¯†ç å³å¯ï¼Œå¦‚ä¸‹å›¾ï¼š</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1801981-f5ca409d28f18e39.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="GUI WIFI Config"></p>
</li>
</ul>
<p>è·å–åˆ°IPå¹¶æ¥å…¥åˆ°ç½‘ç»œï¼Œæ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°±å¯ä»¥å¼€å¯æˆ‘ä»¬çš„æ ‘è“æ´¾ä¹‹æ—…ã€‚å„ä½ç©çš„å¼€å¿ƒ~~</p>
<hr>
<p><img src="https://raw.githubusercontent.com/ttdevs/ttdevs.github.io/common/images/logo.png" alt="Create by ttdevs"></p>
]]></content>
      
        <categories>
            
            <category> æŠ€æœ¯ </category>
            
        </categories>
        
        
        <tags>
            
            <tag> ç©è½¬æ ‘è“æ´¾ </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[ã€Œç©è½¬æ ‘è“æ´¾ã€0x03åˆå§‹åŒ–é…ç½®]]></title>
      <url>/1970/01/01/%5B%E7%8E%A9%E8%BD%AC%E6%A0%91%E8%8E%93%E6%B4%BE%5D0x03%E5%88%9D%E5%A7%8B%E5%8C%96%E9%85%8D%E7%BD%AE/</url>
      <content type="html"><![CDATA[<h2 id="0x00-ç³»ç»Ÿçš„åˆå§‹åŒ–é…ç½®"><a href="/1970/01/01/[ç©è½¬æ ‘è“æ´¾]0x03åˆå§‹åŒ–é…ç½®/#0x00-ç³»ç»Ÿçš„åˆå§‹åŒ–é…ç½®" class="headerlink" title="0x00 ç³»ç»Ÿçš„åˆå§‹åŒ–é…ç½®"></a>0x00 ç³»ç»Ÿçš„åˆå§‹åŒ–é…ç½®</h2><p>Config Raspberry Pi</p>
<p>ç³»ç»Ÿçš„é»˜è®¤é…ç½®æœ‰æ—¶å€™æ— æ³•æ»¡è¶³æˆ‘ä»¬å¤šæ ·çš„å®é™…æƒ…å†µï¼Œæ¯”å¦‚æˆ‘ä»¬çš„æ—¶åŒºã€æˆ‘ä»¬çš„è¯­è¨€ã€æˆ‘ä»¬å¤–æ¥æ˜¾ç¤ºå™¨çš„æ¥å£ç±»å‹å’Œå‚æ•°ç­‰ç­‰ï¼Œ è¿™ä¸ªæ—¶å€™å°±éœ€è¦æˆ‘ä»¬å¯¹ç³»ç»Ÿçš„é»˜è®¤é…ç½®è¿›è¡Œä¿®æ”¹ï¼Œæ¥æ»¡è¶³æˆ‘ä»¬çš„å…·ä½“çš„è¦æ±‚ã€‚ä¸‹é¢ç»™å¤§å®¶ä»‹ç»å¯èƒ½éœ€è¦ç”¨åˆ°çš„é…ç½®ã€‚</p>
<h2 id="0x01-config-txt"><a href="/1970/01/01/[ç©è½¬æ ‘è“æ´¾]0x03åˆå§‹åŒ–é…ç½®/#0x01-config-txt" class="headerlink" title="0x01 config.txt"></a>0x01 config.txt</h2><p><code>config.txt</code> è¿™æ˜¯ä¸€ä¸ªé‡è¦çš„ç³»ç»Ÿé…ç½®æ–‡ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥åˆ° Raspberry Pi çš„è¿™ä¸ª <code>/boot/config.txt</code> ç›®å½•ä¸‹æŸ¥çœ‹ï¼Œä¹Ÿå¯ç›´æ¥åœ¨ TF å¡çš„æ ¹ç›®å½•ä¸‹æ‰¾åˆ°ä»–ã€‚éƒ¨åˆ†é…ç½®å¯å‚è€ƒï¼š<a href="/1970/01/01/[ç©è½¬æ ‘è“æ´¾]0x03åˆå§‹åŒ–é…ç½®/0x01 Install Raspbian.md">æ ‘è“æ´¾çš„å®‰è£…</a> ã€‚æ›´å¤šçš„é…ç½®æˆ‘ä»¬ä¼šåœ¨ä»¥åç”¨åˆ°çš„æ—¶å€™è®²è§£ã€‚</p>
<h2 id="0x02-raspi-config"><a href="/1970/01/01/[ç©è½¬æ ‘è“æ´¾]0x03åˆå§‹åŒ–é…ç½®/#0x02-raspi-config" class="headerlink" title="0x02 raspi-config"></a>0x02 raspi-config</h2><p><code>raspi-config</code> è¿™ä¸ªå·¥å…·å¯ä»¥å¯¹ç³»ç»Ÿè¿›è¡Œå„ç§<a href="https://www.raspberrypi.org/documentation/configuration/raspi-config.md" target="_blank" rel="external">é…ç½®</a>ï¼Œéœ€è¦ä½¿ç”¨ç³»ç»Ÿæƒé™æ‰§è¡Œï¼š<code>sudo raspi-config</code>ã€‚æ‰“å¼€åæˆ‘ä»¬ä¼šè§åˆ°å¦‚ä¸‹å›¾çš„é…ç½®ç•Œé¢ï¼š</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1801981-697b513cfffa95d3.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="raspi-config"></p>
<p>è¿™ä¸ªç•Œé¢æ“ä½œæ¯”è¾ƒç®€å•ï¼Œå¦‚æœä½ ç”¨è¿‡DOSç³»ç»Ÿï¼Œè‚¯å®šä¸ä¼šé™Œç”Ÿã€‚ä¸€èˆ¬æƒ…å†µåªæœ‰ä¸‹é¢å‡ ç§æŒ‰é”®ï¼š<code>Esc</code>ã€<code>Tab</code>ã€<code>ä¸Š</code>ã€<code>ä¸‹</code>ã€<code>å·¦</code>ã€<code>å³</code>ã€<code>Space</code>ã€<code>å›è½¦</code>ã€‚ç¡®è®¤æŒ‰<code>å›è½¦</code>ï¼Œè¿”å›ç”¨<code>Esc</code>ï¼Œé€‰æ‹©ç”¨<code>Space</code>ã€<code>ä¸Š</code>ã€<code>ä¸‹</code>å’Œ<code>Tab</code>ã€‚</p>
<ul>
<li><p>Expand Filesystem </p>
<p>  è¯´ä»–é‡è¦ä¸»è¦æ˜¯å› ä¸ºå¾ˆå¤šå°ä¼™ä¼´æ¯”è¾ƒå¥½å¥‡ <code>ä¸ºä»€ä¹ˆæˆ‘çš„æ–‡ä»¶ç³»ç»Ÿå˜å°äº†</code>ï¼Œåªæœ‰MBçº§ï¼Œè€Œä½ ç”¨çš„å´æ˜¯16æˆ–è€…32Gçš„å­˜å‚¨å¡ã€‚å¦‚æœä½ ä¹Ÿæœ‰è¿™ä¸ªç–‘é—®ï¼Œåˆ™å¯ä»¥é€šè¿‡æ‰§è¡Œè¿™ä¸ªé€‰é¡¹æ¥æ‰©å±•ä½ çš„æ–‡ä»¶ç³»ç»Ÿä½¿å…¶å¯ä»¥ä½¿ç”¨æ•´ä¸ªå­˜å‚¨å¡ã€‚</p>
</li>
<li><p>Change User Password</p>
<p>  å­—é¢æ„æ€ï¼Œä¿®æ”¹ä½  Raspbian çš„ <code>pi</code> ç”¨æˆ·çš„å¯†ç </p>
</li>
<li><p>Boot Options</p>
<p>  é€‰æ‹©ä½ çš„å¯åŠ¨æ–¹å¼ï¼Œå¦‚ä½¿ç”¨Console or GUIï¼Œæ˜¯å¦è‡ªåŠ¨ç™»å½•</p>
</li>
<li><p>Wait for Network at Boot</p>
<p>  æ˜¯å¦åœ¨å¯åŠ¨è¿‡ç¨‹ä¸­ç­‰å¾…ç½‘ç»œè¿æ¥ï¼Œé»˜è®¤å°±å¥½</p>
</li>
<li><p>Internationalistion Options</p>
<p>  å›½é™…åŒ–æ”¯æŒï¼Œä¿®æ”¹ä½ çš„ä½ç½®ï¼Œæ—¶åŒºï¼Œé”®ç›˜å¸ƒå±€ï¼ŒWifiç­‰ã€‚</p>
<ol>
<li><p>Change Localeï¼š</p>
<ul>
<li>è‹¥æœä½ å¯ä»¥æ— éšœç¢ä½¿ç”¨è‹±æ–‡ï¼Œå»ºè®®ä¸åšæ”¹åŠ¨</li>
<li>è‹¥æƒ³ä½¿ç”¨ä¸­æ–‡ï¼Œæ”¹ä¸ºï¼š<code>zh_CN.UTF-8 UTF-8</code>ã€‚æ”¹åŠ¨ä¹‹åå»ºè®®å®‰è£…ä¸­æ–‡å­—ä½“ï¼Œå¦åˆ™å¯èƒ½ä¼šå‡ºç°ä¹±ç ï¼ˆå››ä¸ªæ•°å­—çš„æ–¹å—ï¼‰ï¼Œå…·ä½“å‚è€ƒä¸‹é¢çš„ä¸­æ–‡ä¹±ç ã€‚<br><img src="http://upload-images.jianshu.io/upload_images/1801981-98f2afb853686149.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="raspi-config locale"></li>
</ul>
</li>
<li><p>TimeZoneï¼šä¸œå…«åŒºï¼Œæ‰€ä»¥æˆ‘ä»¬é€‰æ‹©ï¼š<code>Asiz</code> &gt; <code>Shanghai</code></p>
</li>
<li>Keyboard Layoutï¼šè¿™ä¸ªæˆ‘ä»¬å¯ä»¥ä½¿ç”¨é»˜è®¤ï¼Œæˆ–è€…æ ¹æ®ä½ å®é™…ä½¿ç”¨é”®ç›˜é€‰æ‹©</li>
<li>Wifiï¼šæˆ‘ä»¬é€‰æ‹© <code>CN China</code></li>
</ol>
</li>
<li><p>Enable Camera</p>
<p>  Cameraï¼Œä¸ç¡®å®šæ˜¯å¯ç”¨æˆ‘ä»¬è‡ªå·±çš„USBæ‘„åƒå¤´è¿˜æ˜¯å®˜æ–¹çš„æ‘„åƒå¤´ï¼Œé€‰æ‹© <code>Enable</code></p>
</li>
<li><p>Add to Rastrack</p>
<p>  ä¸€å°è®¾å¤‡ï¼Œæ­¤å¤„ä¸åšæ”¹åŠ¨</p>
</li>
<li><p>Overclock</p>
<p>  è¶…é¢‘ï¼Œè¿™ä¸ªè‡ªå·±å†³å®šï¼Œä¸ªäººæ„Ÿè§‰æ²¡å¿…è¦</p>
</li>
<li><p>Advanced Options</p>
<p>  è¿™é‡Œçš„é€‰é¡¹æ¯”è¾ƒå¤šï¼Œå…±11é¡¹ï¼Œä»¥åç”¨åˆ°çš„æ—¶å€™å†è¿‡æ¥ä»‹ç»<br>  <img src="http://upload-images.jianshu.io/upload_images/1801981-ce2b21c3e59670ea.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="raspi-config advaned"></p>
</li>
<li><p>About raspi-config</p>
<p>  è¿™ä¸ªå°±ä¸è¯´äº†ï¼Œæ²¡äº‹å¯ä»¥è¯»è¯»</p>
</li>
</ul>
<h2 id="0x03-æ›´æ–°è½¯ä»¶æº"><a href="/1970/01/01/[ç©è½¬æ ‘è“æ´¾]0x03åˆå§‹åŒ–é…ç½®/#0x03-æ›´æ–°è½¯ä»¶æº" class="headerlink" title="0x03 æ›´æ–°è½¯ä»¶æº"></a>0x03 æ›´æ–°è½¯ä»¶æº</h2><p>å¦‚æœä½ ä½¿ç”¨é»˜è®¤çš„è½¯ä»¶æºï¼Œå¾ˆå¤šæ—¶å€™é€Ÿåº¦æ˜¯éå¸¸æ…¢çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬è€ƒè™‘æ¢æˆå›½å†…çš„é•œåƒã€‚æ ‘è“æ´¾çš„è½¯ä»¶æºåˆ—è¡¨è¯·å‚è€ƒ<a href="http://www.raspbian.org/RaspbianMirrors" target="_blank" rel="external">è¿™é‡Œ</a>ï¼Œ<code>sources.list</code> çš„ä¿¡æ¯å¯å‚è€ƒ<a href="https://www.debian.org/doc/manuals/debian-handbook/apt.zh-cn.html#sect.apt-sources.list" target="_blank" rel="external">è¿™é‡Œ</a>ã€‚</p>
<p>å¯èƒ½ä½ ä¼šé—®æ€ä¹ˆé€‰æ‹©ï¼Œé¦–å…ˆå¤©æœçš„ç½‘ç»œè‚¯å®šé€‰å›½å†…çš„ï¼Œå›½å†…çš„ç®€å•æ¥è¯´é€‰æ‹©ç¦»è‡ªå·±è¿‘çš„ï¼Œè¿è¥å•†ç›¸åŒçš„ï¼Œå½“ç„¶ä½ ä¹Ÿå¯ä»¥é€šè¿‡ä¸“ä¸šçš„æµ‹é€Ÿå·¥å…·æ¥å†³å®šã€‚æˆ‘é€‰æ‹©äº† Open Source Software Association of Chinese Academy of Sciencesï¼ˆ<a href="http://mirrors.opencas.cn/raspbian/raspbian/ï¼‰ï¼Œä¸‹é¢ä»‹ç»ä¿®æ”¹æ–¹æ³•ï¼š" target="_blank" rel="external">http://mirrors.opencas.cn/raspbian/raspbian/ï¼‰ï¼Œä¸‹é¢ä»‹ç»ä¿®æ”¹æ–¹æ³•ï¼š</a></p>
<ul>
<li><p>é¦–å…ˆå¤‡ä»½æºåˆ—è¡¨</p>
<p>  <code>pi@raspi:/etc/apt $ sudo cp sources.list sources.list.bak</code></p>
</li>
<li><p>ç¼–è¾‘æºåˆ—è¡¨</p>
<p>  <code>sudo nano sources.list</code></p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">pi@raspi:/etc/apt $ cat sources.list</div><div class="line">#deb http://mirrordirector.raspbian.org/raspbian/ jessie main contrib non-free rpi</div><div class="line"># Uncomment line below then &apos;apt-get update&apos; to enable &apos;apt-get source&apos;</div><div class="line">#deb-src http://archive.raspbian.org/raspbian/ jessie main contrib non-free rpi</div><div class="line"></div><div class="line">deb http://mirrors.opencas.cn/raspbian/raspbian/ jessie main contrib non-free rpi</div><div class="line"># Uncomment line below then &apos;apt-get update&apos; to enable &apos;apt-get source&apos;</div><div class="line">deb-src http://mirrors.opencas.cn/raspbian/raspbian/ jessie main contrib non-free rpi</div></pre></td></tr></table></figure>
</li>
</ul>
<ul>
<li><p>æ›´æ–°</p>
<p>  <code>sudo apt-get update</code>    </p>
</li>
</ul>
<h2 id="0x04-ä¸­æ–‡ä¹±ç "><a href="/1970/01/01/[ç©è½¬æ ‘è“æ´¾]0x03åˆå§‹åŒ–é…ç½®/#0x04-ä¸­æ–‡ä¹±ç " class="headerlink" title="0x04 ä¸­æ–‡ä¹±ç "></a>0x04 ä¸­æ–‡ä¹±ç </h2><p>å¦‚æœä½ åœ¨Change Locale ä¸­é€‰æ‹©äº† <code>zh_CN.UTF-8</code>å°±å¯èƒ½å‡ºç°ä¸­æ–‡ä¹±ç çš„é—®é¢˜ï¼Œä¸‹é¢ä»‹ç»å¦‚ä½•ä¿®æ”¹ï¼š</p>
<ul>
<li><p>å®‰è£…å­—ä½“ï¼š<code>sudo apt-get install ttf-wqy-zenhei</code></p>
<blockquote>
<p>é¡ºä¾¿å®‰è£…è¾“å…¥æ³•ï¼š<code>sudo apt-get -y install scim-pinyin</code></p>
</blockquote>
</li>
<li><p>ä½¿ç”¨è‡ªå·±çš„å­—ä½“ï¼šå°†è‡ªå·±çš„å­—ä½“æ”¾åˆ° <code>~/.local/share/fonts/</code> or <code>~/.fonts</code> æ–‡ä»¶å¤¹ä¸­ï¼ˆæ²¡æœ‰çš„è¯å°±åˆ›å»ºï¼‰ï¼Œç„¶ååˆ·æ–°å­—ä½“ <code>fc-cache -fv</code> æˆ–è€… é‡å¯</p>
</li>
</ul>
<p>ç»è¿‡ä¸Šé¢çš„é…ç½®ï¼ŒåŸºæœ¬ä¸Šå°±å¯ä»¥ä½¿ç”¨æˆ‘ä»¬çš„ Raspberry Pi äº†ã€‚æ¥ä¸‹æ¥å†ç»™å¤§å®¶ä»‹ç»å¦‚æœçªç ´å¤©æœçš„ç½‘ç»œé—®é¢˜ï¼Œç„¶åæˆ‘ä»¬å°±å¯ä»¥æ­£å¼çš„ç©è½¬æ ‘è“æ´¾äº†ï½ï½</p>
<p><img src="https://raw.githubusercontent.com/ttdevs/ttdevs.github.io/common/images/logo.png" alt="Create by ttdevs"></p>
]]></content>
      
        <categories>
            
            <category> æŠ€æœ¯ </category>
            
        </categories>
        
        
        <tags>
            
            <tag> ç©è½¬æ ‘è“æ´¾ </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Hello World]]></title>
      <url>/1970/01/01/hello-world/</url>
      <content type="html"><![CDATA[<img src="/1970/01/01/hello-world//1970/01/01/hello-world/77DE502A.jpg" alt="cover" title="cover">
<img class="cover 77DE502A.jpg">
<p><img src="/1970/01/01/hello-world//images/77DE502A.jpg" alt="77DE502A.jpg"></p>
<p>Welcome to <a href="https://hexo.io/" target="_blank" rel="external">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/" target="_blank" rel="external">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html" target="_blank" rel="external">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues" target="_blank" rel="external">GitHub</a>.</p>
<h2 id="Quick-Start"><a href="/1970/01/01/hello-world/#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="/1970/01/01/hello-world/#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ hexo new <span class="string">"My New Post"</span></div></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/writing.html" target="_blank" rel="external">Writing</a></p>
<h3 id="Run-server"><a href="/1970/01/01/hello-world/#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ hexo server</div></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/server.html" target="_blank" rel="external">Server</a></p>
<h3 id="Generate-static-files"><a href="/1970/01/01/hello-world/#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ hexo generate</div></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/generating.html" target="_blank" rel="external">Generating</a></p>
<h3 id="Deploy-to-remote-sites"><a href="/1970/01/01/hello-world/#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ hexo deploy</div></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/deployment.html" target="_blank" rel="external">Deployment</a></p>
<p>===</p>
<h1 id="My-Demo"><a href="/1970/01/01/hello-world/#My-Demo" class="headerlink" title="My Demo"></a>My Demo</h1><p>è¿™æ˜¯ä¸€ç¯‡è®°å½•ä½¿ç”¨æ–¹æ³•çš„ä»‹ç»ï¼Œ å…±ä»¥åå‚è€ƒã€‚</p>
<h2 id="title1"><a href="/1970/01/01/hello-world/#title1" class="headerlink" title="title1"></a>title1</h2><h3 id="title2"><a href="/1970/01/01/hello-world/#title2" class="headerlink" title="title2"></a>title2</h3><h4 id="title3"><a href="/1970/01/01/hello-world/#title3" class="headerlink" title="title3"></a>title3</h4><p>æµ‹è¯•TOC</p>
<h2 id="åˆ›å»ºtags"><a href="/1970/01/01/hello-world/#åˆ›å»ºtags" class="headerlink" title="åˆ›å»ºtags"></a>åˆ›å»ºtags</h2><ul>
<li>æ–¹æ³•ä¸€</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">tags: </div><div class="line">    - hexo </div><div class="line">    - yml</div></pre></td></tr></table></figure>
<ul>
<li>æ–¹æ³•äºŒ</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">tags: [hexo, yml]</div></pre></td></tr></table></figure>
<h2 id="æ’å…¥å›¾ç‰‡"><a href="/1970/01/01/hello-world/#æ’å…¥å›¾ç‰‡" class="headerlink" title="æ’å…¥å›¾ç‰‡"></a>æ’å…¥å›¾ç‰‡</h2><p><img src="/1970/01/01/hello-world/901E3DC5.jpg" alt="æ’å…¥å›¾ç‰‡"></p>
<h2 id="æ’å…¥ä»£ç "><a href="/1970/01/01/hello-world/#æ’å…¥ä»£ç " class="headerlink" title="æ’å…¥ä»£ç "></a>æ’å…¥ä»£ç </h2><ul>
<li>æ–¹æ³•ä¸€</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> class <span class="title">Test</span><span class="params">()</span></span>&#123;</div><div class="line">    </div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li><p>æ–¹æ³•äºŒ</p>
<p>  public class Test(){</p>
<p>  }</p>
</li>
</ul>
<h2 id="åˆ›å»ºAbouté¡µé¢"><a href="/1970/01/01/hello-world/#åˆ›å»ºAbouté¡µé¢" class="headerlink" title="åˆ›å»ºAbouté¡µé¢"></a>åˆ›å»ºAbouté¡µé¢</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">âœ  blog hexo new page &quot;about&quot;</div><div class="line">INFO  Created: ~/OneDrive/blog/source/about/index.md</div><div class="line">âœ  blog</div></pre></td></tr></table></figure>
<h2 id="æ’å…¥éŸ³ä¹"><a href="/1970/01/01/hello-world/#æ’å…¥éŸ³ä¹" class="headerlink" title="æ’å…¥éŸ³ä¹"></a>æ’å…¥éŸ³ä¹</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">iframe</span> <span class="attr">frameborder</span>=<span class="string">"no"</span> <span class="attr">border</span>=<span class="string">"0"</span> <span class="attr">marginwidth</span>=<span class="string">"0"</span> <span class="attr">marginheight</span>=<span class="string">"0"</span> <span class="attr">width</span>=<span class="string">330</span> <span class="attr">height</span>=<span class="string">86</span> </span></div><div class="line">    <span class="attr">src</span>=<span class="string">"http://music.163.com/outchain/player?type=2&amp;id=25706282&amp;auto=0&amp;height=66"</span>&gt;  </div><div class="line"><span class="tag">&lt;/<span class="name">iframe</span>&gt;</span></div></pre></td></tr></table></figure>
<iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="http://music.163.com/outchain/player?type=2&id=25706282&auto=0&height=66"><br></iframe>  


]]></content>
      
        <categories>
            
            <category> æŠ€æœ¯ </category>
            
        </categories>
        
        
        <tags>
            
            <tag> hexo </tag>
            
            <tag> yml </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[ã€Œç©è½¬æ ‘è“æ´¾ã€0x04è¿˜æˆ‘80ç«¯å£]]></title>
      <url>/1970/01/01/%5B%E7%8E%A9%E8%BD%AC%E6%A0%91%E8%8E%93%E6%B4%BE%5D0x04%E8%BF%98%E6%88%9180%E7%AB%AF%E5%8F%A3/</url>
      <content type="html"><![CDATA[<h2 id="0x00-èŠ±ç”Ÿå£³ä»‹ç»"><a href="/1970/01/01/[ç©è½¬æ ‘è“æ´¾]0x04è¿˜æˆ‘80ç«¯å£/#0x00-èŠ±ç”Ÿå£³ä»‹ç»" class="headerlink" title="0x00 èŠ±ç”Ÿå£³ä»‹ç»"></a>0x00 èŠ±ç”Ÿå£³ä»‹ç»</h2><p>Oray for Raspberry Pi</p>
<p>èŠ±ç”Ÿå£³æœåŠ¡<a href="http://baike.baidu.com/link?url=EYa6mHfgk9r-R6a0_GvHX2aUNOWOQiTwSXvnMy-f4xHGfBMlOnP78dU_KfmlNCcTHYxvXhDcZ-ncLk1enR8mB_" target="_blank" rel="external">ç™¾åº¦ç™¾ç§‘</a>ä¸­æœ‰è¿™æ ·ä¸€æ®µä»‹ç»ï¼š</p>
<blockquote>
<p>èŠ±ç”Ÿå£³æ˜¯åŠ¨æ€åŸŸåè§£ææœåŠ¡å®¢æˆ·ç«¯è½¯ä»¶ã€‚å½“æ‚¨å®‰è£…å¹¶æ³¨å†Œè¯¥é¡¹æœåŠ¡ï¼Œæ— è®ºæ‚¨åœ¨ä»»ä½•åœ°ç‚¹ã€ä»»ä½•æ—¶é—´ã€ä½¿ç”¨ä»»ä½•çº¿è·¯ï¼Œå‡å¯åˆ©ç”¨è¿™ä¸€æœåŠ¡å»ºç«‹æ‹¥æœ‰å›ºå®šåŸŸåå’Œæœ€å¤§è‡ªä¸»æƒçš„äº’è”ç½‘ä¸»æœºã€‚â€œèŠ±ç”Ÿå£³â€æ”¯æŒçš„çº¿è·¯åŒ…æ‹¬æ™®é€šç”µè¯çº¿ã€isdnã€adslã€æœ‰çº¿ç”µè§†ç½‘ç»œã€åŒç»çº¿åˆ°æˆ·çš„å®½å¸¦ç½‘å’Œå…¶å®ƒä»»ä½•èƒ½å¤Ÿæä¾›äº’è”ç½‘çœŸå®ipçš„æ¥å…¥æœåŠ¡çº¿è·¯ï¼Œè€Œæ— è®ºè¿æ¥è·å¾—çš„ipå±äºåŠ¨æ€è¿˜æ˜¯é™æ€ã€‚</p>
</blockquote>
<p>ç®€å•æ¥è¯´ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡èŠ±ç”Ÿå£³çš„æœåŠ¡æŠŠæˆ‘ä»¬çš„IPå’Œä¸€ä¸ªåŸŸååšæ˜ å°„ï¼Œæ˜ å°„åå°±å¯ä»¥ä½¿ç”¨åŸŸåè®¿é—®è€Œä¸éœ€è¦è®°IPäº†ã€‚IPæ˜¯ä¸€ä¸ªä¸å¥½è®°çš„ä¸œè¥¿ï¼Œåƒæˆ‘ä»¬è¿™æ ·çš„ä¸ªäººç”¨æˆ·åˆæ˜¯æ²¡æœ‰å›ºå®šIPçš„ï¼ˆå›ºå®šIPçš„å®½å¸¦æœåŠ¡è¾ƒè´µï¼ŒåœŸè±ªå¯å¿½ç•¥ï¼‰ï¼Œå› æ­¤èŠ±ç”Ÿå£³å¯ä»¥å¸®æˆ‘ä»¬è§£å†³è¿™ä¸ªç–¼ç‚¹ã€‚ä¹‹å‰çš„èŠ±ç”Ÿå£³ç»™æ³¨å†Œç”¨æˆ·å…è´¹æä¾›äº†ä¸€ä¸ªäºŒçº§åŸŸåï¼Œç°åœ¨æ³¨å†Œéœ€è¦èŠ±5å…ƒè´­ä¹°ä¸€ä¸ªæ°¸ä¹…çš„äºŒçº§åŸŸåã€‚ä¸‹é¢ä¼šæœ‰ä»‹ç»ã€‚</p>
<h2 id="0x01-å®‰è£…èŠ±ç”Ÿå£³å†…ç½‘ç‰ˆ"><a href="/1970/01/01/[ç©è½¬æ ‘è“æ´¾]0x04è¿˜æˆ‘80ç«¯å£/#0x01-å®‰è£…èŠ±ç”Ÿå£³å†…ç½‘ç‰ˆ" class="headerlink" title="0x01 å®‰è£…èŠ±ç”Ÿå£³å†…ç½‘ç‰ˆ"></a>0x01 å®‰è£…èŠ±ç”Ÿå£³å†…ç½‘ç‰ˆ</h2><p><code>èŠ±ç”Ÿå£³å†…ç½‘ç‰ˆ</code> è¿™ä¸ªä¸œè¥¿æ˜¯å¹²å˜›çš„ï¼Ÿ å¦‚æœä½ æ²¡æœ‰æ¥è§¦è¿‡ï¼Œå¯èƒ½ä¼šæœ‰è¿™ä¸ªç–‘é—®ï¼Œä¸”å¬æˆ‘æ…¢æ…¢é“æ¥ã€‚ç°åœ¨æˆ–è€…æœªæ¥çš„æŸä¸€å¤©ï¼Œä½ ä¼šçŸ¥é“ï¼Œä¸­å›½ç”µä¿¡æˆ–è€…å…¶ä»–å®¶çš„å®½å¸¦ä¼šå°æ‰ä¸€äº›æˆ‘ä»¬å¸¸ç”¨çš„ç«¯å£ï¼Œæ¯”å¦‚æœ€å¸¸è§çš„80ç«¯å£ã€‚å¯èƒ½ä¸»è¦æ˜¯ä¸ºäº†åŠ å¼ºç½‘ç»œç®¡ç†ï¼Œä¸å…è®¸ç§äººåœ¨å®¶é‡Œæ­å»ºç½‘ç»œæœåŠ¡å§ã€‚é¡ºä¾¿å‘Šè¯‰ä½ ä¸€ä¸ªä¸å¹¸çš„æ¶ˆæ¯ï¼Œå¦‚æœä½ çš„sshä¸èƒ½åœ¨å¤–ç½‘è®¿é—®æˆ–è€…è®¿é—®ä¸ç¨³å®šï¼Œä¹Ÿæœ‰å¯èƒ½è¢«å°äº†ã€‚è€Œæˆ‘ä»¬å°†è¦å®‰è£…çš„ <code>èŠ±ç”Ÿå£³å†…ç½‘ç‰ˆ</code> å°±æ˜¯çªç ´è¿™ä¸ªé™åˆ¶çš„ã€‚å¤§å®¶ä¹Ÿå¯ä»¥å‚è€ƒ<a href="http://service.oray.com/question/2680.html" target="_blank" rel="external">è¿™é‡Œ</a>ã€‚</p>
<h3 id="ä¸‹è½½"><a href="/1970/01/01/[ç©è½¬æ ‘è“æ´¾]0x04è¿˜æˆ‘80ç«¯å£/#ä¸‹è½½" class="headerlink" title="ä¸‹è½½"></a>ä¸‹è½½</h3><p>é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦ä¸‹è½½<a href="http://hsk.oray.com/download/#type=http|shumeipai" target="_blank" rel="external">æ ‘è“æ´¾ç‰ˆçš„èŠ±ç”Ÿå£³å†…ç½‘ç‰ˆ</a>ï¼Œåœ¨æ ‘è“æ´¾ä¸Šï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ <code>wget</code> è¿›è¡Œä¸‹è½½ï¼ˆè¿™é‡Œæˆ‘ä»¬ä¸‹è½½åˆ°~/Downloads/ï¼‰ï¼Œå‘½ä»¤å¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">pi@raspberrypi:~/Downloads $ wget http://download.oray.com/peanuthull/embed/phddns_raspberry.tgz</div></pre></td></tr></table></figure>
<p>ä¸‹è½½ä¸‹æ¥çš„æ–‡ä»¶å« <code>phddns_raspberry.tgz</code>ï¼Œæˆ‘ä»¬å¯¹å…¶è¿›è¡Œè§£å‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">pi@raspberrypi:~/Downloads $ tar zxvf phddns_raspberry.tgz</div><div class="line">phddns2/</div><div class="line">phddns2/oraynewph</div><div class="line">phddns2/oraynewph.tgz</div><div class="line">phddns2/oray_serve</div><div class="line">phddns2/parse</div></pre></td></tr></table></figure>
<h3 id="å®‰è£…"><a href="/1970/01/01/[ç©è½¬æ ‘è“æ´¾]0x04è¿˜æˆ‘80ç«¯å£/#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h3><p>æˆ‘ä»¬éœ€è¦ä½¿ç”¨rootè´¦å·æ¥å®‰è£…ï¼Œå¦åˆ™å¯èƒ½å‡ºç°æƒé™é—®é¢˜ï¼Œå¯¼è‡´å®‰è£…å¤±è´¥ã€‚<code>sudo su</code> åˆ‡æ¢åˆ°rootï¼Œä½¿ç”¨ <code>./oraynewph start</code> æ‰§è¡Œå®‰è£…ã€‚ä¸‹é¢æ˜¯å®‰è£…è¿‡ç¨‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">pi@raspberrypi:~/Downloads $ cd phddns2</div><div class="line">pi@raspberrypi:~/Downloads/phddns2 $ sudo su</div><div class="line">root@raspberrypi:/home/pi/Downloads/phddns2# ./oraynewph start</div><div class="line">...</div></pre></td></tr></table></figure>
<h3 id="é…ç½®"><a href="/1970/01/01/[ç©è½¬æ ‘è“æ´¾]0x04è¿˜æˆ‘80ç«¯å£/#é…ç½®" class="headerlink" title="é…ç½®"></a>é…ç½®</h3><p>åœ¨ä¸Šé¢çš„å®‰è£…æ—¥å¿—ä¸­æˆ‘ä»¬å¯ä»¥çœ‹åˆ°è¿™çš„æç¤ºä¿¡æ¯ï¼ˆä½ ä¹Ÿå¯ä»¥ä½¿ç”¨ <code>oraynewph status</code> å‘½ä»¤æ¥æŸ¥çœ‹æ­¤ä¿¡æ¯ï¼‰ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">SN:RAPIe*************</div><div class="line">Please visit http://b.oray.com</div><div class="line">Oraynewph start success !</div></pre></td></tr></table></figure>
<p>æŒ‰ç…§æç¤ºï¼Œæˆ‘ä»¬æ‰“å¼€ <a href="http://b.oray.com" target="_blank" rel="external">http://b.oray.com</a> è¿™ä¸ªç½‘ç«™ï¼Œä½¿ç”¨ä¸Šé¢çš„SNç™»å½•ç³»ç»Ÿï¼ˆé»˜è®¤å¯†ç æ˜¯<code>admin</code>ï¼Œç™»å½•åä¼šè¦æ±‚ä½ è®¾ç½®å¯†ç ï¼Œç»‘å®šèŠ±ç”Ÿå£³è´¦å·ç­‰ï¼Œå¦‚æœä½ æ²¡æœ‰ï¼Œé‚£éœ€è¦ä½ æ³¨å†Œä¸€ä¸ªï¼‰ï¼Œç™»å½•åå¦‚ä¸‹å›¾ï¼š</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1801981-3b9d5ae4dd7ad773.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="èŠ±ç”Ÿå£³"></p>
<p>æˆ‘ä»¬ç‚¹å‡»å†…ç½‘æ˜ å°„ï¼Œè¿›å…¥è®¾ç½®ç•Œé¢ï¼Œç‚¹å‡» æ·»åŠ é…ç½®ï¼Œå¦‚ä¸‹å›¾ï¼š</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1801981-35f932a7e5c24583.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="é…ç½®"><br><img src="http://upload-images.jianshu.io/upload_images/1801981-33ccee123723a0df.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="é…ç½®"></p>
<p>ç»è¿‡å¦‚ä¸Šé…ç½®ï¼Œæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡åŸŸåæ¥è®¿é—®æˆ‘ä»¬æ”¾åœ¨å®¶é‡Œçš„æ ‘è“æ´¾ä¸Šçš„httpæœåŠ¡äº†ã€‚ç®€å•çš„ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤èµ·ä¸€ä¸ªhttpæœåŠ¡ï¼š<code>sudo python -m SimpleHTTPServer 80</code> è¿›è¡Œæµ‹è¯•ã€‚</p>
<h2 id="0x02-èŠ±ç”Ÿå£³æœåŠ¡"><a href="/1970/01/01/[ç©è½¬æ ‘è“æ´¾]0x04è¿˜æˆ‘80ç«¯å£/#0x02-èŠ±ç”Ÿå£³æœåŠ¡" class="headerlink" title="0x02 èŠ±ç”Ÿå£³æœåŠ¡"></a>0x02 èŠ±ç”Ÿå£³æœåŠ¡</h2><h3 id="æ³¨å†ŒèŠ±ç”Ÿå£³"><a href="/1970/01/01/[ç©è½¬æ ‘è“æ´¾]0x04è¿˜æˆ‘80ç«¯å£/#æ³¨å†ŒèŠ±ç”Ÿå£³" class="headerlink" title="æ³¨å†ŒèŠ±ç”Ÿå£³"></a>æ³¨å†ŒèŠ±ç”Ÿå£³</h3><p>é¦–å…ˆæˆ‘ä»¬éœ€è¦æ³¨å†Œä¸€ä¸ªèŠ±ç”Ÿå£³ï¼Œå¹¶èŠ±Â¥5è´­ä¹°ä¸€ä¸ªæ°¸ä¹…çš„äºŒçº§åŸŸåï¼Œè¿™ä¸ªå°±ä»‹ç»äº†ï¼Œç±»ä¼¼è¿™æ ·ï¼š</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1801981-2e065557539ab45b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="oray info"></p>
<h3 id="è·¯ç”±å™¨ä¸Šç™»å½•èŠ±ç”Ÿå£³"><a href="/1970/01/01/[ç©è½¬æ ‘è“æ´¾]0x04è¿˜æˆ‘80ç«¯å£/#è·¯ç”±å™¨ä¸Šç™»å½•èŠ±ç”Ÿå£³" class="headerlink" title="è·¯ç”±å™¨ä¸Šç™»å½•èŠ±ç”Ÿå£³"></a>è·¯ç”±å™¨ä¸Šç™»å½•èŠ±ç”Ÿå£³</h3><p>æ¥ä¸‹æ¥çš„æ“ä½œéƒ½æ˜¯åŸºäºè¿™ä¸ªå‰æçš„ã€‚å…ˆå›é¡¾ä¸‹æˆ‘çš„ç½‘ç»œæ‹“æ‰‘ï¼š</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1801981-f2dc8e70dc55ce2f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="network topology"></p>
<p>æˆ‘ä½¿ç”¨çš„æ˜¯TP-Linkçš„è·¯ç”±å™¨ï¼Œå®½å¸¦ADSLæ‹¨å·æ˜¯åœ¨è¿™ä¸ªè·¯ç”±å™¨ä¸Šï¼Œè·¯ç”±å™¨æœ‰ä¸€ä¸ªå…¬ç½‘IPã€‚TP-Linkè·¯ç”±å™¨æ˜¯æ”¯æŒèŠ±ç”Ÿå£³æœåŠ¡çš„ã€‚æˆ‘ä»¬åœ¨è·¯ç”±å™¨ç™»å½•èŠ±ç”Ÿå£³è´¦å·åå³å¯é€šè¿‡ç™»å½•å¸å·ç»‘å®šçš„åŸŸåæ¥è®¿é—®è¿™ä¸ªå…¬ç½‘IPäº†ï¼ŒTP-Linkçš„è·¯ç”±å™¨ç™»å½•åçš„ä¿¡æ¯å¦‚ä¸‹ï¼š</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1801981-ae18c1b1d02d7ab1.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="tplink_ddns_oray"></p>
<h3 id="é…ç½®DMZ"><a href="/1970/01/01/[ç©è½¬æ ‘è“æ´¾]0x04è¿˜æˆ‘80ç«¯å£/#é…ç½®DMZ" class="headerlink" title="é…ç½®DMZ"></a>é…ç½®DMZ</h3><p>å¯¹äºæŒ‚åœ¨è·¯ç”±å™¨ä¸‹çš„ Raspberry Pi ä»…ä»…ä¾é ä¸Šé¢çš„èŠ±ç”Ÿå£³é…ç½®è¿˜ä¸å¤Ÿçš„ã€‚æˆ‘ä»¬è¿˜éœ€è¦å¯ç”¨è·¯ç”±å™¨çš„DMZä¸»æœºåŠŸèƒ½ï¼Œä¸‹é¢æ˜¯å…³äºDMZçš„ä»‹ç»ï¼š</p>
<blockquote>
<p>åœ¨æŸäº›ç‰¹æ®Šæƒ…å†µä¸‹ï¼Œéœ€è¦è®©å±€åŸŸç½‘ä¸­çš„ä¸€å°è®¡ç®—æœºå®Œå…¨æš´éœ²ç»™å¹¿åŸŸç½‘ï¼Œä»¥å®ç°åŒå‘é€šä¿¡ï¼Œæ­¤æ—¶å¯ä»¥æŠŠè¯¥è®¡ç®—æœºè®¾ç½®ä¸ºDMZä¸»æœºã€‚ åªæœ‰å¯ç”¨äº†è¯¥åŠŸèƒ½åï¼Œå¯¹åº”çš„DMZä¸»æœºæ‰ä¼šç”Ÿæ•ˆã€‚</p>
</blockquote>
<p>æ ¹æ®ä»‹ç»ï¼Œæˆ‘ä»¬åšä¸‹é¢çš„é…ç½®ï¼š</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1801981-e179b14b6d8e5843.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="DMZ"></p>
<p>è¿™æ ·å‘é€åˆ°æˆ‘ä»¬è·¯ç”±å™¨çš„æ‰€æœ‰è¯·æ±‚éƒ½ä¼šè¢«è½¬å‘åˆ°æˆ‘ä»¬çš„ Raspberry Piäº†ï¼Œæˆ‘ä»¬çš„ Raspberry Pi å°±æˆäº†å…¬ç½‘ä¸­çš„ä¸€å°ä¸»æœºäº†ã€‚</p>
<p><code>PSï¼šDMZä¸»æœºé…ç½®å¹¶ä¸æ˜¯ä¸€ä¸ªå®‰å…¨çš„é€‰æ‹©ï¼Œæ›´å®‰å…¨çš„é…ç½®æ˜¯åªå½±å°„æˆ‘ä»¬ä½¿ç”¨çš„ç«¯å£ï¼Œæ¯”å¦‚80ï¼Œ22ç­‰</code></p>
<p>å¥½äº†ï¼Œè¿™åŸºæœ¬ç®—æ˜¯æœ€åä¸€ç¯‡åŸºç¡€ä»‹ç»äº†ã€‚ä¸‹ä¸€ç¯‡å¼€å§‹ä»‹ç»æ ‘è“æ´¾æœ€å¸å¼•æˆ‘çš„åœ°æ–¹ <code>GPIO</code> æ“ä½œï¼Œæƒ³æƒ³éƒ½å…´å¥‹äº†ï½ï½</p>
<hr>
<p><img src="https://raw.githubusercontent.com/ttdevs/ttdevs.github.io/common/images/logo.png" alt="Create by ttdevs"></p>
]]></content>
      
        <categories>
            
            <category> æŠ€æœ¯ </category>
            
        </categories>
        
        
        <tags>
            
            <tag> ç©è½¬æ ‘è“æ´¾ </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[ã€Œç©è½¬æ ‘è“æ´¾ã€0x06DS18B20æ¸©åº¦æ£€æµ‹]]></title>
      <url>/1970/01/01/%5B%E7%8E%A9%E8%BD%AC%E6%A0%91%E8%8E%93%E6%B4%BE%5D0x06DS18B20%E6%B8%A9%E5%BA%A6%E6%A3%80%E6%B5%8B/</url>
      <content type="html"><![CDATA[<h2 id="0x00-DS18B20æ¸©åº¦æ£€æµ‹"><a href="/1970/01/01/[ç©è½¬æ ‘è“æ´¾]0x06DS18B20æ¸©åº¦æ£€æµ‹/#0x00-DS18B20æ¸©åº¦æ£€æµ‹" class="headerlink" title="0x00 DS18B20æ¸©åº¦æ£€æµ‹"></a>0x00 DS18B20æ¸©åº¦æ£€æµ‹</h2><p>Raspberry connect to DS18B20</p>
<p>éœ€è¦ä¸€ä¸ªèƒ½æµ‹é‡æ°´æ¸©çš„æ¸©åº¦è®¡ï¼Œæ·˜å®ä¹°äº†é«˜é€¼æ ¼çš„çº¢å¤–æ¸©æªï¼Œåˆ°æ‰‹åå‘ç°è¿™é¬¼ä¸œè¥¿ä¸èƒ½æµ‹é‡‘å±æ¯é‡Œçš„æ°´æ¸©ï¼ˆå¥½çš„å¤ªè´µï¼‰ã€‚ç„¶ååˆæ·˜å®äº†ä¸‹ï¼Œä¸€ä¸ªç”µå­æ¸©åº¦è®¡éƒ½å–ä¸‰ä½æ•°ï¼Œå¥½å§ï¼Œæˆ‘ç©·â€¦â€¦ å¿½ç„¶æƒ³èµ·æ‰‹ä¸Šæœ‰ä¸€ä¸ª <code>DS18B20</code>ï¼Œå—¯å—¯ï¼Œæ‹¿å‡ºæ¥è‡ªå·±åšä¸€ä¸ªæ¸©åº¦è®¡å§ï½ï½</p>
<p><code>DS18B20</code> è¿™ä¸ªä¼ æ„Ÿå™¨å¾ˆå¸¸è§ï¼ŒæŸå®ä¸Šä¸€æœä¸€è´­ç‰©è½¦ï¼Œä»·æ ¼5åˆ°10å…ƒä¸ç­‰ï¼Œå½“ç„¶ä¹Ÿæœ‰æ›´å¥½çš„ï¼ŒæŒ‰éœ€è´­ä¹°ï¼Œå¤§æ¦‚<a href="http://www.wendangku.net/doc/529cf93fc281e53a5802fff5.html" target="_blank" rel="external">å‚æ•°å¦‚ä¸‹</a>ï¼š</p>
<blockquote>
<ul>
<li>ç‹¬ç‰¹çš„1-Wireæ€»çº¿æ¥å£ä»…éœ€è¦ä¸€ä¸ªç®¡è„šæ¥é€šä¿¡ã€‚</li>
<li>æ¯ä¸ªè®¾å¤‡çš„å†…éƒ¨ROMä¸Šéƒ½çƒ§å†™äº†ä¸€ä¸ªç‹¬ä¸€æ— äºŒçš„64ä½åºåˆ—å·ã€‚</li>
<li>å¤šè·¯é‡‡é›†èƒ½åŠ›ä½¿å¾—åˆ†å¸ƒå¼æ¸©åº¦é‡‡é›†åº”ç”¨æ›´åŠ ç®€å•ã€‚</li>
<li>æ— éœ€å¤–å›´å…ƒä»¶ã€‚</li>
<li>èƒ½å¤Ÿé‡‡ç”¨æ•°æ®çº¿ä¾›ç”µï¼›ä¾›ç”µèŒƒå›´ä¸º3.0Vè‡³5.5Vã€‚</li>
<li>æ¸©åº¦å¯æµ‹é‡èŒƒå›´ä¸ºï¼š-55â„ƒè‡³+125â„ƒï¼ˆ-67â„‰è‡³+257â„‰ï¼‰ã€‚</li>
<li>æ¸©åº¦èŒƒå›´è¶…è¿‡-10â„ƒè‡³85â„ƒä¹‹å¤–æ—¶å…·æœ‰+-0.5â„ƒçš„ç²¾åº¦ã€‚<code>ï¼ˆæ€€ç–‘æœ‰è¯¯ï¼‰</code></li>
<li>å†…éƒ¨æ¸©åº¦é‡‡é›†ç²¾åº¦å¯ä»¥ç”±ç”¨æˆ·è‡ªå®šä¹‰ä¸º9-Bitsè‡³12-Bitsã€‚</li>
<li>DS18B20 åˆ†è¾¨ç‡å¯ç¼–ç¨‹ 1-Wireæ•°å­—æ¸©åº¦ä¼ æ„Ÿå™¨</li>
<li>æ¸©åº¦è½¬æ¢æ—¶é—´åœ¨è½¬æ¢ç²¾åº¦ä¸º12-Bitsæ—¶è¾¾åˆ°æœ€å¤§å€¼750msã€‚</li>
<li>ç”¨æˆ·è‡ªå®šä¹‰éæ˜“å¤±æ€§çš„çš„æ¸©åº¦æŠ¥è­¦è®¾ç½®ã€‚ Â· å®šä¹‰äº†æ¸©åº¦æŠ¥è­¦æœç´¢å‘½ä»¤å’Œå½“æ¸©åº¦è¶…è¿‡ç”¨æˆ·è‡ªå®šä¹‰çš„è®¾å®šå€¼æ—¶ã€‚</li>
<li>å¯é€‰æ‹©çš„8-Pin SO (150 mils), 8-PinÎ¼SOPï¼ŒåŠ3-Pin TO-92å°è£…ã€‚ Â· ä¸DS1822ç¨‹åºå…¼å®¹ã€‚</li>
<li>åº”ç”¨äºæ¸©åº¦æ§åˆ¶ç³»ç»Ÿï¼Œå·¥ä¸šç³»ç»Ÿï¼Œæ°‘ç”¨äº§å“ã€‚</li>
</ul>
</blockquote>
<p>å—¯å—¯ï¼Œå¾ˆå¤šæŠ€æœ¯å‚æ•°ï¼Œä½œä¸ºå¤–è¡Œäººçœ‹ç€å°±æ™•ã€‚è¿™é‡Œå…³æ³¨å‡ ä¸ªç»†èŠ‚å°±å¥½ï¼š</p>
<ul>
<li>ç”µå‹ï¼š3.0Vï½5.5V</li>
<li>æ¸©åº¦èŒƒå›´ï¼š-55â„ƒè‡³+125â„ƒ</li>
<li>æµ‹é‡ç²¾åº¦ï¼šå¯è°ƒï¼Œ0.5â„ƒå¯¹æˆ‘æ¥è¯´å¯æ¥å—ï¼Œæ‰€ä»¥æš‚æ—¶æ²¡å»ç»†ç©¶</li>
</ul>
<p>æ¥ä¸‹æ¥ç»“åˆæˆ‘çš„æ ‘è“æ´¾çš„æ¿å­ï¼Œç»™å¤§å®¶æ¼”ç¤ºå¦‚ä½•ä½¿ç”¨ã€‚</p>
<h2 id="0x01-ä½¿ç”¨"><a href="/1970/01/01/[ç©è½¬æ ‘è“æ´¾]0x06DS18B20æ¸©åº¦æ£€æµ‹/#0x01-ä½¿ç”¨" class="headerlink" title="0x01 ä½¿ç”¨"></a>0x01 ä½¿ç”¨</h2><p>é¦–å…ˆæŒ‰ç…§ç½‘ä¸Šçš„æ–¹æ³•ï¼Œæ¯”å¦‚<a href="http://blog.csdn.net/vvbbbbb/article/details/52053293" target="_blank" rel="external">vvbbbbb</a>ï¼Œä¸€æ­¥æ­¥æ“ä½œï¼Œéš¾å…é‡åˆ°ä¸€äº›å‘ï¼Œæˆ‘çš„é—®é¢˜æ˜¯æ€ä¹ˆéƒ½ä¸èƒ½è¯†åˆ«è¿™ä¸ªä¼ æ„Ÿå™¨ï¼Œåæ¥æ‰¾äº†å¾ˆä¹…ï¼Œæ— æ„ä¸­è§£å†³äº†ï¼Œç»“åˆæˆ‘çš„å®é™…ï¼Œåšç®€å•è®°å½•ï¼Œå…·ä½“æ“ä½œå¦‚ä¸‹ï¼š</p>
<ul>
<li><p>è¿æ¥ä¼ æ„Ÿå™¨å’ŒRaspberry Pi</p>
<p>  <code>DS18B20</code> æœ‰ä¸‰ä¸ªé’ˆè„šï¼Œåˆ†åˆ«æ˜¯</p>
<ul>
<li>VCC çº¢è‰²ï¼Œè¿ <code>Raspberry Pi</code> çš„ VCCï¼Œæµ‹è¯•è¿æ¥ 3V3 æˆ– 5V5 éƒ½å¯ä»¥</li>
<li>DATA é»„è‰²ï¼Œè¿ <code>Raspberry Pi</code> çš„ GPIO4</li>
<li><p>GND é»‘è‰²ï¼Œè¿ <code>Raspberry Pi</code> çš„ GND</p>
<p>å¦å¤–å’Œéœ€è¦åœ¨ç”¨ä¸€ä¸ª 4.7K çš„ç”µé˜»è¿æ¥ VCC å’Œ DATA ï¼ˆåˆ«é—®æˆ‘ä¸ºä»€ä¹ˆï¼Œæˆ‘ä¹Ÿä¸çŸ¥é“ï¼Œå¤§å­¦æ¨¡ç”µå­¦çš„é‚£å«ä¸€ä¸ªæ¸£ï¼‰ï¼Œå¦‚æœä½ æ²¡æœ‰ 4.7K çš„ç”µé˜»ï¼Œå¬è¯´å¤§ä¸€ç‚¹æˆ–è€…å°ä¸€ç‚¹éƒ½å¯ä»¥ï¼Œæˆ‘æ²¡è¯•ï¼Œåæ­£æˆ‘æœ‰ã€‚å¦‚æœä½ è¿ç”µé˜»éƒ½æ²¡æœ‰ï¼Œå‘Šè¯‰ä½ æŸå®ä¸Šæœ‰æ‰“åŒ…ä¸€è¢‹å‡ºå”®çš„ï¼Œå¸¸ç”¨é˜»å€¼çš„éƒ½æœ‰ï¼Œå¾ˆä¾¿å®œï¼Œå€¼å¾—ä½ å…¥æ‰‹ã€‚å¥½äº†ï¼Œæœ€ç»ˆç”µè·¯å¦‚å›¾ï¼š</p>
</li>
</ul>
</li>
</ul>
<p><img src="http://upload-images.jianshu.io/upload_images/1801981-003624acc884b839.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="ds18b20"></p>
<ul>
<li><p>æ“ä½œ </p>
<ol>
<li><p>æ›´æ–°ç³»ç»Ÿ</p>
<p> å¦‚æœä½ çš„ç³»ç»Ÿç‰ˆæœ¬æ¯”è¾ƒæ—§ï¼Œå»ºè®®ä½ æ›´æ–°ï¼Œå¦åˆ™è·³è¿‡è¿™ä¸€æ­¥ï¼š</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">sudo apt-get update</div><div class="line">sudo apt-get upgrade</div></pre></td></tr></table></figure>
</li>
</ol>
</li>
</ul>
<pre><code>    æ›´æ–°é€Ÿåº¦è§†ä½ çš„ç½‘é€Ÿå’Œæºçš„é€Ÿåº¦ï¼Œæ€ä¹ˆåˆ‡æ¢æºï¼Œå¯ä»¥å‚è€ƒæˆ‘ä¹‹å‰çš„æ–‡ç« ã€‚

1. å¯ç”¨ `1-Wire`

    - ç»ˆç«¯æ‰§è¡Œ `sudo raspi-config`ï¼Œæ‰“å¼€é…ç½®ç•Œé¢ï¼Œæ‰¾åˆ° `1-Wire`ï¼ˆæˆ‘çš„ä½äº`Interfacing Option` ä¸‹ï¼Œä¸åŒç‰ˆæœ¬ä¸ä¸€æ ·ï¼Œæœ‰çš„å¯èƒ½åœ¨ `Advanced Options` ä¸‹ï¼‰å¯ç”¨å®ƒã€‚
    - ä½ ä¹Ÿå¯ä»¥ç›´æ¥é…ç½®ï¼šç¼–è¾‘ `/boot/config.txt` ï¼Œåœ¨æœ€åä¸€è¡Œæ·»åŠ  `dtoverlay=w1-gpio` ä¿å­˜å³å¯ã€‚

        1. ç»ˆç«¯è¾“å…¥ï¼š`sudo nano /boot/config.txt`
        2. `Ctrl+V` æ»šåˆ°æœ€ä¸‹é¢ï¼Œè¾“å…¥ `dtoverlay=w1-gpio`
        3. `Ctrl+O` ä¿å­˜ï¼Œ`Ctrl+X` é€€å‡º

    ä¸¤ä¸ªæ–¹æ³•ç»“æœä¸€æ ·ï¼Œæ“ä½œå®Œæˆä¹‹åéœ€è¦é‡å¯æœºå™¨ï¼Œå‘½ä»¤ï¼š`sudo reboot`

2. æŸ¥çœ‹ä½ çš„ä¼ æ„Ÿå™¨

    <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">pi@raspberrypi:~ $ cd /sys/bus/w1/devices</div><div class="line">pi@raspberrypi:/sys/bus/w1/devices $ ls</div><div class="line">28-031561d43aff  w1_bus_master1</div><div class="line">pi@raspberrypi:/sys/bus/w1/devices $ cat 28-031561d43aff/w1_slave</div><div class="line">48 01 01 01 1f ff 0c 10 04 : crc=04 YES</div><div class="line">48 01 01 01 1f ff 0c 10 04 t=20500</div><div class="line">pi@raspberrypi:/sys/bus/w1/devices $</div></pre></td></tr></table></figure>


    å…ˆæŸ¥çœ‹ `w1` è®¾å¤‡åˆ—è¡¨ï¼Œç„¶åæŸ¥çœ‹é‡Œé¢çš„ `w1_slave` æ–‡ä»¶å†…å®¹ï¼Œå³å¯æ˜¾ç¤ºå‡ºæ¸©åº¦ä¿¡æ¯ï¼ˆè¿™ä¸ªæ¸©åº¦ä¿¡æ¯å¹¶ä¸æ˜¯æˆ‘ä»¬æœ€ç»ˆçš„æ¸©åº¦ï¼Œéœ€è¦ç»è¿‡ä¸€å®šçš„æ¢ç®—ï¼‰ã€‚

    `å‰æ–¹é«˜èƒ½`
    `å‰æ–¹å¡«å‘`

    å—¯å—¯ï¼Œå‘å‡ºç°äº†ï¼Œæˆ‘çš„åœ¨æŸ¥çœ‹ä¼ æ„Ÿå™¨çš„æ—¶å€™æ˜¾ç¤ºå¦‚ä¸‹ï¼š

    <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">pi@raspberrypi:~$ cd /sys/bus/w1/devices/</div><div class="line">pi@raspberrypi:/sys/bus/w1/devices $ ls</div><div class="line">00-600000000000  00-a00000000000  00-e00000000000  w1_bus_master1</div><div class="line">pi@raspberrypi:/sys/bus/w1/devices $</div></pre></td></tr></table></figure>


    ç½‘ä¸Šçœ‹åˆ°çš„éƒ½æ˜¯ `28-xxxxxxxxxxxxxx` è¿™æ ·çš„ä¿¡æ¯ï¼Œè€Œæˆ‘çš„å´ä¸æ˜¯ï¼›è¿™äº›ç›®å½•ä¸‹ä¹Ÿæ²¡æœ‰ `w1_slave`æ–‡ä»¶ï¼›è€Œä¸”æ¯æ¬¡è¿›è¿™ä¸ªç›®å½• `/sys/bus/w1/devices` è¿™äº›æ–‡ä»¶å¤¹çš„åå­—å’Œæ•°é‡éƒ½æœ‰å¯èƒ½ä¼šå˜ã€‚å¥½å§ï¼Œæ‡µé€¼äº†ã€‚æ‰€ä»¥å»æ‰¾ç­”æ¡ˆï¼Œæœç„¶ä¹Ÿæœ‰ä¸€äº›äººååº”è¿‡è¿™ä¸ªé—®é¢˜ï¼Œä½†å¤§éƒ¨åˆ†å¯¹æˆ‘éƒ½æ²¡ç”¨ï¼Œæ¯”å¦‚ VCC ä» 3V3 æ¢åˆ° 5V5 ï¼Œçœ‹çœ‹æ—¶é—´ï¼Œåˆå¿«12ç‚¹äº†ï¼Œæƒ³æ”¾å¼ƒäº†éƒ½ã€‚æ­¤æ—¶[ä½›å…‰ä¹ç°](https://www.raspberrypi.org/forums/viewtopic.php?f=28&amp;t=106041)ï¼šå¯èƒ½æ˜¯ `GPIO` å£çš„é—®é¢˜ï¼Œå¯ä»¥æ¢ä¸€ä¸ªè¯•è¯•ï¼Œä¸€è¯•æœç„¶å¾ˆçˆ½ï¼Œæ“ä½œå¦‚ä¸‹ï¼š

    ç¼–è¾‘ `/boot/config.txt`ï¼Œå°†åˆšæ‰æ·»åŠ çš„é‚£è¡Œä¿®æ”¹å¦‚ä¸‹ `dtoverlay=w1-gpio,gpiopin=5,pullup=on` è¿™é‡Œçš„ `5` æ˜¯å¯¹åº”çš„GPIOå£ï¼Œä½ ä¹Ÿå¯ä»¥ç”¨å…¶ä»–çš„ï¼Œé«˜å…´å°±å¥½ã€‚ä¿å­˜é‡å¯å³å¯ã€‚

3. æŸ¥çœ‹æ¸©åº¦æ•°æ®

    <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">pi@raspberrypi:/sys/bus/w1/devices $ cat 28-031561d43aff/w1_slave</div><div class="line">48 01 01 01 1f ff 0c 10 04 : crc=04 YES</div><div class="line">48 01 01 01 1f ff 0c 10 04 t=20500</div><div class="line">pi@raspberrypi:/sys/bus/w1/devices $</div></pre></td></tr></table></figure>


    è¿™é‡Œçš„ `t=20500` åº”è¯¥å°±æ˜¯æ¸©åº¦æ•°æ®ï¼Œä¸çŸ¥é“ `crc=40` æ˜¯ä¸æ˜¯æ ¡éªŒæ•°æ®ï¼Œä¸ç®¡äº†ï¼Œæˆ‘ä¹Ÿæ²¡æ—¶é—´å»è®¡ç®—ã€‚ç½‘ä¸Šè‚¯å®šæœ‰ç°æˆçš„è½®å­æ¥å±•ç¤ºï¼Œè¿™é‡Œæ¨è [w1thermsensor](https://github.com/timofurrer/w1thermsensor)ã€‚

    - å®‰è£…

        `pip install w1thermsensor`

    - ä½¿ç”¨(ds18b20.py)

        <figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">from</span> w1thermsensor <span class="keyword">import</span> W1ThermSensor</div><div class="line">sensor = W1ThermSensor(W1ThermSensor.THERM_SENSOR_DS18B20, <span class="string">"031561d43aff"</span>)</div><div class="line"><span class="keyword">while</span> <span class="keyword">True</span>:</div><div class="line">    temperature_in_celsius = sensor.get_temperature()</div><div class="line">    <span class="keyword">print</span> temperature_in_celsius</div></pre></td></tr></table></figure>


        è¿™é‡Œçš„ä¸€ä¸ªå¸¸é‡ `031561d43aff` å°±æ˜¯ `28-031561d43aff` è¿™é‡Œçš„ååŠéƒ¨åˆ†ï¼Œä½ çš„å¯èƒ½è·Ÿæˆ‘ä¸ä¸€æ ·ï¼Œè¯·æ”¹æˆä½ è‡ªå·±çœ‹åˆ°çš„ã€‚

        æ‰§è¡Œï¼š

        <figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">pi@raspberrypi:~/python $ cat ds18b20.py</div><div class="line"><span class="keyword">from</span> w1thermsensor <span class="keyword">import</span> W1ThermSensor</div><div class="line">sensor = W1ThermSensor(W1ThermSensor.THERM_SENSOR_DS18B20, <span class="string">"031561d43aff"</span>)</div><div class="line"><span class="keyword">while</span> <span class="keyword">True</span>:</div><div class="line">    temperature_in_celsius = sensor.get_temperature()</div><div class="line">    <span class="keyword">print</span> temperature_in_celsius</div><div class="line">pi@raspberrypi:~/python $ python ds18b20.py</div><div class="line"><span class="number">21.0</span></div><div class="line"><span class="number">21.0</span></div></pre></td></tr></table></figure>
</code></pre><p>å®Œç¾ï½</p>
<h2 id="0xFF-å‚è€ƒ"><a href="/1970/01/01/[ç©è½¬æ ‘è“æ´¾]0x06DS18B20æ¸©åº¦æ£€æµ‹/#0xFF-å‚è€ƒ" class="headerlink" title="0xFF å‚è€ƒ"></a>0xFF å‚è€ƒ</h2><ol>
<li><a href="https://datasheets.maximintegrated.com/en/ds/DS18B20.pdf" target="_blank" rel="external">https://datasheets.maximintegrated.com/en/ds/DS18B20.pdf</a></li>
<li><a href="http://www.wendangku.net/doc/529cf93fc281e53a5802fff5.html" target="_blank" rel="external">http://www.wendangku.net/doc/529cf93fc281e53a5802fff5.html</a></li>
<li><a href="http://blog.csdn.net/vvbbbbb/article/details/52053293" target="_blank" rel="external">http://blog.csdn.net/vvbbbbb/article/details/52053293</a></li>
<li><a href="https://www.raspberrypi.org/forums/viewtopic.php?f=28&amp;t=106041" target="_blank" rel="external">https://www.raspberrypi.org/forums/viewtopic.php?f=28&amp;t=106041</a></li>
</ol>
<p><img src="https://raw.githubusercontent.com/ttdevs/ttdevs.github.io/common/images/logo.png" alt="Create by ttdevs"></p>
]]></content>
      
        <categories>
            
            <category> æŠ€æœ¯ </category>
            
        </categories>
        
        
        <tags>
            
            <tag> ç©è½¬æ ‘è“æ´¾ </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[ã€Œç©è½¬æ ‘è“æ´¾ã€0x05GPIO]]></title>
      <url>/1970/01/01/%5B%E7%8E%A9%E8%BD%AC%E6%A0%91%E8%8E%93%E6%B4%BE%5D0x05GPIO/</url>
      <content type="html"><![CDATA[<p>GPIOï¼šGeneral Purpose Input/Output pins on the Raspberry Pi</p>
<blockquote>
<p>General purpose input/output; in this specific case the pins on the Raspberry Pi and what you can do with them. So called because you can use them for all sorts of purposes; most can be used as either inputs or outputs, depending on your program.</p>
</blockquote>
<h2 id="0x00-GPIO"><a href="/1970/01/01/[ç©è½¬æ ‘è“æ´¾]0x05GPIO/#0x00-GPIO" class="headerlink" title="0x00 GPIO"></a>0x00 GPIO</h2><p>æœ‰äº›äº‹æƒ…åšæŒäº†ï¼Œå°±åšå‡ºæ¥äº†ï¼Œä¸åšæŒï¼Œå°±æ”¾å¼ƒäº†ï¼Œå°±è¿™ä¹ˆç®€å•ã€‚ä¹‹å‰æƒ³å†™ä¸ªæ ‘è“æ´¾çš„å…¥é—¨æ–‡ç« ï¼Œä¸€ä¸‹å­å†™äº†å‡ ç¯‡ä¹‹åï¼Œå°±åœä¸‹æ¥äº†ã€‚å¯èƒ½æœ€è¿‘ç¡®æ˜¯æ¯”è¾ƒå¿™ï¼Œæˆ–è€…ï¼Œæ‰¿è®¤æ²¡æœ‰ä¸¥æ ¼è¦æ±‚è‡ªå·±ï¼Œå¥½å§ï¼Œæ‹–äº†è¿™ä¹ˆä¹…ï¼Œä»Šå¤©ï¼Œå†å†™ä¸€ç¯‡ã€‚</p>
<p>ä¸ç®¡ä½ ä¿¡ä¸ä¿¡ï¼Œæ ‘è“æ´¾æœ€å¸å¼•æˆ‘çš„å°±æ˜¯å®ƒçš„GPIOå£ã€‚å³ä½¿æ˜¯ç°åœ¨ï¼Œæƒ³åˆ°GPIOè¿˜æ˜¯éå¸¸çš„å…´å¥‹å‘¢ã€‚ä¸ºä»€ä¹ˆå‘¢ï¼Ÿå¯¹äºé€šç”¨è®¡ç®—æœºï¼Œæˆ‘ä»¬èƒ½æ“ä½œçš„åŸºæœ¬éƒ½æ˜¯USBã€ä¸²å£ç­‰ä¸€äº›æ¥å£ã€‚ä¸è¿™äº›æ¥å£ç›¸æ¯”ï¼ŒGPIOå£æœ‰æ˜æ˜¾çš„ä¸åŒï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥æ“ä½œä¸€ä¸ªIOå£çš„çŠ¶æ€ï¼šæ˜¯é«˜ç”µå¹³è¿˜æ˜¯ä½ç”µå¹³ã€‚æ ¹æ®è¿™ä¸ªç‰¹æ€§ï¼Œæˆ‘ä»¬å°±å¯ä»¥å®Œæˆé¦–æ¬¡æ¥è§¦å•ç‰‡æœºå®Œæˆçš„å°å®éªŒï¼šæ§åˆ¶æˆ‘ä»¬çš„LEDç¯ï¼Œåˆ¶ä½œè·‘é©¬ç¯ï¼Œæ¨¡æ‹Ÿäº¤é€šç¯ç­‰ç­‰æœ‰è¶£çš„å®éªŒã€‚å¦‚æœä½ æƒ³é€šè¿‡å…¶ä»–è®¾å¤‡æ¥å®Œæˆè¿™äº›æ“ä½œï¼Œå¯èƒ½éœ€è¦æŒæ¡å…¶ä»–å¯¹åˆå­¦è€…æ¥è¯´æ¯”è¾ƒå›°éš¾çš„æŠ€æœ¯ã€‚å¦å¤–ï¼Œå¤§å­¦æ—¶æœŸæœ‰ç©è¿‡ 89C51ï¼Œå¯¹IOå£è¿˜æ˜¯æ‹æ‹ä¸èˆï¼Œæ›¾ç»æƒ³é€šè¿‡å…¶äº§ç”ŸPWMä¿¡å·æ§åˆ¶èˆµæœºï¼Œå¾ˆé—æ†¾æ²¡å®ç°ï¼Œç°åœ¨æ­£å¥½å¯ä»¥å®Œæˆè¿™ä¸ªå¿ƒæ„¿ã€‚</p>
<h2 id="0x01-ä»ä¸€ä¸ªLEDè¯´å¼€å»"><a href="/1970/01/01/[ç©è½¬æ ‘è“æ´¾]0x05GPIO/#0x01-ä»ä¸€ä¸ªLEDè¯´å¼€å»" class="headerlink" title="0x01 ä»ä¸€ä¸ªLEDè¯´å¼€å»"></a>0x01 ä»ä¸€ä¸ªLEDè¯´å¼€å»</h2><p>è¿™æ˜¯ä¸€ç¯‡å¾ˆåŸºç¡€çš„æ–‡ç« ï¼Œæ‰€ä»¥ä¼šæ¯”è¾ƒé€šä¿—ã€‚é¦–å…ˆæˆ‘ä»¬é€šè¿‡LEDçš„Demoæ¥äº†è§£ä¸‹ä»€ä¹ˆæ˜¯GPIOã€‚å…ˆçœ‹ä¸€å¼ åŸç†å›¾ï¼š</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1801981-1dd47f2ab18be25f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="LED Demo"></p>
<p>è¿™æ˜¯ä¸€ä¸ªéå¸¸ç®€å•çš„ç”µè·¯ï¼šä¸€ä¸ªå‘å…‰äºŒæç®¡ã€ä¸€ä¸ªç”µé˜»ï¼ˆ300Î©å·¦å³ï¼Œå¿˜è®°æ€ä¹ˆç®—çš„äº†ï¼‰ã€ä¸€ä¸ªRapsberry Piã€‚ç”±äºRapsberry Pi GPIOå£è¾“å‡ºç”µå‹æ˜¯3V3ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸²ä¸€ä¸ªç”µé˜»æ¥ä¿æŠ¤æˆ‘ä»¬çš„LEDã€‚å½“æˆ‘ä»¬é€šè¿‡ä»£ç æ§åˆ¶é“¾æ¥ç”µé˜»çš„é‚£ä¸ªGPIOå£çŠ¶æ€æ—¶ï¼Œå°±å¯ä»¥ä½¿LEDåœ¨äº®å’Œç­ä¹‹é—´åˆ‡æ¢ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">import RPi.GPIO as GPIO</div><div class="line">import time</div><div class="line"></div><div class="line">GPIO.setmode(GPIO.BCM)</div><div class="line">GPIO.setwarnings(False)</div><div class="line"></div><div class="line">led = 23</div><div class="line">GPIO.setup(led, GPIO.OUT)</div><div class="line"></div><div class="line">try:</div><div class="line">    while(True):</div><div class="line">        GPIO.output(led, 1)</div><div class="line">        time.sleep(1)</div><div class="line">        GPIO.output(led, 0)</div><div class="line">        time.sleep(1)</div><div class="line">except Exception as e:</div><div class="line">    print(e)</div><div class="line">finally:</div><div class="line">    GPIO.cleanup()</div></pre></td></tr></table></figure>
<p>è¿è¡Œä¸Šé¢çš„ä»£ç ï¼Œæˆ‘ä»¬å°±å¯ä»¥çœ‹åˆ°LEDä¸¤ç§’ä¸€ä¸ªå¾ªç¯çš„äº®ç­ã€‚å“ˆå“ˆï¼Œæ˜¯ä¸æ˜¯ç‰¹æœ‰æˆå°±æ„Ÿï¼Œä¼ è¯´ä¸­çš„ç‚¹äº®å°ç¯æ³¡ç»ˆäºå®ç°äº†ï½ï½  ç„¶å¹¶åµï¼Œè¿™å¹¶æ²¡æœ‰ä»€ä¹ˆå®é™…çš„ç”¨å¤„ã€‚ä¸‹é¢å†ä»‹ç»ä¸€ä¸ªå±Œå±Œçš„demoï¼Œé€šè¿‡<code>HC-SR501</code>äººä½“çº¢å¤–ä¼ æ„Ÿå™¨æ£€æµ‹æ§åˆ¶LEDçš„äº®ç­ï¼Œå®é™…çš„ä¾‹å­çš„å°±æ˜¯å¾ˆå¤šè‡ªåŠ¨é—¨ï¼Œç«™åœ¨é—¨ä¸‹é¢çš„æ—¶å€™é—¨ä¼šè‡ªåŠ¨æ‰“å¼€ã€‚ <code>HC-SR501</code> å®ƒæ˜¯é•¿è¿™ä¸ªæ ·å­æ»´ï¼š</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1801981-b20c464659eac97e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="hcsr501 1"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/1801981-4f71a6cfafddac73.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="hcsr501 2"></p>
<p>(PS:ä»¥ä¸Šå›¾ç‰‡æ¥è‡ªä¸¤ä¸ªæ·˜å®å–å®¶)</p>
<p>ä¸‰ä¸ªé’ˆè„šï¼šVCCã€OUTã€GNDï¼Œå¦å¤–è¿˜æœ‰ä¸€ä¸ªæ˜¯å¦è¿ç»­ç›‘æµ‹çš„é’ˆè„šï¼Œè¿ç»­æ—¶æ˜¯Hï¼Œä¸è¿ç»­æ—¶æ˜¯Lï¼Œé»˜è®¤æ˜¯Hï¼Œçœ‹ä½ ä¹°çš„å…·ä½“è®¾è®¡äº†ã€‚å¦å¤–è¿˜æœ‰ä¸¤ä¸ªè°ƒèŠ‚æ—‹é’®ï¼Œå¦‚ä¸Šå›¾ã€‚å…¶å®è¿™ä¸ªä¼ æ„Ÿå™¨ç‰¹ç®€å•ï¼Œä¾›ç”µç”µå‹5åˆ°20Vï¼Œè¾“å‡º0æˆ–è€…3V3ä¸¤ä¸ªçŠ¶æ€ï¼Œä¸ç”¨ä¸ Raspiberry Pi è¿æ¥ï¼Œä¹Ÿå¯ä»¥ç›´æ¥å½“ä½œå¼€å…³ä½¿ç”¨ã€‚å¦å¤–æˆ‘è¿˜æ¥äº†ä¸€ä¸ªè‡ªé”å¼€å…³ï¼Œæ§åˆ¶æ•´ä¸ªç”µè·¯çš„å¼€å…³ã€‚å¦‚ä¸‹å›¾ï¼š</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1801981-f0bc7fe3d2041548.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="hcsr501 switcher"></p>
<p>æ¥ç€ä¸Šæºç ï¼š</p>
<pre><code class="python"><span class="keyword">import</span> RPi.GPIO <span class="keyword">as</span> GPIO
<span class="keyword">import</span> time

GPIO.setmode(GPIO.BCM)
GPIO.setwarnings(<span class="keyword">False</span>)

led = <span class="number">25</span>
GPIO.setup(led, GPIO.OUT)
swtich = <span class="number">22</span>
GPIO.setup(swtich, GPIO.IN, GPIO.PUD_UP)
hcsr501 = <span class="number">23</span>
GPIO.setup(hcsr501, GPIO.IN, GPIO.PUD_UP)

<span class="keyword">try</span>:
    GPIO.output(led, <span class="number">0</span>)
    <span class="keyword">while</span>(<span class="keyword">True</span>):
        print(str(GPIO.input(swtich)) + <span class="string">'||'</span> + str(GPIO.input(hcsr501)))
        <span class="keyword">if</span> GPIO.input(swtich) == <span class="keyword">True</span>:
            <span class="keyword">if</span> GPIO.input(hcsr501) == <span class="keyword">True</span>:
                GPIO.output(led, <span class="number">1</span>)
            <span class="keyword">else</span>:
                GPIO.output(led, <span class="number">0</span>)
        <span class="keyword">else</span>:
            GPIO.output(led, <span class="number">0</span>)

        time.sleep(<span class="number">1</span>)
<span class="keyword">except</span> Exception <span class="keyword">as</span> e:
    print(e)
<span class="keyword">finally</span>:
    GPIO.cleanup()
</code></pre>
<p>å½“æˆ‘ä»¬æŠŠå¼€å…³æ‰“å¼€ï¼Œç»è¿‡äººä½“çº¢å¤–ä¼ æ„Ÿå™¨çš„æ—¶å€™LEDï¼ˆè¿™ä¸ªåœ°æ–¹æˆ‘ç”¨çš„æ˜¯3V3çš„é«˜äº®LEDï¼Œæ‰€ä»¥æ²¡æœ‰æ¥ç”µé˜»ï¼‰å°±ä¼šäº®ã€‚æŠŠè¿™ä¸ªä¸œè¥¿æ”¾åœ¨æˆ¿é—´é‡Œï¼Œæ™šä¸Šä¸‹ç­å¼€é—¨å°±å¯ä»¥è‡ªåŠ¨å¼€ç¯äº†ã€‚å¦‚æœä½ æœ‰å…´è¶£ï¼Œè¿˜å¯ä»¥æŠŠé‡Œé¢çš„å¼€å…³æ¢æˆä¸€ä¸ªå…‰çº¿ä¼ æ„Ÿå™¨ï¼Œé‚£æ ·å°±æ›´å®Œç¾äº†ï½ï½</p>
<p>è¿è¡Œä¸Šé¢çš„ä»£ç ï¼Œæˆ‘ä»¬éœ€è¦å®‰è£… <code>RPi.GPIO</code> åº“ï¼ŒRaspbian é»˜è®¤æ˜¯å®‰è£…å¥½äº†ã€‚ç®€å•çš„æµè§ˆä¸Šé¢çš„ä»£ç ï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œé¦–å…ˆè®¾ç½® GPIO modeï¼Œè¿™é‡Œè®¾ç½®ä¸ºBCMï¼›ç„¶åå®šä¹‰GPIOçš„çŠ¶æ€ï¼ŒGPIOå£æˆ‘ä»¬å¯ä»¥å®šä¹‰ä¸¤ç§çŠ¶æ€ï¼ŒGPIO.IN å’Œ GPIO.OUTï¼Œåˆ†åˆ«å¯¹åº”è¾“å…¥å’Œè¾“å‡ºï¼›æœ€åå°±æ˜¯æ“ä½œæˆ‘ä»¬çš„GPIOå£äº†ã€‚ç”±äº<code>RPi.GPIO</code> åº“å·²ç»ç»™æˆ‘ä»¬å°è£…å¤æ‚çš„æ“ä½œï¼Œæ‰€ä»¥æˆ‘ä»¬ç”¨èµ·æ¥ç‰¹åˆ«ç®€ä¾¿ã€‚æ›´å¤šå¯ <code>RPi.GPIO</code> ä¿¡æ¯å¯å‚è€ƒ<a href="https://pypi.python.org/pypi/RPi.GPIO/0.6.2" target="_blank" rel="external">è¿™é‡Œ</a>ã€‚</p>
<h2 id="0x02-Raspberry-Piçš„GPIOé’ˆè„š"><a href="/1970/01/01/[ç©è½¬æ ‘è“æ´¾]0x05GPIO/#0x02-Raspberry-Piçš„GPIOé’ˆè„š" class="headerlink" title="0x02 Raspberry Piçš„GPIOé’ˆè„š"></a>0x02 Raspberry Piçš„GPIOé’ˆè„š</h2><p>æ ¹æ®ä¸Šé¢çš„demoç¨‹åºï¼Œæˆ‘ä»¬å†æ¥è¯¦ç»†çš„ä»‹ç»ä¸‹GPIOã€‚</p>
<ul>
<li><p>GPIO.setmode()</p>
<p>  æŒ‡å®šé’ˆè„šçš„ç¼–å·æ–¹å¼ï¼Œè¿™é‡Œæœ‰ä¸¤ç§é€‰æ‹©ï¼š    </p>
<ol>
<li><p>GPIO.BOARD</p>
<p> ä½¿ç”¨é’ˆè„šçš„ç‰©ç†é¡ºåºæ¥ç¼–å·</p>
</li>
<li><p>GPIO.BCM</p>
<p> Broadcom SoC çš„ç¼–ç æ–¹å¼</p>
<p>å…·ä½“çš„å¯å‚è€ƒä¸‹é¢è¿™å¼ å›¾ï¼Œå…¶ä¸­ <code>Pin</code>  åˆ—ä»£è¡¨çš„æ˜¯ <code>GPIO.BOARD</code> æ–¹å¼çš„ç¼–ç ï¼Œ è€Œ <code>NAME</code> åˆ—ä»£è¡¨çš„æ˜¯<code>GPIO.BCM</code> æ–¹å¼çš„ç¼–ç ã€‚</p>
<p> <img src="http://upload-images.jianshu.io/upload_images/1801981-de0f86b2b6be0658.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="GPIO Pi3">    </p>
<blockquote>
<p>ä¸åŒç‰ˆæœ¬çš„ Raspberry Pi ä¼šæœ‰ä¸åŒçš„é’ˆè„šåˆ†å¸ƒï¼Œé™¤æŸ¥é˜…ç›¸å…³èµ„æ–™å¤–ï¼Œå¯ä»¥æ‰§è¡Œä¸‹é¢å‘½ä»¤æŸ¥çœ‹ï¼š<br>pi@raspberrypi:~ $ gpio readall</p>
</blockquote>
</li>
</ol>
</li>
<li><p>GPIO.setwarnings(True or False)</p>
<p>  å½“æˆ‘ä»¬æœ‰å¤šä¸ªè„šæœ¬åœ¨æ“ä½œåŒä¸€ä¸ªGPIOå£æ—¶å¯èƒ½ä¼šå‡ºç°è­¦å‘Šï¼Œé€šè¿‡è¿™ä¸ªè®¾ç½®æ¥é€‰æ‹©æ˜¯å¦å¿½ç•¥</p>
</li>
<li><p>GPIO.setup(channel, GPIO.OUT, initial=GPIO.HIGH)</p>
<p>  è®¾ç½®GPIOå£çš„çŠ¶æ€ï¼Œå‚æ•°åˆ†åˆ«ä¸ºï¼šé’ˆè„šåºå·ã€è¾“å…¥è¿˜æ˜¯è¾“å‡ºã€åˆå§‹çŠ¶æ€é«˜ç”µå¹³è¿˜æ˜¯ä½ç”µå¹³ã€‚</p>
</li>
<li><p>GPIO.input(channel)</p>
<p>  è·å–æŒ‡å®šGPIOå£çš„çŠ¶æ€</p>
</li>
<li><p>GPIO.output(channel, GPIO.HIGH)</p>
<p>  æ“ä½œGPIOå£çš„è¾“å‡ºçŠ¶æ€</p>
</li>
<li><p>GPIO.cleanup()</p>
<p>  æ¸…é™¤å½“å‰æ“ä½œçš„æ‰€æœ‰GPIOå£çš„çŠ¶æ€ï¼Œæ¢å¤ä¸ºè¾“å…¥çŠ¶æ€ã€‚å¥½çš„åšæ³•æ˜¯æ¯æ¬¡ä½¿ç”¨å®Œéƒ½æ¸…é™¤ä¸€ä¸‹ã€‚</p>
</li>
</ul>
<p>è¿™å°±æ˜¯ä¸€ä¸ªç®€å•å®Œæ•´çš„ä½¿ç”¨ python æ“ä½œ GPIOçš„æµç¨‹ã€‚è™½ç„¶çœ‹åˆ°çš„ç°è±¡ï¼Œçœ‹åˆ°çš„ä»£ç ï¼Œä½†æ˜¯ä½ è¿˜ä¼šé—®ï¼šGPIOåˆ°åº•æ˜¯ä¸ªå•¥æ ·çš„ä¸œè¥¿ï¼Œæˆ‘ä»¬è®¾ç½®ä¸åŒçš„çŠ¶æ€æ—¶å®ƒçš„ç”µå‹æ—¶æ€æ ·çš„ï¼Ÿå®ƒçš„é©±åŠ¨èƒ½åŠ›å¦‚ä½•ï¼Ÿä»€ä¹ˆæ ·çš„æ“ä½œå¯èƒ½å¯¼è‡´çƒ§æ¯GPIOï¼Ÿ</p>
<p>Raspberry Pi 2 Model B ä½¿ç”¨äº† BCM2836èŠ¯ç‰‡ï¼ŒRaspberry Pi Model A, B, B+, Compute Module and Raspberry Pi Zeroä½¿ç”¨äº†BCM2835èŠ¯ç‰‡ï¼Œè¿™é‡Œæˆ‘ä»¬ä»¥BCM2835ä¸ºä¾‹ï¼ˆä½œä¸ºä¸€èˆ¬ä½¿ç”¨è€…ï¼Œå¯ä»¥ä¸å…³å¿ƒè¿™ä¸ªï¼‰ã€‚BCM2835æœ‰3ä¸ªGPIO bankï¼Œè¿™ä¸ª3ä¸ªbankéƒ½æœ‰è‡ªå·±çš„VDDï¼Œå¹¶ä¸”ç”±3V3ç”µå‹æä¾›æ”¯æŒã€‚<code>å¦‚æœæˆ‘ä»¬çš„è¾“å…¥ç”µå‹è¶…è¿‡3V3ï¼Œå°±æœ‰å¯èƒ½çƒ§æ¯SoCä¸Šçš„GPIO bank</code>ã€‚ç”±äºæˆ‘ä¹Ÿæ˜¯ä¸šä½™çš„ï¼Œè¯´çš„å†ä¸“ä¸šæˆ‘ä¹Ÿå¬ä¸æ‡‚ï¼Œå› æ­¤ç®€å•çš„æ¥è¯´ï¼Œä½¿ç”¨å¤–éƒ¨ä¼ æ„Ÿå™¨ï¼Œå®ƒçš„è¾“å…¥ä¿¡å·ç”µå‹æ˜¯3V3çš„å°±æ²¡é—®é¢˜ã€‚å½“ç„¶ï¼Œä¼ æ„Ÿå™¨çš„é©±åŠ¨ç”µå‹å¯ä»¥ä¸æ˜¯3V3ã€‚æ¯”å¦‚ä¸Šé¢ä½¿ç”¨çš„ <code>HC-SR501</code> å®ƒçš„é©±åŠ¨ç”µå‹æ˜¯5Vï¼Œè¾“å…¥ä¿¡å·ç”µå‹æ˜¯3V3ï¼Œè¿™æ ·æ¥åœ¨å¤–é¢çš„ Raspberry Pi å°±å®Œå…¨æ²¡é—®é¢˜ï¼Œè€Œä¸”ä¸éœ€è¦é¢å¤–ç”µæºä¸ºå…¶ä¾›ç”µï¼Œå› ä¸º Raspberry Pi 2 Model B æœ‰ä¸¤ä¸ª5Vçš„é’ˆè„šï¼ˆå°±æ˜¯å³ä¸Šè§’çš„ä¸¤ä¸ªï¼Œ2å’Œ4ï¼‰ã€‚</p>
<p>æ›´å¤šçš„å…³äºGPIOçš„ä¸Šæ‹‰ä¸‹æ‹‰æ‚¬æµ®ç­‰çŠ¶æ€ï¼Œå¯ä»¥å‚è€ƒ<a href="http://dreamcolor.net/archives/rpi-gpio-module-inputs.html" target="_blank" rel="external">è¿™é‡Œ</a>çš„ä»‹ç»ã€‚</p>
<h2 id="0x03-GPIOè¿›é˜¶"><a href="/1970/01/01/[ç©è½¬æ ‘è“æ´¾]0x05GPIO/#0x03-GPIOè¿›é˜¶" class="headerlink" title="0x03 GPIOè¿›é˜¶"></a>0x03 GPIOè¿›é˜¶</h2><p>å¯¹äºæ§åˆ¶ç®€å•çš„è®¾å¤‡ï¼Œæ¯”å¦‚LEDï¼Œä½¿ç”¨ RPi.GPIO å·²ç»å¤Ÿç”¨äº†ã€‚ä½†æ˜¯å½“æˆ‘ä»¬è¿›ä¸€æ­¥ç ”ç©¶ä¹‹åä¼šå‘ç°RPi.GPIOå¹¶ä¸æ˜¯é‚£ä¹ˆå®Œç¾ï¼Œåœ¨å®ƒçš„å®˜æ–¹æ–‡æ¡£ä¸Šæœ‰è¿™ä¹ˆä¸¤æ®µè¯ï¼š</p>
<blockquote>
<p>Note that this module is unsuitable for real-time or timing critical applications. This is because you can not predict when Python will be busy garbage collecting. It also runs under the Linux kernel which is not suitable for real time applications - it is multitasking O/S and another process may be given priority over the CPU, causing jitter in your program. If you are after true real-time performance and predictability, buy yourself an Arduino <a href="http://www.arduino.cc" target="_blank" rel="external">http://www.arduino.cc</a> !<br>Note that the current release does not support SPI, I2C, hardware PWM or serial functionality on the RPi yet. This is planned for the near future - watch this space! One-wire functionality is also planned.</p>
</blockquote>
<p>ä»ä¸Šé¢æˆ‘ä»¬å¯ä»¥äº†è§£åˆ° RPi.GPIO å¹¶ä¸é€‚åˆå®æ—¶æ€§è¦æ±‚é«˜çš„åº”ç”¨ï¼Œä¹Ÿä¸é€‚åˆå‘¨æœŸè®¡æ•°çš„åº”ç”¨ã€‚pythonæœ¬èº«æ€§èƒ½å°±ä¸æ˜¯éå¸¸ç†æƒ³ï¼Œæ¯”å¦‚å½“æˆ‘ä»¬å°è¯•ç”¨pythonå»æ“ä½œDHT11ï¼ˆæ¸©æ¹¿åº¦ä¼ æ„Ÿå™¨ï¼‰å°±éå¸¸çš„å›°éš¾ï¼Œå› ä¸ºå¾ˆéš¾å’Œå®ƒçš„æ—¶åºä¿æŒåŒæ­¥ã€‚è€Œä¸”linuxå¹¶ä¸æ˜¯å®æ—¶æ“ä½œç³»ç»Ÿï¼Œè¿è¡Œåœ¨linuxå†…æ ¸ä¹‹ä¸Šï¼Œæ— æ³•é¿å…è¢«å…¶ä»–è¿›ç¨‹æŠ¢å CPUã€‚ç›®å‰ç‰ˆæœ¬çš„ RPi.GPIO å¹¶ä¸æ”¯æŒSPIã€I2Cã€ç¡¬ä»¶PWMã€ä¸²å£ç­‰ã€‚å¦‚æœä½ å¸Œæœ›ä½¿ç”¨è¿™äº›æ¥å£ï¼Œé‚£å°±éœ€è¦è€ƒè™‘æ¢ä¸€ä¸ªåº“æˆ–è€…æ¢ä¸€ç§è¯­è¨€äº†ã€‚å…·ä½“çš„æ˜¯ç”¨ï¼Œåœ¨ä»¥åçš„æ–‡ç« ä¸­ä¼šåšä»‹ç»ã€‚</p>
<h2 id="0xFF-å‚è€ƒ"><a href="/1970/01/01/[ç©è½¬æ ‘è“æ´¾]0x05GPIO/#0xFF-å‚è€ƒ" class="headerlink" title="0xFF å‚è€ƒ"></a>0xFF å‚è€ƒ</h2><ol>
<li><a href="https://github.com/raspberrypi/documentation" target="_blank" rel="external">https://github.com/raspberrypi/documentation</a></li>
<li><a href="https://zh.scribd.com/doc/101830961/GPIO-Pads-Control2" target="_blank" rel="external">https://zh.scribd.com/doc/101830961/GPIO-Pads-Control2</a></li>
<li><a href="https://pypi.python.org/pypi/RPi.GPIO" target="_blank" rel="external">https://pypi.python.org/pypi/RPi.GPIO</a></li>
<li><a href="http://dreamcolor.net/archives/rpi-gpio-module-pwm.html" target="_blank" rel="external">http://dreamcolor.net/archives/rpi-gpio-module-pwm.html</a></li>
</ol>
<p><img src="https://raw.githubusercontent.com/ttdevs/ttdevs.github.io/common/images/logo.png" alt="Create by ttdevs"></p>
]]></content>
      
        <categories>
            
            <category> æŠ€æœ¯ </category>
            
        </categories>
        
        
        <tags>
            
            <tag> ç©è½¬æ ‘è“æ´¾ </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[ã€Œç©è½¬æ ‘è“æ´¾ã€0x02åŠç‚¸å¤©çš„è¿œç¨‹æ§åˆ¶]]></title>
      <url>/1970/01/01/%5B%E7%8E%A9%E8%BD%AC%E6%A0%91%E8%8E%93%E6%B4%BE%5D0x02%E5%90%8A%E7%82%B8%E5%A4%A9%E7%9A%84%E8%BF%9C%E7%A8%8B%E6%8E%A7%E5%88%B6/</url>
      <content type="html"><![CDATA[<h2 id="0x00-åŠç‚¸å¤©çš„è¿œç¨‹æ§åˆ¶"><a href="/1970/01/01/[ç©è½¬æ ‘è“æ´¾]0x02åŠç‚¸å¤©çš„è¿œç¨‹æ§åˆ¶/#0x00-åŠç‚¸å¤©çš„è¿œç¨‹æ§åˆ¶" class="headerlink" title="0x00 åŠç‚¸å¤©çš„è¿œç¨‹æ§åˆ¶"></a>0x00 åŠç‚¸å¤©çš„è¿œç¨‹æ§åˆ¶</h2><p>Connect to Raspberry Pi</p>
<p>å®‰è£…å¥½äº†ç³»ç»Ÿï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å°±å¯ä»¥å¼€å§‹æ“ä½œ Raspberry Pi äº†ã€‚å¦‚æœä½ ä¸æ˜¯æ‹¿æ¥åšå®¶åº­åª’ä½“ä¸­å¿ƒï¼Œçœ‹è§†é¢‘ä¹‹ç±»ï¼Œæˆ‘ä»¬å®Œå…¨ä¸éœ€è¦ç»™ Raspberry Pi é…ç½®æ˜¾ç¤ºå™¨ï¼Œé€šè¿‡è¿œç¨‹è¿æ¥å·¥å…·å°±å¯ä»¥å®Œæˆæˆ‘ä»¬æ‰€æœ‰çš„æ—¥å¸¸æ“ä½œã€‚ç”±äºè¿æ¥æ˜¾ç¤ºå™¨æ“ä½œæ¯”è¾ƒç›´è§‚ï¼Œè¿™é‡Œä»…ç»™å¤§å®¶ä»‹ç»æ— æ˜¾ç¤ºå™¨çš„è¿œç¨‹æ“ä½œæ–¹æ³•ã€‚</p>
<h2 id="0x01-SSH"><a href="/1970/01/01/[ç©è½¬æ ‘è“æ´¾]0x02åŠç‚¸å¤©çš„è¿œç¨‹æ§åˆ¶/#0x01-SSH" class="headerlink" title="0x01 SSH"></a>0x01 SSH</h2><p>å…ˆçœ‹ä¸€æ®µä»‹ç»ï¼Œæ¥è‡ª<a href="https://zh.wikipedia.org/wiki/Secure_Shell" target="_blank" rel="external">ç»´åŸºç™¾ç§‘</a>ï¼š</p>
<blockquote>
<p>Secure Shellï¼ˆç¼©å†™ä¸ºSSHï¼‰ï¼Œç”±IETFçš„ç½‘ç»œå·¥ä½œå°ç»„ï¼ˆNetwork Working Groupï¼‰æ‰€åˆ¶å®šï¼›SSHä¸ºä¸€é¡¹åˆ›å»ºåœ¨åº”ç”¨å±‚å’Œä¼ è¾“å±‚åŸºç¡€ä¸Šçš„å®‰å…¨åè®®ï¼Œä¸ºè®¡ç®—æœºä¸Šçš„Shellï¼ˆå£³å±‚ï¼‰æä¾›å®‰å…¨çš„ä¼ è¾“å’Œä½¿ç”¨ç¯å¢ƒã€‚<br>ä¼ ç»Ÿçš„ç½‘ç»œæœåŠ¡ç¨‹åºï¼Œå¦‚rshã€FTPã€POPå’ŒTelnetå…¶æœ¬è´¨ä¸Šéƒ½æ˜¯ä¸å®‰å…¨çš„ï¼›å› ä¸ºå®ƒä»¬åœ¨ç½‘ç»œä¸Šç”¨æ˜æ–‡ä¼ é€æ•°æ®ã€ç”¨æˆ·å¸å·å’Œç”¨æˆ·å£ä»¤ï¼Œå¾ˆå®¹æ˜“å—åˆ°ä¸­é—´äººï¼ˆman-in-the-middleï¼‰æ”»å‡»æ–¹å¼çš„æ”»å‡»ã€‚å°±æ˜¯å­˜åœ¨å¦ä¸€ä¸ªäººæˆ–è€…ä¸€å°æœºå™¨å†’å……çœŸæ­£çš„æœåŠ¡å™¨æ¥æ”¶ç”¨æˆ·ä¼ ç»™æœåŠ¡å™¨çš„æ•°æ®ï¼Œç„¶åå†å†’å……ç”¨æˆ·æŠŠæ•°æ®ä¼ ç»™çœŸæ­£çš„æœåŠ¡å™¨ã€‚<br>è€ŒSSHæ˜¯ç›®å‰è¾ƒå¯é ï¼Œä¸“ä¸ºè¿œç¨‹ç™»å½•ä¼šè¯å’Œå…¶ä»–ç½‘ç»œæœåŠ¡æä¾›å®‰å…¨æ€§çš„åè®®ã€‚åˆ©ç”¨SSHåè®®å¯ä»¥æœ‰æ•ˆé˜²æ­¢è¿œç¨‹ç®¡ç†è¿‡ç¨‹ä¸­çš„ä¿¡æ¯æ³„éœ²é—®é¢˜ã€‚é€šè¿‡SSHå¯ä»¥å¯¹æ‰€æœ‰ä¼ è¾“çš„æ•°æ®è¿›è¡ŒåŠ å¯†ï¼Œä¹Ÿèƒ½å¤Ÿé˜²æ­¢DNSæ¬ºéª—å’ŒIPæ¬ºéª—ã€‚<br>SSHä¹‹å¦ä¸€é¡¹ä¼˜ç‚¹ä¸ºå…¶ä¼ è¾“çš„æ•°æ®å¯ä»¥æ˜¯ç»è¿‡å‹ç¼©çš„ï¼Œæ‰€ä»¥å¯ä»¥åŠ å¿«ä¼ è¾“çš„é€Ÿåº¦ã€‚SSHæœ‰å¾ˆå¤šåŠŸèƒ½ï¼Œå®ƒæ—¢å¯ä»¥ä»£æ›¿Telnetï¼Œåˆå¯ä»¥ä¸ºFTPã€POPã€ç”šè‡³ä¸ºPPPæä¾›ä¸€ä¸ªå®‰å…¨çš„â€œé€šé“â€ã€‚</p>
</blockquote>
<p>ä¸Šé¢çš„ä»‹ç»æ˜¯ä¸æ˜¯å¤ªæŠ½è±¡ï½ï½è¿˜æ˜¯æˆ‘æ¥è¯´å§ã€‚æŠ˜è…¾ Raspberry Pi ï¼Œsshä½œä¸ºä¸€ä¸ªé‡è¦çš„è¿œç¨‹è¿æ¥å·¥å…·ï¼ˆæˆ–è€…ç†è§£ä¸ºæŠŠ Raspberry Pi çš„ç»ˆç«¯æ‹¿åˆ°æœ¬åœ°æ¥ï¼‰ï¼Œæ—¥å¸¸æ“ä½œä¸­æ˜¯å¿…ä¸å¯å°‘çš„ï¼åœ¨æ²¡æœ‰æ˜¾ç¤ºå™¨çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨sshå®Œæˆç»å¤§å¤šæ•°ï¼ˆç”šè‡³æ‰€æœ‰çš„ï¼‰æ“ä½œã€‚å› æ­¤ï¼Œè¿™é‡Œæˆ‘å¿…é¡»ç€é‡ä»‹ç»ã€‚æˆ‘ä»¬è£…çš„ Raspbian ç³»ç»Ÿé»˜è®¤æ˜¯æ‰“å¼€sshçš„ï¼ˆå¦åˆ™åœ¨æ²¡æœ‰æ˜¾ç¤ºå™¨çš„æƒ…å†µä¸‹æˆ‘ä»¬æ˜¯æ— æ³•æ“ä½œçš„ï¼Œå½“ç„¶ä½ éå¾—è¯´ç”¨USBè½¬TTLä¹Ÿè¡Œï¼‰ï¼Œå› æ­¤ï¼Œæˆ‘ä»¬ä¸éœ€è¦åšä»»ä½•é…ç½®å°±å¯ä»¥ç›´æ¥ä½¿ç”¨sshã€‚</p>
<h3 id="å®‰è£…SSH"><a href="/1970/01/01/[ç©è½¬æ ‘è“æ´¾]0x02åŠç‚¸å¤©çš„è¿œç¨‹æ§åˆ¶/#å®‰è£…SSH" class="headerlink" title="å®‰è£…SSH"></a>å®‰è£…SSH</h3><p>Windowsç³»ç»Ÿæ¨èä½¿ç”¨å…è´¹ã€å°å·§ã€æ— éœ€å®‰è£…ã€å¹¶ä¸”åŠŸèƒ½å¼ºå¤§çš„sshå·¥å…·ã€‚</p>
<blockquote>
<p><code>PuTTY</code> æ˜¯ä¸€ä¸ªTelnetã€SSHã€rloginã€çº¯TCPä»¥åŠä¸²è¡Œæ¥å£è¿æ¥è½¯ä»¶ã€‚</p>
</blockquote>
<p>å¤§å®¶å¯ä»¥åˆ°ä»–çš„<a href="http://www.putty.org/" target="_blank" rel="external">å®˜ç½‘</a>ä¸‹è½½ï¼Œæˆ–è€…åˆ°è¿™é‡Œ<a href="/1970/01/01/[ç©è½¬æ ‘è“æ´¾]0x02åŠç‚¸å¤©çš„è¿œç¨‹æ§åˆ¶/file/putty.exe">ä¸‹è½½</a>ï¼Œéå¸¸å°ï¼Œ519KBã€‚æ‰“å¼€æ˜¯ç•Œé¢å¦‚ä¸‹ï¼š</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1801981-b8c35c7e12a4d367.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="PuTTY"></p>
<p>ä½¿ç”¨ä¹Ÿæ˜¯éå¸¸çš„ç®€å•ï¼Œåœ¨ <code>Host Name(or IP address)</code> ä¸­å¡«å…¥ä½ çš„åŸŸåæˆ–è€…IPï¼Œåœ¨ <code>Port</code> ä¸­å¡«å…¥ä½ çš„ç«¯å£ï¼Œé»˜è®¤æ˜¯ <code>22</code> ï¼ˆå¦‚æœä½ ä¿®æ”¹äº†é»˜è®¤ç«¯å£ï¼Œåœ¨æ­¤æ”¹æˆæ–°çš„ç«¯å£å³å¯ï¼‰ï¼Œç„¶åç‚¹å‡» <code>Open</code> å°±å¼€å§‹è¿æ¥ï¼Œæ‰“å¼€ä¸€ä¸ª terminal ï¼ŒæŒ‰ç…§æç¤ºæ“ä½œå³å¯ï¼š</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1801981-c0bfadc447cdac8c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="PuTTY login"></p>
<p>Macå’ŒLinuxç³»ç»Ÿä¸­é»˜è®¤å·²ç»å®‰è£…äº† ssh å·¥å…·ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥åœ¨å‘½ä»¤è¡Œä¸­æ“ä½œå³å¯ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">âœ  ~ ssh -V</div><div class="line">OpenSSH_6.9p1, LibreSSL 2.1.8</div><div class="line">âœ  ~ ssh</div><div class="line">usage: ssh [-1246AaCfGgKkMNnqsTtVvXxYy] [-b bind_address] [-c cipher_spec]</div><div class="line">           [-D [bind_address:]port] [-E log_file] [-e escape_char]</div><div class="line">           [-F configfile] [-I pkcs11] [-i identity_file]</div><div class="line">           [-L [bind_address:]port:host:hostport] [-l login_name] [-m mac_spec]</div><div class="line">           [-O ctl_cmd] [-o option] [-p port]</div><div class="line">           [-Q cipher | cipher-auth | mac | kex | key]</div><div class="line">           [-R [bind_address:]port:host:hostport] [-S ctl_path] [-W host:port]</div><div class="line">           [-w local_tun[:remote_tun]] [user@]hostname [command]</div><div class="line">âœ  ~</div></pre></td></tr></table></figure>
<h3 id="ä½¿ç”¨SSH"><a href="/1970/01/01/[ç©è½¬æ ‘è“æ´¾]0x02åŠç‚¸å¤©çš„è¿œç¨‹æ§åˆ¶/#ä½¿ç”¨SSH" class="headerlink" title="ä½¿ç”¨SSH"></a>ä½¿ç”¨SSH</h3><p>sshçš„ä½¿ç”¨æ¯”è¾ƒç®€å•ï¼Œç›´æ¥åœ¨æˆ‘ä»¬æœ¬åœ°çš„ç»ˆç«¯ä¸­è¾“å…¥ <code>ssh pi@&lt;your domain or ip&gt;</code> å‘½ä»¤ï¼ŒæŒ‰ç…§æç¤ºè¾“å…¥å¯†ç å³å¯ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">âœ  ~ ssh pi@ttdevs.com</div><div class="line">pi@ttdevs.com&apos;s password:</div><div class="line"></div><div class="line">The programs included with the Debian GNU/Linux system are free software;</div><div class="line">the exact distribution terms for each program are described in the</div><div class="line">individual files in /usr/share/doc/*/copyright.</div><div class="line"></div><div class="line">Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent</div><div class="line">permitted by applicable law.</div><div class="line">Last login: Thu Mar 31 17:38:44 2016 from 58.11.22.33</div><div class="line">pi@raspberry:~ $</div></pre></td></tr></table></figure>
<p>å®Œæˆsshçš„ç™»å½•ï¼Œä½ å°±å¯ä»¥åœ¨æœ¬åœ°ç›´æ¥æ“ä½œ Raspberry Pi äº†ï¼Œè€Œä¸”ä½“éªŒå’Œç›´æ¥ç™»å½• Raspberry Pi æ“ä½œä¸€æ ·ã€‚</p>
<h3 id="ä¿®æ”¹ç«¯å£å·"><a href="/1970/01/01/[ç©è½¬æ ‘è“æ´¾]0x02åŠç‚¸å¤©çš„è¿œç¨‹æ§åˆ¶/#ä¿®æ”¹ç«¯å£å·" class="headerlink" title="ä¿®æ”¹ç«¯å£å·"></a>ä¿®æ”¹ç«¯å£å·</h3><p>å¦‚æœä½ è·Ÿæˆ‘ä¸€æ ·æ¯”è¾ƒæ‚²å‚¬â€”â€”22ç«¯å£ ä¹Ÿ è¢«ç”µä¿¡å°äº†ï¼ˆæˆ–è€…å¾ˆä¸ç¨³å®šï¼‰ï¼Œé‚£ä½ å°±éœ€è¦ç»™sshæ¢ï¼ˆæˆ–è€…å¢åŠ ï¼‰ä¸€ä¸ªç«¯å£ã€‚å¦‚ä½•åˆ¤æ–­22ç«¯å£æ˜¯å¦è¢«å°äº†ï¼Ÿæœ€ç®€å•å°±æ˜¯å¦‚æœä½ åœ¨å†…ç½‘é€šè¿‡sshå¯ä»¥è®¿é—®Raspberry Piï¼Œå¤–ç½‘å´è®¿é—®ä¸äº†ï¼Œé‚£ä¹ˆ22ç«¯å£å°±æœ‰å¯èƒ½è¢«è¿è¥å•†æˆ–è€…ä½ çš„é˜²ç«å¢™ç»™å°äº†ã€‚æ—¢ç„¶ç«¯å£æœ‰é—®é¢˜ï¼Œé‚£æœ€ç®€å•çš„åŠæ³•æ¢ä¸ªç«¯å£ï¼Œå°±å¯ä»¥è§„é¿è¿™ä¸ªé—®é¢˜ï¼Œä¸‹é¢ä»‹ç»å¦‚ä½•æ“ä½œï¼š</p>
<ul>
<li><p>ç¼–è¾‘sshé…ç½®æ–‡ä»¶ <code>/etc/ssh/sshd_config</code> ä¿®æ”¹ç«¯å£</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">sudo nano /etc/ssh/sshd_config</div><div class="line"></div><div class="line"># Package generated configuration file</div><div class="line"># See the sshd_config(5) manpage for details</div><div class="line"></div><div class="line"># What ports, IPs and protocols we listen for</div><div class="line">Port 22</div><div class="line">Port 2333</div><div class="line">...</div></pre></td></tr></table></figure>
<p>  æ‰¾åˆ°<code>Port 22</code>ï¼Œåœ¨è¿™è¡Œä¸‹é¢å¢åŠ ä¸€è¡Œ <code>Port 2333</code>ã€‚å½“ç„¶ä½ ä¹Ÿå¯ä»¥ç›´æ¥æŠŠ22æ”¹æˆä½ è¦è®¾ç½®çš„ç«¯å£å·ã€‚ä»–ä»¬çš„åŒºåˆ«æ˜¯ï¼š<strong>å¢åŠ ä¸€è¡Œå¯ä»¥å¢åŠ ä¸€ä¸ªsshç«¯å£å·</strong>ã€‚å¦‚ä¸Šé¢çš„å†™æ³•ï¼Œæˆ‘å¯ä»¥ä½¿ç”¨sshé€šè¿‡ 22 æˆ– 2333 ç«¯å£æ¥è®¿é—®Raspberry Piã€‚</p>
</li>
<li><p>ä½¿é…ç½®ç”Ÿæ•ˆ</p>
<ol>
<li>é‡å¯sshï¼š<code>sudo service ssh restart</code></li>
<li>æœ€ç®€å•ä½ ä¹Ÿå¯ä»¥ç›´æ¥é‡å¯è®¾å¤‡ï¼š<code>sudo reboot</code> or <code>sudo init 6</code></li>
</ol>
</li>
<li><p>ä½¿ç”¨æ–°ç«¯å£ç™»å½•</p>
<p>  ä½¿ç”¨æ–°ç«¯å£çš„ç™»å½•æ–¹å¼å¦‚ä¸‹ï¼š<br>  <code>ssh -p &lt;your new port&gt; &lt;username&gt;@&lt;ip-address or domain&gt;</code><br>  å¦‚ï¼š <code>ssh -p 2333 pi@ttdevs.com</code></p>
</li>
</ul>
<h3 id="æ— å¯†ç ç™»å½•"><a href="/1970/01/01/[ç©è½¬æ ‘è“æ´¾]0x02åŠç‚¸å¤©çš„è¿œç¨‹æ§åˆ¶/#æ— å¯†ç ç™»å½•" class="headerlink" title="æ— å¯†ç ç™»å½•"></a>æ— å¯†ç ç™»å½•</h3><p><a href="https://www.raspberrypi.org/documentation/remote-access/ssh/passwordless.md" target="_blank" rel="external">æ— å¯†ç ç™»å½•</a>å°±æ˜¯æŠŠæˆ‘ä»¬ä»æ¯æ¬¡ç™»å½• Raspberry Pi éƒ½éœ€è¦è¾“å…¥å¯†ç çš„ç¹çä¸­è§£è„±å‡ºæ¥ã€‚é…ç½®å®Œæˆåï¼Œæˆ‘ä»¬åªéœ€è¦ <code>ssh &lt;your domain or ip&gt;</code> å³å¯ç™»å½•æˆ‘ä»¬çš„è®¾å¤‡è€Œä¸éœ€è¦è¾“å…¥å¯†ç ã€‚</p>
<p>è¿™ä¸ªé…ç½®å¾ˆç®€å•ï¼Œåªéœ€è¦å°†æˆ‘ä»¬çš„publicç§˜é’¥ä¼ åˆ°Raspberry Piçš„ <code>~/.ssh/authorized_keys</code> æ–‡ä»¶ä¸­å³å¯ã€‚æ‰§è¡Œä¸‹é¢çš„å‘½ä»¤ï¼ˆå‡è®¾ä½ çš„æœ¬åœ°å·²ç»ç”Ÿæˆäº†ç›¸å…³çš„keyï¼‰ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">cat ~/.ssh/id_rsa.pub | ssh &lt;username&gt;@&lt;ip-address or domain&gt; &apos;cat &gt;&gt; .ssh/authorized_keys&apos;</div></pre></td></tr></table></figure>
<p>å…¶ä¸­<code>id_rsa.pub</code>ä¸ºä½ çš„å…¬é’¥ã€‚å¦‚æœæ²¡æœ‰é—®é¢˜ï¼Œå½“ä½ å†æ¬¡å°è¯•ä½¿ç”¨sshç™»å½•çš„è¯å°±ä¸éœ€è¦å¯†ç äº†ã€‚å¦‚æœæœ‰é—®é¢˜ï¼Œè¯·å‚è€ƒ<a href="https://www.raspberrypi.org/documentation/remote-access/ssh/passwordless.md" target="_blank" rel="external">è¿™é‡Œ</a>ã€‚</p>
<h2 id="0x02-VNC"><a href="/1970/01/01/[ç©è½¬æ ‘è“æ´¾]0x02åŠç‚¸å¤©çš„è¿œç¨‹æ§åˆ¶/#0x02-VNC" class="headerlink" title="0x02 VNC"></a>0x02 VNC</h2><p>è™½ç„¶sshå¯ä»¥å®Œæˆæˆ‘ä»¬çš„ç»å¤§å¤šè¯´æ“ä½œã€‚ä½†æ˜¯å¦‚æœä¹ æƒ¯äº†å›¾å½¢ç•Œé¢çš„ä½ ï¼Œä¸€æ—¶åŠä¼šå¾ˆéš¾ä¸Šæ‰‹è¿™ç§å‘½ä»¤è¡Œæ–¹å¼ï¼Œä¼šæƒ³æœ‰ä¸ªæ¡Œé¢æ“ä½œç¯å¢ƒï¼Œé‚£æ¥ä¸‹æ¥æˆ‘ä»¬ä»‹ç»ä¸‹VNCï¼Œå› ä¸ºä»–å¯ä»¥æ»¡è¶³ä½ å¯¹GUIçš„è¦æ±‚ã€‚VNCçš„é…ç½®ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨å¦‚ä¸‹<a href="https://www.raspberrypi.org/documentation/remote-access/vnc/README.md" target="_blank" rel="external"> Raspberry Pi å®˜æ–¹æ–‡æ¡£</a>ä¸­æ‰¾åˆ°ã€‚å½“ç„¶ï¼Œä½ ä¹Ÿå¯ä»¥åˆ°<a href="https://www.realvnc.com" target="_blank" rel="external">VNCçš„å®˜æ–¹ç½‘ç«™</a>æŸ¥çœ‹ã€‚</p>
<h3 id="å®‰è£…VNC"><a href="/1970/01/01/[ç©è½¬æ ‘è“æ´¾]0x02åŠç‚¸å¤©çš„è¿œç¨‹æ§åˆ¶/#å®‰è£…VNC" class="headerlink" title="å®‰è£…VNC"></a>å®‰è£…VNC</h3><ul>
<li><p>å®‰è£…VNC</p>
<p>  æˆ‘ä»¬å¯ä»¥ä½¿ç”¨è¿™ä¸ªå‘½ä»¤æ¥å®‰è£…VNCæœåŠ¡ï¼š <code>sudo apt-get install tightvncserver</code></p>
</li>
<li><p>è®¾ç½®å¯†ç </p>
<p>  åœ¨å¯åŠ¨æœåŠ¡ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦è®¾ç½®ä¸€ä¸ªè®¿é—®å¯†ç ï¼Œå‘½ä»¤ä¸º<code>tightvncserver</code>ï¼Œæ“ä½œå¦‚ä¸‹ï¼š</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line">pi@raspberrypi:~/.vnc $ tightvncserver</div><div class="line">perl: warning: Setting locale failed.</div><div class="line">perl: warning: Please check that your locale settings:</div><div class="line">	LANGUAGE = (unset),</div><div class="line">	LC_ALL = (unset),</div><div class="line">	LC_CTYPE = &quot;zh_CN.UTF-8&quot;,</div><div class="line">	LANG = &quot;en_GB.UTF-8&quot;</div><div class="line">    are supported and installed on your system.</div><div class="line">perl: warning: Falling back to a fallback locale (&quot;en_GB.UTF-8&quot;).</div><div class="line"></div><div class="line">You will require a password to access your desktops.</div><div class="line"></div><div class="line">Password:</div><div class="line">Verify:</div><div class="line">Would you like to enter a view-only password (y/n)? y</div><div class="line">Password:</div><div class="line">Warning: password truncated to the length of 8.</div><div class="line">Verify:</div><div class="line"></div><div class="line">New &apos;X&apos; desktop is raspberrypi:5</div><div class="line"></div><div class="line">Starting applications specified in /home/pi/.vnc/xstartup</div><div class="line">Log file is /home/pi/.vnc/raspberrypi:5.log</div><div class="line"></div><div class="line">pi@raspberrypi:~/.vnc $</div></pre></td></tr></table></figure>
<p>   <code>PSï¼šå¯†ç æ— å›æ˜¾</code></p>
</li>
<li><p>è¿è¡Œä¸€ä¸ªvnc display</p>
<p>  <code>vncserver :1 -geometry 1920x1080 -depth 24</code></p>
<p>  è¿™æ ·ä½ å°±å¯ä»¥é€šè¿‡VNCå®¢æˆ·ç«¯ï¼ˆå¦‚ï¼š<a href="http://www.realvnc.com/download/viewer/" target="_blank" rel="external">VNC Viewer</a>ï¼‰è¿æ¥åˆ°æˆ‘ä»¬çš„æ ‘è“æ´¾äº†ï¼Œå®¢æˆ·ç«¯çš„é…ç½®ï¼Œä½ å¯ä»¥å‚è€ƒ<a href="http://www.realvnc.com/products/vnc/documentation/5.3/" target="_blank" rel="external">è¿™é‡Œ</a>ã€‚ä¸‹é¢æ˜¯æˆ‘çš„æ•ˆæœå›¾ï¼š</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1801981-ec796d19a6d150b5.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="VNC Viewer"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/1801981-526bdab4c819637a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="VNC Viewer logined"></p>
<blockquote>
<ol>
<li>VNC Viewerä¸­æˆ‘ä»¬éœ€è¦æŒ‡å®šè¿æ¥å“ªä¸ªdisplayï¼Œç”±äºæˆ‘ä»¬ä¸Šé¢ç”¨çš„æ˜¯ display 1ï¼Œå› æ­¤åœ°å€å†™ï¼š<code>ttdevs.com:1</code></li>
<li>å¦å¤–ï¼Œä¸Šé¢çš„å‘½ä»¤æ˜¯åœ¨display 1ä½ç½®å¯åŠ¨ï¼Œå¦‚æœä½ è€ƒè™‘èŠ‚çœèµ„æºå¯ä»¥å…³é—­display 0ï¼Œæ‰§è¡Œå‘½ä»¤ï¼š<code>service lightdm stop</code></li>
</ol>
</blockquote>
</li>
</ul>
<h3 id="é…ç½®VNCè‡ªå¯åŠ¨"><a href="/1970/01/01/[ç©è½¬æ ‘è“æ´¾]0x02åŠç‚¸å¤©çš„è¿œç¨‹æ§åˆ¶/#é…ç½®VNCè‡ªå¯åŠ¨" class="headerlink" title="é…ç½®VNCè‡ªå¯åŠ¨"></a>é…ç½®VNCè‡ªå¯åŠ¨</h3><p>é€šè¿‡ä¸Šé¢çš„é…ç½®æˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨VNCäº†ï¼Œä½†æ˜¯å¦‚æœæˆ‘ä»¬é‡æ–°å¯åŠ¨è®¾å¤‡ï¼Œä¹‹å‰çš„é…ç½®å¤±æ•ˆï¼ŒVNCå°±è¿ä¸ä¸Šäº†ã€‚å› æ­¤æœ€å¥½èƒ½<a href="http://manpages.ubuntu.com/manpages/precise/man8/update-rc.d.8.html" target="_blank" rel="external">æŠŠå¯åŠ¨VNCçš„æ“ä½œæ·»åŠ åˆ°ç³»ç»Ÿçš„è‡ªå¯åŠ¨é¡¹ä¸­</a>ã€‚å…·ä½“æ“ä½œå¦‚ä¸‹ï¼š</p>
<ul>
<li>åˆ‡æ¢åˆ°rootè´¦æˆ·ï¼š<code>sudo su</code></li>
<li>è¿›åˆ°/etc/init.d/ç›®å½•ï¼š<code>cd /etc/init.d/</code></li>
<li>åˆ›å»ºvncbootæ–‡ä»¶ï¼š<code>touch vncboot</code></li>
<li><p>ç¼–è¾‘vncbootæ–‡ä»¶ï¼Œè¾“å…¥ä¸‹é¢å†…å®¹ï¼š<code>sudo nano vncboot</code></p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div></pre></td><td class="code"><pre><div class="line">#! /bin/sh</div><div class="line"># /etc/init.d/vncboot</div><div class="line"></div><div class="line">### BEGIN INIT INFO</div><div class="line"># Provides: vncboot</div><div class="line"># Required-Start: $remote_fs $syslog</div><div class="line"># Required-Stop: $remote_fs $syslog</div><div class="line"># Default-Start: 2 3 4 5</div><div class="line"># Default-Stop: 0 1 6</div><div class="line"># Short-Description: Start VNC Server at boot time</div><div class="line"># Description: Start VNC Server at boot time.</div><div class="line">### END INIT INFO</div><div class="line"></div><div class="line">USER=pi</div><div class="line">HOME=/home/pi</div><div class="line"></div><div class="line">export USER HOME</div><div class="line"></div><div class="line">case &quot;$1&quot; in</div><div class="line"> start)</div><div class="line">  echo &quot;Starting VNC Server&quot;</div><div class="line">  #Insert your favoured settings for a VNC session</div><div class="line">  su - $USER -c &quot;/usr/bin/vncserver :1 -geometry 1280x800 -depth 16 -pixelformat rgb565&quot;</div><div class="line">  ;;</div><div class="line"></div><div class="line"> stop)</div><div class="line">  echo &quot;Stopping VNC Server&quot;</div><div class="line">  /usr/bin/vncserver -kill :1</div><div class="line">  ;;</div><div class="line"></div><div class="line"> *)</div><div class="line">  echo &quot;Usage: /etc/init.d/vncboot &#123;start|stop&#125;&quot;</div><div class="line">  exit 1</div><div class="line">  ;;</div><div class="line">esac</div><div class="line"></div><div class="line">exit 0</div></pre></td></tr></table></figure>
</li>
</ul>
<ul>
<li>ä¿®æ”¹vncbootçš„æƒé™ï¼š<code>chmod 755 vncboot</code></li>
<li>è®¾ç½®VNCä¸ºé»˜è®¤å¯åŠ¨ï¼š<code>update-rc.d vncboot defaults</code></li>
<li><p>æœ€åï¼Œå®Œæ•´è„šæœ¬å¦‚ä¸‹</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line">pi@raspberrypi:~ $ sudo su</div><div class="line">root@raspberrypi:/home/pi# cd /etc/init.d/</div><div class="line">root@raspberrypi:/etc/init.d# touch vncboot</div><div class="line">root@raspberrypi:/etc/init.d# sudo nano vncboot</div><div class="line">root@raspberrypi:/etc/init.d# chmod 755 vncboot</div><div class="line">root@raspberrypi:/etc/init.d# update-rc.d vncboot defaults</div><div class="line">perl: warning: Setting locale failed.</div><div class="line">perl: warning: Please check that your locale settings:</div><div class="line">	LANGUAGE = (unset),</div><div class="line">	LC_ALL = (unset),</div><div class="line">	LC_CTYPE = &quot;zh_CN.UTF-8&quot;,</div><div class="line">	LANG = &quot;en_GB.UTF-8&quot;</div><div class="line">    are supported and installed on your system.</div><div class="line">perl: warning: Falling back to a fallback locale (&quot;en_GB.UTF-8&quot;).</div><div class="line">root@raspberrypi:/etc/init.d# ls -al</div><div class="line">total 308</div><div class="line">drwxr-xr-x   2 root root  4096 Mar 22 05:41 .</div><div class="line">drwxr-xr-x 109 root root  4096 Mar 21 15:01 ..</div><div class="line">-rw-r--r--   1 root root  1745 Mar 22 05:43 .depend.boot</div><div class="line">-rw-r--r--   1 root root   930 Mar 22 05:43 .depend.start</div><div class="line">-rw-r--r--   1 root root  1009 Mar 22 05:43 .depend.stop</div><div class="line">-rw-r--r--   1 root root  2427 Apr  6  2015 README</div><div class="line">...</div><div class="line">-rwxr-xr-x   1 root root   699 Mar 22 05:42 vncboot</div><div class="line">-rwxr-xr-x   1 root root  2666 Sep 25  2013 x11-common</div><div class="line"></div><div class="line">root@raspberrypi:/etc/init.d# reboot</div></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="å¯†ç ç®¡ç†"><a href="/1970/01/01/[ç©è½¬æ ‘è“æ´¾]0x02åŠç‚¸å¤©çš„è¿œç¨‹æ§åˆ¶/#å¯†ç ç®¡ç†" class="headerlink" title="å¯†ç ç®¡ç†"></a>å¯†ç ç®¡ç†</h3><p>VNCçš„å¯†ç ç®¡ç†æ¯”è¾ƒç®€å•ï¼Œè¯¦ç»†æè¿°å¯ä»¥å‚è€ƒ<a href="https://www.realvnc.com/products/open/4.1/man/vncpasswd.html" target="_blank" rel="external">è¿™é‡Œ</a>ï¼Œä¸‹é¢åšç®€å•æè¿°ï¼š</p>
<ol>
<li><p>ä¿®æ”¹å¯†ç  <code>vncpasswd</code></p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">pi@raspberrypi:~ $ vncpasswd</div><div class="line">Using password file /home/pi/.vnc/passwd</div><div class="line">Password:</div><div class="line">Verify:</div><div class="line">Would you like to enter a view-only password (y/n)? y</div><div class="line">Password:</div><div class="line">Warning: password truncated to the length of 8.</div><div class="line">Verify:</div><div class="line">pi@raspberrypi:~ $</div></pre></td></tr></table></figure>
<p> <code>PSï¼šè®¾ç½®æ–°çš„å¯†ç ï¼Œå¥½åƒå¹¶ä¸ä¼šéªŒè¯ä½ çš„æ—§å¯†ç </code></p>
</li>
<li><p>å¿˜è®°å¯†ç  </p>
<p> VNCçš„å¯†ç æ–‡ä»¶å­˜å‚¨åœ¨ï¼š<code>$HOME/.vnc/passwd</code>ä¸­ï¼Œå¦‚æœä½ å¿˜è®°äº†VNCçš„å¯†ç ï¼Œå¯ä»¥ç›´æ¥åˆ é™¤è¿™ä¸ªæ–‡ä»¶ï¼Œè¿è¡Œ <code>tightvncserver</code> å³å¯ä½¿ç”¨æ–°çš„å¯†ç ã€‚</p>
</li>
</ol>
<h3 id="å…¶ä»–è¯´æ˜"><a href="/1970/01/01/[ç©è½¬æ ‘è“æ´¾]0x02åŠç‚¸å¤©çš„è¿œç¨‹æ§åˆ¶/#å…¶ä»–è¯´æ˜" class="headerlink" title="å…¶ä»–è¯´æ˜"></a>å…¶ä»–è¯´æ˜</h3><ul>
<li>VNCé»˜è®¤ç«¯å£å·ï¼š<code>5901</code></li>
<li>VNCé…ç½®æ–‡ä»¶ï¼š<code>~/.vnc</code></li>
<li>VNCå¯†ç æ–‡ä»¶ï¼š<code>/.vnc/passwd</code></li>
</ul>
<h2 id="0x03-SCP"><a href="/1970/01/01/[ç©è½¬æ ‘è“æ´¾]0x02åŠç‚¸å¤©çš„è¿œç¨‹æ§åˆ¶/#0x03-SCP" class="headerlink" title="0x03 SCP"></a>0x03 SCP</h2><p>è®²è¿‡ä¸Šé¢çš„é…ç½®ä¹‹åæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡è¿™ä¸¤ç§æ–¹å¼æ¥è¿œç¨‹æ“ä½œæˆ‘ä»¬çš„æ ‘è“æ´¾äº†ã€‚ä½†æ˜¯ï¼Œæœ‰æ—¶å€™æˆ‘ä»¬éœ€è¦åœ¨æœ¬åœ°å’Œ Raspberry Pi ä¹‹é—´è¿›è¡Œæ–‡ä»¶æ‹·è´ï¼Œè¿™é‡Œæˆ‘ä»¬å¯ä»¥æœ‰å¾ˆå¤šç§é€‰æ‹©ï¼Œæ¯”å¦‚å¸¸è§çš„FTPï¼ŒSFTPç­‰ã€‚ä½†æ˜¯ç”±äºFTPçš„é…ç½®æ¯”è¾ƒéº»çƒ¦ï¼Œè€Œä¸”å¿…é¡»ä»¥æœåŠ¡çš„æ–¹å¼åœ¨ç³»ç»Ÿå¸¸é©»ï¼Œå› æ­¤ç»™å¤§å®¶æ¨è SCPã€‚SCP æ˜¯secure copyçš„ç®€å†™ï¼Œç”¨äºåœ¨Linuxä¸‹è¿›è¡Œè¿œç¨‹æ‹·è´æ–‡ä»¶ã€‚æˆ‘ä»¬æ¯”è¾ƒå¸¸è§çš„  <code>cp</code> å‘½ä»¤å’Œ <code>scp</code> ç±»ä¼¼ï¼Œä¸è¿‡<code>cp</code> åªæ˜¯åœ¨æœ¬æœºè¿›è¡Œæ‹·è´ï¼Œä¸èƒ½è·¨æœåŠ¡å™¨ã€‚è€ƒè™‘ç½‘ç»œä¼ è¾“çš„å®‰å…¨æ€§ï¼Œ <code>scp</code> ä¼ è¾“æ˜¯åŠ å¯†çš„ã€‚é»˜è®¤æƒ…å†µï¼Œæˆ‘ä»¬çš„Raspberry Pi å·²ç»å®‰è£…äº†SCPï¼Œ å¯ä»¥é€šè¿‡ç›´æ¥åœ¨ç»ˆç«¯è¾“å…¥ <code>scp</code> æ¥æŸ¥çœ‹ï¼Œå¦‚ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">$ scp</div><div class="line">usage: scp [-12346BCpqrv] [-c cipher] [-F ssh_config] [-i identity_file]</div><div class="line">           [-l limit] [-o ssh_option] [-P port] [-S program]</div><div class="line">           [[user@]host1:]file1 ... [[user@]host2:]file2</div></pre></td></tr></table></figure>
<p>ç”±äºæˆ‘ç”¨çš„æ˜¯Macç³»ç»Ÿï¼Œé»˜è®¤æƒ…å†µä¹Ÿå·²ç»å®‰è£…äº†SCPå‘½ä»¤ã€‚å¦‚æœä½ ä½¿ç”¨çš„æ˜¯Windowsç³»ç»Ÿï¼Œæˆ‘ä»¬å¯ä»¥åˆ°è¿™é‡Œ<a href="http://winscp.net/" target="_blank" rel="external">ä¸‹è½½WinSCP</a>ã€‚</p>
<ul>
<li><p>æœ¬åœ°æ–‡ä»¶æ‹·è´åˆ° Raspberry Pi</p>
<ol>
<li><p>æ‹·è´æœ¬åœ°æ–‡ä»¶file.txtåˆ°Raspberry Piçš„ç”¨æˆ·ç›®å½•ä¸‹</p>
<p> <code>scp file.txt pi@ttdevs.com:</code></p>
</li>
<li><p>æ‹·è´æœ¬åœ°æ–‡ä»¶file.txtåˆ°Raspberry Piçš„ç”¨æˆ·ç›®å½•ä¸‹çš„raspiæ–‡ä»¶ä¸‹ï¼Œè·¯å¾„ä¸º<code>/home/pi/raspi/</code></p>
<p> <code>scp file.txt pi@ttdevs.com:raspi</code></p>
</li>
</ol>
</li>
<li><p>Raspberry Piæ–‡ä»¶æ‹·è´åˆ°æœ¬åœ°</p>
<p>  <code>scp pi@ttdevs.com:file.txt .</code></p>
<p>  æ‹·è´è¿œç¨‹Raspberry Piç”¨æˆ·ç›®å½•ä¸‹çš„file.txtåˆ°æœ¬åœ°çš„å½“å‰ç›®å½•</p>
</li>
<li><p>å¤šæ–‡ä»¶æ‹·è´</p>
<p>  scpæ”¯æŒå¤šæ–‡ä»¶æ‹·è´ï¼Œæˆ‘ä»¬å¯ä»¥ä¸€æ¬¡æŒ‡å®šå¤šä¸ªæ–‡ä»¶æˆ–è€…ä½¿ç”¨é€šé…ç¬¦æ¥è¿›è¡Œæ“ä½œ</p>
<ol>
<li><p>æŒ‡å®šå¤šä¸ªæ–‡ä»¶</p>
<p> <code>scp file.txt file2.txt pi@ttdevs.com:</code></p>
</li>
<li><p>ä½¿ç”¨é€šé…ç¬¦</p>
<p> <code>scp *.txt pi@ttdevs.com:</code></p>
</li>
</ol>
</li>
</ul>
<h2 id="0x04-HTTP"><a href="/1970/01/01/[ç©è½¬æ ‘è“æ´¾]0x02åŠç‚¸å¤©çš„è¿œç¨‹æ§åˆ¶/#0x04-HTTP" class="headerlink" title="0x04 HTTP"></a>0x04 HTTP</h2><p>ä¸ºä»€ä¹ˆä¼šæåˆ°è¿™ä¸ªå‘¢ï¼ŸåŸå› å¾ˆç®€å•ï¼Œåœ¨æ¥ä¸‹æ¥çš„å­¦ä¹ ä¸­å¤§éƒ¨åˆ†çš„ç¼–ç æ“ä½œéƒ½ä¼šä½¿ç”¨pythonæ¥å®Œæˆã€‚æ‰€ä»¥æˆ‘ä»¬ä¼šå®‰è£…pythonè¯­è¨€ï¼Œè€Œä¸”ï¼Œé»˜è®¤æƒ…å†µæˆ‘ä»¬çš„Raspberry Piå·²ç»å®‰è£…äº†python 2.7ç‰ˆæœ¬ã€‚python2 ä¸­é»˜è®¤åŒ…å«äº†SimpleHTTPServerè¿™ä¸ªåº“ã€‚å› æ­¤æˆ‘ä»¬å¯ä»¥ç›´æ¥æ‹¿æ¥ä½¿ç”¨ã€‚è¯´äº†è¿™ä¹ˆå¤šä½ è¿˜ä¸çŸ¥é“è¿™ä¸ªä¸œä¸œæ˜¯å¹²å˜›çš„ã€‚å…¶å®ä»åå­—ä¸­æˆ‘ä»¬å°±å¯ä»¥çœ‹å‡ºæ¥ï¼Œä»–æ˜¯ä¸€ä¸ªhttp serverã€‚æ—¢ç„¶æ˜¯http serverï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥ç”¨æ¥ä½œä¸ºä¸‹è½½æ–‡ä»¶æœåŠ¡æ¥ä½¿ç”¨ï¼Œé—´æ¥å®Œæˆæ–‡ä»¶çš„æ‹·è´ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡å¦‚ä¸‹çš„å‘½ä»¤æ¥å¯åŠ¨ä¸€ä¸ªhttpæœåŠ¡ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">~ $ python -m SimpleHTTPServer 8088</div><div class="line">Serving HTTP on 0.0.0.0 port 8088 ...</div><div class="line">...</div></pre></td></tr></table></figure>
<p>å¦‚æœä½ æƒ³ä½¿ç”¨80ç«¯å£ï¼ˆè¯·ç¡®ä¿æ²¡æœ‰è¢«è¿è¥å•†å°æ‰ï¼‰ï¼Œè¯·å°†8088æ”¹æˆ80ï¼Œ<code>sudo python -m SimpleHTTPServer 80</code>ã€‚å¯åŠ¨å¥½ä¹‹åæˆ‘ä»¬å°±å¯ä»¥åœ¨æµè§ˆå™¨ä¸­é€šè¿‡æ‰“å¼€ <code>http://&lt;your ip or domain&gt;:8088</code>  è¿™æ ·çš„æ–¹å¼æ¥è®¿é—®å¯åŠ¨æœåŠ¡æ—¶é‚£ä¸ªä½ç½®ä¸‹çš„æ‰€æœ‰æ–‡ä»¶ã€‚å¦‚æœä½ æƒ³ä»Raspberry Piä¸­æ‹·è´æ–‡ä»¶åˆ°æœ¬åœ°ï¼Œé‚£å°±åœ¨ Raspberry Pi ä¸­å¯åŠ¨æœåŠ¡ï¼Œå¦‚æœä½ æƒ³æŠŠæœ¬åœ°æ–‡ä»¶æ‹·è´åˆ°Raspberry Piä¸­ï¼Œåœ¨æˆ‘ä»¬æœ¬åœ°å¯åŠ¨æœåŠ¡å³å¯ã€‚</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1801981-a6bed76cc26db1a6.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Raspberry Pi Python Http"></p>
<p>è‡³æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥çœŸæ­£å¼€å§‹Raspberry Pi æ“ä½œäº†ï½ï½</p>
<hr>
<p><img src="https://raw.githubusercontent.com/ttdevs/ttdevs.github.io/common/images/logo.png" alt="Create by ttdevs"></p>
]]></content>
      
        <categories>
            
            <category> æŠ€æœ¯ </category>
            
        </categories>
        
        
        <tags>
            
            <tag> ç©è½¬æ ‘è“æ´¾ </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[ã€ŒJavaã€Javaä¸­TCPå’ŒUDPæ€»ç»“]]></title>
      <url>/1970/01/01/%5BJava%5DJava%E4%B8%ADTCP%E5%92%8CUDP%E6%80%BB%E7%BB%93/</url>
      <content type="html"><![CDATA[<h2 id="0x00-è¿˜æ˜¯å…ˆè¯´ç‚¹å•¥"><a href="/1970/01/01/[Java]Javaä¸­TCPå’ŒUDPæ€»ç»“/#0x00-è¿˜æ˜¯å…ˆè¯´ç‚¹å•¥" class="headerlink" title="0x00 è¿˜æ˜¯å…ˆè¯´ç‚¹å•¥"></a>0x00 è¿˜æ˜¯å…ˆè¯´ç‚¹å•¥</h2><p>ä¹‹å‰å†™è¿‡ä¸€äº›å…³äºTCPå’ŒUDPæ•°æ®ä¼ è¾“çš„ä»£ç ï¼Œæ¯”å¦‚ä½¿ç”¨TCPä¼ è¾“éŸ³è§†é¢‘æ•°æ®åŒ…ï¼ŒP2Pæ‰“æ´ä¸­ä½¿ç”¨UDPç­‰ã€‚å†™å¥½ä¹‹åå°±ç›´æ¥ä¸¢ä¸‹äº†ï¼Œæ²¡æœ‰æ€»ç»“ä¸‹éƒ½ã€‚æœ€è¿‘å‡†å¤‡æ‰¾å·¥ä½œï¼Œå†æ‹¿æ¥æ¸©ä¹ ä¸‹ã€‚</p>
<p>æš‚æ—¶æŠŠè‡ªå·±çš„å®šä½å¾ˆæ˜ç¡®ï¼Œå°±æ˜¯androidåº”ç”¨å±‚çš„å¼€å‘ï¼Œæ‰€ä»¥å…³äºTCP/UDPçš„å®ç°ç»†èŠ‚ï¼Œæš‚æ—¶ä¹Ÿä¸æƒ³å»æ·±ç©¶ã€‚ä½†æ˜¯å¿ƒé‡Œæ¸…æ¥šè¿™ä¸ªå¿…é¡»å»çœ‹çš„ï¼Œæœ‰æ—¶é—´æ¨èå¤§å®¶çœ‹çœ‹ã€ŠTCP/IPè¯¦è§£ã€‹æˆ–è€…ç½‘ä¸Šæœ‰å¾ˆå¤šå¤§ç‰›çš„æ€»ç»“ã€‚  </p>
<h2 id="0x01-TCP"><a href="/1970/01/01/[Java]Javaä¸­TCPå’ŒUDPæ€»ç»“/#0x01-TCP" class="headerlink" title="0x01 TCP"></a>0x01 TCP</h2><p>ä¸çŸ¥é“ä¸ºä»€ä¹ˆï¼Œè¿™ä¸ªæ€»ç»“ä¸æƒ³å†™çš„å¤ªç»†ï¼Œä¸è´´ä»£ç å†™çš„ç»†åˆä¸çŸ¥é“èƒ½æ€»ç»“å•¥ï¼Œå¥½çº ç»“ï¼Œå¯èƒ½å°±æ˜¯è®¤è¯†æœ‰é™å§ï¼Œå…¬å¸è¦æ˜¯æœ‰ä¸ªæ¶æ„å°±å¥½äº†ã€‚ä¸è¯´äº†ï¼Œè¿˜æ˜¯å®‰å®‰ç¨³ç¨³çš„å†™æ€»ç»“å§ã€‚TCPè¿™ä¸ªå¯èƒ½æ˜¯æˆ‘ä»¬ç”¨çš„æ¯”è¾ƒå¤šçš„æˆ–è€…è¯´æˆ‘ç”¨çš„æ¯”è¾ƒå¤šçš„ï¼Œä¸»è¦çš„å·¥ä½œè¿˜æ˜¯è¿›è¡Œå¤§é‡æ•°æ®çš„ä¼ è¾“å’Œå¿ƒè·³ä¿æŒï¼ˆæƒ³æƒ³å»å¹´é¢è¯•çš„æ—¶å€™éƒ½ä¸çŸ¥é“å•¥æ˜¯å¿ƒè·³ï¼Œæ±—â€¦â€¦ï¼‰ã€‚å¯¹äºå¿ƒè·³ä¿æŒï¼Œå°±æ˜¯ä¸€ä¸ªç®€å•çš„å°å¿ƒè·³åŒ…ï¼›å¤§é‡æ•°æ®çš„ä¼ è¾“ï¼Œè¿™ä¸ªä¹Ÿæ€»ç»“ä¸äº†å•¥ä¸œè¥¿ï¼Œä»£ç å°±é‚£æ ·ï¼Œå°±æ˜¯ä¸€äº›ç»†èŠ‚è¯´ä¸€ä¸‹ã€‚</p>
<h3 id="å®¢æˆ·ç«¯"><a href="/1970/01/01/[Java]Javaä¸­TCPå’ŒUDPæ€»ç»“/#å®¢æˆ·ç«¯" class="headerlink" title="å®¢æˆ·ç«¯"></a>å®¢æˆ·ç«¯</h3><p>è¿™ä¸ªæ˜¯æˆ‘ä»¬å…³æ³¨çš„æœ€å¤šçš„ï¼Œä¹Ÿæ˜¯ä½œä¸ºä¸€ä¸ªæ‰‹æœºAPPä¸»è¦å…³æ³¨çš„ï¼Œå› ä¸ºæˆ‘ä»¬å°±æ˜¯clientã€‚</p>
<h4 id="åˆ›å»ºclient"><a href="/1970/01/01/[Java]Javaä¸­TCPå’ŒUDPæ€»ç»“/#åˆ›å»ºclient" class="headerlink" title="åˆ›å»ºclient"></a>åˆ›å»ºclient</h4><p><code>new Socket(ip, port);</code></p>
<p>æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸Šé¢çš„æ–¹å¼åˆ›å»ºä¸€ä¸ªsocketï¼Œå¦‚æœå¤±è´¥ï¼Œä¼šæŠ›å‡ºIOExceptionã€‚å‚æ•°ä¸­çš„IPå’ŒPortæ˜¯ç›®æ ‡æœåŠ¡å™¨çš„IPå’Œç«¯å£å·ã€‚è‹¥ä½ æƒ³å¾—åˆ°æœ¬åœ°çš„IPå’ŒPORTä¹Ÿå¯é€šè¿‡è¿™ä¸ªsocketæ‹¿åˆ°ã€‚å½“ç„¶ï¼Œåˆ›å»ºsocketè¿˜æœ‰å¤šç§æ–¹æ³•ï¼Œæ¯”å¦‚ <code>new Socket(proxy)</code>ï¼Œå¦‚æœæœ‰éœ€è¦ä½ å¯ä»¥æŸ¥é˜…ç›¸å…³èµ„æ–™ã€‚</p>
<p>æ‹¿åˆ°socketå¯¹è±¡ä¹‹åæˆ‘ä»¬æ¥ç€è¦åšçš„äº‹æƒ…å°±æ˜¯ä»è¿™ä¸ªsocketä¸­æ‹¿åˆ°è¾“å…¥å’Œè¾“å‡ºæµï¼Œè¿™æ ·æˆ‘ä»¬æ‰å¯ä»¥è¿›è¡Œæ•°æ®çš„æ”¶å‘ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">InputStream is = mSocket.getInputStream();</div><div class="line">OutputStream out = mSocket.getOutputStream();</div></pre></td></tr></table></figure>
<p>é€šè¿‡è¾“å‡ºæµï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ is.read(receiveBuffer) å’Œ out.write(data); æ¥è¿›è¡Œæ•°æ®çš„æ”¶å‘ã€‚è¿™é‡Œç»™ä¸¤ä¸ªç®€å•å®ä¾‹ï¼š</p>
<h4 id="æ¥æ”¶æ•°æ®"><a href="/1970/01/01/[Java]Javaä¸­TCPå’ŒUDPæ€»ç»“/#æ¥æ”¶æ•°æ®" class="headerlink" title="æ¥æ”¶æ•°æ®"></a>æ¥æ”¶æ•°æ®</h4>  <figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@Override</span></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">execute</span><span class="params">()</span> </span>&#123;</div><div class="line">    <span class="keyword">try</span> &#123;</div><div class="line">        <span class="keyword">int</span> count = is.read(receiveBuffer);</div><div class="line">        <span class="keyword">if</span> (count == -<span class="number">1</span>) &#123;</div><div class="line">            notifyError();</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">byte</span>[] data = getPacket(receiveBuffer, count, is);</div><div class="line">        mReceiverQueue.put(data);</div><div class="line">    &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</div><div class="line">        e.printStackTrace();</div><div class="line">        notifyError();</div><div class="line">    &#125; <span class="keyword">catch</span> (IOException e) &#123;</div><div class="line">        e.printStackTrace();</div><div class="line">        notifyError();</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>å‡å¦‚æˆ‘ä»¬çš„æ•°æ®åŒ…åè®®æ ¼å¼å¦‚ä¸‹ï¼š  </p>
<p><img src="http://img.blog.csdn.net/20140222112122625?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvdHRkZXZz/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="">  </p>
<p>è¿™ä¸ªæ—¶å€™ï¼Œå¦‚æœè¿›è¡Œå¤§é‡æ•°æ®ä¼ è¾“çš„æ—¶å€™æˆ‘ä»¬ä»InputStreamä¸­ä¸€æ¬¡è¯»å–çš„æ•°æ®å¯èƒ½ä¸æ˜¯ä¸€ä¸ªå®Œæ•´çš„æ•°æ®åŒ…ã€‚è¿™ä¸ªæ—¶å€™æˆ‘ä»¬éœ€è¦åšä¸‹é¢çš„åˆ¤æ–­ï¼š</p>
<p>aã€è¯»å–çš„æ•°æ®é•¿åº¦æ˜¯å¦è¾¾åˆ°åŒ…å¤´å¤§å°ï¼Œè‹¥æ²¡æœ‰åŒ…å¤´é•¿ï¼Œç»§ç»­è¯»ï¼Œç›´åˆ°è¾¾åˆ°æˆ–è€…è¶…è¿‡åŒ…å¤´å¤§å°<br>bã€ä»åŒ…å¤´ä¸­è§£å‡ºé•¿åº¦å­—æ®µï¼Œå¾ªç¯è¯»å–ï¼Œç›´åˆ°è¯»åˆ°é•¿åº¦å­—æ®µæ ‡ç¤ºé•¿åº¦ä¸ºæ­¢<br>cã€æ ¡éªŒæ•°æ®ï¼Œå»é™¤åŒ…å¤´ï¼Œå–å‡ºåŒ…ä½“<br>dã€é‡å¤ä¸Šè¿°æ­¥éª¤</p>
<h4 id="å‘é€æ•°æ®"><a href="/1970/01/01/[Java]Javaä¸­TCPå’ŒUDPæ€»ç»“/#å‘é€æ•°æ®" class="headerlink" title="å‘é€æ•°æ®"></a>å‘é€æ•°æ®</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@Override</span></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">execute</span><span class="params">()</span> </span>&#123;</div><div class="line">	<span class="keyword">try</span> &#123;</div><div class="line">		<span class="keyword">byte</span>[] data = mSenderQueue.take();</div><div class="line">		out.write(data);</div><div class="line">	&#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</div><div class="line">		e.printStackTrace();</div><div class="line">		notifyError();</div><div class="line">	&#125; <span class="keyword">catch</span> (IOException e) &#123;</div><div class="line">		e.printStackTrace();</div><div class="line">		notifyError();</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>mSenderQueueå’ŒmReceiverQueueä¸€æ ·ï¼Œéƒ½æ˜¯é˜»å¡é˜Ÿåˆ—ã€‚å‘é€çš„æ—¶å€™ï¼Œæˆ‘ä»¬ä»é˜Ÿåˆ—ä¸­å–å‡ºè¦å‘é€çš„æ•°æ®ï¼Œç„¶åé€šè¿‡è¾“å‡ºæµå†™å…¥å³å¯ã€‚è¿™ä¸ªåœ°æ–¹æ¯”å‘é€ç®€å•äº†ä¸€äº›ã€‚å¯èƒ½ä½ å·²ç»æ³¨æ„åˆ°ï¼Œæˆ‘çš„å‘é€å’Œæ¥æ”¶éƒ½ç”¨äº†é˜»å¡é˜Ÿåˆ—ï¼Œè¿™ä¸ªåŸå› å°±æ˜¯è€ƒè™‘åˆ°å¤§é‡æ•°æ®çš„æ—¶å€™åšä¸€ä¸ªç¼“å†²ï¼Œå¦‚æœæ²¡æœ‰ç¼“å†²ï¼Œå¯èƒ½å¯¼è‡´ä»£ç çš„é˜»å¡ã€‚å¦å¤–å°±æ˜¯å½“æˆ‘ä»¬çš„é˜»å¡é˜Ÿåˆ—å……æ»¡çš„æ—¶å€™å¯ä»¥æ‰‹åŠ¨ä¸¢å¼ƒä¸€äº›æ•°æ®ï¼Œè¿™ä¸ªå°±æ˜¯å…·ä½“åº”ç”¨äº†ã€‚  </p>
<h3 id="æœåŠ¡ç«¯"><a href="/1970/01/01/[Java]Javaä¸­TCPå’ŒUDPæ€»ç»“/#æœåŠ¡ç«¯" class="headerlink" title="æœåŠ¡ç«¯"></a>æœåŠ¡ç«¯</h3><p>è¿™ä¸ªå¯ä»¥ç®€å•äº†è§£ä¸‹ï¼Œå¯ä»¥ä½¿ç”¨å„ç§è¯­è¨€å®ç°ï¼Œæ¯”å¦‚Javaã€C++ç­‰ã€‚è¿™é‡Œç®€å•ä»‹ç»Javaçš„å®ç°ã€‚</p>
<p>é¦–å…ˆï¼Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªServerSocketå¯¹è±¡å¹¶æŒ‡å®šä¸€ä¸ªç«¯å£å·ï¼Œé€šè¿‡è¿™ä¸ªå¯¹è±¡çš„accept()æ–¹æ³•ç­‰å¾…å®¢æˆ·çš„è¿æ¥ï¼Œè¿™ä¸ªæ–¹æ³•æ˜¯é˜»å¡çš„ï¼›å½“æœ‰å®¢æˆ·ç«¯è¿æ¥ä¸Šæ¥ä¹‹åï¼Œæˆ‘ä»¬å°±æ‹¿åˆ°äº†è¿æ¥çš„socketï¼Œæ‹¿åˆ°è¿™ä¸ªsocketä¹‹åçš„æ“ä½œå°±å’Œå®¢æˆ·ç«¯ä¸€æ ·äº†ï¼Œæœ€åçœ‹ä¸€ä¸‹å…³é”®ä»£ç ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">try</span> &#123;</div><div class="line">	ServerSocket serverSocket = <span class="keyword">new</span> ServerSocket(<span class="number">9559</span>);</div><div class="line">	<span class="keyword">while</span> (<span class="keyword">true</span>) &#123;</div><div class="line">		Socket socket = serverSocket.accept();</div><div class="line">		<span class="comment">// new ServiceSocketThread(socket).start();</span></div><div class="line">	&#125;</div><div class="line">&#125; <span class="keyword">catch</span> (Exception e) &#123;</div><div class="line">	e.printStackTrace();</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>å› ä¸ºæœåŠ¡ç«¯ä¸å¯èƒ½åªä¸ä¸€ä¸ªå®¢æˆ·ç«¯è¿æ¥ï¼Œå› æ­¤ä¸Šé¢çš„ä»£ç å†™åœ¨ä¸€ä¸ªæ­»å¾ªç¯ä¸­ã€‚æ‹¿åˆ°socketä¹‹åèµ·ä¸€ä¸ªæ–°çš„çº¿ç¨‹æ¥å¤„ç†è¿™ä¸ªsocketã€‚å½“ç„¶ï¼Œå®é™…æƒ…å†µå¯èƒ½ä¸æ˜¯è¿™æ ·ï¼Œä¸ºæ¯ä¸€ä¸ªè¿æ¥åˆ›å»ºä¸€ä¸ªæ–°çš„çº¿ç¨‹æ˜¯å¾ˆè€—è´¹èµ„æºçš„ã€‚</p>
<p>æœ€åï¼Œè¿˜æœ‰ä¸€ç‚¹éœ€è¦æ³¨æ„çš„æ˜¯ï¼šä»Socketä¸­æ‹¿åˆ°InputStreamå’ŒOutputStreamä¹‹åå¦‚æœå…³é—­å®ƒä»¬ï¼Œsocketä¹Ÿå°†éšä¹‹å…³é—­(æœªéªŒè¯)ã€‚</p>
<h2 id="0x02-UDP"><a href="/1970/01/01/[Java]Javaä¸­TCPå’ŒUDPæ€»ç»“/#0x02-UDP" class="headerlink" title="0x02 UDP"></a>0x02 UDP</h2><p>è¿™ä¸ªä¸œè¥¿ç”¨çš„å¾ˆå°‘ï¼Œå°±æ˜¯å½“åˆæµ‹è¯•P2Pçš„æ—¶å€™ç”¨è¿‡ã€‚èƒ½æƒ³åˆ°çš„é—®é¢˜å°±æ˜¯æ•°æ®å¤§å°çš„é—®é¢˜ï¼Œæ¯”å¦‚å‘é€æ•°æ®æˆ‘ä»¬çš„æ•°æ®å®šä¹‰ä¸ºå¤šå¤§åˆé€‚ã€‚ä½†æ˜¯æœ€åæ²¡æœ‰å®é™…çš„é¡¹ç›®éªŒè¯ï¼Œåœ¨æ­¤ä¹Ÿä¸å¥½å›ç­”ã€‚å…ˆè´´ä¸€æ®µä»£ç å‡ºæ¥ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UDPServer</span> <span class="keyword">extends</span> <span class="title">BaseThread</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * å‘é€é˜Ÿåˆ—å¤§å°</div><div class="line">     */</div><div class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> SENDQUEUESIZE = <span class="number">10</span>;</div><div class="line">    <span class="comment">/**</span></div><div class="line">     * æ¥æ”¶é˜Ÿåˆ—å¤§å°</div><div class="line">     */</div><div class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> RECEIVEQUEUESIZE = <span class="number">10</span>;</div><div class="line">    <span class="comment">/**</span></div><div class="line">     * UDPæ¥æ”¶ç¼“å­˜å¤§å°</div><div class="line">     */</div><div class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> RECEIVERBUFFERSIZE = <span class="number">1024</span>;</div><div class="line">    <span class="comment">/**</span></div><div class="line">     * UDPæ¥æ”¶ç¼“å­˜å¤§å°</div><div class="line">     */</div><div class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> RECEIVERPACKETSIZE = <span class="number">1024</span> * <span class="number">64</span>;</div><div class="line"></div><div class="line">    <span class="keyword">private</span> <span class="keyword">int</span> count = <span class="number">0</span>;</div><div class="line">    <span class="keyword">private</span> DatagramPacket receivePacket;</div><div class="line">    <span class="keyword">private</span> DatagramSocket mSocket;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">prepare</span><span class="params">()</span> </span>&#123;</div><div class="line">        receivePacket = <span class="keyword">new</span> DatagramPacket(<span class="keyword">new</span> <span class="keyword">byte</span>[RECEIVERPACKETSIZE], RECEIVERPACKETSIZE);</div><div class="line">        <span class="keyword">try</span> &#123;</div><div class="line">            mSocket = <span class="keyword">new</span> DatagramSocket(<span class="number">9559</span>);</div><div class="line">        &#125; <span class="keyword">catch</span> (SocketException e) &#123;</div><div class="line">            System.out.println(String.format(<span class="string">"udp connect init error: %s"</span>, e.getMessage()));</div><div class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">execute</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">try</span> &#123;</div><div class="line">            mSocket.receive(receivePacket);</div><div class="line"></div><div class="line">            <span class="keyword">byte</span>[] data = receivePacket.getData();</div><div class="line">            <span class="keyword">int</span> length = receivePacket.getLength();</div><div class="line">            <span class="keyword">int</span> offset = receivePacket.getOffset();</div><div class="line">            System.out.print(++count</div><div class="line">                    + String.format(<span class="string">"length:%d|%d, offset:%d, data: %s \n"</span>, length, data.length, offset, <span class="keyword">new</span> String(data, <span class="string">"gbk"</span>)));</div><div class="line">            System.out.println(data[<span class="number">1024</span>]);</div><div class="line">        &#125; <span class="keyword">catch</span> (SocketException e) &#123;</div><div class="line">            System.out.println(String.format(<span class="string">"udp connect init error: %s"</span>, e.getMessage()));</div><div class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</div><div class="line">            System.out.println(String.format(<span class="string">"udp connect init error: %s"</span>, e.getMessage()));</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><code>byte[] data = receivePacket.getData();</code> </p>
<p>è¿™ä¸ªåœ°æ–¹æ‹¿åˆ°çš„dataæ˜¯ç¼“å†²åŒºçš„å¤§å°ï¼Œä»–ä»¬åœ°å€æ˜¯ä¸€æ ·çš„ï¼Œè¿™ä¸ªå¤§å®¶å¯ä»¥è¯•è¯•å°±çŸ¥é“ã€‚è‡³äºè¿™ä¸ªdataä¸­æœ‰å¤šå°‘æ•°æ®ï¼Œå°±éœ€è¦æˆ‘ä»¬é€šè¿‡ <code>receivePacket.getLength();</code> æ‹¿åˆ°ã€‚</p>
<p><img src="https://raw.githubusercontent.com/ttdevs/ttdevs.github.io/common/images/logo.png" alt="Create by ttdevs"></p>
]]></content>
      
        <categories>
            
            <category> æŠ€æœ¯ </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Java </tag>
            
        </tags>
        
    </entry>
    
  
  
</search>
